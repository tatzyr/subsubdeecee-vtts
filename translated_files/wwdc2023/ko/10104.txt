10104

♪ ♪

알렉스: 안녕하세요, 저는 알렉스 아브라메츠입니다.

"미디어 앱을 HomePod와 통합하세요"에 오신 것을 환영합니다.

저는 홈을 위한 흥미롭고 새로운 Siri 기능을 소개하기 위해 왔습니다.

iOS 17부터 HomePod 소유자는 iPhone 또는 iPad에 설치된 앱을 사용하여 Siri에게 미디어를 재생하도록 요청할 수 있습니다.

이 새로운 Siri 기능을 사용하면 현재 SiriKit 미디어 인텐트를 지원하는 앱이 HomePod에서 콘텐츠를 원활하게 재생할 수 있습니다.

먼저, 저는 HomePod에서 재생할 미디어 앱에 대한 확장된 지원을 소개할 것입니다.

그런 다음, 나는 지원되는 사용 사례와 경험을 다루고 그것들을 구현하는 가장 좋은 방법을 보여줄 것이다.

마지막으로, 나는 이 기능이 집과 어떻게 통합되는지에 대해 이야기할 것이다.

더 많은 미디어 앱에 대한 HomePod 지원을 검토하는 것으로 시작합시다.

HomePod가 요청을 처리하면, SiriKit 인텐트가 iPhone으로 전송되며, Siri는 앱을 시작하고 AirPlays 콘텐츠를 스피커로 다시 보냅니다.

우리는 이 세션의 뒷부분에서 AirPlay 지원에 대해 더 이야기할 것이다.

요청을 이행하기 위해, HomePod는 Wi-Fi를 통해 iPhone과 통신할 것이며, 이는 요청 시 장치가 동일한 네트워크에 있어야 한다는 것을 의미합니다.

장치는 물리적으로 근접할 필요가 없다.

만약 내가 거실에서 스피커와 이야기하고 있고 내 휴대폰이 침실에서 충전되고 있다면, HomePod는 성공적으로 재생될 것이다.

Siri는 AirPlay를 지원하는 대부분의 스피커를 포함하여 여러 목적지에서 미디어 작업을 재생하도록 요청합니다.

오늘날 SiriKit Media Intents를 지원하는 모든 앱은 추가 변경 없이 이 기능을 사용할 수 있습니다.

나중에, 나는 사용자 경험과 성능을 더 좋게 만들 수 있는 몇 가지에 대해 이야기할 것이다.

HomePod에서 기본적으로 지원되지 않는 앱에 대한 재생, 추가 및 선호도 요청은 기본 iPhone으로 라우팅됩니다.

HomePod에서 미디어를 찾거나 검색하면 재생이 된다는 점에 유의하십시오.

Siri는 음성 인식에 의존하여 인식된 홈 사용자의 장치로 요청을 라우팅할 것이다.

또한, 노래 "좋아요" 또는 "추가" 요청은 Siri를 사용하지 않고 AirPlay된 콘텐츠에서도 작동합니다.

이제 많은 기존 미디어 앱을 HomePod에서 사용할 수 있으며, 단순한 음악이 아닙니다.

많은 종류의 미디어가 지원된다.

음악, 오디오북, 팟캐스트, 라디오, 명상 등.

SiriKit Media 의도에 대한 새로운 지원을 추가하는 모든 앱은 HomePod에서 자동으로 지원됩니다.

당신의 앱이 오늘 iOS에서 할 수 있는 모든 것은 HomePod에서 작동할 것입니다.

예를 들어, 앱 사용자는 아티스트, 앨범, 노래, 음악 장르 및 히트곡을 재생하도록 요청할 수 있습니다.

앱 이름이 요청에 사용되면, Siri는 앱이 iPhone에 설치되어 있는지 확인합니다.

앱이 설치되면, Siri는 AirPlay 연결을 설정하고 앱에 재생을 시작하도록 요청합니다.

아마도 당신의 앱은 팟캐스트나 오디오북을 듣는 것에 관한 것입니다.

이제 뉴스를 따라잡거나 HomePod에서 현재 오디오북을 계속 들을 수 있습니다.

Siri는 속도 변경, 빨리 감기 및 재생 제어 요청을 이해할 것이다.

앱과 관련이 있고 미디어 인텐트가 다루지 않는 요청은 앱 인텐트를 사용하여 구현할 수 있습니다.

"앱 인텐트 개선 사항 탐색" 및 기타 관련 세션을 확인하세요.

그래서 내 앱에 Siri를 어떻게 추가하나요?

SiriKit 미디어 인텐트를 지원하는 데 필요한 것을 살펴본 다음, 모든 것이 안정적으로 작동하고 훌륭한 경험을 제공하는지에 대해 이야기해 봅시다.

미디어 인텐트를 지원하는 앱은 그냥 작동할 것이다.

예를 들어, 사운드클라우드가 아이폰에 설치되어 있고 홈팟에게 사운드클라우드에서 무언가를 재생하도록 요청하면, 미디어는 스피커에서 재생됩니다.

Siri를 통해 재생 지원을 앱에 추가하는 것은 몇 가지 간단한 단계를 포함합니다.

인텐트 확장을 추가하고 검색 및 재생으로 Siri 콜백을 연결하는 몇 가지 방법을 구현해야 합니다.

2019년의 "SiriKit 미디어 의도 소개" 비디오와 2020년의 "SiriKit 미디어 의도를 더 많은 플랫폼으로 확장"에서 자세한 지침을 찾을 수 있습니다.

노래를 재생할 수 있는 샘플 앱에서 코드를 검사해 봅시다.

여기서, 저는 그 요청이 "Push it"이라는 엔티티에 대한 것인지 확인하고 있으며, 만약 그렇다면, 미디어 항목을 반환합니다.

한 번 해보자.

Siri야, Control Audio에서 Dukes의 "Push It"을 틀어줘.

Siri: "Push It"은 이제 iPhone에서 재생됩니다.

알렉스: 그 노래는 예상대로 재생된다!

이제 다른 걸 물어보자.

Siri야, 컨트롤 오디오에서 재즈를 틀어줘.

Siri: 당신의 컨트롤 오디오 라이브러리에서 그것을 찾을 수 없습니다.

알렉스: 이번에는, Siri가 아무것도 찾지 못했다고 말했다.

이것은 내 앱이 장르 재생을 지원하지 않기 때문에 기능이 "지원되지 않는" 응답을 반환했기 때문에 발생했다.

하지만 나는 Siri가 더 잘 반응하도록 할 수 있어!

"지원되지 않는 미디어 유형"이나 앱에 유효한 로그인이 필요한 것과 같이 재생할 수 없는 더 구체적인 이유를 제공할 수 있습니다.

그러한 경우, Siri는 문제를 해결하는 데 도움이 되는 응답을 제공할 것이다.

이제, 저는 제 코드를 변경하고 요청이 음악 장르를 재생하는 것이라면 더 구체적인 오류 코드를 반환할 가드 문을 추가할 것입니다.

Siri야, 컨트롤 오디오에서 재즈를 틀어줘.

Siri: 컨트롤 오디오는 재생을 지원하지 않습니다.

알렉스: 그래서 이제, 시리는 앱이 그것을 재생하는 것을 지원하지 않는다고 말하는데, 이는 더 유용한 반응이다.

Siri 요청이 이루어질 때 앱이 무엇을 받을지 궁금할 수도 있습니다.

이전 예시에서, 우리는 "mediaName"과 "mediaType" 필드에 대해 논의했다.

당신의 앱이 얻을 수 있는 가장 일반적인 의도 중 일부를 검토해 봅시다.

앱 이름만으로 간단한 "플레이"는 검색 기준 없이 의도를 보낼 것이다.

음악 앱은 개인 믹스나 스테이션을 재생할 수 있다.

팟캐스트와 오디오북 앱은 마지막으로 재생된 항목을 재개할 수 있습니다.

"앱에서 음악 재생" 요청의 경우, "음악"은 "mediaType"으로 번역됩니다.

엔티티 이름이 있는 "재생" 요청은 mediaName 필드만 제공합니다.

노래, 아티스트, 팟캐스트 또는 다른 것이든, 엔티티의 유형을 결정하는 것은 앱에 달려 있습니다.

"노래"와 그 이름을 언급하면 노래와 같은 mediaType과 mediaName 필드가 생성됩니다.

이것이 "인기 히트"를 요구하는 방식이 될 것이다.

미디어 이름은 "음악"으로 설정되고 정렬 순서는 "인기"가 될 것이다.

다음에 무언가를 재생하도록 요청하면 앱에 대기열에 추가하라고 말할 것이다.

"Playbackqueuelocation"은 "next"의 값을 가지고 있습니다.

앱이 뉴스, 팟캐스트 또는 오디오북을 지원하는 경우, "내 오디오북 재생", "최신 뉴스 재생" 또는 "기술 뉴스 팟캐스트 재생"과 같은 요청을 받을 수 있습니다.

앱으로 전송될 것으로 예상되는 요청에 대해 Siri가 생성한 의도를 탐구하고 실험해야 합니다.

결과를 해결한 후, Siri는 당신의 의도 확장에서 "처리" 단계를 실행할 것입니다.

"handleInApp"과 "continueInApp"의 두 응답 중 하나를 반환할 수 있습니다.

"HandleInApp"은 시스템에 앱을 시작하고 백그라운드에서 재생하도록 지시할 것이다.

"ContinueInApp"은 시스템에 포그라운드에서 앱을 시작하도록 요청할 것이다.

오디오 재생 요청의 경우, 백그라운드 재생은 휴대폰의 잠금을 해제할 필요가 없기 때문에 더 나은 경험을 제공할 것입니다.

HomePod에 요청이 있을 때, 휴대폰이 근처에 없을 수 있기 때문에 훨씬 더 두드러집니다.

Siri 콜백에 대한 앱의 응답은 상당히 빨라야 한다는 것을 명심하세요.

느린 요청은 종종 포기되거나 단순히 시간 밖에 없다.

앱이 최대 10초 안에 응답하는지 확인하세요.

가능한 한 빨리 하는 것이 바람직하지만, 10초 후에 Siri의 반응은 일반적이고 별로 도움이 되지 않을 것이다.

Siri에게 노래나 팟캐스트를 좋아한다고 말하고 싶거나, 재생 목록에 추가하고 싶다면 어떨까요?

INAddMediaIntent와 INUpdateMediaAffinityIntent를 지원하면 앱이 이러한 요청을 처리할 수 있습니다.

구현은 INPlayMediaIntent와 매우 유사하다.

AirPlayed 콘텐츠의 경우, Siri는 말하는 사람의 iPhone으로 요청을 보낼 것이다.

Siri와 앱의 통합을 더 강력하게 만들 수 있는 몇 가지 사항을 살펴봅시다.

첫 번째는 개인 앱 어휘입니다.

개인 앱 어휘를 사용하여, 당신의 앱은 요청에 포함될 수 있는 사용자별 엔티티의 시스템을 알릴 수 있습니다.

여기에는 개인 재생 목록, 구매한 오디오북, 팟캐스트, 좋아하는 아티스트 또는 작가가 포함될 수 있습니다.

일반적으로 포그라운드 앱만 재생을 시작할 수 있지만, Siri 요청 중에는 앱이 백그라운드에서 오디오를 시작할 수 있습니다.

이것이 작동하려면, 해당 세션을 활성화하기 전에 오디오 세션을 올바르게 구성하는 것이 매우 중요합니다.

이것은 HomePod, iOS 및 CarPlay를 포함한 지원되는 모든 플랫폼에 적용됩니다.

이 예에서, 오디오 카테고리를 재생으로 설정함으로써, 앱은 오디오를 재생할 것이라고 시스템에 알릴 것이다.

오디오 카테고리, 모드 및 경로 공유 정책은 시스템이 오디오 재생 및 중단을 처리하는 방식에 영향을 미칩니다.

모드를 "음성 오디오"로 설정하면 콘텐츠의 볼륨을 일시적으로 줄이는 대신 중단될 때 재생이 일시 중지됩니다.

이것은 청취자가 콘텐츠의 중요한 부분을 놓치지 않도록 팟캐스트나 오디오북을 재생하는 앱에 특히 유용합니다.

세션을 활성화하기 전에 오디오 카테고리가 ".playback"으로 설정되지 않으면 어떻게 되는지 확인해 봅시다.

이봐, Siri, Control Audio에서 Dukes의 "Push It"을 틀어줘.

Siri: "Push It"은 이제 iPhone에서 재생됩니다.

알렉스: 앱이 전경에 있는 동안, 오디오가 재생되지만, 앱이 백그라운드로 들어가면, 예를 들어 휴대폰을 잠그면 재생이 멈춥니다.

그것은 작동하지만, 당신이 기대하는 방식은 아닙니다.

오디오 세션을 올바르게 구성하기 위해 코드를 변경하면 어떻게 되는지 알아봅시다.

이봐, Siri, Control Audio에서 Dukes의 "Push It"을 틀어줘.

Siri: 여기 당신의 iPhone에서 "Push It"이 있습니다.

알렉스: 내가 핸드폰을 잠그면, 오디오가 계속 재생된다.

♪ ♪

HomePod와 iPhone은 많은 일을 할 수 있으므로, 앱에서 오디오 재생이 수신 전화, 탐색 프롬프트, Siri 요청 또는 다른 것을 재생하는 다른 앱에 의해 중단되는 것은 드문 일이 아닙니다.

특히 방 건너편의 누군가가 HomePod와 이야기하고 있고 iPhone이 편리하지 않을 때 앱이 계속 재생될 수 있도록 중단을 처리하는 것이 중요합니다.

좋아, 에어플레이에 대해 얘기하자.

시스템이 앱에서 콘텐츠를 성공적으로 AirPlay하려면 다음을 수행해야 합니다. 앞서 이야기한 것처럼 오디오 카테고리, 모드 및 경로 공유 정책을 적절하게 설정하고, MPNowPlayingInfoCenter를 사용하여 현재 재생 중인 항목에 대해 시스템에 알리고, MPRemoteCommandCenter를 사용하여 재생, 일시 중지 및 건너뛰기와 같은 원격 명령을 수신하십시오.

이 단계는 AirPlay 스피커에서 재생되는 앱에서 미디어를 얻을 수 있습니다.

하지만 오디오 데이터가 다른 장치로 전달되고 있기 때문에, 시스템은 버퍼가 필요하며 원활한 재생을 보장하기 위해 일부 데이터를 축적할 것이다.

이것은 미디어가 재개되거나 중단될 때마다 지연을 초래할 수 있다.

버퍼링된 재생을 위해 API 중 하나를 사용하면 이러한 우려가 제거됩니다.

이 주제에 대한 자세한 내용은 "AirPlay 경험 조정"이라는 올해의 세션을 확인하세요.

다음으로, 나는 이 능력에 대한 추가적인 고려 사항에 대해 이야기할 것이다.

iPhone이나 iPad가 여러 개 있으면 어떡하지? Siri는 어떤 것을 사용해야 할지 어떻게 알 수 있을까요?

답은 Siri가 Apple ID 및 내 찾기 설정에서 위치를 공유하도록 설정된 기본 iPhone으로 SiriKit Media 요청을 라우팅한다는 것입니다.

Siri는 이러한 요청을 이행하기 위해 다른 장치와 통신하기 때문에, 요청하는 사용자는 홈에 등록하고 내 음성 인식을 활성화해야 합니다.

홈 앱에서 이 설정을 찾을 수 있습니다.

이 기능이 작동하려면 개인 요청을 활성화할 필요가 없습니다.

"내 목소리 인식"을 활성화하지 않았거나 홈에 등록되지 않은 경우, 귀하 또는 다른 사람의 장치에서 미디어를 재생할 수 없다는 것을 명심하십시오.

방금 앱을 설치했거나 Siri에게 재생을 요청한 적이 없다면, 앱을 사용하여 재생하라는 첫 번째 요청은 iOS 장치로 안내하고 Siri가 앱 데이터에 액세스할 수 있는 권한을 요청합니다.

이 권한은 앱에서 재생하기 위한 첫 번째 Siri 요청에만 필요합니다.

내가 널 보내기 전에, 여기 네가 기억해야 할 것들이 있어.

SiriKit 미디어 인텐트 지원을 추가하는 것은 앱이 HomePod에서 작동하는 데 필요한 한 가지입니다.

버퍼 재생을 추가하고, 더 복잡한 쿼리를 지원하고, Siri에게 더 많은 컨텍스트를 제공함으로써 사용자 경험을 더욱 향상시킬 수 있습니다.

고마워!

당신의 앱이 HomePod에서 작동하는 것을 빨리 보고 싶어요!

♪ ♪