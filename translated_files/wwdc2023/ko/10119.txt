10119

♪ 부드러운 기악 힙합 ♪

♪

데이비드 존슨: 안녕하세요, 여러분.

"Safari 확장 프로그램의 새로운 기능"에 오신 것을 환영합니다.

제 이름은 데이비드 존슨이고, 저는 여기 애플의 사파리 확장 엔지니어입니다.

오늘, 저는 사용자 경험과 새로운 기능의 개선을 강조하는 사파리 확장의 최근 발전에 대해 이야기하게 되어 기쁩니다.

먼저, 오늘 App Store에서 사용할 수 있는 2000개 이상의 Safari 확장 프로그램을 만들고 공유해 주셔서 감사합니다.

iOS의 사파리 확장에 대한 수요는 특히 인상적이었다.

그들은 종종 WWDC21에서 소개된 이후 App Store의 상위 카테고리 중 하나이다.

확장 프로그램을 사용하면 macOS, iOS 및 iPadOS에서 브라우징 경험을 사용자 정의할 수 있습니다.

사파리 확장 프로그램을 만드는 네 가지 방법이 있습니다: 콘텐츠 차단기, 공유 확장, 앱 확장 및 웹 확장.

사파리 17은 이러한 모든 유형을 계속 지원하지만, 브라우저 사용자 지정의 미래는 웹 확장에 있다.

애플은 다른 주요 브라우저 공급 업체와 함께 웹 확장을 표준화하는 데 전념하고 있다.

이 협업은 호환성을 개선하고, 개발을 간소화하며, 모든 브라우저에서 친숙한 경험을 보장하는 것을 목표로 한다.

우리는 Apple이 자랑스럽게 공동 의장을 맡고 있는 W3C WebExtensions 커뮤니티 그룹에서 함께 일하고 있습니다.

이 표준화 노력을 추진하기 위해 다른 브라우저 및 확장 개발자와 연결함으로써, 우리는 더 강력하고 통합된 웹 확장 생태계를 구축하고 있습니다.

오늘의 주제로 뛰어들기 전에, 저는 사파리 웹 확장에 대한 두 가지 주요 세부 사항을 공유하고 싶습니다.

첫째, 사파리 17은 매니페스트 v2와 v3 웹 확장을 모두 계속 지원할 것이다.

우리는 매니페스트 v3에 새로운 기능을 계속 추가할 것이므로, 확장에 의미가 있을 때 업데이트하십시오.

둘째, 웹 확장은 플랫폼 전반에 걸쳐 사파리 확장을 만드는 가장 좋은 방법입니다.

단일 공유 코드베이스를 통해 웹 확장 프로그램을 사용하면 iOS, iPadOS, macOS 및 현재 xrOS에서 Safari의 기능을 사용자 정의할 수 있습니다.

맞습니다, iOS와 iPadOS에서 사용할 수 있는 웹 확장 프로그램은 xrOS에서도 사용할 수 있습니다.

xrOS의 웹 확장 프로그램은 예상대로 작동하며 스크립트를 삽입하고, 배경 콘텐츠를 실행하고, 팝오버를 표시하는 기능을 포함하여 iOS의 확장 프로그램과 동일한 기능을 가지고 있습니다.

우리는 당신의 확장 프로그램이 xrOS에서 브라우징 경험을 어떻게 향상시키는지 보게 되어 기쁩니다.

xrOS에서 Safari에 대해 자세히 알아보려면, "xrOS용 Safari 만나기"를 확인하세요.

그 발표와 함께, 오늘 세션의 나머지 부분에서 다룰 내용은 다음과 같습니다.

먼저, 우리는 새롭고 업데이트된 확장 API와 Safari 확장의 기능을 향상시키는 방법을 탐구할 것입니다.

그런 다음 Safari 앱 확장에 대한 사이트별 권한을 다루어 사용자에게 브라우징 경험을 더 잘 제어할 수 있도록 합니다.

그리고 마지막으로, 우리는 사파리 프로필과 개인 브라우징 모두와의 호환성을 보장하는 방법을 살펴볼 것입니다.

먼저, 새로운 확장 API.

콘텐츠 차단기는 웹 페이지를 정리하고, 성가심을 제거하고, 스크립트 로딩을 차단하는 좋은 방법입니다.

콘텐츠 차단기는 JSON에 정의된 규칙을 사용하여 방문한 웹사이트에 대한 정보에 접근할 필요 없이 콘텐츠를 차단하거나 숨깁니다.

웹 페이지에 콘텐츠를 선언적으로 숨기는 것은 까다로울 수 있다.

그것이 콘텐츠 차단기가 이제 :has() 선택기를 지원하는 이유입니다.

:Has() 선택기는 콘텐츠 차단기가 자식을 기반으로 부모 요소를 정확하게 타겟팅할 수 있기 때문에 좋습니다.

이 규칙 예제에서, 우리는 .paid-promo 클래스와 자식 요소가 있는 .post 클래스의 요소를 숨기고 있습니다.

웹 페이지 콘텐츠를 숨기거나 네트워크 요청을 차단하는 확장 프로그램은 가장 인기 있는 유형의 확장 프로그램 중 일부입니다.

그렇기 때문에 사파리는 사용자에게 안전하고 사적인 브라우징 경험을 제공하는 혁신적이고 효과적인 확장 프로그램을 만드는 데 계속 지원합니다.

웹 확장 프로그램으로 네트워크 요청을 차단하거나 수정하려는 경우, 선언적 넷 요청에 대한 이러한 업데이트를 확인해야 합니다.

Declarative Net Request는 웹 확장 프로그램이 네트워크 요청을 차단하고 수정할 수 있는 방법을 제공하는 강력한 API입니다.

콘텐츠 차단기와 마찬가지로, 확장 프로그램은 JSON 형식으로 규칙을 제공하고 Safari는 나머지를 처리합니다.

이것은 특히 배터리 구동 장치에서 향상된 전력 효율을 의미합니다.

이러한 규칙은 선언적이기 때문에, 확장 프로그램은 사용자가 방문하는 웹 페이지에 액세스할 필요가 없기 때문에 개인 정보 보호와 보안이 강화됩니다.

사파리 16.4의 선언적 넷 요청에 대한 한 가지 큰 업데이트는 확장 프로그램이 이제 요청 헤더를 수정할 수 있다는 것입니다.

이 예에서, 저는 example.com에 대한 모든 요청에 대한 사용자 지정 사용자-에이전트 헤더를 설정하는 작업을 정의했습니다.

헤더 설정 외에도, 이 작업 유형은 새 값을 추가하거나, 기존 값을 제거하거나, HTTP 요청에서 헤더를 완전히 제거하여 헤더를 수정할 수 있습니다.

네트워크 요청을 수정하는 것은 강력한 도구이며, 명심해야 할 몇 가지 핵심 사항이 있습니다.

먼저, 매니페스트에서 declarativeNetRequestWithHostAccess 권한을 선언해야 합니다.

사파리 16.4에서, 이 권한은 이제 리디렉션 작업에도 필요합니다.

확장은 또한 수정 헤더 또는 리디렉션 작업을 적용할 수 있는 사이트별 권한을 부여받아야 합니다.

이것은 사용자가 사이트별로 데이터를 제어할 수 있도록 보장한다.

이러한 고려 사항을 염두에 함으로써, 사용자에게 맞춤형 경험을 제공하는 강력하고 개인 정보 보호 친화적인 콘텐츠 차단 확장 프로그램을 만들 수 있습니다.

Declarative Net Request를 사용하는 확장 프로그램을 구축하는 경우, 사용자에게 얼마나 많은 요청을 차단했는지 알릴 수 있습니다.

새로운 declarativeNetRequest.setExtensionActionOptions API를 사용하여 차단된 로드 수와 같은 작업 수를 표시하도록 배지 텍스트를 구성할 수 있습니다.

이 예에서, 우리는 displayActionCountAsBadgeText 옵션을 true로 설정했는데, 이는 현재 이 API의 유일한 옵션입니다.

확장 배지는 취한 조치에 따라 자동으로 업데이트됩니다.

이를 통해 사용자는 브라우징 기록을 비공개로 유지하면서 확장 프로그램의 활동과 효과를 쉽게 모니터링할 수 있습니다.

이제 확장 프로그램의 동작을 더 잘 제어할 수 있는 스크립팅 API에 대한 업데이트를 다룰 것입니다.

registerContentScript API 세트를 사용하면 프로그래밍 방식으로 등록, 업데이트 또는 제거할 수 있는 콘텐츠 스크립트를 만들 수 있습니다.

이것은 콘텐츠 스크립트에 적용할 특정 페이지나 조건을 타겟팅할 수 있다는 것을 의미합니다.

이 예에서, 저는 webkit.org와 일치하는 페이지에 주입할 스크립트를 등록하고 있습니다.

이 스크립트 등록은 세션 전반에 걸쳐 지속될 것이다.

이 새로운 API는 확장 매니페스트에 정의된 정적 콘텐츠 스크립트를 보완하여 콘텐츠 스크립트를 관리하는 데 더 큰 유연성을 제공하고 확장을 위한 고급 기능을 만들 수 있습니다.

사파리 16.4는 또한 웹 확장에 새로운 저장 영역을 제공합니다: 세션 저장 영역.

세션 저장소에서 데이터를 저장하고 검색하는 것은 다른 저장 영역과 동일한 친숙한 기능을 사용합니다.

이 API를 사용하면 브라우저 세션 동안 메모리에 데이터를 저장할 수 있으며, 비영구적인 백그라운드 페이지 로드 간에 데이터에 액세스할 수 있는 빠르고 효율적인 방법을 제공합니다.

로컬 스토리지와 달리, 세션 스토리지는 디스크에 유지되지 않으며 사파리가 종료될 때 지워진다.

이를 통해 세션 저장소는 로컬 저장소에 저장해서는 안 되는 암호 해독 키 또는 인증 토큰과 같은 민감한 또는 보안 관련 데이터를 저장하는 데 특히 유용합니다.

마지막으로, 우리는 당신의 확장 프로그램이 다른 UI 요소에 대한 모든 올바른 아이콘 크기를 가지고 있는지 확인하는 것이 번거로운 일이라는 것을 알고 있습니다.

그렇기 때문에 Safari 16.4에서 시작하여, 이제 어떤 크기에서도 아름답게 보이는 단일 SVG 아이콘을 만들 수 있습니다.

사파리는 확장 프로그램의 아이콘을 날카롭게 확장하여 다른 모든 것에 집중할 수 있도록 합니다.

이러한 API 업데이트는 올해 사파리 확장의 개선 사항 중 일부일 뿐입니다.

이제 사파리 앱 확장과 사이트별 권한에 대해 이야기해 봅시다.

웹 확장 프로그램의 사이트별 권한에 이미 익숙하다면, 앱 확장에서도 같은 방식으로 작동합니다.

사용자는 탐색할 때 웹사이트에 대한 확장 액세스 권한을 부여하여 더 나은 개인 정보 보호 및 제어를 제공할 수 있습니다.

확장 프로그램이 처음 켜지면, 사용자가 방문하는 어떤 사이트에도 접근할 수 없습니다.

확장 프로그램이 처음으로 페이지에 액세스하려고 할 때, 사파리는 확장 프로그램의 도구 모음 항목에 배지를 부여하여 사용자에게 확장 프로그램이 현재 페이지에 액세스하기를 원한다고 경고합니다.

사용자가 해당 도구 모음 항목을 클릭하면, 확장 프로그램에 대한 액세스에 대한 정보가 표시되며, 하루 동안 허용 또는 항상 허용 옵션이 제공됩니다.

권한이 부여되면, 확장 프로그램의 도구 모음 항목은 확장 프로그램이 현재 페이지에 액세스할 수 있음을 보여주기 위해 착색됩니다.

Safari 17로 업그레이드하고 이미 Safari 앱 확장 프로그램을 켠 사람은 해당 확장 프로그램에 대한 모든 권한을 마이그레이션할 수 있습니다.

그들은 또한 사생활을 높일 수 있는 옵션을 제공하는 배너를 보게 될 것이다.

각 웹사이트 요청이 선택되면, 모든 사파리 앱 확장 권한이 재설정되며, 사용자는 방문할 때 각 사이트에 대한 확장 액세스 권한을 부여할 수 있습니다.

Safari 17에서 이러한 변경 사항을 지원하기 위해 채택할 새로운 API는 없지만, 확장 프로그램의 가정을 검토하고 Safari 17에서 확장 프로그램이 어떻게 작동하는지 테스트하는 데 시간이 좀 걸리십시오.

사용자는 모든 사파리 앱 확장 프로그램이 액세스할 수 있는 웹사이트를 완전히 제어할 수 있습니다.

사용자가 권한을 부여하면 확장 프로그램은 자동으로 사이트에 액세스할 수 있습니다.

그러나, 허가는 언제든지 부여되거나 취소될 수 있다.

도구 모음 항목은 이제 모든 확장 프로그램에 대해 기본적으로 표시됩니다.

Safari에서 확장 아이콘이 어떻게 나타나는지 살펴보고 적절하게 착색할 수 있는 PDF 벡터 아이콘을 제공하십시오.

마지막으로, 프로필과 비공개 브라우징 모두에서 확장이 어떻게 작동하는지에 대한 업데이트에 대해 이야기해 봅시다.

Safari 17에서 사용자는 다른 브라우징 컨텍스트에서 확장 프로그램을 끌 필요 없이 개인 브라우징 창과 탭에 액세스할 수 있는 확장 프로그램을 제어할 수 있습니다.

스크립트를 삽입하거나 사용자가 방문하는 페이지에 대한 정보를 읽을 수 있는 확장 프로그램은 기본적으로 꺼져 있습니다.

그러나 콘텐츠 차단제와 같은 콘텐츠에 액세스하지 않는 확장 프로그램은 추가적인 개인 정보 보호 문제가 없기 때문에 비공개 브라우징에서 자동으로 허용됩니다.

다음은 macOS의 Safari 설정에서 업데이트된 확장 창이며 iOS에서도 비슷한 업데이트가 있습니다.

개인 브라우징에서 이 확장을 허용하는 새로운 옵션이 있습니다.

확장 프로그램이 켜져 있는 경우, Safari 설정에서 한 번의 클릭으로 해당 확장 프로그램이 비공개 브라우징에 액세스할 수 있도록 합니다.

프로필은 올해 사파리에서 새로 생겼습니다.

그것들은 브라우징 데이터를 분리하는 방법이다.

프로필에는 별도의 기록, 쿠키 및 웹사이트 데이터가 포함되어 있습니다.

사용자는 또한 프로필당 어떤 확장 프로그램을 켜고 싶은지 선택할 수 있습니다.

여기에는 새로운 탭 페이지 확장이 포함됩니다.

그리고 물론, 이러한 모든 설정은 iCloud를 통해 사용자의 모든 iPhone, iPad 및 Mac에서 동기화됩니다.

사파리 설정의 확장 창도 확장이 활성화된 프로필을 나열하도록 업데이트되었습니다.

여기서 당신은 Sea Creator 확장이 직장과 학교 프로필 모두에서 활성화되어 있다는 것을 알 수 있습니다.

프로필에서 확장이 켜지면, 그것은 그 확장의 완전히 새로운 인스턴스이다.

이것은 각 인스턴스가 다른 UUID, 배경 페이지 및 저장소를 가질 것이라는 것을 의미합니다.

그러나, 사이트별 권한은 프로필 간에 공유됩니다.

즉, 사용자는 확장 액세스 권한을 한 번만 부여하면 됩니다.

프로필에서 실행할 때, 확장 프로그램은 해당 프로필과 관련된 창, 탭 및 기타 데이터에만 액세스할 수 있습니다.

확장 프로그램이 네이티브 호스트 앱과 통신하는 경우, 앱이 여러 프로필에서 메시지를 받을 것으로 예상하고 해당 프로필 간의 데이터 분리를 존중하는지 확인하십시오.

앱이 beginRequest(컨텍스트: 포함) 호출을 받으면, userInfo 사전을 디코딩하세요.

확장 프로그램이 프로필에서 활성화된 경우, 키 SFExtensionProfileKey에 대한 profileIdentifier 값이 있을 것입니다.

확장에는 프로필당 고유한 인스턴스가 있기 때문에, 배경 콘텐츠를 별도로 검사할 수 있습니다.

Safari 17의 개발 메뉴에서 웹 확장 백그라운드 콘텐츠 메뉴 항목으로 뛰어들어 확장별로 그룹화된 백그라운드 페이지와 서비스 작업자를 볼 수 있습니다.

각 확장 프로그램은 프로필당 검사 가능한 콘텐츠를 나열할 것이다.

올해 사파리 개발자 기능 개선에 대해 자세히 알아보려면, "웹 인스펙터의 새로운 기능"과 "사파리 개발자 기능 재발견"을 확인하세요.

요약하자면, 사파리는 웹 확장을 표준화하고 혁신적이고 효과적인 확장을 만들기 위한 새로운 API를 제공하기 위해 최선을 다하고 있습니다.

우리는 당신이 토론에 참여하고 WECG에 참여함으로써 웹 확장의 미래를 형성하는 데 도움을 줬으면 합니다.

앱 확장에 대한 사이트별 권한과 :has() 선택기와 같은 새로운 기능을 지원하면 사용자에게 안전하고 사적인 브라우징 경험을 제공하는 확장 프로그램을 만들 수 있습니다.

이러한 새로운 기능을 활용하고 프로필과 개인 브라우징 모두에서 잘 작동하는지 확인하기 위해 확장 프로그램을 업데이트하는 것을 잊지 마세요.

그리고 마지막으로, Safari 17에서 확장 프로그램을 테스트할 때 피드백 어시스턴트를 통해 피드백을 제공하세요.

들어주셔서 감사드리며, 남은 WWDC 잘 보내세요.

♪