10044

♪ ♪

데이비드: 안녕. 제 이름은 데이비드 핀들레이입니다.

저는 Create ML 팀의 기계 학습 엔지니어입니다.

우리는 Create ML 앱과 프레임워크를 크게 개선하기 위해 노력해 왔습니다.

새로운 것에 대한 투어에 당신을 데려가게 되어 기쁩니다.

처음부터 대규모 모델을 훈련하는 데는 수천 시간, 수백만 개의 주석이 달린 파일 및 전문 도메인 지식이 필요할 수 있습니다.

우리의 목표는 모든 오버헤드 없이 기계 학습을 사용하는 훌륭한 앱을 만들 수 있는 도구를 제공하는 것입니다.

우리는 사진 앱의 검색 경험과 접근성의 사용자 지정 사운드 인식과 같은 많은 기능을 지원하는 최첨단 모델을 만드는 과정을 거쳤습니다.

Create ML을 사용하면 최신 기술에 액세스할 수 있으므로 번거로움 없이 자신만의 맞춤형 기계 학습 경험을 구축할 수 있습니다.

나는 우리가 ML을 만들기 위해 만든 개선 사항을 살펴보는 것으로 시작할 것이다.

그런 다음 여러 라벨이 있는 장면을 이해하기 위해 기계 학습 모델을 구축하는 새로운 방법을 소개하겠습니다.

그리고 마지막으로, 훈련 데이터에 제한되어 있을 때 모델의 품질을 향상시킬 수 있도록 설계된 새로운 증강 API에 대해 이야기하겠습니다.

텍스트 분류 개선을 시작합시다.

텍스트 분류기는 자연어 텍스트의 패턴을 인식하도록 설계된 기계 학습 작업이다.

그러한 모델을 훈련시키려면, 텍스트와 라벨 쌍의 테이블을 제공하기만 하면 됩니다.

이 예에서, 나는 스포츠, 엔터테인먼트, 그리고 자연 라벨을 가지고 있다.

사전 훈련된 임베딩 모델을 기능 추출기로 사용하는 전송 학습 알고리즘을 선택할 수 있습니다.

올해, 우리는 새로운 임베딩 모델을 설계하고 수십억 개의 라벨이 지정된 텍스트 예제에 대해 훈련했습니다.

그것은 변압기 모델 또는 BERT의 양방향 인코더 표현이다.

설정 탭의 모델 매개 변수 섹션에서 ML 만들기 앱에서 새로운 옵션을 찾을 수 있습니다.

BERT 임베딩 모델은 다국어이며, 이는 훈련 데이터가 이제 하나 이상의 언어를 포함할 수 있음을 의미합니다.

다국어 텍스트 분류기를 지원하는 것 외에도, BERT는 단일 언어 텍스트 분류기의 정확성을 높일 수 있습니다.

iOS 17, iPadOS 17 및 macOS Sonoma에서 BERT를 활용할 수 있습니다.

우리는 모든 세부 사항을 다루는 전체 비디오를 가지고 있습니다.

더 알아보려면 "자연어 다국어 모델 탐색"을 꼭 보세요.

다음으로, 저는 이미지 분류 작업에서 전송 학습을 어떻게 사용하는지에 대해 이야기하고 싶습니다.

Create ML의 이미지 분류기는 질문에 답하기 위해 모델을 만드는 데 도움이 되도록 설계되었습니다. 내 이미지의 내용을 설명하는 가장 좋은 라벨은 무엇입니까?

텍스트 분류기와 마찬가지로, 이미지 분류기는 사전 훈련된 모델을 활용하여 이미지에서 관련 정보를 추출합니다.

최신 버전의 Apple Neural Scene Analyzer는 이제 훈련 데이터가 거의 없는 최첨단 모델을 구축하는 데 사용할 수 있습니다.

OS의 이미지 이해 모델은 가능한 최고의 경험을 제공하기 위해 계속 진화하고 있습니다.

기계 학습 연구 웹사이트에서 우리의 기사를 확인하여 더 많은 것을 알 수 있습니다.

Create ML 앱에서 설정 탭의 모델 매개 변수 섹션에서 새로운 기능 추출기 옵션을 볼 수 있습니다.

새로운 기능 추출기는 이전 버전에 비해 출력 임베딩 크기가 더 작습니다.

일반적인 개선 외에도, 이것은 분류기의 정확성을 높이고, 더 빠른 훈련 시간으로 이어지며, 추출된 기능을 저장하는 데 필요한 메모리를 줄일 수 있습니다.

이제 Create ML의 개선 사항을 다루었으므로, 새로운 다중 라벨 이미지 분류기에 대해 이야기하고 싶습니다.

내가 거기에 도착하기 전에, 단일 라벨 이미지 분류는 이미지의 내용을 설명하는 최고의 라벨을 예측하도록 설계되었다는 것을 기억하세요.

예를 들어, 당신은 이 이미지를 개 또는 야외로 묘사할 수 있습니다.

하지만 넌 하나를 골라야 해.

물체에 관심이 있다면, 물체 탐지기를 사용하여 장면 내에서 물체를 찾을 수 있습니다.

예를 들어, 나는 개 주위에 경계 상자를 그리고 공 주위에 또 다른 상자를 그렸다.

이제, 이것은 훌륭하지만, 나는 또한 물체가 있는 장면에 관심이 있다.

나는 개가 공원이나 야외에 있다는 것을 나타내기 위해 경계 상자를 그릴 수 없다.

그것이 새로운 다중 라벨 이미지 분류기가 들어오는 곳이다.

이미지에 대한 일련의 개체, 속성 또는 라벨을 예측할 수 있습니다.

예를 들어, 이 이미지에는 개, 장난감, 잔디, 공원이 포함되어 있습니다.

Create ML을 사용하여 하나를 만들어 봅시다.

평소와 같이, 내가 가장 먼저 해야 할 일은 훈련 데이터를 수집하는 것이다.

나는 약간의 재미를 가지고 다른 장면에서 여러 즙이 많은 식물을 감지하는 분류기를 만들기로 결정했다.

예를 들어, 여기 창틀에 화분에 있는 하워시아, 제이드, 알로에의 이미지가 있다.

다음 이미지에는 냄비에 선인장을 들고 있는 사람이 있다.

훈련 이미지를 수집하는 동안, 알로에의 사진과 같이 라벨이 하나뿐인 일부 이미지를 포함하는 것도 괜찮습니다.

JSON 파일에서 주석을 정리해야 합니다.

각 파일에 주석 세트로 주석을 달기만 하면 됩니다.

이제, Create ML 앱에서 모델을 만드는 데모를 보여드리겠습니다.

Create ML 앱에서 새로운 다중 라벨 이미지 분류기 템플릿을 선택하겠습니다.

그리고 즙 분류기라는 프로젝트를 만드세요.

이것은 나를 설정 탭으로 데려간다.

우선, 수업 수와 훈련 이미지의 요약을 제공하는 훈련 데이터를 드래그할 것입니다.

나는 또한 검증 데이터를 드래그할 수 있는 옵션이 있지만, 지금은 훈련 데이터를 무작위로 분할하도록 선택할 것이다.

나는 기본 반복 횟수를 사용하고 증강도 생략할 것이다.

나는 내 모델 설정을 마쳤으니, 계속해서 기차를 클릭할 것이다.

이 모델은 내 Mac에서 훈련하는 데 몇 분밖에 걸리지 않는다.

즉시, 모델은 내가 이전에 도입한 새로운 기능 추출기를 사용하여 기능을 추출하기 시작한다.

그것이 끝나면, 앱은 분류기를 훈련시키기 시작한다.

훈련 과정에서, 앱은 평균 평균 정밀도 점수 또는 줄여서 MAP를 계산하여 내 모델의 품질을 측정합니다.

일반적으로, 나는 MAP 점수를 극대화하고 싶다. 왜냐하면 그것은 내 모델이 내 데이터 세트의 모든 라벨에 대해 평균적으로 더 높은 정밀도와 더 높은 리콜을 가지고 있다는 것을 의미하기 때문이다.

내 모델은 훈련을 마쳤고 74번의 반복으로 일찍 수렴했으며, MAP 점수는 훈련 세트에서 97%, 검증 세트에서 93%였다.

다음 단계는 테스트 데이터에 대한 내 모델을 평가하는 것이다.

데스크톱에서 폴더를 드래그하고 테스트 버튼을 클릭하세요.

테스트 데이터는 내가 모델을 훈련시키는 데 사용한 것과 동일한 클래스 라벨 세트를 포함해야 한다.

이 앱은 MAP 점수와 어떤 클래스 라벨이 가장 높고 가장 낮은 정밀도와 리콜을 가지고 있는지와 같은 몇 가지 높은 수준의 통계를 계산했다.

메트릭스 탭에 집중합시다.

이 앱은 거짓 긍정, 거짓 부정, 정밀도, 리콜 및 신뢰 임계값과 같은 각 클래스 라벨에 대한 메트릭을 계산합니다.

내 모델로 예측을 할 때, 신뢰도가 주어진 클래스 라벨의 임계값보다 높으면 예측이 정확하다.

모델이 알로에의 신뢰 임계값 이상으로 예측한 이미지를 살펴봅시다.

이제 예시를 클릭하겠습니다.

모델은 이 이미지가 알로에 신뢰 임계값인 40% 이상인 90% 신뢰도를 가진 알로에를 포함하고 있다고 예측했다.

다른 라벨의 경우, 모델은 각각의 임계값보다 낮은 자신감을 예측했다.

다시 말해서, 그 모델은 그것들을 예측하지 않았다.

다음으로, 저는 제 모델이 알로에를 예측하지 않았지만 알로에로 분류된 이미지를 탐구하고 싶습니다.

나는 거짓 부정 결과 유형을 선택하여 그것을 할 수 있다.

이 이미지는 흥미롭다. 더 탐구해 봅시다.

여기서, 알로에는 배럴 선인장과 달 선인장 뒤에 있으므로, 모델은 알로에를 예측하는 데 어려움을 겪습니다.

하지만 좋은 소식은 그 모델이 두 개의 다른 라벨을 정확하게 예측한다는 것이다.

다음으로, 미리보기 탭으로 갈게요.

이곳은 내가 아직 라벨을 붙이지 않은 이미지에 대한 모델 예측을 미리 볼 수 있는 곳이다.

나는 내가 직접 심은 즙이 많은 배열을 가지고 있는데 시도해 보는 것이 재미있을 것 같다.

못 박았어.

내 모델은 내 부엌에서 달 선인장, 토끼 귀 선인장, 배럴 선인장을 정확하게 예측했다.

나는 내 모델의 품질에 꽤 만족하지만, 내 모델의 한계를 이해하고 내 데이터 세트에 더 많은 다육식물과 장면을 추가하기 위해 계속 실험할 것이다.

지금은, 넘어가자.

출력 탭에서, 내가 훈련한 모델을 디스크에 저장할 수 있다.

예측을 만들기 위해 작성해야 할 몇 가지 코드를 살펴봅시다.

첫 번째 단계는 컴파일된 Core ML 모델에서 비전 모델을 만드는 것이다.

그런 다음 비전 프레임워크를 사용하여 소스 이미지로 이미지 요청 핸들러를 만든 다음 요청을 수행할 것입니다.

마지막으로, 나는 분류 관찰을 검색하고 내가 관심 있는 정밀도와 리콜 값을 사용하여 필터링할 수 있다.

사용 사례에 적합한 정밀도와 리콜 값을 선택하는 방법에 대해 자세히 알아보려면, WWDC 2019, "비전 프레임워크의 이미지 이해"의 비디오를 시청하십시오.

계속 진행하기 전에, 잠시 시간을 내어 이미지 분류기 및 다중 라벨 이미지 분류기와 유사하게 개체 감지를 위한 탐색 옵션으로 평가 탭을 향상시켰다는 것을 언급하고 싶습니다.

꼭 확인해 봐.

저는 당신의 초점을 제 마지막 주제로 옮기고 싶습니다. 증강을 사용하여 제한된 데이터에 대한 기계 학습 모델을 교육합니다.

잘 일반화되는 모델을 얻으려면, 훈련 세트의 이미지는 다양한 조명 조건, 방향 및 배경과 같은 다양한 특성을 가져야 합니다.

하지만 다른 상황에서 훈련 이미지를 캡처하고 라벨을 붙이는 것은 시간이 많이 걸릴 수 있다.

데이터 증강은 변환을 적용하여 기존 교육 예제에서 새로운 교육 예제를 생성하는 기술입니다.

이미지의 경우, 변환은 수평 또는 수직 뒤집기, 자르기 또는 대비가 될 수 있습니다.

이 예에서, 나는 즙이 많은 이미지로 시작하고 네 가지 변형을 생성한다.

그리고 반전과 대비 증가와 같은 변형은 결합될 수 있다.

증강은 특히 작은 훈련 데이터 세트가 있을 때 모델의 품질을 향상시킬 수 있습니다.

모델이 장면에서 물체의 정확한 위치와 같은 속성을 배우는 것을 방지하기 때문에 모델의 일반화를 개선하는 데 사용할 수 있습니다.

그러나, 각 훈련 반복에서 기능 추출이 발생하기 때문에 훈련이 일반적으로 느리다는 것을 고려하는 것이 중요하다.

아직 하지 않았다면, Create ML Components를 소개한 WWDC 2022의 비디오를 꼭 보세요.

우리는 변압기 및 추정기와 같은 구성 요소를 사용하여 맞춤형 기계 학습 모델을 구축하는 데 도움이 되는 프레임워크를 설계했습니다.

올해, 우리는 당신이 자신만의 맞춤형 증강 파이프라인을 설계하는 데 사용할 수 있는 새로운 증강 API를 추가했습니다.

SwiftUI에 대한 경험이 있다면, 이것은 당신에게 친숙할 수 있습니다.

첫 번째 단계는 증강기를 만드는 것이다.

SwiftUI와 마찬가지로, 증강기는 결과 빌더를 사용한다.

증강기의 본문에서, 당신은 당신의 데이터를 보강하기 위해 변형을 추가할 수 있습니다.

증강기는 일반적이기 때문에, 당신의 데이터는 라벨이 붙은 이미지, 라벨이 붙은 소리 또는 심지어 다른 것일 수 있습니다.

중요한 부분은 각 변환의 입력 및 출력 유형이 일치해야 한다는 것이다.

예를 들어, 이미지를 찍고 이미지를 생성한다.

50% 확률로 수평으로 뒤집어서 이미지를 보강하고 싶습니다.

Augmenter에 ApplyRandomly를 추가하는 것으로 시작하겠습니다.

이것은 주어진 확률로 변환을 적용한다.

그럼 내가 그 몸에 수평 뒤집기 변압기를 추가할게.

좋아요, 이제 증강기가 생겼으니, 적용된 방법을 호출하여 증강을 만드는 데 사용할 수 있습니다.

증강을 설계할 때, 데이터의 본질을 신중하게 고려하는 것이 중요합니다.

거꾸로 된 다육식물을 만날 가능성은 거의 없다.

따라서 이 경우 수직 플립 증강을 적용하는 것은 말이 되지 않는다.

아니면 대신 교통 표지판을 분류하고 싶다고 잠시 상상해 보세요.

플립 증강을 적용할 때, 라벨은 더 이상 당신의 이미지를 올바르게 설명하지 못할 수 있습니다.

따라서 사용자 지정 증강을 설계하기 전에 데이터의 특성을 고려하는 것을 잊지 마세요.

좋아요, 다음 단계는 증강기에 더 많은 변형을 추가하는 것입니다.

이번에는 UniformRandomFloatingPointParameter를 사용하여 이미지를 무작위로 회전할 것입니다.

이것은 내가 증강을 적용할 때마다 임의의 각도를 생성한다.

그리고 마지막으로, 나는 무작위로 이미지를 자를 것이다.

증강기에서 각 변환은 순서대로 적용된다는 점에 유의하십시오.

그래서 먼저, 내 이미지는 무작위로 뒤집혔다.

결과는 무작위로 회전한 다음 무작위로 자른다.

나는 네가 Augmenter로 할 수 있는 것의 표면만 긁었어.

여기 당신이 시작하기 위해 우리가 제공하는 몇 가지 구성 요소가 있습니다.

하지만 네가 더 멀리 가고 싶다면?

사용자 지정 변환을 구축하고 이미지를 보강하는 데 사용하는 방법에 대한 예를 살펴봅시다.

강력한 분류기를 구축하려면, 다양한 장면과 환경에서 훈련 이미지를 캡처하는 것이 중요합니다.

이 예에서, 나는 임의의 장면의 임의의 위치에 다육식물을 배치하는 사용자 지정 증강을 만들 것이다.

RandomImageBackground를 정의하는 것으로 시작하겠습니다.

그것은 변압기와 비슷하지만 난수 생성기를 필요로 하는 새로운 프로토콜인 RandomTransformer를 준수합니다.

나는 내 증강이 다른 배경 장면으로 다육식물을 무작위로 배치하기를 원하기 때문에, 배경 이미지를 찍는 이니셜라이저를 만들 것이다.

RandomTransformer 프로토콜을 준수하려면, 적용된 방법을 구현해야 합니다.

증강을 적용할 때, 첫 번째 단계는 무작위로 배경을 선택하는 것이다.

그런 다음, 배경 이미지에서 입력 이미지를 배치하고 싶은 임의의 위치를 선택할 것이며, 자르지 않도록 주의하겠습니다.

다음으로, 나는 내 입력 이미지를 임의의 위치로 번역할 것이다.

그리고 마지막으로, 나는 무작위로 선택된 배경 위에 입력 이미지를 놓을 것이다.

나는 즙이 많은 것을 다른 배경에 배치하기 전에 뒤집기, 회전 및 자르기가 일어날 수 있도록 마지막에 새로운 사용자 지정 확대를 추가할 것이다.

그리고 이건 내 마지막 증강기야.

증강기를 사용하여 분류기를 훈련하기 위해 정말 흥미로운 이미지를 생성할 수 있습니다.

그게 다음 단계야.

증강을 사용할 때 업데이트 방법을 사용하여 점진적으로 훈련하는 것이 더 합리적이다.

그것을 염두에 두고, 증강을 사용한 훈련의 예를 살펴봅시다.

그리고 나는 참지 않을 것이다: 나는 또한 일괄 처리, 무작위화, 그리고 조기 정지를 통합할 것이다.

빈 이미지 분류기 모델을 만드는 것으로 시작하겠습니다.

그럼 내가 훈련 루프를 만들게.

훈련 루프에서, 첫 번째 단계는 훈련 이미지를 섞고 보강하는 것이다.

각 반복에서 배치가 다른 이미지를 포함하도록 보강하기 전에 셔플하고 싶을 것입니다.

증강기의 결과는 비동기 시퀀스이며, 이는 변형이 게으르게 일어난다는 것을 의미한다.

배치 방법을 사용하여 비동기 증강 시퀀스를 그룹으로 그룹화할 수 있습니다.

이 경우, 저는 16의 배치 크기를 사용했습니다.

마지막으로, 나는 증강 이미지의 각 배치로 내 모델을 업데이트할 것이다.

이것이 데이터 증강을 할 때 업데이트 방법을 사용하는 것이 좋은 이유이다.

각 반복에서, 당신은 새로운 이미지 세트를 받습니다.

증강기에 따라, 업데이트 방법은 정확히 같은 이미지를 두 번 이상 접할 것 같지 않습니다.

이것은 모델이 암기하는 대신 일반화하도록 장려한다.

저는 100번의 반복을 선택했지만, 이상적으로는 검증 정확도가 개선되지 않을 때 훈련을 중단해야 합니다.

이 예에서, 훈련 정확도는 계속 향상되지만, 몇 번의 반복 후에 검증 정확도가 감소하기 시작한다는 것을 주목하세요.

이것은 모델이 훈련 데이터를 암기하여 새로운 데이터에 일반화할 수 없고 검증 및 테스트 데이터에서 성능이 더 나쁘다는 것을 의미합니다.

이 후에 계속 훈련하는 것은 해롭다.

마지막 예로, 나는 훈련 루프에 조기 정지를 추가할 것이다.

업데이트 단계 후, 검증 메트릭을 계산할 수 있습니다.

나는 분류기 모델에 효과가 있는 훈련을 일찍 중단하기 위해 검증 정확도를 사용하고 있다.

하지만 그건 정말 너에게 달렸어.

검증 손실을 사용하거나 모델의 품질을 평가하기 위해 자신만의 메트릭을 설계할 수도 있습니다.

그런 다음, 나는 지난 다섯 번의 반복 동안 정확도가 향상되지 않았을 때 훈련 루프에서 벗어날 것이다.

그리고 그것으로 내 증강 이미지 분류기를 마칩니다.

이 비디오에서는 앱에서 훌륭한 기계 학습 경험을 구축하는 데 사용할 수 있는 OS에 출시된 새로운 최첨단 모델을 소개했습니다.

그런 다음 새로운 다중 라벨 이미지 분류기를 사용하여 장면을 이해하기 위한 모델을 만드는 방법의 예를 들어보았습니다.

마지막으로, 모델 품질을 개선하기 위해 자신만의 맞춤형 증강을 만들 수 있는 방법에 대해 자세히 설명했습니다.

그리고 그건 포장이야.

Create ML로 앱을 향상시킬 때입니다.