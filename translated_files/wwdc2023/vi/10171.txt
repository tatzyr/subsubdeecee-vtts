10171

♪ ♪

Si: Xin chào, tôi là Si từ nhóm Swift on Server tại Apple.

Trong video này, tôi sẽ chỉ cho bạn cách Swift OpenAPI Generator có thể giúp bạn làm việc với các API máy chủ.

Cho dù mở rộng ứng dụng iOS hay viết máy chủ phụ trợ trong Swift, trình cắm gói Swift mới này có thể hợp lý hóa quy trình làm việc của bạn và đơn giản hóa cơ sở mã của bạn.

Năm nay, chúng tôi đã thấy việc làm việc với dữ liệu trên thiết bị trở nên dễ dàng hơn bao giờ hết.

Nhưng đôi khi tính năng bạn muốn triển khai sẽ yêu cầu nội dung động được cung cấp bởi một thành phần máy chủ.

Điều này có nghĩa là thực hiện các yêu cầu mạng đến một dịch vụ từ xa, gọi API của nó.

Nhưng để đưa ra yêu cầu mạng phù hợp, có rất nhiều điều cần xem xét.

URL cơ sở của máy chủ là gì?

Những thành phần đường dẫn nào tạo nên điểm cuối API?

Bạn nên sử dụng phương thức HTTP nào?

Và bạn nên cung cấp các thông số như thế nào?

Đây chỉ là một số câu hỏi cần xem xét khi gọi API máy chủ.

Đối với các API liên quan nhiều hơn, bạn sẽ cần xem xét nhiều hơn nữa.

Vậy bạn trả lời những câu hỏi này như thế nào?

Hầu hết các dịch vụ đều có một số dạng tài liệu API.

Nhưng tài liệu viết tay thường có thể không chính xác hoặc lỗi thời, đặc biệt nếu dịch vụ đang phát triển nhanh chóng.

Nếu bạn có quyền truy cập vào mã nguồn, bạn có thể xem xét việc triển khai hoặc bạn có thể thử nghiệm thủ công với API.

Nhưng điều này có thể dẫn đến sự hiểu biết không đầy đủ về hành vi dịch vụ.

Bạn có thể tìm kiếm các diễn đàn hỗ trợ hoặc dựa vào kiến thức tổ chức khác.

Nhưng ngay cả những cá nhân có ý tốt nhất cũng có thể thiếu hiểu biết hoặc cung cấp câu trả lời không nhất quán, để lại cho bạn nhiều câu hỏi hơn bạn bắt đầu.

Mặc dù những tài nguyên này cung cấp một số trợ giúp, nhưng nó không phải là một bức tranh hoàn chỉnh.

Sử dụng mô tả chính thức và có cấu trúc hơn về API có thể giúp loại bỏ sự mơ hồ.

Gặp gỡ OpenAPI, một đặc tả mở để xác định các dịch vụ HTTP.

OpenAPI là một tiêu chuẩn công nghiệp, và việc áp dụng và trưởng thành rộng rãi của nó có nghĩa là có các quy ước và phương pháp hay nhất đã được thiết lập để giúp bạn làm việc với API.

Với OpenAPI, bạn ghi lại hành vi dịch vụ trong YAML hoặc JSON và các định dạng có thể đọc được bằng máy này cho phép bạn hưởng lợi từ một hệ sinh thái công cụ phong phú.

Có các công cụ để tạo thử nghiệm, xác thực thời gian chạy, khả năng tương tác và hơn thế nữa.

Một điều mà OpenAPI đặc biệt được biết đến là công cụ để tạo tài liệu tương tác.

Nhưng động lực cốt lõi của OpenAPI là tạo mã cho phép người chấp nhận sử dụng phát triển dựa trên thông số kỹ thuật.

Bạn có nhớ điểm cuối API ví dụ của chúng tôi không?

Chà, khi nhận được yêu cầu này, máy chủ sẽ trả về lời chào được cá nhân hóa trong một đối tượng JSON.

Chúng ta hãy xem mã chúng ta cần viết để gọi API này, mà không cần sử dụng tạo mã.

Đầu tiên, chúng ta cần biết URL cơ sở của máy chủ để chuyển đổi thành các thành phần của nó.

Sau đó, chúng tôi nối thêm thành phần đường dẫn để xây dựng điểm cuối API và chỉ định tham số làm mục truy vấn.

Sau đó, chúng tôi xây dựng một URLRequest và sử dụng URLSession để thực hiện yêu cầu HTTP.

Sau đó, chúng ta phải xác thực các phản hồi của loại dự kiến có mã trạng thái dự kiến và loại nội dung.

Sau đó, chúng ta phải giải mã các byte từ phản hồi, điều mà chúng ta thực hiện bằng cách xác định một loại Swift phù hợp với Decodable và sử dụng JSONDecoder.

Cuối cùng, chúng tôi trả lại thuộc tính tin nhắn từ phản hồi.

Viết mã này là tốt, nhưng đây chỉ là một yêu cầu duy nhất cho một hoạt động API tầm thường.

Nhiều API trong thế giới thực có hàng trăm hoạt động, với các loại yêu cầu và phản hồi phong phú, trường tiêu đề, tham số và hơn thế nữa.

Viết mã này cho mọi thao tác trở nên lặp đi lặp lại, dài dòng và dễ bị lỗi.

Và tất cả các buổi lễ này trong cơ sở mã của bạn làm giảm logic cốt lõi của ứng dụng của bạn.

Với OpenAPI, bạn có thể sử dụng công cụ để tạo hầu hết mã này để bạn có thể tập trung vào mã mà người dùng của bạn tương tác.

Chúng tôi sẽ sử dụng API ví dụ của mình để khám phá tài liệu OpenAPI.

Mọi tài liệu OpenAPI đều khai báo phiên bản của đặc tả OpenAPI mà nó đang sử dụng.

Nó cung cấp siêu dữ liệu về API, bao gồm tên và phiên bản của nó và danh sách các URL máy chủ.

Sau đó, nó liệt kê các đường dẫn và phương thức HTTP tạo nên API.

API này chỉ có một thao tác, được đặt tên là getGreeting, xác định hành vi cho phương thức GET trên đường chào hỏi.

Trong ví dụ này, máy chủ luôn phản hồi với 200, đó là mã trạng thái HTTP cho OK và trả về một đối tượng JSON, được xác định bằng Lược đồ JSON.

Đối với hình minh họa này, chúng tôi đã giữ nó đơn giản, nhưng các hoạt động có thể có nhiều phản hồi, với các mã trạng thái và loại nội dung khác nhau, cho phép bạn ghi lại tất cả các tình huống, bao gồm cả những gì xảy ra khi có lỗi.

Và nếu thao tác chấp nhận các tham số, chúng cũng có thể được đưa vào tài liệu OpenAPI.

Thao tác này hỗ trợ một tham số truy vấn tùy chọn được gọi là "name", một giá trị chuỗi được sử dụng để cá nhân hóa lời chào.

Với sự trợ giúp của Swift OpenAPI Generator, chúng ta có thể thực hiện cùng một lệnh gọi API với ít mã hơn nhiều.

Chúng tôi có thể sử dụng đầu vào an toàn loại và các giá trị đầu ra là các loại enum phong phú để trình biên dịch có thể giúp chúng tôi đảm bảo chúng tôi xử lý mọi phản hồi được ghi lại và loại nội dung.

Và giá trị liên quan trong nội dung phản hồi là một loại giá trị với các thuộc tính an toàn kiểu.

Tất cả các buổi lễ liên quan đến việc mã hóa đầu vào, thực hiện yêu cầu, phân tích cú pháp phản hồi và giải mã đầu ra đều được xử lý bởi mã được tạo.

Swift OpenAPI Generator là một trình cắm Swift Package chạy tại thời điểm xây dựng.

Điều này có nghĩa là mã được tạo luôn đồng bộ với tài liệu OpenAPI và không cần phải cam kết với kho lưu trữ nguồn của bạn.

Để tìm hiểu thêm về các trình cắm gói Swift, hãy xem phiên có tên "Gặp gỡ các plugin gói Swift".

Hãy cùng xem cách chúng ta có thể sử dụng Swift OpenAPI Generator trong một ứng dụng iOS đơn giản.

Đối với điều này, chúng tôi sẽ cần một API mà chúng tôi có thể gọi.

Trong bản demo này, chúng tôi sẽ gọi một API đơn giản trả về một trong mười biểu tượng cảm xúc khuôn mặt mèo một cách ngẫu nhiên.

Chúng ta sẽ bắt đầu với ứng dụng SwiftUI mẫu và thay thế nội dung mẫu bằng một biểu tượng cảm xúc lớn và một nút tìm nạp một cái mới từ máy chủ trên mỗi lần nhấn.

Chúng tôi đã có một máy chủ đang chạy, lắng nghe trên localhost, mà chúng tôi có thể truy vấn từ Terminal bằng curl.

Không thể phủ nhận rằng đây là một API tuyệt vời.

Nhưng điều làm cho nó thậm chí còn tốt hơn là nó được xác định bằng OpenAPI.

Hãy sử dụng một loại mèo rất khác để hiển thị tài liệu OpenAPI cho dịch vụ này.

API này có một thao tác duy nhất có tên getEmoji mà chúng tôi sẽ gọi từ ứng dụng của mình để cập nhật giao diện người dùng.

Để bắt đầu, chúng ta sẽ chuyển sang Xcode.

Ứng dụng iOS mẫu này có giao diện người dùng cơ bản, được xác định bằng SwiftUI, mà chúng ta có thể thấy trong bản xem trước Xcode.

Trong vài phút tới, chúng tôi sẽ thay thế các thành phần giao diện người dùng bằng nội dung động, mà chúng tôi sẽ tìm nạp từ máy chủ.

Và chúng tôi sẽ sử dụng Swift OpenAPI Generator để đơn giản hóa mã mà chúng tôi phải viết bằng tay để thực hiện các lệnh gọi API.

Chúng tôi sẽ bắt đầu bằng cách thêm các phụ thuộc gói bắt buộc vào dự án của chúng tôi.

Sau đó, chúng tôi sẽ định cấu hình mục tiêu của mình để sử dụng plugin để tạo mã và thêm tài liệu OpenAPI và tệp cấu hình trình cắm vào thư mục nguồn mục tiêu của chúng tôi.

Khi dự án được cấu hình, chúng tôi sẽ thay thế các thành phần giao diện người dùng và sử dụng loại Khách hàng được tạo để thực hiện các lệnh gọi API đến máy chủ.

Để định cấu hình ứng dụng của bạn để sử dụng Trình tạo Swift OpenAPI, hãy điều hướng đến Trình chỉnh sửa dự án, chọn tab Phụ thuộc gói và nhấp để thêm phụ thuộc mới.

Đối với bản demo này, chúng tôi đang sử dụng bộ sưu tập gói cục bộ, nhưng bạn có thể tìm thấy URL gói trong ghi chú phiên.

Đầu tiên, chúng tôi sẽ thêm sự phụ thuộc vào trình tạo swift-openapi, cung cấp trình cắm gói.

Sau đó, chúng tôi sẽ thêm sự phụ thuộc vào swift-openapi-runtime, cung cấp các loại và trừu tượng phổ biến được sử dụng bởi mã được tạo.

Và bởi vì mã được tạo không bị ràng buộc với bất kỳ thư viện máy khách HTTP cụ thể nào, chúng tôi cần chọn một gói tích hợp cho thư viện mà chúng tôi muốn sử dụng.

Chúng tôi đang xây dựng một ứng dụng iOS, vì vậy chúng tôi sẽ sử dụng gói URLSession, nhưng hãy xem tài liệu để biết các ví dụ khác và cách viết của riêng bạn.

Với các phụ thuộc tại chỗ, chúng ta có thể định cấu hình mục tiêu để sử dụng plugin OpenAPI Generator.

Trong Cài đặt Mục tiêu, chọn Giai đoạn Xây dựng và mở rộng phần có tên "Chạy Trình cắm Công cụ Xây dựng".

Nhấp để thêm một trình cắm mới và chọn OpenAPIGenerator từ danh sách.

Trình cắm mong đợi hai tệp đầu vào trong thư mục nguồn đích của bạn: tài liệu OpenAPI và tệp cấu hình trình cắm, mà tôi sẽ thêm vào dự án ngay bây giờ.

Cấu hình trình cắm được viết bằng lược đồ YAML đơn giản chỉ định mã mà trình cắm sẽ tạo.

Trong trường hợp này, chúng tôi sẽ tạo ra "các loại", là các loại có thể tái sử dụng có nguồn gốc từ tài liệu OpenAPI.

Và chúng tôi cũng sẽ tạo mã máy khách, có thể được sử dụng để thực hiện các cuộc gọi API với bất kỳ máy khách HTTP nào.

Chúng tôi sẽ chuyển trở lại ContentView.swift, điều này sẽ biên dịch lại dự án của chúng tôi để mã được tạo sẵn sàng để sử dụng trong ứng dụng của chúng tôi.

Như một biện pháp bảo mật, bạn sẽ được yêu cầu tin tưởng trình cắm ngay lần đầu tiên bạn sử dụng nó.

Bây giờ chúng tôi đã biên dịch lại dự án, chúng tôi có thể thay thế các thành phần giao diện người dùng và sử dụng loại Khách hàng được tạo để thực hiện các lệnh gọi API đến máy chủ và cập nhật chế độ xem.

Chúng tôi sẽ bắt đầu bằng cách thêm một thuộc tính trạng thái mới vào chế độ xem cho biểu tượng cảm xúc của chúng tôi và khởi tạo nó với giá trị giữ chỗ.

Sau đó, chúng tôi sẽ thay thế hình ảnh quả địa cầu bằng chế độ xem Văn bản chứa biểu tượng cảm xúc, thay thế thông báo "Xin chào, thế giới" bằng một nút và đặt kiểu nút cho chế độ xem của chúng tôi.

Mã được tạo cung cấp một loại, được đặt tên là Khách hàng, mà bạn có thể sử dụng để thực hiện các lệnh gọi API.

Nhưng trước tiên, chúng ta cần nhập thời gian chạy OpenAPI và các mô-đun vận chuyển.

Bây giờ chúng ta có thể thêm một thuộc tính khách hàng vào chế độ xem của mình và một trình khởi tạo cấu hình nó để sử dụng URL máy chủ localhost, được xác định trong tài liệu OpenAPI.

Bây giờ chúng ta sẽ thêm một hàm thực hiện lệnh gọi API đến máy chủ bằng máy khách này.

Đó là tất cả mã chúng ta cần viết bằng tay để thực hiện yêu cầu API.

Mọi thứ khác đều được xử lý bởi mã được tạo.

Phản hồi là một giá trị liệt kê của một loại mô hình hóa tất cả các phản hồi được ghi lại và các loại nội dung khuyến khích chúng tôi xử lý tất cả các tình huống.

Vì vậy, chúng ta cần trích xuất biểu tượng cảm xúc từ nội dung phản hồi bằng cách sử dụng câu lệnh chuyển đổi.

Có gì đó còn thiếu ở đây.

Trình biên dịch đã nói với chúng tôi rằng chúng tôi chưa xử lý mọi tình huống.

Chúng tôi sẽ để Xcode điền vào trường hợp công tắc bị thiếu.

Trong trường hợp máy chủ phản hồi bằng thứ gì đó không được chỉ định trong tài liệu OpenAPI của nó, bạn vẫn có cơ hội xử lý điều đó một cách duyên dáng.

Đối với bản demo này, chúng tôi sẽ in cảnh báo lên bảng điều khiển và cập nhật biểu tượng cảm xúc của chúng tôi thành một thứ khác ngoài một con mèo.

Bây giờ chúng ta có thể gọi hàm này khi nhấn nút của chúng ta.

Và chúng ta có thể sử dụng nút của mình để tìm nạp biểu tượng cảm xúc mèo mới và cập nhật giao diện người dùng của mình.

Khi các tính năng mới được thêm vào máy chủ, API của nó sẽ phát triển.

Và nếu máy chủ được ghi lại bằng OpenAPI, thì Swift OpenAPI Generator giúp việc sử dụng các tính năng mới này từ ứng dụng của bạn trở nên đơn giản.

Hãy xem qua một ví dụ về cách cập nhật ứng dụng khi tài liệu OpenAPI phát triển.

Khi nói đến biểu tượng cảm xúc, nhiều hơn là nhiều hơn, vì vậy chúng tôi đã mở rộng API dịch vụ để lấy tham số truy vấn tùy chọn mới, đếm, có thể được sử dụng để tìm nạp nhiều biểu tượng cảm xúc.

Chúng tôi sẽ mở rộng ứng dụng của mình bằng một nút khác tìm nạp ba con mèo thay vì một con.

Đầu tiên, chúng ta sẽ thêm một tham số vào tài liệu OpenAPI.

Và một khi chúng tôi biên dịch lại dự án, tham số sẽ có sẵn để sử dụng trong ứng dụng.

Sau đó, chúng tôi sẽ tạo một nút mới thực hiện lệnh gọi API bằng cách sử dụng tham số này.

Chúng ta sẽ bắt đầu bằng cách thêm tham số mới vào tài liệu OpenAPI.

Tham số này được đặt tên là "đếm".

Đó là một tham số tùy chọn.

Nó được cung cấp như một phần của truy vấn URL và là một giá trị nguyên.

Hãy quay trở lại ContentView.swift và mở rộng chức năng updateEmoji để lấy một tham số.

Và hãy sử dụng tham số này khi thực hiện lệnh gọi API.

Chúng tôi sẽ sao chép nút và thay đổi nhãn thành "Thêm mèo".

Khi nút này được nhấn, chúng ta sẽ gọi cùng một hàm, nhưng lần này với số lượng là ba.

Bây giờ trong bản xem trước, chúng ta có thể nhấn vào "Nhận mèo" để lấy một con mèo hoặc "Thêm mèo" để lấy ba con.

Trong suốt thời gian này, chúng tôi đã đưa ra các yêu cầu đối với một máy chủ thực sự, điều này không phải lúc nào cũng thực tế hoặc mong muốn, đặc biệt là trong quá trình phát triển.

Bởi vì loại Khách hàng được tạo phù hợp với giao thức Swift, chúng tôi dễ dàng viết một mô phỏng không yêu cầu kết nối mạng hoặc thư viện vận chuyển.

Giao thức được tạo có tên là APIProtocol, vì vậy chúng ta sẽ bắt đầu bằng cách xác định một loại MockClient mới áp dụng giao thức này.

Sau đó, chúng tôi sẽ cập nhật chế độ xem của mình để chung chung đối với bất kỳ loại nào phù hợp với APIProtocol và cập nhật các trình khởi tạo để hỗ trợ tiêm phụ thuộc.

Sau đó, chúng tôi sẽ sử dụng MockClient khi xem trước giao diện người dùng trong Xcode.

Chúng tôi sẽ bắt đầu bằng cách khai báo loại MockClient của chúng tôi.

Bởi vì chúng tôi đã tuyên bố rằng loại này áp dụng APIProtocol, trình biên dịch sẽ đảm bảo nó đáp ứng các yêu cầu giao thức.

Chúng tôi sẽ để Xcode thêm trình xử lý bị thiếu cho hoạt động API.

Và chúng tôi sẽ thêm logic kinh doanh, trả về biểu tượng cảm xúc robot, để phân biệt nó với dịch vụ thực.

Bây giờ chúng ta có thể làm cho chế độ xem của mình chung chung trên các loại phù hợp với giao thức này và cập nhật thuộc tính máy khách để sử dụng tham số loại chung.

Chúng tôi sẽ thêm một trình khởi tạo, lấy một khách hàng làm tham số và chúng tôi sẽ cập nhật trình khởi tạo hiện có với một mệnh đề where chung, vì vậy nếu không có khách hàng nào được cung cấp, chúng tôi sẽ sử dụng cùng một ứng dụng như trước đây.

Khi ứng dụng của chúng tôi được khởi chạy, nó sẽ tiếp tục sử dụng máy chủ thực, nhưng bây giờ chúng tôi có thể tiêm MockClient khi xem trước giao diện người dùng trong Xcode.

Bây giờ khi chúng tôi nhấn vào các nút của mình trong bản xem trước giao diện người dùng, chúng tôi sẽ nhận được rô bốt thay vì mèo và sẽ không yêu cầu kết nối mạng hoặc máy chủ đang chạy.

Cho đến khi chúng tôi thêm ứng dụng khách giả, ứng dụng iOS của chúng tôi đã thực hiện các yêu cầu đến một máy chủ thực đang chạy trên máy cục bộ của tôi.

Máy chủ này cũng được viết bằng Swift với sự trợ giúp của Swift OpenAPI Generator.

Máy chủ là một gói Swift đơn giản, sử dụng trình cắm gói Swift OpenAPI Generator để tạo mã.

Để sử dụng mã máy chủ được tạo, chúng tôi đã xác định một loại phù hợp với giao thức được tạo có tên APIProtocol và chỉ triển khai logic kinh doanh cho các hoạt động API của chúng tôi.

Và để cấu hình máy chủ, chúng tôi đã sử dụng một hàm được tạo, registerHandlers, kết nối các yêu cầu HTTP đến cho các hoạt động API với các trình xử lý của chúng tôi cung cấp logic kinh doanh.

Hãy cùng xem nào.

Nếu chúng tôi mở rộng bảng điều khiển, chúng tôi có thể thấy các yêu cầu thực tế từ ứng dụng iOS demo của chúng tôi.

Và đây là tất cả mã Swift mà chúng tôi cần viết bằng tay để triển khai máy chủ.

Thay vì sử dụng OpenAPI để chỉ ghi lại dịch vụ này, chúng tôi đã bắt đầu với tài liệu OpenAPI và sử dụng Swift OpenAPI Generator để đơn giản hóa việc viết một máy chủ triển khai đặc tả API.

Chúng tôi đã xác định một loại phù hợp với Giao thức API được tạo và chỉ cung cấp logic kinh doanh cho các hoạt động API của chúng tôi.

Và chúng tôi đã sử dụng một hàm được tạo, để đăng ký các phương thức của nó với máy chủ HTTP cho các điểm cuối API.

Trong bản demo này, chúng tôi đang sử dụng Vapor, một khung web mã nguồn mở cho Swift.

Nhưng mã được tạo có thể được sử dụng với bất kỳ khung web nào cung cấp gói tích hợp cho Swift OpenAPI Generator.

Kiểm tra tài liệu để biết các tùy chọn khác và cách bạn có thể tự viết.

Trong chức năng chính của chúng tôi, chúng tôi tạo ra một ứng dụng Vapor mới, mà chúng tôi sử dụng để tạo ra một phương tiện vận chuyển OpenAPI.

Sau đó, chúng tôi tạo một phiên bản của loại trình xử lý của mình và sử dụng chức năng registerHandlers được tạo để thiết lập định tuyến trong máy chủ HTTP cho từng hoạt động API của chúng tôi, điều mà nếu không chúng tôi sẽ phải thực hiện thủ công.

Cuối cùng, chúng tôi chạy ứng dụng Vapor, giống như cách chúng tôi đã định cấu hình nó theo cách thủ công.

Swift là một ngôn ngữ tuyệt vời để phát triển máy chủ và nếu bạn muốn tìm hiểu thêm về cách viết các dịch vụ phụ trợ trong Swift, hãy xem phiên có tên "Sử dụng Xcode để phát triển phía máy chủ".

Chúng ta hãy xem cách gói được cấu hình để sử dụng Swift OpenAPI Generator.

Máy chủ được triển khai như một gói Swift và được xác định bằng cách sử dụng tệp Package.swift.

Gói này có một mục tiêu thực thi duy nhất, được gọi là CatService, sử dụng plugin Swift OpenAPI Generator.

Mã máy chủ được tạo phụ thuộc vào các loại và trừu tượng phổ biến từ thư viện thời gian chạy và có thể được sử dụng với bất kỳ khung web nào cung cấp gói tích hợp, vì vậy mục tiêu này phụ thuộc vào swift-openapi-runtime, swift-openapi-vapor và chính vapor.

Trong thư mục nguồn đích, chúng tôi đã thêm tài liệu OpenAPI, cùng một tài liệu mà chúng tôi đã sử dụng trong ứng dụng iOS demo của mình và tệp cấu hình trình cắm thêm.

Đối với mục tiêu này, chúng tôi đang tạo ra các loại và cuống máy chủ.

Hãy xem cách phát triển dựa trên thông số kỹ thuật có thể giúp việc thêm các tính năng mới vào dịch vụ này trở nên đơn giản hơn.

Biểu tượng cảm xúc mèo rất tuyệt, nhưng rất nhiều bằng chứng cho thấy internet chủ yếu được xây dựng để trao đổi video về mèo, vì vậy chúng tôi sẽ thêm tính năng đó vào máy chủ của mình.

Với sự phát triển dựa trên thông số kỹ thuật, việc thêm một hoạt động API mới chỉ cần hai bước.

Đầu tiên, chúng tôi thêm thao tác mới vào tài liệu OpenAPI.

Sau đó, vì giao thức được tạo hiện có yêu cầu chức năng mới, trình biên dịch sẽ nhấn mạnh rằng chúng tôi xác định một phương thức trên trình xử lý của mình và triển khai logic kinh doanh.

Trước khi chúng ta bắt đầu, chúng ta sẽ cần một video về mèo, mà tôi đã thêm vào thư mục Tài nguyên cho mục tiêu của chúng ta.

Chúng ta sẽ đi đến tài liệu OpenAPI và thêm thao tác mới.

Thao tác này được gọi là getClip và có phản hồi nhị phân với loại nội dung cho biết nội dung phản hồi chứa dữ liệu video.

Khi chúng tôi cố gắng biên dịch lại gói của mình, nó sẽ thất bại.

Đó là bởi vì trình xử lý của chúng tôi không còn phù hợp với giao thức được tạo, bởi vì nó không cung cấp chức năng cho hoạt động mới.

Chúng tôi sẽ để Xcode điền vào sơ khai giao thức cho chúng tôi và chúng tôi sẽ cung cấp logic kinh doanh, đọc các byte từ tệp tài nguyên video và trả về phản hồi OK, với nội dung nhị phân.

Lưu ý rằng mã được tạo an toàn kiểu chỉ cho phép trả về nội dung phản hồi nhị phân từ hàm này, bởi vì đó là những gì được chỉ định trong tài liệu OpenAPI cho thao tác này.

Khi chúng tôi biên dịch lại gói của mình, nó sẽ thành công và chúng tôi có thể khởi chạy lại máy chủ của mình.

Và nếu chúng ta chuyển sang Safari, chúng ta có thể kiểm tra điểm cuối API mới của mình.

Vì vậy, chúng tôi đã thấy cách các dịch vụ ghi lại bằng OpenAPI có thể giúp loại bỏ sự mơ hồ và cho phép phát triển dựa trên thông số kỹ thuật.

Chúng tôi đã chỉ ra cách Swift OpenAPI Generator có thể đơn giản hóa việc làm việc với các API máy chủ trong ứng dụng iOS của bạn.

Cuối cùng, chúng ta đã thấy các tính năng ngôn ngữ của Swift và hệ sinh thái Swift-on-server đang phát triển khiến nó trở thành một lựa chọn tuyệt vời để triển khai các dịch vụ phụ trợ như thế nào.

Và đó là lý do tại sao Swift OpenAPI Generator là mã nguồn mở và có sẵn trên GitHub, nơi bạn có thể tìm hiểu thêm và thậm chí đóng góp cho dự án khi nó tiếp tục phát triển.

Cảm ơn vì đã xem phiên này.

Đó là tất cả cho meo meo!