10142

♪ ♪

Hemant: Xin chào, tôi là Hemant, một người ủng hộ nhà phát triển thương mại cho App Store.

Tôi rất vui được thảo luận về các công cụ của App Store để giúp bạn kiểm tra và xác thực trải nghiệm mua hàng trong ứng dụng của mình.

Tôi sẽ chi trả các lợi ích cho từng công cụ này và khi nào là tốt nhất để sử dụng cái nào.

Tôi cũng sẽ đề cập đến tất cả các tính năng mới tuyệt vời mà chúng tôi sẽ giới thiệu trong năm nay để thử nghiệm mua hàng trong ứng dụng.

Vậy hãy bắt đầu nào.

App Store cung cấp ba công cụ để giúp bạn kiểm tra mua hàng trong ứng dụng.

Có Thử nghiệm StoreKit trong Xcode, nơi bạn có thể kiểm tra mua hàng trong ứng dụng cục bộ, và sau đó là hộp cát, sử dụng các sản phẩm bạn đã thiết lập trong App Store Connect và TestFlight để thực hiện thử nghiệm beta đầu cuối và thu thập phản hồi từ những người thử nghiệm.

Những công cụ này có sẵn để giúp bạn xây dựng, kiểm tra và tối ưu hóa trải nghiệm mua hàng trong ứng dụng của mình.

Tôi sẽ mô tả ngắn gọn từng công cụ này để giúp bạn xác định công cụ thích hợp cho thử nghiệm mua hàng trong ứng dụng của mình.

Bắt đầu với Kiểm tra StoreKit trong Xcode.

Chúng tôi đã giới thiệu Thử nghiệm StoreKit trong Xcode tại WWDC20.

Nó cho phép bạn kiểm tra các giao dịch mua trong ứng dụng mà không cần thiết lập sản phẩm của mình trong App Store Connect.

Bạn có thể kiểm tra các giao dịch mua trong ứng dụng của mình hoàn toàn ngoại tuyến mà không cần máy chủ.

Nó cung cấp cho bạn khả năng tạo và quản lý các giao dịch mua trong ứng dụng của bạn trong tệp cấu hình StoreKit.

Vì vậy, bạn có thể kiểm tra các thay đổi mã của mình cục bộ và trong thời gian thực.

Khi bạn bắt đầu tích hợp StoreKit, bạn có thể kiểm tra trải nghiệm mua hàng trong ứng dụng của mình bằng trình giả lập hoặc thiết bị.

Bạn có thể xây dựng tự động hóa để liên tục kiểm tra các giao dịch mua trong ứng dụng của mình bằng cách sử dụng khung StoreKitTest chuyên dụng.

Ngoài ra, bạn có thể đồng bộ hóa các sản phẩm mua hàng trong ứng dụng của mình từ App Store Connect với Xcode.

Điều này làm giảm bớt nhu cầu thiết lập tệp cấu hình StoreKit theo cách thủ công.

Và bạn có khả năng kiểm tra các trường hợp sử dụng đăng ký nâng cao, chẳng hạn như đổi mã ưu đãi, bảng tăng giá và đăng ký vào và thoát khỏi thử lại thanh toán, tất cả cục bộ mà không có bất kỳ sự phụ thuộc nào vào máy chủ.

Và một khả năng duy nhất là tỷ lệ gia hạn đăng ký linh hoạt, nơi bạn có tùy chọn để chọn tỷ lệ phù hợp với nhu cầu của mình, từ thời gian thực đến hai giây một lần.

Và bây giờ chúng tôi có các tùy chọn mới có sẵn với Xcode 15, cung cấp cho bạn một bộ tỷ lệ gia hạn tĩnh và độc lập với thời lượng đăng ký.

Vì vậy, một sản phẩm hàng tháng hoặc sản phẩm hàng năm sẽ được gia hạn với cùng tốc độ đó.

Bạn có thể mô phỏng các lỗi StoreKit mà ứng dụng của bạn có thể gặp phải, điều này sẽ giúp bạn xây dựng xử lý lỗi vào ứng dụng của mình, các lỗi như nếu một sản phẩm không có sẵn để bán hoặc nếu người dùng hủy giao dịch mua.

Và bây giờ, nếu bạn đang chạy nhiều phiên bản ứng dụng của mình, người quản lý giao dịch sẽ hiển thị các giao dịch cho từng phiên bản ứng dụng, cho phép bạn kiểm tra trên nhiều thiết bị.

Người quản lý giao dịch đã thêm khả năng mua hàng trực tiếp trong ứng dụng, tất cả mà không cần mở ứng dụng của bạn, vì vậy bạn có thể kiểm tra cách ứng dụng của mình xử lý các giao dịch bên ngoài.

Những khả năng mới này có sẵn với Xcode 15.

Để biết thêm chi tiết, vui lòng xem phiên WWDC23 "Có gì mới trong StoreKit 2 và Kiểm tra StoreKit trong Xcode."

Bây giờ, chúng ta hãy xem hộp cát App Store.

Hộp cát App Store cho phép bạn kiểm tra và xác thực việc triển khai mua hàng trong ứng dụng từ đầu đến cuối trên cả máy khách và máy chủ.

Điều này rất quan trọng khi xây dựng và đủ điều kiện trải nghiệm ứng dụng hoàn chỉnh của bạn và đảm bảo bạn đang cung cấp thành công nội dung cho người dùng của mình.

Để kiểm tra các giao dịch mua trong ứng dụng trong hộp cát, tài khoản nhà phát triển của bạn cần phải có thỏa thuận ứng dụng trả phí.

Bạn có thể kiểm tra ứng dụng và mua hàng trong ứng dụng trên thiết bị đã đăng ký bằng tài khoản nhà phát triển của mình.

Để mua hàng trong hộp cát, trước tiên bạn sẽ cần tạo ID Apple hộp cát trong phần Người dùng và Truy cập của App Store Connect.

Để chạy ứng dụng của bạn trên thiết bị iOS chạy iOS 16 trở lên, bạn sẽ cần bật chế độ nhà phát triển trong Cài đặt quyền riêng tư.

Ứng dụng đã cài đặt được dự định sử dụng để phát triển và thử nghiệm.

Sandbox giúp bạn xác thực logic của mình để xử lý các tình huống giống như sản xuất như mua hàng, khôi phục và cung cấp đăng ký và cung cấp cho bạn sự tự tin để khởi chạy ứng dụng của mình trong quá trình sản xuất.

Để kiểm tra ứng dụng của bạn trong hộp cát, bạn cần một thiết bị và bạn có thể phân phối ứng dụng của mình bằng hai tùy chọn, chẳng hạn như bạn có thể kết nối thiết bị của mình với máy Mac và tải xuống ứng dụng trên thiết bị hoặc sử dụng một trong hai phương pháp phân phối như Kiểm tra phát hành, Gỡ lỗi và Tùy chỉnh để tạo tệp IPA

Những phương pháp này giúp bạn cung cấp ứng dụng cho mục đích thử nghiệm cho nhóm của mình mà không cần cung cấp mã nguồn.

Chúng tôi đã lắng nghe phản hồi của bạn và chúng tôi hiểu rằng hộp cát rất quan trọng đối với bạn để kiểm tra trải nghiệm của khách hàng.

Chúng tôi tiếp tục cải thiện sandbox và thêm các tính năng thử nghiệm mới, và năm nay, chúng tôi đã thêm hỗ trợ để mô phỏng các tình huống xung quanh sự gián đoạn không tự nguyện như nhắn tin vấn đề thanh toán đăng ký và thời gian ân hạn thanh toán.

Cuối năm nay, chúng tôi sẽ phát hành hỗ trợ để thử nghiệm các giao dịch mua trong ứng dụng Chia sẻ trong gia đình và chúng tôi đã thêm các tùy chọn mới vào trang Cài đặt tài khoản hộp cát iOS.

Hãy đi sâu vào tất cả các tính năng này.

Mô phỏng thông báo sự cố thanh toán có sẵn cho bạn trong hộp cát và cuối năm nay, nó sẽ được trình bày cho khách hàng trong quá trình sản xuất khi họ nhập thử thanh toán lại.

Nhắn tin vấn đề thanh toán giúp khách hàng giải quyết vấn đề thanh toán mà không cần rời khỏi ứng dụng của bạn và luôn đăng ký nội dung và dịch vụ của bạn.

Bảng vấn đề thanh toán sử dụng API tin nhắn StoreKit 2 với lý do Vấn đề thanh toán.

API tin nhắn StoreKit được hiển thị theo mặc định khi khách hàng khởi chạy ứng dụng của bạn hoặc đưa nó lên nền trước.

Bạn có thể chọn trì hoãn hoặc ngăn chặn tin nhắn bằng cách triển khai trình nghe tin nhắn trong chế độ xem, trong đó bản trình bày bảng vấn đề thanh toán có thể gây nhầm lẫn cho khách hàng.

Bạn có thể mô phỏng tin nhắn API lý do billingIssue trong hộp cát để kiểm tra cách ứng dụng của bạn xử lý bản trình bày tin nhắn.

Để tìm hiểu thêm về việc triển khai StoreKit 2 Message API, vui lòng xem phiên WWDC22 "Có gì mới với mua hàng trong ứng dụng."

Bây giờ, hãy xem lại các bước để mô phỏng thông báo sự cố thanh toán trong hộp cát.

Để kiểm tra thông báo sự cố thanh toán, ID Apple hộp cát của bạn cần được đăng ký đăng ký tự động gia hạn với trạng thái đang hoạt động.

Sau đó, bạn có thể mô phỏng vấn đề thanh toán bằng cách điều hướng đến trang cài đặt tài khoản hộp cát của mình trên thiết bị trong cài đặt App Store và tắt công tắc "Cho phép mua hàng & gia hạn".

Việc tắt công tắc sẽ mô phỏng vấn đề thanh toán cho Sandbox Apple ID và các đăng ký tự động gia hạn hiện tại sẽ không gia hạn theo tỷ lệ gia hạn đăng ký đã định cấu hình và sẽ chuyển sang trạng thái thử lại thanh toán.

Và khi bạn điều hướng trở lại ứng dụng của mình, App Store sẽ gửi thông báo Vấn đề thanh toán khi đăng ký không gia hạn và thông báo sự cố thanh toán sẽ xuất hiện.

Khi bạn nhấn vào nút Tiếp tục, nó sẽ mở trang Cài đặt Tài khoản hộp cát iOS và bây giờ bạn có thể BẬT công tắc "Cho phép Mua hàng & Gia hạn" để gia hạn đăng ký thành công.

Khi đăng ký gia hạn thành công, bạn sẽ không còn nhận được thông báo về vấn đề thanh toán nữa.

Điều này giúp bạn mô phỏng khách hàng đang khôi phục sự cố thanh toán mà không cần rời khỏi ứng dụng của bạn khi họ cập nhật phương thức thanh toán cho ID Apple của họ.

Cho phép thời gian ân hạn cho phép khách hàng giữ quyền truy cập đầy đủ vào nội dung và dịch vụ trả phí của ứng dụng của bạn trong khi Apple cố gắng thu tiền thanh toán.

Điều này cũng giúp bạn với tư cách là nhà phát triển tránh bị gián đoạn trong những ngày dịch vụ trả phí của bạn nếu đăng ký tự động gia hạn được khôi phục trong thời gian ân hạn.

Để bật và mô phỏng thời gian gia hạn thanh toán trong hộp cát, hãy điều hướng đến phần Đăng ký ứng dụng của bạn trong App Store Connect.

Trong phần Thời gian ân hạn thanh toán, nhấp vào "Thiết lập thời gian ân hạn thanh toán".

Điều này sẽ mở ra một hộp thoại, cho phép bạn định cấu hình thời gian gia hạn thanh toán cho ứng dụng của mình.

Bạn có thể chọn từ thời gian ân hạn có sẵn.

Hãy nhớ rằng, những khoảng thời gian này chỉ áp dụng cho sản xuất, vì vậy khi thử nghiệm trong hộp cát, thời hạn thử lại thanh toán và thời gian ân hạn thanh toán được đặt trước theo tỷ lệ gia hạn tài khoản hộp cát của bạn.

Bạn cũng có thể chọn người đăng ký đủ điều kiện cho thời gian ân hạn thanh toán và chọn môi trường.

Bạn có thể chọn bật nó trước trong hộp cát hoặc chọn bật trong cả hộp cát và sản xuất, sau đó nhấp vào Xác nhận.

Bạn sẽ thấy lựa chọn của mình hiển thị trong App Store Connect.

Và bây giờ hãy thảo luận về Chia sẻ trong gia đình.

Chia sẻ trong gia đình là một công cụ mạnh mẽ giúp khách hàng dễ dàng chia sẻ các giao dịch mua kỹ thuật số của họ với các thành viên trong gia đình.

Bật tính năng Chia sẻ trong gia đình cho các đăng ký tự động gia hạn và các sản phẩm không tiêu thụ của bạn có thể giúp bạn thu hút khách hàng mới, tăng mức độ tương tác của người dùng và cải thiện khả năng giữ chân.

Chúng tôi muốn cung cấp cho bạn khả năng kiểm tra việc mua hàng trong ứng dụng Chia sẻ trong gia đình trong hộp cát.

Để kiểm tra Chia sẻ trong gia đình trong hộp cát, bạn sẽ cần đăng nhập vào App Store Connect và điều hướng đến đăng ký hoặc các sản phẩm không tiêu thụ mà bạn cần bật Chia sẻ trong gia đình.

Sau đó, bạn sẽ cần tổ chức hộp cát Thành viên Chia sẻ Gia đình trong App Store Connect.

Và cuối cùng, hãy mua hàng bằng ID Apple hộp cát của bạn được bật để Chia sẻ trong gia đình.

Hãy xem qua các chi tiết kiểm tra.

Khi bạn đã bật sản phẩm mua trong ứng dụng của mình có thể điều hòa gia đình, bây giờ bạn có thể điều hướng đến phần "Người dùng và Truy cập" của App Store Connect và ở đó, bạn sẽ thấy một phần mới có nhãn "Chia sẻ trong gia đình".

Trong phần đó, bạn sẽ có thể sắp xếp và xem các thành viên gia đình hộp cát của mình cho một mặt tiền cửa hàng.

Hãy minh họa trải nghiệm mua hàng trong ứng dụng trông như thế nào trong hộp cát.

Tại đây, bạn bắt đầu mua hàng trên thiết bị, giống như bất kỳ giao dịch mua hộp cát thông thường nào khác.

Khi Chia sẻ trong gia đình được kích hoạt, các giao dịch sẽ được tạo cho mỗi thành viên trong gia đình.

Ứng dụng của bạn bây giờ sẽ thấy các giao dịch mới này khi khởi chạy hoặc trong thời gian thực từ StoreKit.

Tại thời điểm này, bạn có thể kiểm tra logic ứng dụng của mình để đảm bảo rằng nó xác thực và cho phép dịch vụ cho giao dịch.

Ngoài ra, bạn cũng có thể mô phỏng một thành viên trong gia đình mất quyền truy cập vào dịch vụ.

Để làm điều đó, trên Cài đặt Tài khoản hộp cát iOS, nhấn vào Chia sẻ trong Gia đình.

Điều này sẽ hiển thị cho bạn cái nhìn về tất cả các thành viên trong gia đình trong hộp cát và bạn có thể chọn dừng Chia sẻ trong gia đình.

Chia sẻ trong gia đình trong hộp cát sẽ cho phép bạn xác minh và xác thực các trường hợp sử dụng như: bán các sản phẩm có thể điều hòa gia đình bằng cách sử dụng thuộc tính isFamilySharable của StoreKit.

Xác thực logic ứng dụng của bạn để cho phép dịch vụ cho một thành viên trong gia đình, cho một giao dịch mua mới hoặc hiện có.

Mỗi thành viên trong gia đình có thể tắt tính năng chia sẻ, cho phép bạn kiểm tra khi các thành viên trong gia đình mất quyền truy cập vào giao dịch mua được chia sẻ trước đó.

Đối với trường hợp người mua dừng Chia sẻ trong gia đình, bạn sẽ có thể xác thực việc thu hồi quyền truy cập vào các dịch vụ bằng cách sử dụng revocationDate có sẵn trong JWSTransactions.

Và cuối cùng, bạn sẽ nhận được Thông báo Máy chủ App Store cho các thành viên trong gia đình.

Để tìm hiểu thêm về việc triển khai Chia sẻ trong gia đình, vui lòng xem phiên Nói chuyện công nghệ "Khám phá Chia sẻ trong gia đình để mua hàng trong ứng dụng."

Cuối năm nay, chúng tôi sẽ thêm các tùy chọn vào Cài đặt Tài khoản hộp cát iOS.

Cài đặt tài khoản hộp cát iOS có sẵn khi bạn đã mua hàng ban đầu trong ứng dụng trong ứng dụng hộp cát của mình.

Tài khoản hộp cát đã đăng nhập của bạn hiển thị trong cài đặt App Store.

Cuộn xuống trang này để xem Sandbox Apple ID của bạn.

Khi bạn nhấn vào Sandbox Apple ID, một hộp thoại sẽ xuất hiện.

Nhấn vào nút Quản lý và bạn sẽ điều hướng đến Cài đặt Tài khoản hộp cát của mình.

Cuối năm nay, bạn sẽ thấy ba tùy chọn, trước đó đã có sẵn trong App Store Connect và hiện có sẵn cho bạn trên thiết bị để thử nghiệm.

Bây giờ thông qua trang Cài đặt Tài khoản, bạn sẽ phải điều chỉnh tỷ lệ gia hạn đăng ký, kiểm tra các giao dịch mua bị gián đoạn và xóa lịch sử mua hàng.

Khi bạn nhấn vào Tỷ lệ gia hạn, bạn có thể điều chỉnh tỷ lệ gia hạn đăng ký cho tài khoản hộp cát của mình.

Và bạn cũng sẽ có thể xóa lịch sử mua hàng của ID Apple hộp cát, để làm mới ID Apple hộp cát của bạn và kiểm tra lại các trường hợp sử dụng của bạn.

Cuối cùng, chúng ta hãy xem TestFlight.

TestFlight giúp bạn kiểm tra trải nghiệm đầu cuối của ứng dụng, phân phối ứng dụng của bạn và thu thập phản hồi từ nhiều đối tượng thử nghiệm hơn.

Điều này giúp bạn xác thực và cải thiện trải nghiệm ứng dụng của mình trước khi phát hành nó trên App Store.

TestFlight cho phép bạn phân phối ứng dụng của mình trên tất cả các nền tảng của Apple.

Bạn có thể thêm cả người kiểm tra bên trong và bên ngoài, tạo nhiều nhóm người kiểm tra và thêm các bản dựng khác nhau vào mỗi nhóm tùy thuộc vào các tính năng bạn muốn mỗi nhóm kiểm tra.

Người kiểm tra có thể cho phép các bản dựng mới nhất được cài đặt tự động và mỗi bản dựng vẫn có sẵn trong 90 ngày sau khi tải lên.

Để biết thêm thông tin, vui lòng xem phiên Tech Talks "Bắt đầu với TestFlight."

Khi thử nghiệm mua hàng trong ứng dụng, người kiểm tra cần tải xuống các bản dựng ứng dụng của bạn bằng ứng dụng TestFlight.

Khi mua một giao dịch mua trong ứng dụng cho một ứng dụng được tải xuống thông qua TestFlight, nó sẽ sử dụng ID Apple của bạn, được đăng nhập vào cài đặt Media & Purchases của thiết bị.

Tương tự như sandbox, bạn sẽ không bị tính phí khi thử nghiệm mua hàng trong ứng dụng cho một ứng dụng được tải xuống thông qua TestFlight.

Để thử nghiệm các đăng ký tự động gia hạn, tỷ lệ gia hạn trong TestFlight tương đương với tỷ lệ gia hạn mặc định của sandbox.

Và nếu ứng dụng của bạn đã triển khai showManageSubscription API của StoreKit, nó cung cấp cho bạn khả năng kiểm tra việc hủy đăng ký hoặc thay đổi đăng ký.

Năm nay, chúng tôi đang giúp việc quản lý những người thử nghiệm trong TestFlight trở nên dễ dàng hơn.

Bạn có thể lọc theo dữ liệu người kiểm tra như trạng thái, phiên và nhóm người kiểm tra chọn hàng loạt để thêm hoặc xóa khỏi một nhóm.

Và để hợp lý hóa việc phân phối ứng dụng TestFlight của bạn, một phương pháp mới được thêm vào để bạn phân phối bản dựng, Chỉ nội bộ.

Sử dụng phương pháp này đảm bảo bản dựng có thể có sẵn cho những người kiểm tra nội bộ và không thể gửi để đánh giá App Store.

Để tìm hiểu thêm, vui lòng xem phiên "Có gì mới trong App Store Connect" và "Đơn giản hóa việc phân phối trong Xcode và Xcode Cloud."

Bây giờ tôi đã xem xét các công cụ có sẵn để thử nghiệm mua hàng trong ứng dụng, điều quan trọng là bạn phải biết rằng những công cụ này có lợi ích và sự khác biệt riêng nhưng cũng có rất nhiều điểm chung, chẳng hạn như chúng hỗ trợ thử nghiệm tất cả các loại mua hàng trong ứng dụng và đăng ký gia hạn với tốc độ nhanh.

Tuy nhiên, một số công cụ này có thể lý tưởng cho các trường hợp sử dụng hoặc triển khai tính năng cụ thể.

Ví dụ: đổi mã ưu đãi đăng ký và bảng tăng giá có thể được kiểm tra bằng cách sử dụng Kiểm tra StoreKit trong Xcode.

Thử lại thanh toán và thời gian gia hạn có thể được kiểm tra bằng cách sử dụng cả Thử nghiệm StoreKit trong Xcode và hộp cát.

Để xác thực việc triển khai phía máy chủ của bạn, cả sandbox và TestFlight đều hỗ trợ Thông báo Máy chủ App Store và API Máy chủ App Store, trong khi TestFlight cung cấp cho bạn một quy trình hợp lý để nhận phản hồi từ những người kiểm tra nội bộ và bên ngoài về hiệu suất và trải nghiệm tổng thể của ứng dụng của bạn.

Cân nhắc tận dụng các công cụ này để thử nghiệm mua hàng trong ứng dụng tùy thuộc vào trường hợp sử dụng, triển khai tính năng và cấu trúc nhóm của tổ chức bạn.

Chúng tôi đã đề cập rất nhiều ngày hôm nay và tôi hy vọng phiên này đã giúp bạn hiểu rõ hơn về tất cả các công cụ có sẵn để bạn kiểm tra mua hàng trong ứng dụng.

Để tìm hiểu thêm, vui lòng xem tài liệu có sẵn trên developer.apple.com.

Và chúng tôi rất muốn nghe phản hồi của bạn về cách chúng tôi có thể cải thiện trải nghiệm thử nghiệm mua hàng trong ứng dụng của bạn.

Vui lòng cho chúng tôi biết thông qua Trợ lý Phản hồi.

Cảm ơn bạn đã dành thời gian xem phiên này.