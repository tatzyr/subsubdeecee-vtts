10252

♪ ♪

Kevin Cathey: Xin chào, tên tôi là Kevin, và tôi làm việc trên Previews.

Xây dựng phần mềm, và đặc biệt là các ứng dụng, là một quá trình thực sự lặp đi lặp lại và sáng tạo, vì vậy bạn muốn có cách nhanh nhất để kiểm tra mã của mình và trải nghiệm những gì bạn đang làm trở nên sống động.

Đó là lý do tại sao chúng tôi đã xem trước; vì vậy bạn có thể có phản hồi trực quan gần như tức thì để bạn có thể tập trung vào việc sáng tạo.

Và các bản xem trước được xây dựng để linh hoạt.

Bạn có thể sử dụng chúng trên toàn bộ ứng dụng của mình với các loại chế độ xem, dữ liệu và thiết bị khác nhau.

Cho dù bạn chưa quen với các bản xem trước hay bạn đã sử dụng chúng trong một thời gian, tôi muốn giúp bạn tận dụng tối đa chúng.

Chúng tôi sẽ làm điều này trong ba phần.

Đầu tiên, chúng tôi sẽ xem xét các bản xem trước là gì.

Thật hữu ích khi hiểu một chút về cách chúng hoạt động và cách chúng liên quan đến phần còn lại của mã trong dự án của bạn.

Thứ hai, có hai cách khác nhau để bạn có thể cung cấp nội dung cho các bản xem trước của mình: lượt xem và tiện ích.

Tôi sẽ chỉ cho bạn cách viết những thứ này và một số quy trình làm việc độc đáo của chúng trong Xcode.

Và cuối cùng, khi bạn bắt đầu áp dụng các bản xem trước trong dự án của mình, có một số tình huống hoặc câu hỏi phổ biến mà bạn nhất định phải gặp phải.

Tôi muốn cung cấp cho bạn một vài mẹo và thủ thuật để giúp xem trước thêm trong dự án của bạn.

Hãy bắt đầu nào.

Vậy bản xem trước là gì?

Bản xem trước là một đoạn mã tạo và định cấu hình chế độ xem.

Chúng được viết ở cấp cao nhất của tệp nguồn, có nghĩa là chúng không được lồng vào bên trong bất kỳ loại hoặc chức năng nào.

Và chúng thực sự có thể đơn giản như thế này.

Bạn sử dụng macro #Preview và trả về một chế độ xem.

Các bản xem trước được biên dịch vào ứng dụng của bạn, ngay bên cạnh phần còn lại của mã ứng dụng và tài nguyên của bạn.

Bởi vì các bản xem trước của bạn có thể truy cập các biểu tượng và tài nguyên này, các bản xem trước thực sự linh hoạt.

Bạn có thể làm bất cứ điều gì bạn cần để thiết lập bản xem trước cho bất kỳ chế độ xem nào trong ứng dụng của mình và nó sẽ xuất hiện ngay trong khung vẽ trong Xcode.

Nhưng các bản xem trước cũng là về việc lặp lại nhanh hơn.

Khi bạn chỉnh sửa bất kỳ mã Swift nào trong dự án của mình, Xcode sẽ tự động thực hiện hai việc.

Đầu tiên, nó sẽ kiểm tra thay đổi bạn đã thực hiện và biên dịch lại số lượng mã tối thiểu.

Và sau đó, thứ hai, chạy lại bản xem trước của bạn.

Điều này có nghĩa là bạn có thể tập trung vào việc viết và lặp lại mã của mình và Xcode sẽ tự động xử lý việc xây dựng, chạy và cập nhật các bản xem trước của bạn.

Và, một khi bạn đã xác định bản xem trước, Xcode có thể tự động chạy bản xem trước đó trong các ngữ cảnh khác nhau mà không cần bạn phải viết bất kỳ mã bổ sung nào.

Ví dụ, bạn có thể kiểm tra nó ở chế độ tối hoặc các kích thước và hướng loại khác nhau.

Đây không phải là một phép loại suy hoàn hảo, nhưng có thể hữu ích khi nghĩ đến các bản xem trước tương tự như các bài kiểm tra.

Giống như các bài kiểm tra, các bản xem trước chạy mã thực trong dự án thực của bạn.

Chúng tôi không mô phỏng hoặc giải thích mã.

Điều này có nghĩa là bạn tự tin rằng những gì bạn đang thử nghiệm và xem trước cũng đại diện cho những gì những người sẽ sử dụng ứng dụng của bạn sẽ trải nghiệm.

Thứ hai, đầu tư vào các bài kiểm tra viết và xem trước, cuối cùng chúng sẽ giúp bạn phát triển nhanh hơn. Thậm chí một chút cũng có thể đi một chặng đường dài.

Thứ ba, bạn có thể kiểm tra và xem trước các lớp khác nhau của ứng dụng của mình.

Ví dụ, với các bài kiểm tra, bạn có thể có các bài kiểm tra giao diện người dùng cấp cao thực hiện một phần đáng kể chức năng của ứng dụng và bạn có thể có các bài kiểm tra đơn vị nhỏ hơn kiểm tra các thành phần riêng lẻ.

Tương tự, bạn có thể có các bản xem trước cho các chế độ xem bao gồm rất nhiều ứng dụng của mình và bạn có thể có các bản xem trước hiển thị các chế độ xem lá riêng lẻ.

Đó là một cái nhìn nhanh về cách các bản xem trước hoạt động.

Tiếp theo, hãy tập trung vào cách bạn viết chúng và các loại nội dung bạn có thể xem trước.

Bất kể bạn xem trước những gì, mọi bản xem trước bạn xác định đều có cùng một hình dạng cơ bản với ba phần.

Đầu tiên, bắt đầu với trình khởi tạo macro Xem trước ở cấp cao nhất của tệp nguồn.

Sau đó, trả về một hoặc nhiều nội dung đóng cuối.

Đây là nơi bạn có thể định cấu hình giao diện người dùng của mình cho chính xác kịch bản mà bạn muốn xem trước.

Và đó là tất cả những gì cần thiết để tạo bản xem trước, nhưng bạn cũng có thể tùy chọn định cấu hình bản xem trước để linh hoạt hơn nữa.

Bạn có thể đặt tên cho nó và tùy thuộc vào nội dung của bản xem trước, bạn có thể cần hoặc muốn vượt qua cấu hình bổ sung trong trình khởi tạo.

Chúng ta sẽ xem xét một số ví dụ về điều này.

Hãy nói về loại nội dung bạn có thể xem trước.

Có hai loại chính: chế độ xem và vật dụng.

Lượt xem có thể đến từ SwiftUI, UIKit hoặc AppKit.

Đối với SwiftUI, chỉ cần trả lại bất kỳ chế độ xem nào mà bạn đang làm việc.

Nhưng bạn không cần phải chỉ vượt qua chế độ xem mà bạn đang thực hiện; Bạn có thể đặt nó trong bất kỳ chế độ xem nào khác mà bạn cần.

Và điều này rất hữu ích vì đôi khi bạn muốn làm việc trên một chế độ xem trong một số bối cảnh rộng hơn.

Ví dụ, một chế độ xem luôn thực sự có ý định nằm trong Danh sách.

Đây cũng là nơi để đính kèm các công cụ sửa đổi cung cấp dữ liệu thông qua môi trường nếu các chế độ xem bạn đang xem trước cần nó.

Xem trước giống như những cảnh mà bạn xác định ở cấp cao nhất của ứng dụng.

Các cảnh đóng vai trò là điểm vào ứng dụng của bạn.

Bạn thiết lập dữ liệu và bạn chuyển nó qua chế độ xem của mình.

Các bản xem trước phục vụ cùng một mục đích, vì vậy bạn có thể sử dụng bản xem trước để thiết lập dữ liệu và nội dung và sau đó chuyển chúng vào các chế độ xem mà bạn đang xem trước.

Khi nói đến việc cấu hình bản xem trước, bạn có thể đặt tên cho nó.

Và các bản xem trước dựa trên chế độ xem, như SwiftUI, hỗ trợ chuyển một hoặc nhiều đặc điểm cấu hình dưới dạng danh sách đối số đa dạng.

Ví dụ, bạn có thể đặt hướng bắt đầu cho thiết bị mà bạn đang xem trước.

Hình dạng của API giống nhau đối với UIKit và AppKit.

Thay vì chế độ xem SwiftUI, chỉ cần tạo bộ điều khiển chế độ xem và định cấu hình nó khi cần thiết.

Ngoài bộ điều khiển chế độ xem, bạn cũng có thể xem trước trực tiếp UIView hoặc NSView.

Vì vậy, có rất nhiều sự linh hoạt tùy thuộc vào những gì bạn đang cố gắng xây dựng.

Tôi muốn cho bạn thấy những gì chúng ta đã nói cho đến nay để bạn có thể hiểu cách bắt đầu sử dụng các bản xem trước và một số công cụ giúp các bản xem trước trở nên linh hoạt.

Tôi đang viết một ứng dụng tạo ảnh ghép.

Tôi có thể chọn ảnh, tôi có thể chọn bố cục và thêm bộ lọc.

Hãy đến Xcode và khám phá các tính năng của khung Xem trước.

Tôi đã bắt đầu viết chế độ xem cho phép tôi thêm bộ lọc vào hình ảnh.

Để giúp tôi lặp lại chế độ xem này, tôi sẽ cần xem trước.

Để bắt đầu, tôi sẽ đảm bảo chế độ canvas được bật bằng cách đi đến phía trên bên phải của trình chỉnh sửa và nhấp vào menu tùy chọn.

Chế độ canvas được bật theo mặc định cho các dự án mới, nhưng nếu bạn có một dự án hiện có, bạn có thể cần bật tính năng này lên.

Nhưng ngay cả khi chế độ canvas được bật, canvas vẫn bị ẩn trừ khi có bản xem trước được xác định trong tệp, vì vậy hãy thêm một bản.

Khi tôi bắt đầu gõ #Preview, Xcode gợi ý một bản xem trước cho tôi.

Khi tôi chấp nhận hoàn thành, Xcode sẽ xây dựng và chạy bản xem trước của tôi, và chế độ xem của tôi xuất hiện ngay trong khung vẽ.

Có ba chế độ khác nhau mà tôi có thể sử dụng để làm việc theo chế độ xem của mình.

Những thứ này xuất hiện ở góc dưới cùng bên trái của khung vẽ.

Chế độ đầu tiên và mặc định là chế độ trực tiếp hoặc tương tác.

Tôi dành phần lớn thời gian của mình ở chế độ này vì tôi có thể tương tác với chế độ xem của mình trong khung vẽ như kéo các thanh trượt này.

Tôi cũng có thể kiểm tra hoạt ảnh và tôi có thể gọi và trả lời mã không đồng bộ.

Chế độ thứ hai là lựa chọn, hoặc chế độ tĩnh.

Chế độ này chụp nhanh chế độ xem của tôi và cho phép tôi tương tác với các yếu tố trong khung vẽ.

Nhấp vào chế độ xem sẽ làm nổi bật dòng mã đã xuất hiện trong trình chỉnh sửa nguồn.

Và nếu tôi nhấp đúp vào một số chế độ xem văn bản nhất định, như Nhãn này, nó sẽ di chuyển tiêu điểm đến trình chỉnh sửa nguồn để tôi có thể nhanh chóng thay đổi nó.

Vignette là một nhãn hiệu ngắn gọn hơn.

Hãy nói về môi trường.

Đó là, môi trường xem trước.

Khung vẽ đang hiển thị cho tôi bản xem trước của tôi ở chế độ sáng, nhưng nếu tôi muốn xem nó ở chế độ tối thì sao?

Tôi có thể chỉnh sửa mã của mình để đặt bảng màu, nhưng đôi khi tôi chỉ muốn nhanh chóng kiểm tra nó ở chế độ tối và có thể thực hiện một số chỉnh sửa.

Thay vào đó, tôi sẽ sử dụng cửa sổ bật lên Cài đặt Thiết bị trong khung vẽ.

Ở thanh dưới cùng, nhấp vào biểu tượng điều khiển để hiển thị cài đặt.

Bây giờ tôi có thể bật chế độ tối hoặc kích thước loại động cụ thể.

Nhưng nếu tôi muốn xem tầm nhìn của mình trông như thế nào trong cả hai bảng màu cùng một lúc thì sao?

Chà, đối với điều này, tôi sẽ sử dụng chế độ xem trước thứ ba: các biến thể.

Khi tôi nhấp vào chế độ biến thể ở dưới cùng của khung vẽ, tôi có thể chọn cài đặt thiết bị nào tôi muốn xem tất cả các giá trị, như bảng màu hoặc tất cả các kích thước loại động.

Tôi có thể kiểm tra một biến thể riêng lẻ bằng cách nhấp vào nó, và sau đó tôi có thể lướt qua từng biến thể.

Hừm.

Khi tôi đạt đến các kích thước loại động lớn hơn này, tầm nhìn của tôi thực sự bắt đầu sụp đổ, phải không?

Hãy sửa nó.

Thay vì VStack, tôi sẽ sử dụng Biểu mẫu, hoàn hảo cho các nhóm điều khiển.

Và các biểu mẫu trông tuyệt vời khi các điều khiển được đặt trong Phần.

Hãy biến mỗi HStack thành một Phần.

Tôi có thể thực hiện những thay đổi này trên tất cả các trường hợp HStack của mình bằng cách tận dụng lợi thế của việc chỉnh sửa đa con trỏ.

Tôi sẽ chọn HStack đầu tiên, sau đó nhấn Command-Option-E để tìm và chèn con trỏ cho mỗi trường hợp HStack.

Tôi sẽ thay đổi từng cái này thành Phần.

Tôi cũng muốn có một tiêu đề cho mỗi Phần, được cung cấp trong phần đóng thứ hai.

Mũi tên xuống và thêm phần đóng cuối bổ sung.

Hãy sử dụng các Nhãn mà chúng tôi đã có cho các tiêu đề này.

Mũi tên quay lại Nhãn và nhấn Command-Option-Right Brace để di chuyển Nhãn xuống tiêu đề.

Và wow, quan điểm của chúng tôi trông đẹp hơn rất nhiều.

Các tính năng tương tự này đều hoạt động tốt với chế độ xem AppKit và UIKit và bộ điều khiển chế độ xem.

Tôi sẽ chuyển tab sang bộ điều khiển chế độ xem hiển thị bộ lọc bằng CoreImage và chuyển khung vẽ trở lại chế độ trực tiếp.

Bây giờ, tôi đã thực hiện bản xem trước cho bộ điều khiển chế độ xem này và nó trông thực sự giống với bộ điều khiển SwiftUI.

Trong macro xem trước, tôi đã tạo một bộ điều khiển chế độ xem và tôi đã chuyển cho nó một hình ảnh mẫu.

Nhưng tôi muốn kiểm tra hình ảnh này với bộ lọc được áp dụng, vì vậy tôi sẽ thêm mã để chuyển bộ lọc vào bộ điều khiển chế độ xem của mình.

Và, à, nở hoa và họa tiết. Không bao giờ già đi.

Bên cạnh việc cấu hình bộ điều khiển chế độ xem của mình, tôi cũng có thể định cấu hình bản xem trước.

Bất kỳ bản xem trước nào cũng có thể có tên tùy chọn làm đối số đầu tiên.

Và với các bản xem trước, như SwiftUI và UIKit, tôi có thể thêm một hoặc nhiều đặc điểm trong danh sách đa dạng sau tên.

Ví dụ, tôi có thể đặt bản xem trước để bắt đầu ở ngang.

Đó là một chuyến tham quan nhanh về việc viết bản xem trước chế độ xem.

Danh mục nội dung chính thứ hai mà bạn có thể xem trước là các tiện ích.

Các tiện ích thực sự làm nổi bật tốc độ xem trước có thể nhanh như thế nào.

Có hai loại tiện ích bạn có thể xem trước.

Đầu tiên, các tiện ích sử dụng nhà cung cấp dòng thời gian tạo ra các mục nhập riêng lẻ.

Trong Xcode, bạn có thể xem trước toàn bộ nhà cung cấp dòng thời gian hoặc bạn có thể tạo dòng thời gian của riêng mình cho các mục nhập ngay tại đó trong bản xem trước.

Hãy đến Xcode để xem một ví dụ về từng thứ này.

Ứng dụng cắt dán hình ảnh của tôi có một tiện ích với nhà cung cấp dòng thời gian hiển thị cho tôi ảnh ghép được xây dựng ngẫu nhiên mỗi giờ.

Đối với nhà cung cấp dòng thời gian của tôi, tôi sẽ xem trước với ba điều: Đầu tiên, tiện ích tôi muốn xem trước.

Thứ hai, nhà cung cấp dòng thời gian.

Và, thứ ba, gia đình tiện ích để sử dụng để xem trước.

Đó là một lượng nhỏ mã, nhưng nó mang lại cho tôi một số quy trình làm việc tuyệt vời trong Xcode.

Mặc dù tiện ích này sẽ xây dựng một ảnh ghép ngẫu nhiên mỗi giờ, tôi không cần đợi một giờ để xem mọi mục nhập trong dòng thời gian.

Xem trước ảnh chụp nhanh từng mục nhập dòng thời gian và hiển thị chúng trong khung vẽ.

Tôi có thể nhấp qua chúng, hoặc sử dụng các phím mũi tên.

Và khi tôi làm vậy, Xcode giao tiếp với tiện ích của tôi và hiển thị sự chuyển tiếp với hoạt ảnh giữa các mục nhập này, cho phép tôi phát hiện bất kỳ vấn đề nào, không chỉ trong giao diện người dùng, mà còn trong các thay đổi giữa các điểm khác nhau của dòng thời gian.

Giống như ở đây, giữa các mục 8 và 9.

Hình ảnh động ở đây không tuyệt vời. Nó chỉ mờ dần.

Tôi muốn sửa kịch bản này, nhưng nhà cung cấp dòng thời gian của tôi là ngẫu nhiên, vì vậy tôi không biết liệu tôi có thấy kịch bản này một lần nữa khi tôi đang thử nghiệm hay không.

Đây là nơi dòng thời gian của các mục cụ thể có ích.

Tôi có thể tạo ra kịch bản chính xác mà tôi muốn lặp lại.

Tôi sẽ thay đổi timelineProvider: trong Xem trước thành chỉ timeline, và sau đó, thay vì trả lại một nhà cung cấp timeline, tôi sẽ trả lại hai mục sao chép trường hợp tôi muốn sửa.

Nhưng mã tôi cần sửa cho quá trình chuyển đổi này nằm trong một tệp khác và tôi không muốn mất bản xem trước này khi tôi điều hướng đi.

Thuận tiện, tôi có thể giữ bản xem trước trong khung vẽ bằng cách sử dụng ghim.

Nếu tôi nhấp vào nút ghim ở phía trên bên trái của khung vẽ, nó sẽ giữ cho bản xem trước hoạt động ngay cả khi tôi điều hướng đến một tệp khác.

Đây là chế độ xem vẽ ảnh ghép và chứa quá trình chuyển đổi.

Để giúp tôi tập trung vào việc khắc phục sự cố, trong khung vẽ, tôi có thể nhấn nút phát trong dòng thời gian và nút vòng lặp.

Bây giờ Xcode sẽ tiếp tục phát lại quá trình chuyển đổi này trong khi tôi sửa mã.

Và, à, đây là vấn đề.

Khi ảnh ghép bao gồm các hàng, tôi có một chuyển tiếp đính kèm, nhưng tôi không có khi ảnh ghép bao gồm các cột.

Tôi có thể sao chép và dán phần chuyển đổi.

Và điều đó tốt hơn, nhưng nó đang làm sinh động ra khỏi rìa sau.

Tôi nghĩ đẩy ra khỏi đáy sẽ tốt hơn.

Và chúng ta bắt đầu.

Với các bản xem trước, tôi đã có thể lặp lại nhanh chóng, không chỉ với nhà cung cấp dòng thời gian của mình, mà tôi còn có thể tinh chỉnh hoạt ảnh bằng cách sử dụng các sự kiện cụ thể.

Nó thực sự làm cho việc xây dựng và lặp lại trên giao diện người dùng của tôi nhanh hơn và thú vị hơn.

Quy trình làm việc của các tiện ích tương tự này cũng có sẵn cho loại tiện ích thứ hai mà bạn có thể xem trước: các hoạt động trực tiếp.

API trông gần giống nhau nhưng thay vì cung cấp nhà cung cấp dòng thời gian và các mục nhập, bạn cung cấp một tập hợp các thuộc tính hoạt động trực tiếp và một tập hợp các trạng thái.

Đây là một ví dụ.

Đầu tiên, chuyển các thuộc tính bạn muốn sử dụng trong trình khởi tạo.

Sau đó, thứ hai, chuyển các trạng thái nội dung cho các thuộc tính đó.

Ví dụ: nếu bạn đang xây dựng một tiện ích để đặt bánh pizza, bạn có thể cung cấp một bộ trạng thái tùy chỉnh về cách nướng và giao bánh pizza đó, sau đó kiểm tra hình ảnh động giữa tất cả các trạng thái đó.

Tôi chỉ đang làm xước bề mặt của những gì bạn có thể làm với các tiện ích xem trước.

Kiểm tra phiên "Mang Widgets vào cuộc sống" để tìm hiểu thêm.

Khi chúng ta chuyển sang phần cuối cùng của cuộc nói chuyện này, tôi muốn giúp bạn tận dụng tối đa các bản xem trước bằng văn bản trong dự án của mình.

Chúng tôi sẽ khảo sát ba kịch bản khác nhau ảnh hưởng đến việc thiết lập dự án của bạn, cung cấp dữ liệu và tận dụng khả năng của các thiết bị của chúng tôi.

Đầu tiên, tôi muốn nói về việc xem trước nội dung trong các mục tiêu thư viện.

Điều này bao gồm các khuôn khổ, gói Swift hoặc thư viện động.

Có nhiều lý do khiến bạn có thể sử dụng thư viện.

Ví dụ, bạn có thể đang sử dụng các thư viện để mô đun hóa dự án của mình hoặc bạn có thể đang phát triển một thư viện để phân phối cho những người khác.

Các bản xem trước hoạt động tốt trong các mục tiêu này, nhưng điều thú vị là bạn có thể tận dụng các mục tiêu thư viện để xem trước thêm trong bất kỳ dự án nào.

Bước đầu tiên trong việc tận dụng các thư viện là hiểu được tệp thực thi mà Previews sử dụng để chạy mã của bạn.

Các bản xem trước cần một tệp thực thi, một ứng dụng hoặc một tiện ích, để khởi chạy và hiển thị các bản xem trước.

Thông thường đây là ứng dụng của bạn, nhưng nếu bạn không có ứng dụng, nó hoạt động như thế nào?

Xem trước sử dụng ba thứ để tìm ra cái nào có thể thực thi để sử dụng.

Một, các tệp nguồn mà bạn đang làm việc.

Thứ hai, các mục tiêu chứa các tệp đó và tất cả các phụ thuộc của các mục tiêu đó.

Sau đó, thứ ba, các bản xem trước giao nhau các phụ thuộc mục tiêu đó với các mục tiêu trong sơ đồ mà bạn đã chọn.

Các bản xem trước sẽ chỉ chọn một ứng dụng nằm trong sơ đồ đang hoạt động.

Hãy xem xét một vài ví dụ.

Trong trường hợp đơn giản nhất, bạn có thể đang làm việc trong một tệp nguồn duy nhất là thành viên của mục tiêu ứng dụng.

Có lẽ không có gì ngạc nhiên khi đây là ứng dụng chúng tôi sẽ sử dụng để xem trước.

Nhưng nếu bạn có tệp nguồn đó trong hai mục tiêu thì sao?

Ví dụ, phiên bản dùng thử của ứng dụng của bạn và phiên bản đầy đủ của ứng dụng của bạn.

Đây là nơi mà kế hoạch xuất hiện.

Các bản xem trước sẽ chỉ sử dụng ứng dụng nằm trong sơ đồ đang hoạt động.

Đây là một ví dụ khác: Giả sử bạn có hai tệp Swift đang mở, mỗi tệp thuộc về một gói cũng có thể được nhập bởi một gói khác, sau đó tất cả đều được nhập bởi một ứng dụng.

Chúng tôi sẽ duyệt qua các tệp đó để tìm tệp thực thi phổ biến đầu tiên ở trên cùng.

Với ý nghĩ đó, bây giờ chúng ta có thể quay lại câu hỏi mà chúng ta đã bắt đầu: nếu tôi không có ứng dụng gì cả thì sao?

Trong trường hợp này, các bản xem trước tạo một ứng dụng thay mặt bạn, được gọi là XCPreviewAgent, sẽ tải thư viện của bạn.

Tất cả điều này xảy ra tự động cho bạn, nhưng thật hữu ích khi biết cách thức hoạt động của nó và đặc biệt là tên của quy trình này để bạn có thể biết mã của mình đang chạy ở đâu.

Ví dụ: nếu có báo cáo sự cố cho XCPreviewAgent, bạn có thể biết nó đang xảy ra trong mã của mình và tìm ra vấn đề ở đâu.

Tuy nhiên, bạn có thể tận dụng các mục tiêu thư viện để làm cho các bản xem trước hoạt động tốt hơn trong dự án của bạn theo ít nhất hai cách.

Chúng ta có thể dành nhiều thời gian để nói về từng thứ này, nhưng ít nhất tôi muốn đề cập ngắn gọn đến chúng.

Đầu tiên, nếu bạn mô đun hóa ứng dụng của mình thành các thư viện, bạn có thể tạo các sơ đồ nhỏ hơn để có thời gian xây dựng tốt hơn hoặc chỉ để có thể tập trung vào một phần của dự án của bạn.

Và mặc dù bạn đang sử dụng một sơ đồ nhỏ hơn với một tập hợp con các mục tiêu của mình, bạn vẫn có thể nhận được toàn bộ sức mạnh của các bản xem trước.

Thứ hai, nếu sau đó bạn mô đun hóa mã thành các thư viện, có thể có các chế độ xem cần các quyền được yêu cầu hoặc các khóa Info.plist mà mục tiêu ứng dụng của bạn đang cung cấp.

Bạn vẫn có thể xem trước những lượt xem này bằng cách tạo một ứng dụng nhỏ chỉ để xem trước.

Đây là cách.

Giả sử tôi đang tạo một chế độ xem sử dụng thư viện Ảnh, yêu cầu khóa Info.plist cụ thể và tôi đã đặt chế độ xem đó vào thư viện - ví dụ: SamplePhotoLibraryUtilities.

Tôi có thể xem trước với các khả năng phù hợp bằng cách tạo một mục tiêu ứng dụng mới.

Sau đó, tôi sẽ thêm bất kỳ khả năng nào tôi cần.

Trong trường hợp này, tôi cần thêm khóa Info.plist, vì vậy tôi sẽ vào cài đặt xây dựng, lọc chuỗi sử dụng thư viện Ảnh và đặt nó.

Tiếp theo, tôi sẽ đảm bảo thư viện của tôi với chế độ xem tôi đang làm việc được nhúng vào ứng dụng của tôi.

Sử dụng tab giai đoạn xây dựng, tôi sẽ thêm nó làm phụ thuộc mục tiêu và nhúng nó với giai đoạn tệp sao chép.

Bây giờ tôi đã sẵn sàng để chọn sơ đồ chỉ chứa ứng dụng xem trước này và thư viện của tôi.

Khi tôi xem trước chế độ xem của mình, nó sẽ sử dụng ứng dụng tôi vừa tạo để xem trước và tất cả các phím Info.plist phù hợp sẽ được đặt đúng chỗ.

Điều này cho phép tôi tận dụng các sơ đồ nhỏ hơn với thời gian xây dựng nhanh hơn trong khi vẫn giữ khả năng xem trước tất cả các chế độ xem mà tôi đang thực hiện.

Tiếp theo, hãy nói về cách đưa dữ liệu và tài sản vào bản xem trước của bạn.

Tôi đã lẻn cái này vào một bản demo trước đó, nhưng tôi muốn quay lại và xem lại những gì tôi đã làm.

Hãy quay lại bộ điều khiển chế độ xem mà chúng ta đã xem trước đó đã hiển thị bộ lọc.

Khi tôi định cấu hình bản xem trước, tôi đã chuyển một hình ảnh mẫu.

Hình ảnh này đến từ một danh mục tài sản trong dự án của tôi.

Nếu tôi tiết lộ trình điều hướng dự án, danh mục nội dung được đặt ở đây, bên trong thư mục Nội dung xem trước.

Những hình ảnh này rất tuyệt vời trong quá trình phát triển để giúp tôi kiểm tra các kịch bản khác nhau và không yêu cầu cấu hình mọi thiết bị tôi kiểm tra bằng ảnh.

Nhưng tôi không muốn gửi những thứ này trong ứng dụng của mình.

Tôi có thể tránh điều đó với một tính năng gọi là Tài sản Phát triển.

Đây là những thư mục trong dự án của tôi mà tôi định cấu hình trong cài đặt xây dựng của mình và mọi thứ trong các thư mục đó sẽ bị xóa khỏi ứng dụng của tôi khi tôi gửi đến App Store.

Điều này có thể bao gồm danh mục tài sản hoặc bất kỳ tài nguyên nào bạn sử dụng để giúp bạn xem trước.

Hãy thêm thư mục Nội dung Xem trước này làm đường dẫn nội dung phát triển.

Trong cài đặt dự án, chuyển đến tab cài đặt xây dựng và tôi có thể lọc các tài sản phát triển.

Sau khi nhấp đúp để chỉnh sửa, tôi có thể nhập đường dẫn theo cách thủ công hoặc tôi có thể kéo thư mục Nội dung Xem trước vào cửa sổ bật lên.

Với điều đó được thêm vào, bây giờ đường dẫn này sẽ bị xóa khỏi ứng dụng của tôi khi tôi gửi đến App Store.

Đường dẫn tài sản phát triển được thiết lập tự động khi bạn tạo một dự án hoặc mục tiêu ứng dụng mới, nhưng bạn có thể thêm các đường dẫn bổ sung hoặc thêm chúng vào các loại mục tiêu khác hoặc các dự án hiện có.

Bản demo đó nêu bật cách một cách cung cấp tài sản cho bản xem trước của bạn bằng cách thêm chúng vào dự án của bạn bằng cách sử dụng tài sản phát triển.

Điều này hoạt động tốt nếu bạn muốn chia sẻ tất cả các tài sản này trên tất cả các thiết bị và trong nhóm của mình.

Nhưng có một cách khác để cung cấp dữ liệu và hình ảnh nếu bạn đang muốn bắt đầu và chạy nhanh chóng.

Nhiều người trong chúng ta đã có tài sản và dữ liệu trên thiết bị của mình.

Xem trước cũng cho phép bạn tận dụng những thứ đó.

Các trình mô phỏng trong Xcode có thể làm được rất nhiều và là một điểm khởi đầu tuyệt vời cho hầu hết sự phát triển.

Các bản xem trước hoạt động tốt trong trình giả lập và chúng cũng hoạt động tốt trên các thiết bị vật lý.

Có những lý do tại sao bạn muốn xem trước trên thiết bị mà ứng dụng của bạn cuối cùng sẽ xuất xưởng.

Ví dụ, bạn muốn truy cập vào máy ảnh hoặc cảm biến.

Một lý do khác là thiết bị của bạn có thể đã có rất nhiều dữ liệu thực trên đó, ví dụ như ảnh hoặc tệp.

Tôi muốn chỉ cho bạn một ví dụ về cách tận dụng dữ liệu thiết bị của bạn.

Một chế độ xem khác mà tôi đang làm việc có một nút cho phép tôi chọn ảnh từ thư viện ảnh iCloud của mình và sau đó chọn bố cục để tạo ảnh ghép mới.

Tôi muốn kiểm tra điều đó giống như cách tôi đã lặp lại trên các chế độ xem khác của mình, nhưng tôi cần sử dụng một thiết bị có nhiều lựa chọn ảnh.

Tôi sẽ thay đổi thiết bị nào được sử dụng để xem trước bằng cách sử dụng bộ chọn thiết bị xem trước ở dưới cùng của khung vẽ.

Hãy đi sâu vào một số lựa chọn.

Hầu hết thời gian, bạn có thể gắn bó với chế độ Tự động, chế độ này sẽ theo dõi họ thiết bị của điểm đến chạy mà bạn đã chọn.

Ở phía đối diện theo nghĩa đen của menu là menu con More.

Điều này liệt kê tất cả các thiết bị giả lập bạn đã thêm vào trong cửa sổ Thiết bị, vì vậy bạn có thể chọn chính xác kiểu máy bạn muốn.

Tuy nhiên, đôi khi, bạn chỉ muốn chọn một thiết bị theo tính năng của nó.

Phần giữa của menu cung cấp các thiết bị theo các tính năng phổ biến nên bạn không cần phải nhớ chính xác kiểu máy nào có Touch ID chẳng hạn.

Nhưng tôi muốn sử dụng thiết bị này bên cạnh tôi, vì vậy tôi có thể truy cập bộ ảnh lớn từ thư viện của mình.

Bộ chọn thiết bị xem trước cũng bao gồm bất kỳ thiết bị nào được kết nối với máy Mac của tôi.

Khi tôi chọn một trong những thiết bị được kết nối này, Xcode sẽ xây dựng và xem trước dành riêng cho thiết bị này, bỏ qua hoàn toàn trình giả lập.

Và cứ như vậy, tôi có tầm nhìn của mình đang chạy trên một thiết bị thực.

Nhưng chỉ vì nó có trên thiết bị của tôi không có nghĩa là tôi không thể sử dụng các tính năng của bản xem trước mà chúng ta đã nói đến cho đến nay.

Tôi vẫn có thể sử dụng tất cả các chế độ của canvas và thậm chí đặt cài đặt thiết bị.

Ví dụ, cái này trông như thế nào trong Chế độ tối?

Và các bản cập nhật mã của tôi hiển thị ngay lập tức trên thiết bị của tôi.

Chế độ xem này cần tiêu đề điều hướng, vì vậy tôi sẽ thêm Tiêu đề điều hướng vào mã, và sau đó, tôi sẽ tùy chỉnh tiêu đề và xem lại nó trên thiết bị ngay lập tức.

Điều đó thật nhanh!

Bây giờ tôi đã sẵn sàng để kiểm tra tích hợp thư viện Ảnh của mình bằng cách sử dụng tất cả các hình ảnh trên điện thoại này.

Tôi sẽ nhấn Thêm từ Ảnh, chọn một số ảnh-- Aww, con sóc này rất dễ thương-- và nhấn Thêm.

Khung cảnh này đang hoạt động rất tốt.

Ảnh của tôi xuất hiện trong bộ chọn bố cục và tôi có thể nhanh chóng kiểm tra các bố cục khác nhau.

Tôi thích điều này.

Chỉnh sửa trong Xcode và trải nghiệm quan điểm của tôi trở nên sống động trên điện thoại của tôi không bao giờ cũ.

Và đó là ba mẹo và thủ thuật để sử dụng bản xem trước trong dự án của bạn.

Một vài điều cần kết thúc: API Xem trước cung cấp cho bạn sự linh hoạt để xác định các bản xem trước cho giao diện người dùng trên toàn bộ ứng dụng của bạn và cho tất cả các nền tảng của chúng tôi.

Bạn có thể sử dụng SwiftUI, UIKit, AppKit và nhiều loại tiện ích.

Các bản xem trước cũng linh hoạt trong việc cho phép bạn định cấu hình bản xem trước của mình chính xác theo cách bạn cần.

Bạn có thể chuyển dữ liệu và tài sản mẫu, thiết lập môi trường trong mã và tận dụng các tính năng trong Xcode để kiểm tra các cài đặt thiết bị khác nhau.

Và các bản xem trước cũng cung cấp cho bạn sự linh hoạt trong việc xem trước trên các thiết bị khác nhau, cho dù đó là sự tiện lợi của trình giả lập ngay trong khung vẽ hay bằng cách sử dụng thiết bị vật lý để có độ trung thực cao nhất hoặc truy cập dữ liệu và ảnh.

Nhưng bạn vẫn nhận được tất cả các tính năng của bản xem trước bất kể bạn chọn thiết bị nào.

Cuối cùng, nếu bạn mô đun hóa ít nhất các phần của ứng dụng của mình vào thư viện, bạn có thể tạo các sơ đồ trong Xcode để có thời gian xây dựng tốt hơn và tập trung vào một thứ bạn đang làm.

Các bản xem trước ở đây để giúp bạn sáng tạo.

Cảm ơn vì đã xem.