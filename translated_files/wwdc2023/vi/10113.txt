10113

♪ Hip-hop nhạc cụ êm dịu ♪

♪

Xin chào, tên tôi là Mark, và tôi là một kỹ sư SwiftUI.

Tôi rất hân hạnh được mời bạn vào một cuộc hành trình ra khỏi máy bay và vào vũ trụ bằng SwiftUI.

Để chứng minh cách SwiftUI hoạt động trong một chiều hướng mới và để cho thấy cách SwiftUI và RealityKit hoạt động cùng nhau trong hệ thống để cho phép trải nghiệm đáng kinh ngạc, chúng ta sẽ nói về một số ít API cung cấp năng lượng cho một ứng dụng mẫu mà chúng tôi đã xây dựng có tên là World.

World thể hiện một số hình thức khác nhau mà các ứng dụng có thể thực hiện trên hệ thống, từ cửa sổ quen thuộc đến khối lượng mới, cho phép trải nghiệm 3D giới hạn đến toàn bộ không gian, cho phép hiển thị nội dung ảo không giới hạn.

Mặc dù hầu hết các API mà chúng ta sẽ thảo luận trong buổi nói chuyện này cho dù bạn chỉ thêm một chút 3D vào ứng dụng cửa sổ 2D chủ yếu của mình hay tạo trải nghiệm 3D nhập vai tận dụng toàn bộ không gian, chúng tôi sẽ tập trung vào việc sử dụng Volumes làm vùng chứa vì chúng cung cấp một cách tuyệt vời để khám phá lĩnh vực 3

Để tìm hiểu thêm về các vùng chứa khác cho nội dung SwiftUI, vui lòng tham khảo cuộc nói chuyện "Nâng cao ứng dụng có cửa sổ của bạn cho điện toán không gian" và cuộc nói chuyện "Vượt ra ngoài cửa sổ với SwiftUI".

Khi chúng tôi đề cập đến những điều cơ bản về khối lượng, chúng tôi sẽ thảo luận về cách bạn có thể tạo và định vị nội dung 3D với chế độ xem và bố cục thể tích, cách tích hợp chế độ xem SwiftUI vào Chế độ xem thực tế mới và cuối cùng là cách kết hợp mọi thứ lại với nhau bằng cử chỉ 3D.

Nhưng trước khi chúng ta vượt lên chính mình, hãy nói về khối lượng là gì và cách chúng có thể giúp chúng ta thực hiện bước đầu tiên vào lĩnh vực 3D.

Thế giới sử dụng khối lượng để nhấn mạnh nội dung 3D của nó.

Cảnh này không có cửa sổ kính chính.

Thay vào đó, nó đặt nội dung 3D của nó trực tiếp vào cảnh với một bảng điều khiển ở phía trước.

Nhưng nội dung 3D là ngôi sao của chương trình ở đây.

Khối lượng cung cấp cho bạn một thùng chứa tỷ lệ cố định.

Không giống như các cửa sổ tự động chia tỷ lệ dựa trên khoảng cách chúng được đặt từ bạn, khối lượng duy trì cùng kích thước ở bất kỳ khoảng cách nào.

Khối lượng được căn chỉnh theo chiều ngang và hỗ trợ xem từ mọi góc độ.

Âm lượng là một cách tuyệt vời để hiển thị nội dung 3D trong ứng dụng của bạn mà không chiếm toàn bộ không gian và việc tạo một nội dung cực kỳ đơn giản.

Tất cả những gì bạn phải làm là sử dụng kiểu cửa sổ thể tích mới khi tạo một cảnh mới, chẳng hạn như nhóm cửa sổ và bạn sẽ tự động nhận được tất cả các tính năng này.

Bây giờ chúng ta đã thiết lập khối lượng của mình, hãy lấy một số nội dung bên trong nó.

Để giúp chúng tôi làm điều đó, RealityKit cung cấp một API mới được gọi là Model3D, một chế độ xem SwiftUI giúp tải các tài sản 3D phong phú, chẳng hạn như USDZ, đồng thời cung cấp các giai đoạn để xử lý các phần khác nhau của vòng đời tải tài sản trở nên đơn giản.

Hãy nghĩ về Model3D như một đối tác của AsyncImage.

Nó xử lý tất cả công việc tải hình học phức tạp trong khi vẫn giữ cho ứng dụng của bạn chạy trơn tru.

Hãy sử dụng Model3D để hiển thị một trong những mô hình khác từ ứng dụng Thế giới, mặt trăng.

Bây giờ, tôi đã thêm tệp moon USDZ vào dự án của mình và tôi có thể chuyển tên đó cho trình khởi tạo Model3D.

Bây giờ chúng ta có thể xử lý giai đoạn của mô hình.

Bây giờ, đây không phải là giai đoạn của mặt trăng.

Nó thực sự chỉ ra trạng thái tải của tài sản và nó có một vài trạng thái khác nhau mà chúng ta có thể chuyển đổi.

Trước khi mô hình được tải, tôi có thể hiển thị một số văn bản hoặc một phần giao diện người dùng khác cho người dùng biết nội dung chưa sẵn sàng.

Tôi sẽ sử dụng chế độ xem tiến độ ở đây.

Nếu mô hình không tải được, tôi có thể hiển thị thông báo lỗi bằng cách sử dụng mô tả được bản địa hóa từ lỗi.

Và nếu mô hình thành công, tôi có thể sử dụng nó trong giao diện người dùng của mình.

Tương tự như hình ảnh, tôi cần sử dụng công cụ sửa đổi kích thước để thông báo cho hệ thống bố cục rằng mô hình có thể được thay đổi kích thước theo không gian có sẵn của nó.

Và tôi muốn mô hình phù hợp với không gian có sẵn của nó, vì vậy tôi sẽ sử dụng công cụ sửa đổi scaledToFit.

Bây giờ tôi có một mặt trăng tải không đồng bộ trong ứng dụng của tôi.

Hãy tiếp tục xây dựng ví dụ này để khám phá thêm chức năng 3D trong SwiftUI.

Hãy kiểm tra một số mô hình khác xuất hiện trong ứng dụng Thế giới.

Tôi muốn hiển thị tất cả chúng cùng một lúc trong một loại màn hình.

Chúng tôi có thể sử dụng lại MoonView mà chúng tôi vừa viết để xử lý việc hiển thị bất kỳ tệp USDZ nào.

Hãy đổi tên nó.

Và chuyển tên của tệp USDZ để tải.

Bây giờ tôi có thể thay thế chuỗi Moon được mã hóa cứng.

Bây giờ hãy tạo một cấu trúc dữ liệu để biểu diễn một thiên thể.

Tôi sẽ cho mỗi người một cái tên và một kích cỡ.

Tôi sẽ liệt kê một vài vật thể khác nhau mà tôi có trong dự án của mình: Trái đất, Mặt trăng và mặt trời.

Bây giờ tôi có thể hiển thị từng đối tượng trong một HStack với một ForEach.

Đối với mỗi đối tượng, tôi có thể sử dụng CelestialObjectView mới mà chúng tôi vừa tạo bằng cách sử dụng tên của đối tượng.

Hãy thay đổi kích thước của từng mô hình bằng cách sử dụng công cụ sửa đổi khung bằng cách sử dụng kích thước đối tượng.

Các mô hình của chúng tôi trông tuyệt vời từ phía trước, nhưng hãy nhớ rằng chúng tôi đang ở dạng 3D.

Một sự thay đổi về phối cảnh cho thấy rằng các vật thể của chúng ta được căn chỉnh mặt sau, như thể các hộp giới hạn của chúng phẳng với một mặt phẳng phía sau cả ba chúng.

Đây là căn chỉnh mặc định cho nội dung 3D trong SwiftUI.

Nếu chúng ta muốn thay đổi điều đó, chúng ta có thể chỉ định căn chỉnh độ sâu để sử dụng trong công cụ sửa đổi độ sâu khung như vậy.

Tôi có thể chuyển kích thước của đối tượng để sử dụng cho độ sâu và chỉ định rằng tôi muốn các mô hình mặt trước được căn chỉnh thay vì mặt sau.

Bây giờ tất cả các góc nhìn đều có mặt trước được căn chỉnh thay thế.

Bây giờ tôi muốn dán nhãn cho mỗi đối tượng.

Tôi có thể làm điều đó bằng cách cho mỗi Model3D một lớp phủ.

Bên trong tôi sẽ tạo một nhãn văn bản với hiệu ứng nền thủy tinh để đảm bảo nó luôn có thể đọc được.

Tôi cũng sẽ làm cho các nhãn này được căn chỉnh vào cuối mô hình, vì vậy tôi không chặn nội dung.

Màn hình hiển thị trông tuyệt vời cho đến nay, nhưng nó cảm thấy hơi tĩnh.

Cuối cùng, hãy khám phá một số bổ sung mới của SwiftUI cho các hiệu ứng hình học.

Tôi có thể sử dụng TimelineView để tạo hiệu ứng động cho sự thay đổi về thời gian.

Bây giờ tôi sẽ đưa ra quan điểm của chúng tôi một số vòng quay bằng cách sử dụng Rotation3DEffect mới.

Tôi sẽ làm một cái và cho nó một góc dựa trên ngày hiện tại với hệ số tỷ lệ.

Và tôi sẽ để các vật thể quay xung quanh trục y.

Và cứ như vậy, chúng ta có những đồ vật của mình quay.

Model3D rất tuyệt vời để tải và hiển thị các nội dung đơn giản trong hệ thống phân cấp chế độ xem của bạn.

Nhưng đối với các mô hình, cảnh hoặc trải nghiệm 3D liên quan nhiều hơn, RealityView là điểm khởi đầu của SwiftUI để giải phóng sức mạnh của RealityKit trong ứng dụng của bạn.

Và thực sự, ứng dụng Thế giới sử dụng RealityView để chia nhỏ các hình ảnh trực quan phức tạp hơn của nó bằng cách sử dụng hệ thống RealityKit Entity-Component.

Điều này cho phép kết xuất các mô hình riêng lẻ, cũng như các hiệu ứng kết xuất nâng cao như ánh sáng và đường dẫn quỹ đạo.

Nhờ RealityView mới, SwiftUI và RealityKit đi đôi với nhau trên nền tảng.

Để biết thêm thông tin về RealityView và nhiều tính năng RealityKit mới hơn, vui lòng xem "Xây dựng trải nghiệm không gian với RealityKit" và "Nâng cao ứng dụng điện toán không gian của bạn với RealityKit."

Hiện tại, hãy nói về cách bạn có thể tận dụng tối đa SwiftUI trong RealityView của mình bằng cách sử dụng API tệp đính kèm mới.

Tệp đính kèm cho phép bạn ghép nối chế độ xem SwiftUI được gắn thẻ với một thực thể mà bạn có thể sử dụng bên trong Chế độ xem thực tế của mình.

Tệp đính kèm rất phù hợp để thêm chú thích hoặc chỉnh sửa khả năng chi trả liên quan đến các thực thể cụ thể.

Nếu bạn đã sử dụng Canvas API trong SwiftUI, các tệp đính kèm có thể sẽ cảm thấy quen thuộc.

Sự khác biệt chính với tệp đính kèm là chúng là chế độ xem trực tiếp, không chỉ là ảnh chụp nhanh.

Điều này có nghĩa là họ có thể phản ứng với các thay đổi trạng thái, chạy hoạt ảnh và xử lý các cử chỉ.

Hãy cùng khám phá các tệp đính kèm bên trong ứng dụng Thế giới bằng cách thêm một số chức năng bổ sung cho phép tôi đặt một số điểm đánh dấu theo dõi các địa điểm yêu thích của tôi trên khắp thế giới.

Trong chế độ xem Trái đất, tôi đã tạo một số trạng thái theo dõi một mảng một số địa điểm yêu thích của tôi, mỗi địa điểm có tên và vị trí.

Đối với mỗi nơi, tôi có thể tạo một số văn bản với tên của nó.

Và tôi có thể tạo cho nó một hiệu ứng nền thủy tinh để nó luôn dễ đọc.

Và bây giờ tôi sẽ đưa cho nó một thẻ để tôi có thể tham khảo nó sau này trong RealityView của mình.

Thẻ này có thể là bất kỳ giá trị có thể băm nào, nhưng tôi sẽ sử dụng một mã định danh duy nhất mà tôi đã thêm cho mỗi địa điểm.

Bây giờ tôi có thể tra cứu một thực thể lưu trữ mỗi chế độ xem tệp đính kèm bằng cách sử dụng thẻ tôi đã chỉ định.

Tôi có thể thêm thực thể này vào nội dung RealityView của mình.

Và sau đó tôi có thể sử dụng chức năng lookAt để định vị và định hướng nhãn dọc theo bề mặt quả địa cầu.

Bây giờ chúng tôi có một vài địa điểm thú vị được xác định chính xác.

Nhưng chúng ta đừng quá gắn bó với ứng dụng này.

Tôi có thêm một số ý tưởng về cách chúng ta có thể đưa nó lên cấp độ tiếp theo.

Vì vậy, bây giờ chúng tôi đã biết cách định vị nội dung 3D và tận dụng tối đa SwiftUI bên trong RealityView bằng cách sử dụng tệp đính kèm.

Bây giờ hãy nói về cách tương tác với tất cả nội dung này.

Nền tảng đưa các cử chỉ bạn đã quen thuộc vào chiều không gian thứ ba với sự hỗ trợ cho tay và mắt, cũng như cơ chế bàn di chuột mới.

Hãy sử dụng những khả năng mới này để mở rộng tiến trình của chúng ta trên ứng dụng Thế giới.

Chúng tôi có một điều khá tốt với phần mở rộng "Địa điểm yêu thích" của chúng tôi.

Tuy nhiên, tôi không nghĩ rằng tôi hài lòng với số lượng địa điểm mà chúng tôi đã vạch ra.

Hãy tạo ra một cách để thêm một số hơn bằng cách sử dụng cử chỉ chạm trên toàn cầu.

Tuy nhiên, trước khi chúng ta nhảy vào điều đó, hãy nói về cách định cấu hình một thực thể cho đầu vào.

Giả sử chúng tôi đang cấu hình RealityView với nội dung của mình.

Ở đây tôi đã thêm một mô hình Trái Đất.

Một hệ thống phân cấp thực thể cần một InputTargetComponent để nhận đầu vào bên trong RealityView.

Nếu thành phần được thêm vào một thực thể, tất cả con cháu của thực thể đó cũng có thể nhận được đầu vào trừ khi có quy định khác.

Trong RealityKit, CollisionComponent được sử dụng để xác định hình dạng của vùng tương tác của một thực thể.

Hãy sử dụng một hình cầu cho mô hình Trái đất để chúng ta có thể có được một điểm tương tác chính xác trên bề mặt của nó.

Đây là tất cả những gì chúng ta cần để cho phép thực thể của chúng ta xử lý các cử chỉ SwiftUI bên trong RealityView.

Tại thời điểm này, tôi có thể thêm SpatialTapGesture vào RealityView của mình.

Nhưng để làm cho việc sử dụng cử chỉ SwiftUI với nội dung RealityKit của bạn trở nên dễ dàng hơn, chúng tôi đã thêm một công cụ sửa đổi cử chỉ mới có tên targetedToEntity mà tôi có thể sử dụng để nhắm mục tiêu cụ thể vào earthEntity của mình.

Nếu việc nhấn không xảy ra trên thực thể này hoặc một trong những hậu duệ của nó, cử chỉ sẽ thất bại.

Bây giờ hãy xử lý giá trị cử chỉ.

SpatialTapGesture có thuộc tính location3D mới, cho phép chúng tôi có được một điểm nhấn chính xác trên bề mặt địa cầu.

Vị trí 3D nằm trong không gian tọa độ SwiftUI cục bộ của RealityView tính bằng điểm, không phải mét.

Để tìm ra nơi chúng tôi muốn đặt nhãn mới của mình, chúng tôi sẽ cần chuyển đổi vị trí thành cảnh của RealityView.

Công cụ sửa đổi targetedToEntity làm cho điều này cực kỳ dễ dàng bằng cách thêm vào một số trình trợ giúp chuyển đổi không gian tọa độ vào chính giá trị của cử chỉ.

Chúng ta có thể sử dụng nó để chuyển đổi từ không gian cục bộ SwiftUI sang không gian tọa độ của cảnh.

Cuối cùng, tôi có thể thêm dữ liệu cho địa điểm mới bằng cách sử dụng vị trí mà chúng tôi vừa tính toán.

Tôi cũng sẽ mở rộng vị trí chỉ một chút để các nhãn nổi lên trên bề mặt Trái đất một chút.

Bây giờ chúng ta có một cách để thêm nhiều địa điểm yêu thích hơn vào toàn cầu chỉ với một cú chạm.

Nhưng bây giờ chúng ta có một vấn đề: chúng ta cần khám phá nhiều địa điểm hơn!

Để làm điều đó, hãy phóng một vệ tinh có thể giúp chúng ta chọn ra nhiều điểm thú vị hơn trên khắp thế giới.

Một cách để thêm mô hình vệ tinh vào địa cầu của chúng ta là tải mô hình bằng RealityKit, nhưng hãy sử dụng một số kỹ thuật khác mà chúng ta đã học được.

Tôi có thể thêm Model3D làm tệp đính kèm.

Việc chỉ định khung giúp thay đổi kích thước mô hình vệ tinh thành kích thước hợp lý trở nên cực kỳ dễ dàng.

Tôi cũng sẽ đưa cho mô hình của mình một thẻ để tôi có thể tham khảo nó trong RealityView của mình.

Cũng giống như với các nhãn, tôi cần thêm mô hình của mình vào RealityView.

Bây giờ, hãy xác định một cử chỉ trả về một biến đổi 3D sẽ cho phép chúng ta xác định tỷ lệ, chuyển động quay và vị trí của vệ tinh của chúng ta.

Tôi sẽ bắt đầu với việc kéo bằng cách sử dụng DragGesture.

Để chuyển đổi từ cử chỉ kéo sang chuyển đổi, tôi sẽ sử dụng bản đồ.

DragGesture có một số thuộc tính mới để xử lý thao tác trong 3D.

Chúng ta có thể sử dụng thuộc tính translation3D mới của DragGesture để biết mức độ kéo đã di chuyển kể từ khi nó bắt đầu.

Bây giờ tôi sẽ tạo ra sự biến đổi.

Tôi có thể chuyển bản dịch sang trình khởi tạo và trả lại nó từ bản đồ.

Bây giờ tôi có thể sử dụng cử chỉ thao tác của chúng tôi mà chúng tôi vừa viết để biến đổi vệ tinh của tôi.

Tôi sẽ sử dụng công cụ sửa đổi cập nhật để theo dõi khi cử chỉ đang hoạt động.

Tôi có thể sử dụng trạng thái này để thu nhỏ tất cả các nhãn của chúng ta trong quá trình tương tác để chúng không chặn tầm nhìn của chúng ta về Trái đất.

Điều quan trọng là sử dụng cập nhật để theo dõi bất kỳ trạng thái cử chỉ tạm thời nào mà tôi có vì nó đảm bảo rằng trạng thái cử chỉ của tôi sẽ tự động được đặt lại nếu cử chỉ không thành công.

Khi giá trị cử chỉ của tôi thay đổi, tôi có thể đặt biến đổi mới của trạng thái và sau đó sử dụng công cụ sửa đổi bù để định vị mô hình vệ tinh.

Tôi cũng sẽ tạo hiệu ứng động cho các thay đổi đối với biến đổi bằng cách sử dụng hoạt ảnh lò xo, để khi chúng ta buông vệ tinh ra, nó sẽ tạo hiệu ứng động trở lại vị trí ban đầu.

Bây giờ chúng ta có thể kéo vệ tinh xung quanh.

Đây là một khởi đầu tuyệt vời, nhưng chúng ta cần xem điều này chi tiết hơn.

Bây giờ chúng ta đã kết nối mọi thứ, hãy thêm vào một số hành động mở rộng quy mô.

Đối với điều này, tôi thêm một MagnifyGesture nhận dạng đồng thời với lực kéo.

Tôi cũng sẽ thêm RotateGesture3D mới, có thể đo vòng quay 3D không bị ràng buộc của bàn tay người dùng.

Tôi sẽ cắm những giá trị mới này vào biến đổi của chúng tôi, và cuối cùng tôi cần cập nhật vòng quay và quy mô của thực thể.

Tôi sẽ sử dụng rotation3DEffect và scaleEffect cho việc này.

Và chúng ta đã có nó!

Bây giờ chúng ta có thể tự do kéo, chia tỷ lệ và xoay thực thể vệ tinh của mình.

Vệ tinh của chúng tôi có vẻ như đã sẵn sàng cho chuyến đi.

Các cử chỉ mà chúng tôi đã thêm hoạt động với tất cả các thiết bị và chế độ đầu vào mà bạn mong đợi, bao gồm tương tác trực tiếp với tay, chụm gián tiếp, bàn di chuột và các tính năng trợ năng.

Sử dụng các cử chỉ SwiftUI quen thuộc, cùng với công cụ sửa đổi targetedToEntity mới, bạn có thể nhanh chóng xây dựng các tương tác trong các hệ thống phân cấp thực thể phức tạp.

Bây giờ chúng tôi đã sẵn sàng khám phá hành tinh với vệ tinh của mình, nhưng bây giờ là lúc để bạn khám phá các khả năng 3D mới của SwiftUI trong các ứng dụng của mình.

Các loại cảnh mới như khối lượng và không gian đầy đủ cho phép bạn xem xét một ứng dụng có thể là gì theo tất cả các cách mới.

Bố cục mạnh mẽ và hệ thống kết xuất trong SwiftUI đã được mở rộng để làm cho SwiftUI không chỉ là một cách mạnh mẽ để xây dựng ứng dụng trên iOS, macOS, tvOS và watchOS, mà còn trên nền tảng hoàn toàn mới này.

API tệp đính kèm mới mở ra những cơ hội mới đáng kinh ngạc để tích hợp chế độ xem SwiftUI vào các cảnh 3D.

Và cuối cùng chúng tôi đã khám phá cách đặt những câu chuyện bạn kể cho mọi người ngay trong lòng bàn tay của họ, sử dụng những cử chỉ quen thuộc và mạnh mẽ trong SwiftUI.

Nhờ SwiftUI và RealityKit, bạn có một hành trình thú vị phía trước vượt ra ngoài giới hạn của máy bay 2D.

Và chúng ta chỉ mới bắt đầu.

Chào mừng đến với nền tảng!

♪