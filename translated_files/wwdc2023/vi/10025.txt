10025

♪ ♪

Artem: Xin chào, tên tôi là Artem.

Tôi là một kỹ sư trong nhóm Thông báo Đẩy của Apple.

Tôi rất vui được giới thiệu với bạn Bảng điều khiển Thông báo Đẩy.

Đây là một công cụ hoàn toàn mới kết hợp một vài tính năng sẽ giúp bạn tích hợp thông báo đẩy vào ứng dụng của mình.

Tôi sẽ bắt đầu bằng cách gửi một số thông báo từ bảng điều khiển, điều này có thể hữu ích cho thử nghiệm từ đầu đến cuối.

Tiếp theo, tôi sẽ sử dụng tính năng nhật ký giao hàng để phân tích một số vấn đề phổ biến.

Và cuối cùng, tôi sẽ giới thiệu cho bạn một số công cụ bổ sung mà bạn có thể tận dụng để làm việc với xác thực và mã thông báo thiết bị.

Để bắt đầu, tôi sẽ đề cập đến một số điều cơ bản về Thông báo Đẩy.

Thông báo đẩy là những tin nhắn ngắn được gửi đến thiết bị của người dùng từ một ứng dụng hoặc trang web.

Chúng là một công cụ cực kỳ mạnh mẽ để mở rộng khả năng của ứng dụng của bạn.

Có hàng triệu thông báo đẩy được gửi đến các thiết bị Apple mỗi giây, làm phong phú thêm trải nghiệm người dùng.

Những thông báo này được gửi theo thời gian thực và được thiết kế để cung cấp cho người dùng thông tin kịp thời và có liên quan.

Điều này cho phép trải nghiệm năng động hơn khi cập nhật ứng dụng của bạn.

Thông báo đẩy có thể giúp tăng mức độ tương tác của người dùng và cho phép họ luôn cập nhật ứng dụng của bạn.

Đây là tổng quan ngắn gọn về cách nó hoạt động.

Phần phụ trợ cho phép gửi thông báo đẩy được gọi tắt là dịch vụ Thông báo Đẩy của Apple, hay viết tắt là APN.

Câu chuyện về thông báo bắt đầu khi bạn nhắc người dùng cho phép thông báo từ ứng dụng của bạn.

Nếu người dùng đồng ý, Mã thông báo thiết bị được tạo bởi APN và sau đó được gửi đến thiết bị.

Mã thông báo đó xác định duy nhất ứng dụng của bạn trên thiết bị cụ thể đó.

Thông thường mã thông báo sau đó được chuyển tiếp đến máy chủ ứng dụng của bạn để lưu trữ nó để sử dụng trong tương lai.

Khi máy chủ muốn gửi thông báo đẩy, nó sẽ sử dụng mã thông báo thiết bị được lưu trữ để giải quyết thông báo thông qua APN.

APNs sau đó gửi thông báo đến ứng dụng trên thiết bị bằng mã thông báo tương ứng.

Lưu ý rằng mã thông báo thiết bị có thể thay đổi, vì vậy điều cần thiết là phải cập nhật chúng ở phía máy chủ để phân phối chính xác và đáng tin cậy.

Bảng điều khiển Thông báo Đẩy là một công cụ hoàn toàn mới cung cấp nhiều công cụ để tương tác với APN.

Nếu bạn đang phát triển một ứng dụng và thêm thông báo đẩy vào nó, bạn có thể muốn có một cách nhanh chóng để kiểm tra nó từ đầu đến cuối.

Đó là nơi tính năng gửi có ích.

Tôi đang phát triển ứng dụng Backyard Birds.

Bây giờ là mùa xuân, và một số loài chim đang trở về từ khu vực trú đông của chúng, vì vậy tôi muốn cho người dùng biết về điều đó.

Tôi sẽ tạo một thông báo mới.

Đặt tên cho nó, cung cấp mã thông báo thiết bị của ứng dụng trên điện thoại và sau đó điền vào một số thuộc tính tải trọng.

Tôi sẽ sử dụng tên của ứng dụng cho tiêu đề.

Phụ đề sẽ ghi "Cập nhật quan trọng." Và cơ thể sẽ là thông điệp "Robins đã trở lại".

Bây giờ nó đã sẵn sàng, tôi sẽ nhấp vào gửi.

Khi một thiết bị nhận được một cú đẩy, nó sẽ hiển thị một thông báo.

Lịch sử của các thông báo được gửi từ trang này được giữ nguyên để thuận tiện cho bạn trong thanh bên trái.

Tôi muốn sử dụng lại thông báo cuối cùng, nhưng thay đổi một chút tin nhắn.

Tôi sẽ sao chép tin nhắn vừa được gửi và tạo một thông báo mới.

Đây, đặt tên cho nó.

Và sau đó chuyển đổi công tắc này cho phép tôi nhập tải trọng ở định dạng JSON thô.

Tôi sẽ chèn tải trọng mà tôi vừa sao chép và chỉ thay đổi tin nhắn sang một tin nhắn khác.

Cung cấp cùng một mã thông báo Thiết bị, và sau đó gửi nó.

Và thiết bị nhận được thông báo cập nhật.

Bảng điều khiển cho phép bạn kiểm tra nhiều loại thông báo và các thuộc tính khác nhau.

Bạn có thể chỉ định môi trường...

Hãy thử các loại đẩy khác nhau...

Đặt thời hạn chính xác...

Hãy thử các ưu tiên khác nhau...

Và gửi bất kỳ loại tải trọng nào.

Tiếp theo, tôi sẽ đề cập đến tính năng Nhật ký giao hàng.

Đôi khi có những tình huống không nhận được thông báo bạn gửi, khiến bạn không chắc chắn về những gì đã xảy ra với nó.

Sử dụng công cụ này có thể giúp bạn phân tích những trường hợp như vậy.

Khi một thông báo đi qua ngăn xếp APN, các sự kiện phản ánh quá trình giao hàng của nó sẽ được ghi lại.

Và bây giờ bạn có thể truy xuất thông tin đó, sử dụng tiêu đề mới mà APNs trả về khi thông báo được gửi đi.

Đây là cách nó hoạt động.

Thiết bị có thể mô phỏng tình huống không nhận được thông báo bằng cách bật chế độ Công suất thấp.

Sau đó, tôi vào tab Gửi và gửi lại một trong các thông báo.

Tôi sẽ đặt tên cho nó, dán tải trọng, cung cấp mã thông báo thiết bị và đặt ngày hết hạn vào một lúc nào đó trong tương lai.

Nhưng lần này, sau khi nhấp vào "gửi", thông báo sẽ không hiển thị trên thiết bị.

Để tìm hiểu chuyện gì đã xảy ra, tôi sẽ sao chép loại ID mới mà APNs trả về trong phản hồi HTTP, "apns-unique-id".

Sau khi chuyển sang tab "Nhật ký giao hàng", tôi được trình bày với một trường tìm kiếm nơi tôi có thể đặt ID mà tôi vừa sao chép.

Khi tôi chạy tìm kiếm, tôi có thể xem lịch sử của thông báo khi nó di chuyển qua ngăn xếp APNs.

Ở đây sự kiện cuối cùng được "lưu trữ để cân nhắc năng lượng thiết bị", điều này giải thích tại sao tin nhắn không được gửi đi.

Trong trường hợp này, điện thoại ở Chế độ năng lượng thấp, vì vậy nó đã trì hoãn việc nhận một số thông báo để tiết kiệm pin.

Khi chế độ Low Power bị vô hiệu hóa, thông báo sẽ được nhận và hiển thị trên thiết bị.

Sau khi được giao, bản cập nhật tương ứng cũng có thể được nhìn thấy trong nhật ký giao hàng.

Với công cụ này, bạn có thể phân tích nhiều tình huống khác nhau.

Mỗi sự kiện lịch sử không chỉ mô tả những gì đã xảy ra, mà còn cả lý do tại sao trong chú giải công cụ tương ứng.

Ví dụ, một thông báo có thể đi đến bộ nhớ APNs nếu thiết bị ngoại tuyến hoặc có thể bị loại bỏ nếu ứng dụng bị xóa khỏi thiết bị.

Bạn sẽ tìm thấy nhiều ví dụ hơn khi bạn bắt đầu làm việc với công cụ.

Tính năng này cũng có sẵn cho các thông báo được gửi qua APNs API thông thường.

Bạn cần ghi lại "apns-unique-id" từ phản hồi của APN để có thể truy vấn thông tin này.

Và đối với các thông báo được gửi từ Bảng điều khiển, không cần phải chuyển sang tab "nhật ký giao hàng", thông tin tương tự có sẵn trên chính trang Gửi.

Khi bạn tích hợp ứng dụng của mình với APNs, bạn sẽ làm việc với các loại mã thông báo khác nhau được sử dụng để xác thực và gửi thông báo, và bảng điều khiển cũng cung cấp nhiều công cụ tiện dụng để giúp bạn làm việc với chúng.

Hãy đề cập đến xác thực trước.

Có hai loại xác thực với APN: dựa trên chứng chỉ và dựa trên mã thông báo.

Xác thực dựa trên chứng chỉ dựa trên chứng chỉ SSL để thiết lập kết nối đáng tin cậy giữa máy chủ của bạn và APN.

Bạn cần tạo và quản lý chứng chỉ cho từng ứng dụng và môi trường trong cổng thông tin Nhà phát triển Apple.

Hãy nhớ rằng chứng chỉ hết hạn và cần được gia hạn định kỳ.

Xác thực dựa trên mã thông báo sử dụng Mã thông báo web JSON để xác thực an toàn và hiệu quả giữa máy chủ nhà cung cấp của bạn và APN.

Nó yêu cầu tạo mã thông báo được ký bằng khóa riêng được liên kết với tài khoản Nhà phát triển Apple của bạn.

Khóa riêng tư không hết hạn như chứng chỉ.

Là một phần của Bảng điều khiển Thông báo Đẩy, giờ đây có một công cụ có thể tạo mã thông báo xác thực cho bạn.

Tất cả những gì bạn cần làm là cung cấp một khóa riêng tư, được lấy từ cổng thông tin dành cho nhà phát triển...

Và ID khóa liên quan.

Sau khi cung cấp những phần này, một mã thông báo mới sẽ được tạo ra.

Sau đó, bạn có thể sử dụng nó để xác thực các yêu cầu của mình đối với APN.

Hãy nhớ rằng thời hạn hiệu lực của các mã thông báo này không được vượt quá một giờ, vì vậy chúng cần được luân chuyển định kỳ.

Và khi bạn tạo mã thông báo, khóa của bạn sẽ không được tải lên ở bất cứ đâu.

Nó chỉ được sử dụng trong trình duyệt của bạn, vì vậy thông tin cá nhân của bạn được giữ nguyên.

Nếu bạn đã có mã thông báo, nhưng nghĩ rằng nó có thể không hoạt động, bạn có thể tận dụng một công cụ khác, trình xác thực mã thông báo xác thực.

Tôi sẽ lấy mã thông báo mà tôi vừa tạo, và sau đó dán nó vào công cụ xác thực.

Ở đây, tôi nhận lại kết quả xác thực, kết quả này sẽ xác nhận rằng mã thông báo hợp lệ, như trong trường hợp này, hoặc cung cấp cho bạn lý do tại sao nó không hợp lệ.

Ví dụ: khi tôi cung cấp mã thông báo mà tôi đã sử dụng cách đây một thời gian, kết quả xác thực cho tôi biết rằng yêu cầu "được cấp tại" quá cũ, điều đó có nghĩa là mã thông báo đã hết hạn.

Và cuối cùng, có trình xác thực Mã thông báo Thiết bị.

Như bạn nhớ, các mã thông báo này được sử dụng để chỉ định người nhận khi bạn gửi thông báo.

Chúng được gắn với một môi trường bê tông và kiểu đẩy.

Khi bạn nhập mã thông báo, bạn sẽ nhận được phản hồi cho bạn biết môi trường và loại đẩy mà mã thông báo hợp lệ, nếu có.

Ví dụ: khi tôi cung cấp mã thông báo đã được sử dụng trong bản trình diễn trước đó, chúng ta có thể thấy rằng nó hợp lệ cho các loại đẩy Cảnh báo & Nền và môi trường Phát triển.

Hy vọng rằng bạn sẽ thích sử dụng các tính năng này và thấy việc tích hợp Thông báo Đẩy vào ứng dụng của mình dễ dàng hơn, cung cấp cho mọi người chức năng thú vị mới.

Bắt đầu ngay hôm nay.

Gửi thông báo đẩy để kiểm tra tích hợp từ đầu đến cuối.

Kiểm tra nhật ký giao hàng và hiểu rõ hơn về quy trình giao hàng.

Xác thực mã thông báo của bạn và tạo mã thông báo mới, tất cả đều từ bảng điều khiển.

Để biết thêm thông tin về việc triển khai thông báo đẩy trên máy khách, hãy xem video "Thông báo đẩy" từ WWDC20.

Cảm ơn vì đã xem.

♪ ♪