10191

♪ Hip-hop nhạc cụ êm dịu ♪

♪

Lei Zhou: Xin chào, tôi là Lei từ nhóm Object Capture.

Trong phiên này, đồng nghiệp Mona của tôi và tôi sẽ giới thiệu cho bạn về Object Capture cho iOS.

Trước khi chúng ta bắt đầu, hãy xem lại Object Capture là gì và nó hoạt động như thế nào ngày hôm nay.

Object Capture sử dụng các công nghệ thị giác máy tính tiên tiến để tạo ra một mô hình 3D sống động như thật từ một loạt các hình ảnh được chụp ở nhiều góc độ khác nhau.

Những hình ảnh này được chuyển sang máy Mac, nơi Object Capture API được sử dụng để tái tạo lại mô hình 3D chỉ trong vài phút.

Kể từ khi phát hành API cho Mac, chúng tôi đã thấy nhiều ứng dụng tận dụng Object Capture để tạo ra các mô hình 3D chất lượng cao.

Chúng tôi đã nhận được rất nhiều phản hồi từ bạn.

Chúng tôi hiện đang thực hiện một bước tiến lớn để mang lại trải nghiệm Object Capture đầy đủ cho iOS!

Điều này có nghĩa là bây giờ chúng ta có thể thực hiện cả việc chụp với giao diện thân thiện với người dùng và tái tạo mô hình trên thiết bị, tất cả đều nằm trong lòng bàn tay của bạn.

Chúng tôi cũng cung cấp một ứng dụng mẫu để chứng minh quy trình làm việc này trên iOS.

Hãy cùng xem ứng dụng mẫu đang hoạt động.

Chúng tôi sẽ sử dụng ứng dụng mẫu để tạo ra một mô hình 3D của một chiếc bình đẹp trong một cách dễ dàng.

Đầu tiên, mở ứng dụng mẫu và hướng nó vào đối tượng.

Bạn sẽ thấy một hộp giới hạn tự động được tạo trước khi bạn bắt đầu chụp.

Sau đó khoanh tròn xung quanh đối tượng trong khi Object Capture tự động chụp những hình ảnh phù hợp với bạn.

Chúng tôi cung cấp hướng dẫn trực quan về các khu vực mà chúng tôi cần nhiều hình ảnh hơn, cùng với các thông báo phản hồi bổ sung để giúp bạn chụp được những bức ảnh chất lượng tốt nhất.

Sau khi chúng ta hoàn thành một quỹ đạo, chúng ta có thể lật vật thể để chụp đáy.

Sau khi quá trình quét ba phân đoạn hoàn tất, chúng tôi sẽ tiến hành giai đoạn tái tạo, hiện đang chạy cục bộ trên thiết bị iOS của bạn.

Chỉ trong vài phút, một mô hình USDZ sẽ sẵn sàng để sử dụng.

Là một phần của tài liệu dành cho nhà phát triển, chúng tôi cung cấp mã nguồn cho ứng dụng này để bạn có thể tự tải xuống và dùng thử ngay lập tức.

Bạn cũng có thể sử dụng nó như một điểm khởi đầu để tạo ra các ứng dụng của riêng bạn.

Bây giờ chúng ta đã thấy bản demo của Object Capture trên ứng dụng mẫu mới của mình, hãy chuyển sang tất cả các tính năng thú vị mới trong năm nay.

Chúng tôi sẽ bắt đầu bằng cách giới thiệu những cải tiến cho Object Capture, hiện đang sử dụng LiDAR để hỗ trợ quét nhiều đối tượng hơn.

Tiếp theo, chúng tôi sẽ trình diễn tính năng Chụp có hướng dẫn giúp đơn giản hóa việc thu thập dữ liệu cho các đối tượng của bạn.

Sau đó, chúng tôi sẽ giải thích cách tạo luồng Object Capture trên iOS với Object Capture API của chúng tôi.

Cuối cùng, chúng tôi sẽ nêu bật một số cải tiến mới cho khả năng tái tạo mô hình của chúng tôi.

Trước tiên chúng ta hãy xem xét sự hỗ trợ cho nhiều đối tượng hơn với LiDAR.

Để tạo ra một mô hình 3D chất lượng cao, điều quan trọng là chọn một đối tượng có đặc điểm tốt.

Hệ thống Object Capture của chúng tôi hoạt động tốt nhất cho các đối tượng có đủ chi tiết kết cấu, nhưng chúng tôi đã cải tiến hơn nữa trong năm nay.

Bây giờ chúng tôi hỗ trợ tái tạo các đối tượng có kết cấu thấp bằng cách tận dụng Máy quét LiDAR.

Hãy xem chiếc ghế này làm ví dụ.

Nó thiếu các chi tiết kết cấu, khiến Object Capture gặp khó khăn trong việc tạo ra một mô hình tốt của nó.

Tuy nhiên, sử dụng LiDAR, chúng tôi có thể xây dựng lại nó với chất lượng tốt hơn.

Trong quá trình chụp, chúng tôi chụp ảnh RGB của chiếc ghế này.

Tuy nhiên, vì ghế và lưng không có kết cấu, chúng tôi không thể khôi phục một mô hình hoàn chỉnh của nó.

Ngoài hình ảnh RGB, API của chúng tôi cũng thu thập dữ liệu đám mây điểm bằng LiDAR, giúp tạo ra một biểu diễn toàn diện về hình dạng 3D của đối tượng với độ bao phủ và mật độ được nâng cao.

Cuối cùng, một mô hình 3D hoàn chỉnh được tạo ra từ dữ liệu đám mây điểm hợp nhất.

Dưới đây là các mô hình của các đối tượng kết cấu thấp bổ sung có chất lượng được cải thiện bởi hệ thống hỗ trợ LiDAR của chúng tôi.

Mặc dù bây giờ chúng tôi hỗ trợ các đối tượng có kết cấu thấp, một số đối tượng vẫn đưa ra những thách thức.

Tốt nhất là tránh các vật thể phản chiếu, trong suốt hoặc chứa các cấu trúc rất mỏng.

Bây giờ chúng ta đã thấy những đối tượng nào được hỗ trợ, chúng ta hãy xem xét kỹ hơn cách chúng ta có thể sử dụng Guided Capture để dễ dàng quét các đối tượng của bạn.

Chúng tôi cung cấp Guided Capture, tự động chụp ảnh và dữ liệu LiDAR.

Nó cũng cung cấp phản hồi hữu ích trong quá trình chụp.

Ngoài ra, nó cung cấp hướng dẫn về việc bạn có nên lật một vật thể hay không.

Chúng tôi tự động hóa trải nghiệm thu thập dữ liệu thay vì yêu cầu bạn chọn góc nhìn tốt theo cách thủ công và nhấn một nút.

Khi bạn khoanh tròn xung quanh một vật thể, hệ thống của chúng tôi sẽ tự động chọn ảnh chụp với độ sắc nét, rõ nét và độ phơi sáng tốt, đồng thời thu thập các điểm LiDAR từ nhiều góc nhìn khác nhau.

Để chụp tất cả các chi tiết về đối tượng của bạn, chúng tôi thực sự khuyên bạn nên chụp ảnh từ càng nhiều góc độ càng tốt.

Chúng tôi cung cấp một mặt số chụp cho biết khu vực nào của đối tượng có hình ảnh đầy đủ.

Chúng tôi khuyên bạn nên lấp đầy mặt số chụp hoàn toàn bằng cách quét đối tượng của bạn từ mọi góc độ.

Ngoài tính năng chụp tự động, chúng tôi cung cấp phản hồi theo thời gian thực để hỗ trợ bạn trong quá trình chụp.

Đầu tiên, đảm bảo rằng môi trường có ánh sáng tốt để có được sự thể hiện màu sắc chính xác.

Nếu trời quá tối, bạn sẽ nhận được lời nhắc điều chỉnh điều kiện ánh sáng.

Chúng tôi khuyên bạn nên sử dụng đèn khuếch tán để giảm thiểu sự phản xạ hoặc làm nổi bật trên bề mặt vật thể.

Thứ hai, di chuyển xung quanh đối tượng từ từ và trơn tru trong khi giữ máy ảnh đều đặn để tránh hình ảnh bị mờ.

Nếu bạn di chuyển quá nhanh, việc chụp tự động sẽ dừng lại và nhắc bạn giảm tốc độ.

Thứ ba, duy trì khoảng cách phù hợp giữa máy ảnh và vật thể để vật thể có thể vừa với khung máy ảnh đúng cách.

Nếu khoảng cách quá xa hoặc quá gần, một lời nhắc văn bản sẽ xuất hiện.

Cuối cùng, luôn giữ đối tượng trong khung.

Nếu đối tượng đi ra ngoài trường nhìn, chụp tự động sẽ tạm dừng và biểu tượng mũi tên sẽ xuất hiện để nhắc bạn điều chỉnh hướng xem.

Để có được một mô hình 3D hoàn chỉnh của đối tượng của bạn, việc chụp tất cả các mặt của nó là rất quan trọng.

Lật đối tượng có thể giúp đạt được điều này.

Nhưng liệu chúng ta có nên lật một đối tượng hay không phụ thuộc vào các thuộc tính của nó.

Nếu đối tượng của bạn cứng nhắc, lật là một ý kiến hay.

Nhưng đối với các vật thể biến dạng, tốt hơn là không di chuyển chúng vì hình dạng của chúng có thể dễ dàng thay đổi.

Đối với các đối tượng giàu kết cấu, nên lật, nhưng điều quan trọng là tránh lật các đối tượng có kết cấu đối xứng hoặc lặp đi lặp lại vì điều này có thể gây hiểu lầm cho hệ thống của chúng tôi.

Ngoài ra, lật các đối tượng không có kết cấu có thể là một thách thức đối với Object Capture vì chúng ta cần đủ kết cấu để ghép các phân đoạn khác nhau lại với nhau.

Để giải quyết vấn đề này, chúng tôi cung cấp một API để đề xuất xem một đối tượng có đủ kết cấu để lật hay không.

Khi bạn quyết định lật một đối tượng, nên quét nó theo ba hướng để chúng ta có thể có được hình ảnh của tất cả các mặt.

Và tốt nhất là sử dụng đèn khuếch tán để giảm thiểu bóng và sự phản chiếu trên bề mặt của vật thể.

Sự chồng chéo hình ảnh giữa các lần quét khác nhau cũng rất quan trọng.

Một phần của đối tượng trong đường chuyền quét nên được ghi lại trong các đường chuyền trước đó.

Chúng tôi cung cấp hướng dẫn trực quan về cách lật một vật đúng cách.

Nếu một đối tượng không thể bị lật, chúng tôi khuyên bạn nên chụp nó từ ba độ cao khác nhau để có được hình ảnh từ các góc nhìn khác nhau.

Đối với hầu hết các vật thể không có kết cấu, bạn nên đặt chúng trên nền có kết cấu, nơi chúng có thể nổi bật.

Object Capture có sẵn trên iPhone 12 Pro, iPad Pro 2021 và các mẫu mới hơn.

Để kiểm tra xem thiết bị của bạn có hỗ trợ Object Capture hay không, chúng tôi cung cấp một API để dễ dàng xác minh.

Tiếp theo, đây là Mona để cho bạn biết thêm chi tiết về Object Capture API.

Mona Yousofshahi: Cảm ơn, Lei!

Bây giờ chúng ta đã thấy ứng dụng mẫu đang hoạt động, hãy xem cách chúng ta sử dụng Object Capture API để tạo ứng dụng này.

Như bạn đã thấy trong bản demo, Object Capture có hai bước, chụp ảnh và tái tạo mô hình.

Hãy nhìn vào ảnh chụp trước.

API Chụp Ảnh có hai phần, một phiên và một chế độ xem SwiftUI.

Phiên cho phép bạn quan sát và kiểm soát luồng của máy trạng thái trong quá trình chụp ảnh.

Chế độ xem SwiftUI hiển thị nguồn cấp dữ liệu máy ảnh và tự động điều chỉnh phần tử giao diện người dùng mà nó trình bày dựa trên trạng thái của phiên.

SwiftUI của chúng tôi không có bất kỳ văn bản hoặc nút 2D nào.

Điều này cho phép bạn tùy chỉnh giao diện của ứng dụng của mình và dễ dàng kết hợp Object Capture vào ứng dụng hiện có của bạn.

Hãy xem xét chi tiết máy trạng thái Object Capture.

Một phiên bắt đầu ở trạng thái khởi tạo khi nó được tạo.

Sau đó, bạn sẽ thực hiện các cuộc gọi hàm để nâng cao trạng thái.

Phiên sẽ chuyển tiếp thông qua sẵn sàng, phát hiện, chụp và kết thúc.

Khi ở trạng thái kết thúc, phiên sẽ tự động chuyển sang trạng thái đã hoàn thành.

Tại thời điểm này, bạn có thể tháo nó xuống một cách an toàn và tiếp tục tái tạo trên thiết bị.

Hãy xem cách sử dụng cái này trong thực tế.

Chúng tôi bắt đầu bằng cách nhập RealityKit và SwiftUI.

Sau đó chúng tôi tạo ra một thể hiện của ObjectCaptureSession.

Vì nó là một loại tham chiếu, chúng tôi khuyên bạn nên lưu trữ phiên bên trong mô hình dữ liệu sự thật cơ bản dưới dạng trạng thái liên tục cho đến khi nó được hoàn thành.

Với điều này, phiên bắt đầu ở trạng thái khởi tạo.

Chúng tôi tiếp tục bằng cách gọi hàm start() với một thư mục cho phiên biết nơi lưu trữ các hình ảnh đã chụp.

Chúng tôi cũng có thể cung cấp một thư mục điểm kiểm tra trong cấu hình, có thể được sử dụng sau này để tăng tốc quá trình tái thiết.

Sau cuộc gọi này, phiên sẽ chuyển sang trạng thái sẵn sàng.

Hãy xem cách sử dụng phiên với ObjectCaptureView.

Chúng tôi sử dụng ObjectCaptureView giống như bất kỳ chế độ xem SwiftUI nào khác.

Chúng tôi đặt nó bên trong cơ thể của một góc nhìn khác, chuyển nó phiên sự thật cơ bản mà chúng tôi vừa tạo ra.

ObjectCaptureView luôn hiển thị giao diện người dùng tương ứng với trạng thái hiện tại trong phiên.

Như bạn thấy ở đây ở trạng thái sẵn sàng, chế độ xem hiển thị nguồn cấp dữ liệu máy ảnh với một ô để hướng dẫn bạn chọn đối tượng để chụp.

Để nâng cao trạng thái, ứng dụng của bạn cần cung cấp giao diện người dùng yêu cầu phiên bắt đầu phát hiện đối tượng.

Ở đây, chúng tôi xếp một nút Tiếp tục lên trên ObjectCaptureView.

Khi được nhấn, nó gọi hàm startDetecting() để chuyển sang trạng thái phát hiện hộp giới hạn.

Ở trạng thái phát hiện, chế độ xem tự động thay đổi để hiển thị hộp giới hạn xung quanh đối tượng hiện được phát hiện.

Bạn có thể tự điều chỉnh kích thước và hướng của hộp giới hạn nếu cần.

Ứng dụng mẫu của chúng tôi cũng cung cấp nút đặt lại để cho phép khởi động lại quá trình lựa chọn đối tượng trong trường hợp bạn muốn chọn một đối tượng khác.

Điều này sẽ đưa phiên trở lại trạng thái sẵn sàng.

Tương tự như quá trình chuyển đổi từ sẵn sàng sang phát hiện, bạn cần cung cấp một nút để yêu cầu phiên bắt đầu chụp khi bạn hài lòng với lựa chọn đối tượng.

Ở đây chúng tôi sử dụng nút Start Capture gọi hàm startCapturing().

Sau cuộc gọi này, phiên chuyển sang trạng thái bắt giữ.

Ở trạng thái chụp, phiên tự động chụp ảnh trong khi bạn từ từ di chuyển xung quanh đối tượng.

Chế độ xem hiển thị một đám mây điểm và một mặt số chụp cho thấy nơi chúng tôi đã thu thập đủ hình ảnh của đối tượng và nơi bạn vẫn cần chụp nhiều hơn.

Quá trình quét được hoàn thành khi mặt số chụp được lấp đầy hoàn toàn.

Khi quay số chụp hoàn tất, phiên sẽ đặt thuộc tính userCompletedScanPass thành true.

Tại thời điểm này, ứng dụng mẫu của chúng tôi cung cấp cho bạn tùy chọn kết thúc phiên hoặc tiếp tục chụp nhiều hình ảnh hơn.

Chúng tôi chỉ định một nút cho mỗi tùy chọn.

Để tái tạo mô hình tốt nhất, chúng tôi khuyên bạn nên hoàn thành ba lần quét.

Hãy xem cách chuyển sang lần quét tiếp theo.

Bạn có thể bắt đầu một lần quét mới theo hai cách, tùy thuộc vào việc bạn có quyết định lật đối tượng hay không.

Lật cho phép bạn chụp những mặt của đối tượng không thể nhìn thấy trong đường chuyền hiện tại, ví dụ như đáy của đối tượng.

Đối với điều này, chúng tôi gọi beginNewScanPassAfterFlip(), điều này di chuyển trạng thái trở lại trạng thái sẵn sàng.

Sau đó bạn sẽ phải thực hiện lựa chọn hộp theo hướng mới.

Nếu bạn quyết định không lật đối tượng, thay vào đó bạn có thể chụp nhiều hình ảnh hơn ở độ cao khác.

Đối với điều này, chúng tôi gọi beginNewScanPass().

Điều này đặt lại mặt số chụp, nhưng phiên vẫn ở trạng thái chụp vì hộp giới hạn không thay đổi.

Khi tất cả các thẻ được hoàn thành, ứng dụng mẫu sẽ cung cấp nút Kết thúc.

Nút này gọi hàm finish(), cho phiên biết rằng chúng ta đã chụp xong hình ảnh và nó có thể bắt đầu quá trình hoàn thiện.

Trong khi ở trạng thái kết thúc, phiên chờ tất cả dữ liệu được lưu.

Sau khi kết thúc, phiên sẽ tự động chuyển sang trạng thái đã hoàn thành.

Chúng ta có thể phá bỏ nó một cách an toàn và bắt đầu tái tạo trên thiết bị.

Trong trường hợp có lỗi không thể khôi phục, chẳng hạn như nếu thư mục hình ảnh đột nhiên không khả dụng, phiên sẽ chuyển sang trạng thái không thành công.

Nếu điều này xảy ra, một phiên mới sẽ cần được tạo.

Và một điều cuối cùng, bạn cũng có thể hiển thị đám mây điểm để xem trước phần nào của đối tượng đã được quét kể từ khi nó được đặt ban đầu hoặc lật lần cuối.

Bạn làm điều này bằng cách hoán đổi ObjectCapturePointCloudView cho ObjectCaptureView.

Điều này sẽ tạm dừng phiên chụp và cho phép bạn tương tác với đám mây điểm để xem trước nó từ mọi góc độ.

Ở đây, chúng tôi hiển thị chế độ xem này kết hợp với một số văn bản và nút, nhưng bạn cũng có thể hiển thị toàn màn hình đám mây điểm.

Bây giờ chúng ta đã chụp được hình ảnh của đối tượng của mình, hãy xem cách tạo mô hình 3D của nó.

Bắt đầu từ năm nay, bạn có thể chạy API tái tạo trên iOS.

Điều này cho phép bạn chạy chụp và tái tạo hình ảnh trên cùng một thiết bị.

Đây là bản tóm tắt về cách sử dụng API tái tạo không đồng bộ.

Nó hoạt động giống nhau trên iOS như trên macOS.

Chúng tôi bắt đầu bằng cách đính kèm một công cụ sửa đổi nhiệm vụ vào chế độ xem mà chúng tôi đã tạo.

Trong công cụ sửa đổi nhiệm vụ, chúng tôi tạo một phiên trắc quang và trỏ nó đến các hình ảnh.

Tùy chọn, chúng tôi có thể cung cấp cùng một thư mục điểm kiểm tra mà chúng tôi đã sử dụng trong quá trình chụp ảnh để tăng tốc quá trình tái tạo.

Sau đó chúng tôi gọi hàm process() để yêu cầu một modelFile.

Cuối cùng, chúng tôi chờ luồng tin nhắn trong một vòng lặp và xử lý các tin nhắn đầu ra khi chúng đến.

Hãy chắc chắn kiểm tra cuộc nói chuyện trước đây của chúng tôi để biết thêm chi tiết.

Để tối ưu hóa việc tạo và xem các mô hình trên thiết bị di động, chúng tôi chỉ hỗ trợ mức độ chi tiết giảm trên iOS.

Mô hình được xây dựng lại bao gồm bản đồ khuếch tán, tắc nghẽn môi trường xung quanh và kết cấu bình thường, tất cả đều được thiết kế để hiển thị trên thiết bị di động.

Nếu bạn muốn tạo các mô hình ở các cấp độ chi tiết khác, bạn có thể chuyển hình ảnh của mình sang máy Mac để tái tạo.

Năm nay, việc tái tạo Mac cũng sử dụng dữ liệu LiDAR mà chúng tôi lưu trong hình ảnh của mình.

Phiên Object Capture mới cũng hỗ trợ luồng này.

Hãy xem làm thế nào.

Theo mặc định, phiên Object Capture sẽ ngừng chụp ảnh khi đạt đến giới hạn tái tạo cho thiết bị iOS.

Để tái tạo macOS, bạn có thể cho phép phiên chụp nhiều hình ảnh hơn so với việc tái tạo trên thiết bị có thể sử dụng.

Để làm như vậy, bạn đặt isOverCaptureEnabled thành true trong cấu hình của phiên.

Những bức ảnh bổ sung này sẽ không được sử dụng để tái tạo trên thiết bị, nhưng chúng được lưu trữ trong thư mục Hình ảnh.

Để tái tạo lại hình ảnh trên máy Mac, bạn thậm chí không cần phải viết bất kỳ mã nào.

Object Capture được tích hợp vào ứng dụng macOS mới của chúng tôi có tên Reality Composer Pro.

Bạn chỉ cần nhập hình ảnh của mình vào ứng dụng, chọn cấp độ chi tiết và tải mô hình của mình.

Để tìm hiểu thêm về ứng dụng này, hãy đảm bảo bạn xem phiên dành cho Reality Composer Pro.

Bây giờ chúng ta đã thấy cách tạo mô hình 3D với API iOS mới, chúng ta hãy xem xét ngắn gọn một vài cải tiến tái tạo được yêu cầu cao.

Chúng tôi đã cải thiện chất lượng mô hình và tốc độ tái tạo trên Mac.

Ngoài phần trăm tiến độ, chúng tôi hiện cung cấp thời gian tái thiết ước tính.

Hãy xem xét hai bổ sung khác chi tiết hơn, đầu ra tư thế và mức độ chi tiết tùy chỉnh.

Bây giờ bạn có thể yêu cầu một tư thế chất lượng cao cho mỗi hình ảnh.

Mỗi tư thế bao gồm vị trí ước tính và hướng của máy ảnh cho hình ảnh đó dựa trên các thuật toán thị giác máy tính của chúng tôi.

Để có được các tư thế, hãy thêm một yêu cầu tư thế vào lệnh gọi hàm process().

Sau đó xử lý đầu ra tư thế khi nó đến luồng tin nhắn đầu ra.

Các tư thế sẽ được trả lại sớm trong quá trình tái thiết trước khi mô hình được tạo ra.

Năm nay, chúng tôi cũng đã thêm một cấp độ chi tiết tùy chỉnh mới cho macOS, cho phép bạn toàn quyền kiểm soát mô hình được xây dựng lại.

Trước đây, bạn có thể chọn từ các mức chi tiết giảm, trung bình, đầy đủ và thô.

Với mức độ chi tiết tùy chỉnh, bạn có thể kiểm soát lượng phân hủy lưới, độ phân giải bản đồ kết cấu, định dạng và bản đồ kết cấu nào nên được bao gồm.

Và đó là một kết thúc trên Object Capture cho iOS.

Object Capture hiện cho phép bạn quét nhiều đối tượng hơn với sự hỗ trợ của LiDAR.

Chúng tôi đã chỉ cho bạn cách bạn có thể chụp, tái tạo và xem hoàn toàn mô hình của mình trên thiết bị iOS của mình.

Object Capture cho iOS cho phép quy trình làm việc mới cho nhiều ứng dụng, chẳng hạn như thương mại điện tử, thiết kế, giáo dục và trò chơi.

Chúng tôi rất vui khi thấy cách bạn sẽ kết hợp Object Capture vào ứng dụng của mình.

Cảm ơn vì đã xem!

♪