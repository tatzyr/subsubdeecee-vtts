10044

♪ ♪

David: Xin chào. Tên tôi là David Findlay.

Tôi là một kỹ sư máy học trong nhóm Create ML.

Chúng tôi đã làm việc trên một số cải tiến tuyệt vời cho ứng dụng và khuôn khổ Create ML.

Tôi rất vui được đưa bạn đi tham quan những gì mới.

Đào tạo một mô hình quy mô lớn từ đầu có thể mất hàng nghìn giờ, hàng triệu tệp được chú thích và kiến thức về miền chuyên gia.

Mục tiêu của chúng tôi là cung cấp cho bạn các công cụ để xây dựng các ứng dụng tuyệt vời sử dụng máy học mà không tốn nhiều chi phí.

Chúng tôi đã trải qua quá trình tạo ra các mô hình hiện đại cung cấp năng lượng cho nhiều tính năng, như trải nghiệm Tìm kiếm trong ứng dụng Ảnh và Nhận dạng Âm thanh Tùy chỉnh trong Khả năng Truy cập.

Create ML cung cấp cho bạn quyền truy cập vào công nghệ mới nhất của chúng tôi để bạn có thể xây dựng trải nghiệm học máy tùy chỉnh của riêng mình mà không gặp rắc rối.

Tôi sẽ bắt đầu bằng cách trải qua những cải tiến mà chúng tôi đã thực hiện để Tạo ML.

Sau đó, tôi sẽ giới thiệu một cách hoàn toàn mới để xây dựng các mô hình học máy để hiểu các cảnh có nhiều nhãn.

Và cuối cùng, tôi sẽ nói về các API Tăng cường mới mà chúng tôi đã thiết kế để giúp bạn cải thiện chất lượng mô hình của mình khi bạn bị giới hạn về dữ liệu đào tạo.

Hãy bắt đầu với những cải tiến Phân loại Văn bản.

Trình phân loại văn bản là một nhiệm vụ học máy được thiết kế để nhận dạng các mẫu trong văn bản ngôn ngữ tự nhiên.

Để đào tạo một mô hình như vậy, tất cả những gì bạn cần làm là cung cấp cho nó một bảng văn bản và các cặp nhãn.

Trong ví dụ này, tôi có các nhãn hiệu thể thao, giải trí và thiên nhiên.

Bạn có thể chọn thuật toán học chuyển giao sử dụng mô hình nhúng được đào tạo trước làm trình trích xuất tính năng.

Năm nay, chúng tôi đã thiết kế một mô hình nhúng mới và đào tạo nó trên hàng tỷ ví dụ văn bản được dán nhãn.

Đó là một biểu diễn bộ mã hóa hai chiều từ mô hình máy biến áp, hay viết tắt là BERT.

Bạn có thể tìm thấy tùy chọn mới trong ứng dụng Tạo ML trong phần thông số mô hình của tab Cài đặt.

Mô hình nhúng BERT là đa ngôn ngữ, có nghĩa là dữ liệu đào tạo của bạn hiện có thể chứa nhiều hơn một ngôn ngữ.

Ngoài việc hỗ trợ phân loại văn bản đa ngôn ngữ, BERT cũng có thể tăng độ chính xác của phân loại văn bản đơn ngữ của bạn.

Bạn có thể tận dụng BERT trên iOS 17, iPadOS 17 và macOS Sonoma.

Chúng tôi có toàn bộ video bao gồm tất cả các chi tiết.

Đảm bảo xem "Khám phá các mô hình đa ngôn ngữ tự nhiên" để tìm hiểu thêm.

Tiếp theo, tôi muốn nói về cách chúng ta sử dụng học chuyển giao trong nhiệm vụ phân loại hình ảnh.

Trình phân loại hình ảnh trong Create ML được thiết kế để giúp bạn xây dựng các mô hình để trả lời câu hỏi, nhãn tốt nhất để mô tả nội dung hình ảnh của tôi là gì?

Tương tự như trình phân loại văn bản, trình phân loại hình ảnh tận dụng mô hình được đào tạo trước để trích xuất thông tin liên quan từ hình ảnh.

Phiên bản mới nhất của Apple Neural Scene Analyzer hiện có sẵn cho bạn để xây dựng các mô hình hiện đại với rất ít dữ liệu đào tạo.

Các mô hình hiểu hình ảnh trong hệ điều hành tiếp tục phát triển để mang đến cho bạn trải nghiệm tốt nhất có thể.

Bạn có thể tìm hiểu thêm bằng cách xem bài viết của chúng tôi trên trang web nghiên cứu học máy.

Trong ứng dụng Tạo ML, bạn sẽ nhận thấy một tùy chọn trích xuất tính năng mới trong phần tham số mô hình của tab Cài đặt.

Trình trích xuất tính năng mới có kích thước nhúng đầu ra nhỏ hơn khi so sánh với phiên bản trước của chúng tôi.

Ngoài những cải tiến chung, điều này có thể tăng độ chính xác của trình phân loại của bạn, dẫn đến thời gian đào tạo nhanh hơn và giảm bộ nhớ cần thiết để lưu trữ các tính năng được trích xuất.

Bây giờ tôi đã đề cập đến những cải tiến trong Create ML, tôi muốn nói về trình phân loại hình ảnh đa nhãn mới.

Trước khi tôi đến đó, hãy nhớ lại rằng phân loại hình ảnh nhãn đơn được thiết kế để dự đoán nhãn tốt nhất mô tả nội dung của hình ảnh.

Ví dụ, bạn có thể mô tả hình ảnh này là chó hoặc có thể ở ngoài trời.

Nhưng bạn cần phải chọn một cái.

Nếu bạn quan tâm đến các đối tượng, thì bạn có thể sử dụng máy dò đối tượng để xác định vị trí các đối tượng trong một cảnh.

Ví dụ, tôi đã vẽ một cái hộp giới hạn xung quanh con chó và một cái khác xung quanh quả bóng.

Bây giờ, điều này thật tuyệt, nhưng tôi cũng quan tâm đến cảnh mà các đồ vật đang ở trong đó.

Tôi thực sự không thể vẽ một hộp giới hạn để thể hiện rằng con chó đang ở trong công viên hoặc ngoài trời.

Đó là nơi phân loại hình ảnh đa nhãn mới xuất hiện.

Nó cho phép bạn dự đoán một tập hợp các đối tượng, thuộc tính hoặc nhãn cho hình ảnh của mình.

Ví dụ như hình ảnh này chứa một con chó, đồ chơi, cỏ và công viên.

Hãy đi xây dựng một cái bằng cách sử dụng Create ML.

Như thường lệ, điều đầu tiên tôi cần làm là thu thập một số dữ liệu đào tạo.

Tôi quyết định vui vẻ một chút và xây dựng một bộ phân loại phát hiện nhiều loài thực vật mọng nước trong các cảnh khác nhau.

Ví dụ, ở đây tôi có một hình ảnh của Haworthia, Jade và Aloe trong chậu trên bệ cửa sổ.

Trong hình ảnh tiếp theo, tôi có một người đang cầm một cây xương rồng trong chậu.

Trong khi thu thập hình ảnh đào tạo, bạn cũng có thể bao gồm một số hình ảnh chỉ có một nhãn duy nhất, chẳng hạn như ảnh chỉ lô hội.

Bạn sẽ cần sắp xếp các chú thích của mình trong tệp JSON.

Tất cả những gì bạn cần làm là chú thích từng tệp với một bộ chú thích.

Bây giờ, hãy để tôi cung cấp cho bạn bản demo xây dựng mô hình trong ứng dụng Tạo ML.

Trong ứng dụng Tạo ML, tôi sẽ chọn mẫu phân loại hình ảnh đa nhãn mới.

Và tạo một dự án có tên Succulent Classifier.

Điều này đưa tôi đến tab Cài đặt.

Để bắt đầu, tôi sẽ kéo dữ liệu đào tạo của mình vào, cung cấp cho tôi bản tóm tắt về số lượng lớp học và hình ảnh đào tạo.

Tôi cũng có tùy chọn để kéo dữ liệu xác thực, nhưng tôi sẽ chọn chia ngẫu nhiên dữ liệu đào tạo ngay bây giờ.

Tôi sẽ sử dụng số lần lặp mặc định và cũng bỏ qua các lần tăng cường.

Tôi đã thiết lập xong mô hình của mình, vì vậy tôi sẽ tiếp tục và nhấp vào Train.

Mô hình này chỉ mất vài phút để luyện tập trên máy Mac của tôi.

Ngay lập tức, mô hình bắt đầu trích xuất các tính năng bằng cách sử dụng trình trích xuất tính năng mới mà tôi đã giới thiệu trước đó.

Sau khi hoàn tất, ứng dụng bắt đầu đào tạo một trình phân loại.

Trong quá trình đào tạo, ứng dụng đo lường chất lượng mô hình của tôi bằng cách tính toán điểm chính xác trung bình trung bình, hay viết tắt là MAP.

Nói chung, tôi muốn tối đa hóa điểm MAP vì điều đó có nghĩa là mô hình của tôi có cả độ chính xác cao hơn và mức thu hồi trung bình cao hơn cho tất cả các nhãn trong tập dữ liệu của tôi.

Mô hình của tôi đã hoàn thành khóa đào tạo và hội tụ sớm ở 74 lần lặp lại, với điểm MAP là 97% trong bộ đào tạo và 93% trên bộ xác nhận.

Bước tiếp theo là đánh giá mô hình của tôi trên dữ liệu thử nghiệm.

Tôi sẽ kéo một thư mục từ màn hình nền của mình và nhấp vào nút Kiểm tra.

Dữ liệu kiểm tra phải chứa cùng một bộ nhãn lớp mà tôi đã sử dụng để đào tạo mô hình của mình.

Ứng dụng đã tính toán một vài số liệu thống kê cấp cao, như Điểm MAP và nhãn lớp nào có độ chính xác và thu hồi cao nhất và thấp nhất.

Hãy tập trung vào tab Số liệu.

Ứng dụng tính toán các số liệu cho từng nhãn lớp, như False Positives, False Negatives, Precision, Recall, và Confidence Threshold.

Khi đưa ra dự đoán với mô hình của tôi, một dự đoán là chính xác nếu độ tin cậy vượt quá ngưỡng cho một nhãn lớp nhất định.

Hãy cùng khám phá những hình ảnh mà mô hình dự đoán trên ngưỡng tin cậy đối với lô hội.

Bây giờ tôi sẽ nhấp vào một ví dụ.

Mô hình dự đoán rằng hình ảnh này chứa lô hội với độ tin cậy 90%, cao hơn ngưỡng độ tin cậy lô hội là 40%.

Đối với các nhãn khác, mô hình dự đoán độ tin cậy dưới ngưỡng tương ứng của chúng.

Nói cách khác, mô hình đã không dự đoán được chúng.

Tiếp theo, tôi muốn khám phá những hình ảnh mà mô hình của tôi không dự đoán lô hội nhưng được dán nhãn là lô hội.

Tôi có thể làm điều đó bằng cách chọn loại kết quả False Negatives.

Hình ảnh này thật thú vị. Hãy cùng khám phá thêm.

Ở đây, lô hội nằm phía sau cây xương rồng thùng và cây xương rồng mặt trăng, vì vậy người mẫu gặp khó dự đoán lô hội.

Nhưng tin tốt là mô hình dự đoán chính xác hai nhãn khác.

Tiếp theo, tôi sẽ chuyển đến tab Xem trước.

Đây là nơi tôi có thể xem trước các dự đoán mô hình của mình trên những hình ảnh mà tôi chưa gắn nhãn.

Tôi có một sự sắp xếp mọng nước mà tôi tự trồng mà tôi nghĩ sẽ rất thú vị khi thử.

Đóng đinh nó.

Mô hình của tôi đã dự đoán chính xác cây xương rồng mặt trăng, cây xương rồng tai thỏ và cây xương rồng thùng trong nhà bếp của tôi.

Tôi khá hài lòng với chất lượng mô hình của mình, nhưng tôi chắc chắn sẽ tiếp tục thử nghiệm để hiểu những hạn chế của mô hình cũng như thêm nhiều loài xương rồng và cảnh vào tập dữ liệu của mình.

Bây giờ, hãy tiếp tục.

Từ tab Đầu ra, tôi có thể lưu mô hình mà tôi đã đào tạo vào đĩa.

Hãy xem qua một số mã mà bạn sẽ cần viết để tạo dự đoán.

Bước đầu tiên là tạo ra một mô hình Vision từ mô hình Core ML được biên dịch.

Sau đó sử dụng khung tầm nhìn, tôi sẽ tạo một trình xử lý yêu cầu hình ảnh với một hình ảnh nguồn và sau đó thực hiện một yêu cầu.

Cuối cùng, tôi có thể truy xuất các quan sát phân loại và lọc chúng bằng cách sử dụng giá trị chính xác và thu hồi mà tôi quan tâm.

Để tìm hiểu thêm về cách chọn giá trị chính xác và thu hồi phù hợp với trường hợp sử dụng của bạn, hãy đảm bảo xem video từ WWDC 2019, "Hiểu về hình ảnh trong khung tầm nhìn".

Trước khi tôi tiếp tục, tôi muốn dành một chút thời gian và đề cập rằng, tương tự như trình phân loại hình ảnh và trình phân loại hình ảnh đa nhãn của chúng tôi, chúng tôi đã nâng cao tab đánh giá với tùy chọn khám phá để phát hiện đối tượng.

Hãy chắc chắn kiểm tra nó.

Tôi muốn chuyển trọng tâm của bạn sang chủ đề cuối cùng của tôi, đào tạo các mô hình học máy về dữ liệu hạn chế bằng cách sử dụng tăng cường.

Để có được một mô hình khái quát hóa tốt, các hình ảnh trong bộ đào tạo của bạn phải có nhiều đặc điểm khác nhau như điều kiện ánh sáng, hướng và nền khác nhau.

Nhưng việc chụp và dán nhãn hình ảnh đào tạo trong các tình huống khác nhau có thể tốn thời gian.

Tăng cường dữ liệu là một kỹ thuật tạo ra các ví dụ đào tạo mới từ những ví dụ hiện có của bạn bằng cách áp dụng các phép biến đổi.

Trong trường hợp hình ảnh, các phép biến đổi có thể là lật, cắt xén hoặc tương phản theo chiều ngang hoặc dọc, chỉ để kể tên một số.

Trong ví dụ này, tôi bắt đầu với một hình ảnh của một loài mọng nước và tạo ra bốn biến thể.

Và các phép biến đổi có thể được kết hợp, như lật và tăng độ tương phản.

Tăng cường có thể nâng cao chất lượng mô hình của bạn, đặc biệt là khi bạn có một bộ dữ liệu đào tạo nhỏ.

Bạn có thể sử dụng chúng để cải thiện sự khái quát hóa mô hình của mình vì nó ngăn mô hình của bạn học các thuộc tính như vị trí chính xác của một đối tượng trong một cảnh.

Tuy nhiên, điều quan trọng là phải xem xét rằng việc đào tạo thường chậm hơn vì việc trích xuất tính năng xảy ra ở mỗi lần lặp lại đào tạo.

Nếu bạn chưa có, hãy đảm bảo xem các video của chúng tôi từ WWDC 2022, nơi chúng tôi đã giới thiệu Tạo các Thành phần ML.

Chúng tôi đã thiết kế khuôn khổ để giúp bạn xây dựng các mô hình học máy tùy chỉnh bằng cách sử dụng các thành phần như máy biến áp và công cụ ước tính.

Năm nay, chúng tôi đã thêm các API tăng cường mới mà bạn có thể sử dụng để thiết kế các đường ống tăng cường tùy chỉnh của riêng mình.

Nếu bạn có kinh nghiệm với SwiftUI, điều này có thể quen thuộc với bạn.

Bước đầu tiên là tạo ra một bộ tăng cường.

Tương tự như SwiftUI, bộ tăng cường sử dụng trình tạo kết quả.

Trong phần thân của bộ tăng cường, bạn có thể thêm các phép biến đổi để tăng cường dữ liệu của mình.

Vì bộ tăng cường là chung chung, dữ liệu của bạn có thể được gắn nhãn hình ảnh, âm thanh được gắn nhãn hoặc thậm chí là thứ gì đó khác.

Phần quan trọng là các loại đầu vào và đầu ra của mỗi phép biến đổi cần phải khớp.

Ví dụ, chụp một hình ảnh và tạo ra một hình ảnh.

Tôi muốn tăng cường hình ảnh của mình bằng cách lật chúng theo chiều ngang với xác suất 50%.

Tôi sẽ bắt đầu bằng cách thêm ApplyRandomly vào Augmenter.

Điều này áp dụng một phép biến đổi với một xác suất nhất định.

Sau đó tôi sẽ thêm một máy biến áp lật ngang vào thân của nó.

Được rồi, bây giờ tôi đã có bộ tăng cường của mình, tôi có thể sử dụng nó để tạo tăng cường bằng cách gọi phương thức được áp dụng.

Khi bạn thiết kế tăng cường, điều quan trọng là phải xem xét cẩn thận bản chất của dữ liệu của bạn.

Không chắc là bạn sẽ gặp phải một quả mọng nước lộn ngược.

Vì vậy, không có ý nghĩa gì khi áp dụng tăng lật dọc trong trường hợp này.

Hoặc tưởng tượng trong giây lát rằng bạn muốn phân loại các biển báo giao thông thay thế.

Khi bạn áp dụng tăng cường lật, nhãn có thể không còn mô tả chính xác hình ảnh của bạn nữa.

Vì vậy, hãy nhớ xem xét bản chất của dữ liệu của bạn trước khi thiết kế tăng cường tùy chỉnh.

Được rồi, bước tiếp theo là thêm nhiều phép biến đổi vào bộ tăng cường.

Lần này, tôi sẽ xoay ngẫu nhiên hình ảnh của mình bằng cách sử dụng UniformRandomFloatingPointParameter.

Điều này tạo ra một góc ngẫu nhiên mỗi khi tôi áp dụng tăng cường.

Và cuối cùng, tôi sẽ cắt ngẫu nhiên các hình ảnh.

Lưu ý rằng mỗi phép biến đổi trong bộ tăng cường được áp dụng theo trình tự.

Vì vậy, đầu tiên, hình ảnh của tôi được lật ngẫu nhiên.

Kết quả được xoay ngẫu nhiên và sau đó được cắt ngẫu nhiên.

Tôi chỉ làm xước bề mặt của những gì bạn có thể làm với Augmenter.

Đây là một số thành phần mà chúng tôi cung cấp để giúp bạn bắt đầu.

Nhưng nếu bạn muốn đi xa hơn nữa thì sao?

Hãy xem qua một ví dụ về cách bạn có thể xây dựng các phép biến đổi tùy chỉnh và sử dụng chúng để tăng cường hình ảnh của mình.

Để xây dựng một bộ phân loại mạnh mẽ, điều quan trọng là phải chụp ảnh đào tạo của bạn trong các cảnh và môi trường khác nhau.

Trong ví dụ này, tôi sẽ tạo một sự tăng cường tùy chỉnh đặt một cây mọng nước ở một vị trí ngẫu nhiên trong một cảnh ngẫu nhiên.

Tôi sẽ bắt đầu bằng cách xác định RandomImageBackground.

Nó phù hợp với một giao thức mới, RandomTransformer, tương tự như một máy biến áp nhưng nhận một trình tạo số ngẫu nhiên.

Vì tôi muốn các tăng cường của mình đặt các loài xương rồng một cách ngẫu nhiên với các cảnh nền khác nhau, tôi sẽ tạo một trình khởi tạo để chụp ảnh nền.

Để phù hợp với giao thức RandomTransformer, tôi sẽ cần triển khai phương pháp được áp dụng.

Khi áp dụng tăng cường của tôi, bước đầu tiên là chọn ngẫu nhiên một nền.

Sau đó, tôi sẽ chọn một vị trí ngẫu nhiên trong hình nền nơi tôi muốn đặt hình ảnh đầu vào của mình, chú ý không cắt nó.

Tiếp theo, tôi sẽ dịch hình ảnh đầu vào của mình sang vị trí ngẫu nhiên.

Và cuối cùng, tôi sẽ đặt hình ảnh đầu vào trên nền được chọn ngẫu nhiên.

Tôi sẽ thêm phần tăng cường tùy chỉnh mới của mình vào cuối để việc lật, xoay và cắt xảy ra trước khi tôi đặt cây mọng nước ở các nền khác nhau.

Và đây là bộ tăng cường cuối cùng của tôi.

Sử dụng bộ tăng cường của mình, tôi có thể tạo ra một số hình ảnh thực sự thú vị để đào tạo một bộ phân loại.

Đó là bước tiếp theo.

Khi sử dụng tăng cường, việc đào tạo dần dần bằng phương pháp cập nhật sẽ có ý nghĩa hơn.

Với ý nghĩ đó, chúng ta hãy xem qua một ví dụ về đào tạo sử dụng tăng cường.

Và tôi sẽ không giữ lại: Tôi cũng sẽ kết hợp trộn hàng loạt, ngẫu nhiên và dừng sớm.

Tôi sẽ bắt đầu bằng cách tạo ra một mô hình phân loại hình ảnh trống.

Sau đó tôi sẽ tạo một vòng lặp đào tạo.

Trong vòng lặp đào tạo, bước đầu tiên là xáo trộn và tăng cường hình ảnh đào tạo của tôi.

Bạn sẽ muốn xáo trộn trước khi tăng cường để trên mỗi lần lặp lại, các lô chứa các hình ảnh khác nhau.

Kết quả của bộ tăng cường là một chuỗi không đồng bộ, có nghĩa là các phép biến đổi xảy ra một cách lười biếng.

Sử dụng phương pháp hàng loạt, tôi có thể nhóm chuỗi tăng cường không đồng bộ thành các nhóm.

Trong trường hợp này, tôi đã sử dụng kích thước lô là 16.

Cuối cùng, tôi sẽ cập nhật mô hình của mình với mỗi lô hình ảnh tăng cường.

Đây là lý do tại sao sử dụng phương pháp cập nhật là một lựa chọn tốt khi tăng cường dữ liệu.

Trên mỗi lần lặp lại, bạn nhận được một bộ hình ảnh mới.

Tùy thuộc vào bộ tăng cường của bạn, phương pháp cập nhật khó có thể gặp phải cùng một hình ảnh chính xác hơn một lần.

Điều này khuyến khích mô hình khái quát hóa thay vì ghi nhớ.

Tôi đã chọn 100 lần lặp lại, nhưng lý tưởng nhất là bạn nên ngừng đào tạo khi độ chính xác xác thực ngừng cải thiện.

Trong ví dụ này, độ chính xác của đào tạo tiếp tục được cải thiện, nhưng lưu ý rằng độ chính xác xác thực bắt đầu giảm sau một vài lần lặp lại.

Điều này có nghĩa là mô hình đang ghi nhớ dữ liệu đào tạo, làm cho nó ít khái quát hơn đối với dữ liệu mới và hoạt động kém hơn trên dữ liệu xác thực và kiểm tra.

Tiếp tục đào tạo sau điều này là bất lợi.

Ví dụ cuối cùng, tôi sẽ thêm điểm dừng sớm vào vòng lặp đào tạo.

Sau bước cập nhật, bạn có thể tính toán các chỉ số xác thực.

Tôi đang sử dụng độ chính xác xác thực để dừng đào tạo sớm, điều này hoạt động cho các mô hình phân loại.

Nhưng điều đó thực sự phụ thuộc vào bạn.

Bạn có thể sử dụng tổn thất xác nhận hoặc thậm chí thiết kế số liệu của riêng bạn để đánh giá chất lượng mô hình của bạn.

Sau đó, tôi sẽ thoát ra khỏi vòng lặp đào tạo khi độ chính xác không được cải thiện trong năm lần lặp lại cuối cùng.

Và điều đó kết thúc trình phân loại hình ảnh tăng cường của tôi.

Trong video này, tôi đã giới thiệu các mô hình hiện đại mới được vận chuyển trong hệ điều hành mà bạn có thể sử dụng để xây dựng trải nghiệm học máy tuyệt vời trong các ứng dụng của mình.

Sau đó, tôi đã đưa ra một ví dụ về cách bạn có thể xây dựng các mô hình để hiểu các cảnh bằng cách sử dụng trình phân loại hình ảnh đa nhãn mới của chúng tôi.

Cuối cùng, tôi đã đi vào chi tiết về cách bạn có thể xây dựng các tăng cường tùy chỉnh của riêng mình để cải thiện chất lượng mô hình của mình.

Và đó là một cái bọc.

Đã đến lúc bạn nâng cao ứng dụng của mình với Create ML.