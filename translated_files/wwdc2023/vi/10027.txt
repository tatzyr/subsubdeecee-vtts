10027

♪ ♪

Kathryn: Xin chào! Tôi là Kathryn, và tôi là một kỹ sư làm việc về Trải nghiệm Hệ thống.

Hôm nay tôi sẽ nói về các vị trí mới cho các tiện ích và cách bạn có thể dễ dàng tối ưu hóa tiện ích của mình để trông tuyệt vời ở mọi nơi.

Đầu tiên, chúng ta hãy xem qua lịch sử nhanh về các vật dụng.

iOS 14 đã giới thiệu các tiện ích trên Màn hình chính và iOS 16 đã đưa các tiện ích lên Màn hình Khóa, sử dụng cùng một API WidgetKit dễ dàng.

Năm nay, hệ sinh thái tiện ích đang mở rộng đến bốn vị trí mới: máy tính để bàn trên Mac, màn hình khóa trên iPad, chế độ StandBy mới trên iPhone và Smart Stack mới trên Apple Watch.

Điều này có nghĩa là mọi người sẽ có thể xem tất cả các vật dụng yêu thích của họ ở nhiều nơi hơn nữa.

Tiện ích của bạn sẽ có thể tự động xuất hiện ở tất cả các vị trí này, vì vậy điều quan trọng là phải đảm bảo rằng nó trông tuyệt vời bất kể nó được hiển thị ở đâu.

Nhờ iPhone Widgets trên Mac, mọi người sẽ có thể sử dụng widget của bạn trên Mac ngay cả khi bạn hiện không có ứng dụng macOS.

Bạn bè của tôi Devon và Graham đã yêu cầu tôi giúp họ cập nhật tiện ích Emoji Rangers của họ để chuẩn bị sẵn sàng cho những địa điểm mới này.

Bạn có thể nhớ dự án này từ "Widgets code-along" của WWDC20 và "Complications and widgets: Reloaded" của WWDC22.

Chúng ta sẽ bắt đầu bằng cách xem xét các lề nội dung mới cho các tiện ích và cách chuyển sang chúng trên Apple Watch.

Tiếp theo, chúng tôi sẽ thêm một nền có thể tháo rời tự động vào tiện ích của mình.

Sau đó, chúng tôi sẽ sửa đổi tiện ích của mình để nó có thể tự động mở rộng bố cục để phù hợp với môi trường của nó.

Cuối cùng, chúng tôi sẽ đảm bảo các yếu tố trong tiện ích của chúng tôi đã sẵn sàng để kết xuất sống động.

Hãy bắt đầu nào.

Điểm mới cho các tiện ích trong năm nay là lề nội dung.

Lề nội dung là phần đệm được tự động áp dụng cho nội dung tiện ích của bạn, ngăn nội dung của bạn đến gần cạnh của vùng chứa tiện ích.

Các lề này có thể lớn hơn hoặc nhỏ hơn, tùy thuộc vào môi trường nơi tiện ích của bạn đang được hiển thị.

Trên watchOS 9 trở xuống, các tiện ích sử dụng khu vực an toàn do hệ thống xác định để giữ cho nội dung không đến quá gần cạnh.

Các tiện ích có thể thêm các công cụ sửa đổi như ignoresSafeArea vào chế độ xem để cho phép chúng mở rộng ra ngoài khu vực an toàn.

Trên watchOS 10 trở lên, các khu vực an toàn trong các tiện ích đã được thay thế bằng việc sử dụng lề nội dung.

Điều này có nghĩa là các công cụ sửa đổi như ignoresSafeArea không còn bất kỳ ảnh hưởng nào trong các tiện ích.

Đối với hầu hết các tiện ích, thay đổi này sẽ không ảnh hưởng đến giao diện tiện ích của bạn.

Tuy nhiên, nếu tiện ích của bạn có nội dung được sử dụng để bỏ qua khu vực an toàn, bạn vẫn có thể đạt được hiệu ứng tương tự bằng cách thêm công cụ sửa đổi contentMarginsDisabled vào cấu hình tiện ích của mình.

Sau đó, đối với bất kỳ nội dung nào nên nằm trong lề nội dung mặc định, chỉ cần thêm phần đệm trở lại.

Bạn có thể sử dụng biến môi trường widgetContentMargins để lấy lề mặc định cho môi trường hiện tại.

Biên độ nội dung, cùng với các công cụ sửa đổi và biến mới này, có sẵn trên mọi nền tảng nơi các tiện ích được hiển thị.

Bây giờ, hãy thêm một nền có thể tháo rời vào tiện ích Emoji Rangers của chúng tôi.

Dòng phụ kiện tiện ích hiện tại của chúng tôi tự động hoạt động trên màn hình Khóa iPad, giống như trên iPhone.

iPad cũng có thể hiển thị các vật dụng nhỏ của hệ thống ngay bên cạnh chúng.

Đây là những gì chúng ta trông giống như trên màn hình Khóa ngay bây giờ.

Chúng ta cần loại bỏ nền của nó trong môi trường này để nó phù hợp với các tiện ích khác tốt hơn.

May mắn thay, làm điều này cực kỳ đơn giản.

Ở đây tôi có mã cho chế độ xem tiện ích nhỏ hệ thống của chúng tôi.

Ngay bây giờ, nó bao gồm một AvatarView được xếp lớp trên màu nền trò chơi của chúng tôi bằng cách sử dụng ZStack.

Để làm cho màu nền có thể tháo rời, tất cả những gì chúng ta cần thay đổi là thêm công cụ sửa đổi nền vùng chứa vào Chế độ xem của chúng ta và di chuyển màu nền trò chơi của chúng ta vào bên trong.

Khi chúng tôi làm điều đó, hệ thống có thể tự động lấy nền tiện ích của chúng tôi ra tùy thuộc vào nơi nó được hiển thị.

Smart Stack trên Apple Watch cũng có thể sử dụng containerBackground mới này.

Theo mặc định, tiện ích hình chữ nhật phụ kiện của bạn sẽ nhận được nền vật liệu tối trong môi trường này.

Bằng cách thêm cùng một công cụ sửa đổi containerBackground vào chế độ xem của chúng tôi, tiện ích được đặt trên cùng nền với các tiện ích khác của chúng tôi, liên kết nó với nhận dạng hình ảnh của ứng dụng của chúng tôi.

Để tìm hiểu sâu hơn về môi trường mới này, hãy xem "Thiết kế tiện ích cho Smart Stack trên Apple Watch".

Một số tiện ích, như tiện ích Ảnh và Bản đồ, không thực sự có nội dung tiền cảnh riêng biệt, vì vậy không có nền nào có ý nghĩa để xóa.

Trong trường hợp này, bạn có thể thêm công cụ sửa đổi containerBackgroundRemovable vào WidgetConfiguration của mình và đặt nó thành false.

Bây giờ, hãy thực hiện một số tối ưu hóa cho bố cục của chúng tôi khi chúng tôi đang sử dụng màn hình Khóa iPad và chế độ StandBy.

Tiện ích Thời tiết là một ví dụ tuyệt vời về cách thay đổi bố cục của bạn khi nền tiện ích bị xóa.

Lưu ý cách tiện ích vẫn chứa cùng một thông tin, nhưng nó đã được tối ưu hóa để tận dụng không gian.

Nội dung được đẩy đến tận các cạnh và các yếu tố quan trọng được phóng to.

Những chỉnh sửa này giúp tiện ích dễ đọc hơn từ xa và tích hợp nó liền mạch hơn vào chế độ StandBy.

Những thay đổi bố cục này cũng giúp tiện ích kết hợp với các tiện ích gia đình phụ kiện trên màn hình Khóa iPad, duy trì giao diện nhất quán hơn trên mọi gia đình.

Hãy chuyển sang Xcode để thực hiện những thay đổi này trong tiện ích của riêng chúng ta.

Ở đây tôi có mã cho AvatarView của chúng tôi, đó là những gì chúng tôi sử dụng cho tiện ích systemSmall của mình.

Ở bên phải, tôi có thể xem bản xem trước trực tiếp về tiện ích của chúng tôi trông như thế nào trong Bản xem trước Xcode.

Khi được hiển thị trong bối cảnh xóa nền vùng chứa, widgetContentMargins sẽ tự động thu nhỏ lại để đưa nội dung của chúng ta tràn cạnh.

Chúng tôi có thể phát hiện xem nền tiện ích đã bị xóa hay chưa bằng cách sử dụng biến môi trường showsWidgetContainerBackground.

Khi đó là, hãy bỏ qua các chi tiết về cấp độ anh hùng và XP của chúng ta khỏi HeroNameView của chúng ta, và thay vào đó hiển thị những chi tiết đó bên dưới.

Điều này cũng sẽ làm cho tên anh hùng của chúng ta lớn hơn khi ở trong môi trường này.

Bây giờ khi chúng tôi chuyển đổi giữa các ngữ cảnh này, bố cục của chúng tôi sẽ tự động thay đổi từ chế độ xem ban đầu sang chế độ xem mở rộng mới của chúng tôi.

Cũng giống như với các tiện ích gia đình phụ kiện, các tiện ích gia đình hệ thống của chúng tôi được hiển thị ở chế độ kết xuất sống động trên màn hình Khóa iPad.

Điều này có nghĩa là tiện ích của bạn sẽ không bão hòa, sau đó được tô màu thích hợp cho nền màn hình Khóa.

Khi được hiển thị như thế này, các vấn đề về độ tương phản có thể ảnh hưởng đến tính dễ đọc của tiện ích của chúng tôi.

Ví dụ, hình đại diện của anh hùng của chúng ta trở nên khó phân biệt với phông nền tròn của nó.

Hãy quay lại Xcode và sửa đổi tiện ích của chúng tôi để xóa phông nền đó khi ở chế độ kết xuất sống động.

Hãy kiểm tra điều này ở chế độ StandBy Night.

Chúng ta có thể sử dụng biến môi trường widgetRenderingMode để phát hiện chúng ta đang ở chế độ kết xuất nào.

Hãy thay đổi tham số Bao gồm Nền của Hình đại diện của chúng tôi để kiểm tra xem chúng tôi có đang ở chế độ kết xuất sôi động hay không.

Chế độ StandBy Night cũng sử dụng kết xuất sống động, vì vậy hình đại diện của chúng tôi cũng hiển thị rõ ràng trong bối cảnh này.

Để tìm hiểu thêm về các chế độ kết xuất tiện ích, hãy xem "Biến chứng và tiện ích: Đã tải lại" từ WWDC22.

Và để biết thêm về những gì mới với các vật dụng, hãy xem "Mang các vật dụng vào cuộc sống".

Tôi rất hào hứng với tất cả những thay đổi sắp tới đối với tiện ích và tôi nóng lòng muốn xem bạn đưa ra ý tưởng nào để nâng cao tiện ích của mình với những tính năng mới này.

Cảm ơn, và tận hưởng!

♪ ♪