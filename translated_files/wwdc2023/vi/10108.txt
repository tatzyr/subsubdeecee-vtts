10108

♪ ♪

Jared: Xin chào, và chào mừng đến với "Có gì mới trong Tài sản nền."

Tên tôi là Jared, và tôi là một kỹ sư phần mềm ở đây tại Apple.

Tôi thực sự mong muốn được chia sẻ với bạn mọi thứ mới trong năm nay với Background Assets.

Bây giờ, nhóm của chúng tôi đã thay đổi một vài điều trong năm qua.

Tuy nhiên, tôi khuyến khích bạn kiểm tra phiên trước của tôi nơi Tài sản nền được giới thiệu.

Có rất nhiều thông tin chi tiết trong đó mà phiên mới này được xây dựng dựa trên.

Trong phiên này, tôi sẽ bắt đầu bằng cách cung cấp cho bạn cái nhìn tổng quan về Tài sản nền và lý do tại sao bạn nên áp dụng nó vào ứng dụng của mình.

Sau đó, tôi sẽ thảo luận về những gì mới trong năm nay trong Background Assets, bao gồm một tính năng hoàn toàn mới mà nhóm của chúng tôi thực sự vui mừng được chia sẻ với bạn.

Sau đó, tôi sẽ hướng dẫn bạn triển khai mẫu Tài sản nền mà bạn thậm chí có thể tự tải xuống và tôi sẽ chỉ cho bạn cách áp dụng công nghệ này có thể cải thiện đáng kể trải nghiệm người dùng của ứng dụng của bạn.

Sau đó tôi sẽ cung cấp cho bạn một số hướng dẫn về việc gỡ lỗi tiện ích mở rộng ứng dụng của bạn và mô phỏng các điểm vào của nó.

Được rồi! Hãy xem qua bản tóm tắt nhanh về Tài sản nền.

Một trong những mục tiêu chính đằng sau Tài sản nền là tránh phải chờ đợi.

Điều cuối cùng mà người dùng muốn trải nghiệm là khởi chạy ứng dụng của bạn và phải đợi quá trình tải xuống lớn hoàn tất.

Background Assets giải quyết vấn đề này thông qua sự kết hợp giữa khuôn khổ của nó và phần mở rộng ứng dụng liên quan.

Công nghệ mới này đã được giới thiệu trong iOS 16.1 cùng với bản phát hành ban đầu của macOS Ventura.

Nó hỗ trợ khả năng tải xuống nội dung bổ sung cho ứng dụng của bạn bằng cách sử dụng nhà cung cấp CDN hoặc máy chủ bạn quản lý.

Ví dụ, nội dung này có thể được tìm nạp trong quá trình cài đặt ứng dụng ban đầu, khi ứng dụng cập nhật hoặc định kỳ trong nền khi người dùng không sử dụng ứng dụng của bạn.

Thông qua tiện ích mở rộng ứng dụng được ghép nối, bạn có thể viết mã chạy khi ứng dụng không được người dùng sử dụng tích cực.

Công nghệ này hiện đang được hỗ trợ trên macOS, iOS và iPadOS, vì vậy nó đã có sẵn trên các nền tảng yêu thích của bạn.

Một trong những phần hay nhất về việc sử dụng Background Assets là tiện ích mở rộng có khả năng chạy trước khi người dùng khởi chạy ứng dụng của bạn.

Điều này cung cấp một cách để bắt đầu tìm nạp tài sản ngay khi ứng dụng của bạn được cài đặt thông qua App Store.

Tiện ích mở rộng cũng có thể được hệ thống khởi chạy định kỳ trong nền.

Điều này là để đảm bảo rằng bất kỳ tài sản mới hoặc cập nhật nào có mặt khi ứng dụng của bạn được người dùng khởi chạy.

Tiện ích mở rộng cũng được sử dụng để phục vụ tải xuống khi ứng dụng không chạy.

Ví dụ, khi một tệp tải xuống xong, tiện ích mở rộng sẽ được khởi chạy để nó có thể di chuyển tệp đến đích cuối cùng.

Một điều cần lưu ý là thời gian chạy của tiện ích mở rộng bị giới hạn.

Điều này là để đảm bảo rằng thiết bị của người dùng được tối ưu hóa về sức mạnh và hiệu suất.

Tôi sẽ sớm đi vào chi tiết hơn về điều này.

Điều quan trọng cần biết là tiện ích mở rộng ứng dụng bạn phát triển để sử dụng với Background Assets được đặt vào một hộp cát chuyên dụng.

Điều này là để đảm bảo rằng tiện ích mở rộng chỉ được sử dụng để quản lý nội dung thông qua Tài sản nền.

Nếu bạn thấy rằng khả năng hoặc API không khả dụng trong hộp cát, vui lòng liên hệ với chúng tôi thông qua Trợ lý phản hồi.

Tôi đã đề cập trước đó rằng tiện ích mở rộng ứng dụng của bạn được gọi trong ba sự kiện hệ thống: cài đặt ứng dụng, cập nhật ứng dụng và định kỳ trong nền.

Hãy cùng xem vòng đời này được quản lý như thế nào.

Vòng đời của tiện ích mở rộng của bạn bắt đầu khi App Store cài đặt hoặc cập nhật ứng dụng của bạn trên thiết bị.

Dịch vụ hệ thống Background Assets sau đó được thông báo và ngăn ứng dụng khởi chạy.

Hệ thống sau đó kiểm tra gói ứng dụng của bạn và đọc Info.plist của nó cho khóa BAManifestURL.

Hệ thống sẽ bắt đầu tải xuống bản kê khai được tham chiếu bởi khóa đó và báo cáo tiến độ tải xuống trở lại App Store.

Khi bản kê khai của bạn đã được tải xuống, hệ thống sẽ đánh thức tiện ích mở rộng của bạn bằng cách đưa ra yêu cầu nội dung cho sự kiện cài đặt hoặc cập nhật đã cho.

Yêu cầu nội dung bao gồm một đường dẫn đến bản kê khai đã tải xuống.

Tiện ích mở rộng của bạn nên sử dụng bản kê khai để xác định URL, kích thước tệp và nội dung nào cần lên lịch tải xuống.

Sau đó, khi tiện ích mở rộng của bạn đã xác định được tài sản nào cần được tải xuống, nó sẽ trả về các bản tải xuống đó dưới dạng một bộ BADownloads.

Hệ thống sau đó tạm dừng tiện ích mở rộng ứng dụng của bạn, hoặc đôi khi chấm dứt nó, để tiết kiệm năng lượng và hiệu suất trên thiết bị.

Việc tải xuống sau đó sẽ bắt đầu và tiện ích mở rộng của bạn sẽ được thông báo ngay sau khi hoàn thành.

Yêu cầu nội dung định kỳ gần giống với sự kiện cài đặt ứng dụng, với sự khác biệt chính duy nhất là thiết bị của bạn xác định khi nào sự kiện sẽ xảy ra.

Thiết bị đưa ra quyết định này dựa trên cách người dùng đã sử dụng thiết bị của họ.

Các yếu tố chính như Chế độ năng lượng thấp, Làm mới ứng dụng nền hoặc tần suất khởi chạy ứng dụng của bạn đều được xem xét.

Bây giờ, chúng ta hãy đi sâu hơn một chút và xem xét các yếu tố góp phần vào thời điểm tiện ích mở rộng của bạn chạy định kỳ.

Chúng tôi quan tâm rất nhiều đến hiệu suất tổng thể và mức sử dụng năng lượng của thiết bị, đó là lý do tại sao Tài sản nền có những hạn chế được đặt ra đối với thời gian chạy của tiện ích mở rộng.

Điều này bao gồm việc thực thi việc sử dụng bộ nhớ của tiện ích mở rộng của bạn.

Nếu tiện ích mở rộng của bạn vượt quá vài megabyte bộ nhớ, nó có thể bị hệ thống chấm dứt.

Vì vậy, bạn có thể muốn xem xét ánh xạ bộ nhớ bất kỳ tệp lớn nào mà tiện ích mở rộng của bạn cần đọc, vì dữ liệu ánh xạ bộ nhớ được hỗ trợ bởi bộ nhớ của thiết bị không được tính vào giới hạn này.

Khi một ứng dụng được cài đặt ban đầu, nó được cung cấp với phân bổ mặc định là vài phút thời gian chạy mỗi ngày.

Mặc dù điều này nghe có vẻ không nhiều, nhưng với phần mở rộng được thiết kế phù hợp, nhưng điều này có thể đi một chặng đường dài.

Thời gian chạy cũng thay đổi dựa trên việc sử dụng ứng dụng.

Nếu một ứng dụng không được khởi chạy trong một thời gian, hệ thống có thể bắt đầu điều chỉnh các lần khởi chạy tiện ích mở rộng.

Ví dụ, một ứng dụng hiếm khi được sử dụng có thể thấy thời gian chạy của nó bị hạn chế nhiều hơn, trong khi một ứng dụng thường được sử dụng có thể được cung cấp thêm thời gian chạy.

Giao thức BADownloaderExtension xác định các chức năng được sử dụng làm điểm vào tiện ích mở rộng ứng dụng của bạn.

Thời gian chạy bắt đầu được tính khi một hàm được hệ thống gọi và ngừng được tính khi hàm đó thoát khỏi phạm vi.

Khi chức năng của bạn thoát khỏi phạm vi hoặc thời gian chạy tiện ích mở rộng của bạn đã cạn kiệt, hệ thống có thể tạm dừng hoặc chấm dứt tiện ích mở rộng.

Tôi sẽ đưa ra một ví dụ trong giây lát.

Tuy nhiên, có một ngoại lệ đối với phạm vi chức năng kiểm soát thời gian chạy của tiện ích mở rộng của bạn.

Nếu một API điều khiển độc quyền không đồng bộ được gọi, tiện ích mở rộng của bạn sẽ được tiếp tục chạy cho đến khi trình xử lý hoàn thành của nó được gọi và trả về.

Có một vài cách mà thời gian chạy của tiện ích mở rộng có thể được kiểm soát bởi người dùng.

Ví dụ: nếu thiết bị ở Chế độ năng lượng thấp hoặc đã tắt Làm mới ứng dụng nền, cho dù đó là trên toàn cầu hay cho ứng dụng cụ thể của bạn, thì tiện ích mở rộng của bạn sẽ không bao giờ chạy.

Trước đây, tôi đã đề cập đến cách xác định thời gian chạy mở rộng dựa trên phạm vi hàm.

Hãy xem một ví dụ để hiểu rõ hơn về cách thức hoạt động của nó.

Mã này đại diện cho giao diện của tiện ích mở rộng phục vụ tải xuống nền của bạn.

Giao thức BADownloaderExtension xác định các chức năng mà hệ thống sẽ gọi vào tiện ích mở rộng của bạn.

Bây giờ hãy thêm một trong những chức năng cần thiết để phù hợp với giao thức này.

Chức năng "tải xuống theo yêu cầu" là một trong những điểm truy cập chính vào tiện ích mở rộng.

BAContentRequest của nó xác định xem nó đang được gọi trong quá trình cài đặt ứng dụng, cập nhật ứng dụng hay như một phần của kiểm tra định kỳ trong nền.

Đối số manifestURL cung cấp đường dẫn đến tệp cục bộ đã được tải xuống trước khi tiện ích mở rộng được gọi.

Tệp kê khai thường được sử dụng để so sánh những gì hiện đang được tải xuống với những bản tải xuống có thể có sẵn trên máy chủ.

Loại trả về của định nghĩa hàm yêu cầu một tập hợp các đối tượng tải xuống phù hợp với loại BADownload.

Điều này có nghĩa là việc trả lời yêu cầu của chức năng này yêu cầu bạn trả lại đồng bộ bất kỳ nội dung nào cần tải xuống trước khi chức năng thoát khỏi phạm vi.

Tuy nhiên, trong ví dụ giả tạo này, giả sử rằng bạn gọi một hàm gọi là parseManifest.

Chức năng này đọc bản kê khai đã tải xuống và sau đó trả về các đối tượng BADownload cần được tải xuống.

Tuy nhiên, giả sử rằng chức năng parseManifest được triển khai kém và mất 30 phút để phân tích cú pháp và xây dựng các bản tải xuống.

Điều này cuối cùng sẽ vượt quá đáng kể thời gian chạy của tiện ích mở rộng và tiện ích mở rộng sẽ bị chấm dứt.

Điều quan trọng cần nhớ là thời gian chạy của tiện ích mở rộng được tính toán từ thời điểm chức năng "tải xuống cho yêu cầu" được gọi, cho đến khi nó thoát khỏi phạm vi và trả về.

Hãy xem xét một ví dụ có vấn đề khác.

Bất cứ khi nào bất kỳ giao thức BADownloaderExtension nào hoạt động phạm vi thoát, tiện ích mở rộng có thể bị đình chỉ và sau đó bị chấm dứt.

Bạn sẽ nhận thấy rằng giao thức không xác định bất kỳ chức năng nào của nó là đột biến và có một lý do chính đáng cho việc này.

Khi tiện ích mở rộng của bạn bị chấm dứt, bất kỳ biến thể hiện hoặc trạng thái trong bộ nhớ nào sẽ không được lưu.

Nếu tiện ích mở rộng của bạn cần duy trì bất kỳ trạng thái nào, bạn nên tuần tự hóa trạng thái đó vào đĩa.

Tiếp theo, hãy nói về API bạn sẽ sử dụng từ cả tiện ích mở rộng và ứng dụng để quản lý tải xuống.

Trình quản lý tải xuống trong khuôn khổ là cách chính để giao tiếp với dịch vụ hệ thống Tài sản nền.

Trình quản lý là một đối tượng đơn lẻ có thể được sử dụng trong toàn bộ ứng dụng của bạn.

Sử dụng trình quản lý, bạn có thể lên lịch tải xuống tài sản của mình ở chế độ nền và quảng bá các bản tải xuống đã được lên lịch ở phía trước.

Từ trình quản lý tải xuống, bạn cũng có thể quản lý các bản tải xuống hiện đang trên chuyến bay, mà tôi đã đề cập trước đó có thể đã được lên lịch bởi tiện ích mở rộng trước khi ứng dụng của bạn được khởi chạy.

Ngoài ra còn có một cơ chế đồng bộ hóa mà bạn có thể sử dụng để đảm bảo rằng cả ứng dụng của bạn và tiện ích mở rộng liên quan của nó không thực hiện các hoạt động tương tự cùng một lúc.

Điều cuối cùng tôi muốn đưa ra về trình quản lý tải xuống là nó có một đại diện để nhận các cuộc gọi lại về tải xuống, tương tự như giao thức BADownloaderExtension.

Nếu bạn đăng ký một đại diện trên BADownloadManager, thì nó sẽ nhận được những cuộc gọi lại đó thay vì tiện ích mở rộng của bạn.

Điều này rất hữu ích vì nó cung cấp cho ứng dụng của bạn một cách để quản lý các bản tải xuống của nó trong khi nó đang chạy.

Bây giờ bạn đã được bồi dưỡng nhanh về cách quản lý tải xuống, hãy nói về cách bạn nên quản lý các tệp đó khi chúng đã có trên thiết bị của người dùng.

Bất kỳ tệp nào bạn tải xuống với Tài sản nền đều được đánh dấu có thể thanh lọc được, điều đó có nghĩa là hệ thống có thể xóa chúng trong những trường hợp quan trọng.

Hãy suy nghĩ về bản cập nhật bảo mật hệ thống hoặc nếu người dùng cần quay video về bước đầu tiên của con họ.

Tuy nhiên, nếu bạn sửa đổi hoặc mở rộng nội dung đã tải xuống, thì những tệp đó không bị hệ thống theo dõi và do đó không thể thanh lọc được.

Bạn nên suy nghĩ cẩn thận về cách bạn sửa đổi tài sản hoặc trích xuất dữ liệu từ chúng.

Nếu bạn quản lý không chính xác tài sản đã tải xuống của mình, bạn có thể tăng kích thước bản sao lưu thiết bị của người dùng hoặc ngăn bản cập nhật bảo mật quan trọng được tải xuống.

Do đó, bạn nên cố gắng lưu trữ tài sản đã tải xuống của mình trong thư mục bộ nhớ cache của mình.

Bằng cách đó, hệ thống biết rằng nó có thể thanh lọc chúng khi điều quan trọng là phải làm như vậy.

Bây giờ bạn đã có bản tóm tắt đầy đủ về cách thức hoạt động của tất cả những điều này, chúng ta hãy xem có gì mới trong năm nay với Tài sản nền.

Đầu năm nay, chúng tôi đã giới thiệu các bản tải xuống cần thiết, cung cấp cách tìm nạp nội dung trong khi ứng dụng của bạn đang cài đặt hoặc cập nhật.

Điều này có nghĩa là các bản tải xuống của bạn được tích hợp hoàn toàn vào Màn hình chính iOS, macOS Launchpad và App Store.

Đối với người dùng cuối, việc tải xuống tài sản của bạn xuất hiện với họ như thể ứng dụng hiện vẫn đang được tải xuống từ App Store.

Điều này cũng có nghĩa là trong khi các bản tải xuống cần thiết của bạn đang trên chuyến bay, người dùng không thể khởi chạy ứng dụng của bạn.

Tất cả những gì người dùng có thể làm là hủy hoặc tạm dừng cài đặt.

Vì tạm dừng được hỗ trợ, máy chủ của bạn nên hỗ trợ phạm vi HTTP để có thể tiếp tục.

Vì các bản tải xuống thiết yếu xảy ra trong quá trình cài đặt ứng dụng, chúng được ưu tiên hơn bất kỳ bản tải xuống không cần thiết nào.

Hãy cùng xem nào.

Tất cả bắt đầu khi ứng dụng của bạn được yêu cầu từ App Store hoặc TestFlight.

Nếu Info.plist của ứng dụng chứa các khóa tài sản thiết yếu, thì tiến trình được thiết lập trên thiết bị và chúng tôi trải qua quy trình này.

Khi ứng dụng của bạn đã được tải xuống và cài đặt, hệ thống sẽ đánh thức tiện ích mở rộng của bạn bằng cách đưa ra yêu cầu nội dung, bao gồm yêu cầu đó là cài đặt ứng dụng, cập nhật ứng dụng hay tìm nạp định kỳ.

Trong thời gian này, một thử thách xác thực có thể được gửi để tải xuống bản kê khai.

Tiện ích mở rộng của bạn sau đó sẽ hỗ trợ kết hợp các bản tải xuống cần thiết và không cần thiết.

Như một lưu ý phụ, điều quan trọng là tiện ích mở rộng của bạn phải nhanh chóng khôi phục tải xuống, vì tiến trình tải xuống ứng dụng của bạn sẽ xuất hiện bị đóng băng đối với người dùng cho đến khi chức năng này quay trở lại.

Thời điểm tiện ích mở rộng cung cấp các bản tải xuống, bất kỳ bản tải xuống nào được đánh dấu là cần thiết sẽ ngay lập tức bắt đầu.

Tiện ích mở rộng của bạn cũng có thể nhận được một thử thách xác thực bổ sung trong thời gian này.

Khi tất cả các bản tải xuống cần thiết của bạn kết thúc, hệ thống sẽ chấm dứt tiện ích mở rộng của bạn và người dùng sẽ có thể khởi chạy ứng dụng được.

Tiện ích mở rộng sau đó sẽ nhận được một loạt các bản tải xuống thành công và có khả năng không thành công.

Nếu có bất kỳ lượt tải xuống không thành công nào, bạn có thể xếp hàng lại chúng là không cần thiết bằng cách sử dụng BADownloadManager.

Vì tiện ích mở rộng của bạn đang nhận được thông báo hoàn thành cho các bản tải xuống cần thiết, hệ thống sẽ ngay lập tức bắt đầu tải xuống các tài sản không cần thiết.

Các bản tải xuống không cần thiết sau đó sẽ được gửi đến tiện ích mở rộng khi chúng hoàn tất tải xuống.

Bây giờ chúng ta hãy xem cách các bản tải xuống cần thiết tích hợp vào tiến trình cài đặt App Store trên Màn hình chính iOS.

Một tỷ lệ phần trăm của chỉ báo tiến độ được chia thành thời gian cần thiết để tải xuống ứng dụng cơ bản của bạn, cộng với lượng thời gian để thực hiện cài đặt, tiếp theo là lượng thời gian cần thiết để tải xuống các tài sản thiết yếu của bạn.

Khóa BAEssentialDownloadAllowance mới được xác định trong Info.plist của ứng dụng của bạn được sử dụng để thiết lập chỉ báo tiến độ tổng thể ban đầu.

Sau đó, khi contentForRequest được gọi vào tiện ích mở rộng của bạn và tiện ích mở rộng của bạn trả về các bản tải xuống, kích thước tệp của mỗi bản tải xuống cần thiết sẽ được cộng lại với nhau để xác định số lượng thực sự đang được tải xuống.

Nếu số tiền bạn lên lịch tải xuống ít hơn đáng kể so với phụ cấp tải xuống thiết yếu, thì chỉ báo tiến độ có thể di chuyển khá nhanh.

Bạn nên đặt mục tiêu đưa trợ cấp tải xuống thiết yếu của mình gần với những gì đang thực sự được tải xuống để đảm bảo tiến trình suôn sẻ cho người dùng.

Điều quan trọng cần lưu ý là mọi thứ chúng ta đã thảo luận đều có thể bị người dùng vô hiệu hóa.

Trong ngăn cài đặt App Store, có một phần để vô hiệu hóa nội dung trong ứng dụng.

Mặc dù điều này không vô hiệu hóa toàn bộ Tài sản nền, nhưng nó ngăn các tài sản thiết yếu tải xuống và khả năng tiện ích mở rộng chạy trước khi người dùng khởi chạy ứng dụng.

Vì vậy, điều quan trọng là phải nghĩ về các tài sản thiết yếu chỉ như vậy: cần thiết nhưng không phải là yêu cầu để ứng dụng của bạn khởi chạy.

Do đó, điều quan trọng đối với ứng dụng của bạn là xử lý các luồng mà các tài sản thiết yếu chưa có trên thiết bị khi ứng dụng của bạn được khởi chạy.

Khả năng sử dụng các tài sản thiết yếu đã thực sự được giới thiệu vào đầu mùa xuân như một phần của iOS 16.4 và macOS Ventura 13.3.

Các API mới khá tối thiểu và nên dễ dàng được thêm vào tiện ích mở rộng hiện có của bạn.

API đầu tiên được tạo ra để hỗ trợ tải xuống thiết yếu thực sự là một trình khởi tạo mới trên BAURLDownload.

Có hai lập luận mới mà chúng tôi đã thêm cụ thể để hỗ trợ tính năng này.

Đối số thiết yếu, như tên gọi của nó, xác định xem việc tải xuống có nên được đánh dấu là cần thiết hay không, trong đó thiết yếu có nghĩa là đóng góp vào tiến trình tải xuống và cài đặt tổng thể của ứng dụng.

Đối số kích thước tệp là kích thước của tài sản sẽ được tải xuống.

Kích thước tệp phải chính xác khi tạo các bản tải xuống cần thiết.

Hệ thống cần thông tin này để tiến trình cài đặt ứng dụng trên thiết bị của người dùng được hiển thị đúng cách.

Nếu tệp mà Tài sản nền tải xuống không khớp với kích thước tệp được cung cấp ở đây, thì việc tải xuống sẽ không thành công nếu tải xuống được đánh dấu là cần thiết.

Nếu phần mở rộng của bạn không biết kích thước của tệp, thì kích thước tệp nên được bao gồm trong BAManifestURL được cung cấp cho phần mở rộng trước khi phần mở rộng được khởi chạy.

Một API khác đã được giới thiệu cung cấp một lớp lót dễ dàng để tạo một đại diện không cần thiết của bản tải xuống.

Vì các bản tải xuống thiết yếu chỉ có thể được xếp hàng trong hàm contentForRequest, API này có thể hữu ích trong nhiều trường hợp.

Ví dụ, giả sử việc tìm nạp bản tải xuống thiết yếu không thành công, có lẽ do sự cố mạng hoặc tệp chỉ đơn giản là tạm thời không khả dụng.

Chà, trong chức năng tải xuống nền không thành công trong tiện ích mở rộng của bạn, bạn có thể dễ dàng tạo một đại diện không cần thiết của bản tải xuống đó và xếp hàng lại nó.

Quá trình tải xuống sau đó sẽ bắt đầu ở chế độ nền và tiện ích mở rộng hoặc ứng dụng của bạn sẽ được thông báo khi hoàn tất.

Bây giờ chúng ta hãy xem xét một số khóa cần thiết cần có trong Info.plist của ứng dụng của bạn.

Trong phiên họp năm ngoái, tôi đã xem xét chi tiết từng chìa khóa này.

Nếu bạn muốn một lời giải thích chuyên sâu hơn, tôi khuyến khích bạn xem bài nói chuyện đó.

Điều quan trọng cần lưu ý là các khóa này được yêu cầu không chỉ để sử dụng khung Tài sản nền mà còn cần thiết để gửi ứng dụng của bạn đến App Store.

Có hai khóa mới trong năm nay được yêu cầu để hỗ trợ các tài sản thiết yếu: BAEssentialDownloadAllowance và BAEssentialMaxInstallSize.

Trợ cấp tải xuống thiết yếu được thể hiện bằng byte và xác định giới hạn trên về mức độ lớn của tổng tất cả các tài sản thiết yếu của bạn để tải xuống.

Điều quan trọng là cố gắng đưa con số này càng gần càng tốt với kích thước của các tài sản thiết yếu mà bạn xếp hàng để quá trình tải xuống diễn ra suôn sẻ cho người dùng khi họ cài đặt ứng dụng của bạn.

Khóa mới khác, BAEssentialMaxInstallSize, đại diện cho kích thước tối đa của những tài sản đó được trích xuất trên thiết bị của người dùng.

Con số này xuất hiện trên App Store như một cách để cho người dùng biết ứng dụng của bạn sẽ sử dụng bao nhiêu dung lượng lưu trữ sau khi các tài sản thiết yếu đã được cài đặt.

Điều đó tóm tắt khá nhiều các API mới mà chúng tôi đã thêm vào cho các tài sản thiết yếu.

Như bạn vừa thấy, việc thêm hỗ trợ tài sản thiết yếu vào ứng dụng hiện tại của bạn có thể được thực hiện với những thay đổi mã tối thiểu.

Nó thực sự dễ dàng như vậy.

Bây giờ cho phần thú vị.

Hãy xem cách bạn có thể mở rộng một ứng dụng hiện có sử dụng URLSession để sử dụng Tài sản nền.

Ứng dụng tôi sẽ giới thiệu cho bạn hôm nay tải xuống WWDC Sessions, giống như ứng dụng này và lưu trữ chúng trên thiết bị của bạn để xem ngoại tuyến.

Hiện tại, ứng dụng phải được khởi chạy trước khi các video được tải xuống.

Bằng cách áp dụng Tài sản nền, chúng tôi có thể loại bỏ thời gian chờ đợi này bằng cách tải xuống các video trước khi ứng dụng được khởi chạy.

Hãy cùng xem nào.

Đây là ứng dụng mà chúng tôi sẽ xây dựng ngày hôm nay.

Bạn sẽ nhận thấy rằng thời điểm nó được khởi chạy, các phiên ngay lập tức bắt đầu tải xuống.

Cách ứng dụng này hiện đang hoạt động là bản tải xuống bản kê khai từ máy chủ, chứa danh sách các phiên WWDC.

Sau khi bản kê khai được tìm nạp, các phiên bắt đầu tải xuống và sau đó có thể xem được sau khi nhấn.

Chúng ta hãy xem xét những gì cần thiết để áp dụng Tài sản nền vào dự án này.

Trước khi bạn bắt đầu sử dụng API Tài sản Nền, điều đầu tiên cần thêm là các khóa Info.plist ban đầu mà tôi đã thảo luận trước đó.

Những khóa này được yêu cầu phải có trong tệp Info.plist của gói ứng dụng của bạn.

Điều tiếp theo bạn cần làm là thêm tiện ích mở rộng tải xuống nền và nhúng nó vào ứng dụng của bạn.

Bạn sẽ muốn đảm bảo rằng mã định danh gói của tiện ích mở rộng của bạn có tiền tố là mã định danh gói của ứng dụng của bạn.

Bạn cũng sẽ muốn đảm bảo rằng cả ứng dụng của bạn và tiện ích mở rộng của nó đều nằm trong một nhóm ứng dụng chung, vì nhóm ứng dụng là cách tiện ích mở rộng của bạn chia sẻ nội dung đã tải xuống với ứng dụng của bạn.

Điều cuối cùng bạn muốn đảm bảo là cả ứng dụng của bạn và tiện ích mở rộng của nó đều được ký bằng mã định danh nhóm của bạn.

Với những bước đó, bạn có thể bắt đầu áp dụng Tài sản nền.

Trước mặt bạn là dự án Xcode cho ứng dụng bạn vừa thấy.

Tôi đã đi và tạo tiện ích mở rộng tải xuống và nhúng nó vào ứng dụng.

Tôi cũng đã thêm các khóa Info.plist bắt buộc.

Với tất cả những điều đó, hãy bắt đầu bằng cách điều hướng đến SessionManager.

SessionManager trong dự án này hiện đang sử dụng URLSession để tìm nạp các bản tải xuống mới nhất.

URLSession là một API tuyệt vời.

Chúng tôi sẽ tiếp tục sử dụng nó trong ứng dụng để tìm nạp bản kê khai.

Tuy nhiên, chúng tôi sẽ chuyển sang sử dụng Tài sản nền để tìm nạp các phiên thực tế.

Điều này là để ứng dụng có thể tận dụng lợi thế của việc quảng bá bất kỳ tài sản nào được lên lịch trong nền bằng tiện ích mở rộng mà chúng tôi sắp tạo ở phía trước khi ứng dụng được khởi chạy.

Để bắt đầu, chúng ta sẽ bắt đầu bằng cách nhập mô-đun khung Tài sản Nền.

Sau đó tôi sẽ cuộn xuống và xóa các biến được liên kết với URLSession vì chúng không còn cần thiết nữa.

Bây giờ tôi sẽ điều hướng đến phương pháp "bắt đầu tải xuống".

Như bạn có thể thấy, mã hiện có là các phiên theo dõi để tải xuống bằng tác vụ tải xuống URLSession.

Điều này sẽ không cần thiết nữa, vì vậy hãy loại bỏ nó.

Đây là nơi mọi thứ bắt đầu trở nên thú vị.

Khi bạn làm việc với Background Assets, điều quan trọng là phải suy nghĩ về tiện ích mở rộng và ứng dụng của bạn có thể chạy cùng một lúc.

Để phối hợp điều này một cách gần như dễ dàng, bạn sẽ cần sử dụng withExclusiveControl để đảm bảo rằng bất kỳ công việc nào cần loại trừ lẫn nhau với quy trình khác đều có thể làm như vậy.

Hãy thêm điều đó vào ngay bây giờ.

Như bạn có thể nói, API này không đồng bộ và thoát ra ngoài.

Bất kỳ công việc nào được lên lịch bên trong việc đóng cửa đều được đảm bảo chạy độc lập với tiện ích mở rộng nếu tiện ích mở rộng cũng sử dụng API này.

Chúng tôi sẽ triển khai tiện ích mở rộng trong giây lát, nhưng bây giờ, hãy tập trung vào ứng dụng.

Vì chúng tôi biết rằng chúng tôi đang chạy trong một bối cảnh loại trừ lẫn nhau, hãy hỏi người quản lý tải xuống nếu hiện tại có bất kỳ bản tải xuống nào trên chuyến bay.

Không có lý do gì để lên lịch lại tải xuống nếu tiện ích mở rộng đã lên lịch.

Tuy nhiên, một điều chúng tôi có thể làm là, nếu chúng tôi tìm thấy một bản tải xuống hiện có, chúng tôi có thể quảng bá nó lên phía trước.

Thúc đẩy quá trình tải xuống ở phía trước có thể làm giảm đáng kể thời gian cần thiết để quá trình tải xuống kết thúc.

Vì người dùng hiện đang sử dụng ứng dụng, đây là một cơ hội tuyệt vời để tải xuống càng nhanh càng tốt.

Người dùng có thể muốn xem nó.

Nếu bản tải xuống chưa tồn tại, chúng tôi sẽ tạo nó.

Sau đó, bất kể chúng tôi vừa tạo bản tải xuống hay tiện ích mở rộng đã làm, chúng tôi sẽ tiếp tục và bắt đầu nó ở phía trước.

Thúc đẩy tải xuống từ nền trước không khiến quá trình tải xuống khởi động lại, nó chỉ đơn giản là được tiếp tục từ nơi nó đã dừng lại trong quá trình chuyển đổi đó.

Điều tiếp theo trong danh sách là triển khai BADownloadManagerDelegate, nhưng trước khi tôi làm điều đó, tôi sẽ xóa URLSessionDelegate cũ.

Bây giờ đại diện cũ đã biến mất, hãy tạo đại diện Tài sản Nền.

Vì người quản lý phiên hiện đang tuân thủ đại biểu, điều quan trọng là nó phải được kết nối để thực sự nhận được những tin nhắn đó.

Vì vậy, tôi sẽ đi đến trình khởi tạo và kết nối nó ngay bây giờ.

Vì BADownloadManager kết nối trực tiếp với bộ lập lịch hệ thống, nó là một đối tượng đơn lẻ.

Việc đính kèm đại diện này vào trình quản lý tải xuống sẽ khiến ứng dụng của bạn nhận tin nhắn qua tiện ích mở rộng nếu ứng dụng của bạn hiện đang chạy.

Bây giờ chúng ta hãy quay trở lại các chức năng mà chúng ta cần thực hiện.

Đối với ứng dụng này, có ba chức năng cụ thể trên giao thức đại diện mà chúng tôi sẽ triển khai.

Đầu tiên là để xử lý tiến độ. Hãy thực hiện điều đó ngay bây giờ.

Trước khi chúng tôi bắt đầu cập nhật tiến trình một cách mù quáng trong giao diện người dùng, chúng tôi sẽ đảm bảo rằng bản tải xuống mà chúng tôi đang nhận được thông báo tiến trình là thứ mà bản kê khai hiện đang theo dõi.

Nếu quá trình tải xuống đang được theo dõi, chúng tôi sẽ gọi updateDownloadProgress, đây là chức năng trợ giúp trong ứng dụng gửi tiến trình trực tiếp đến SwiftUI.

Tiếp theo, tôi sẽ thực hiện những gì xảy ra khi quá trình tải xuống kết thúc.

Nó bắt đầu khá giống nhau, đó là để đảm bảo rằng nó chỉ xử lý các bản tải xuống được mong đợi.

Sau đó replaceItemAt được sử dụng để di chuyển đối tượng từ vị trí tạm thời mà Background Assets đã cung cấp cho chúng ta đến vị trí cuối cùng của nó.

Điều quan trọng là sử dụng các thao tác di chuyển ở đây, vì hệ thống sẽ theo dõi và xóa tệp nếu thiết bị trở nên thiếu dung lượng.

Vì vậy, bạn nên đảm bảo rằng ứng dụng của bạn luôn kiểm tra xem có bất kỳ tệp nào bị thiếu hay không và tải lại nếu cần.

Điều cuối cùng xảy ra ở đây là, một Nhiệm vụ được sinh ra đối với MainActor, trạng thái được đánh dấu là đã tải xuống và ứng dụng bắt đầu tìm nạp hình thu nhỏ của phiên.

Bây giờ, tôi muốn nói rằng tất cả các bản tải xuống sẽ thành công.

Tuy nhiên, sự thật đáng tiếc là họ có thể thất bại, cho dù đó là do máy chủ không còn tài nguyên đó nữa hay có vấn đề về mạng.

Background Assets thử lại và chờ đợi các sự cố kết nối mạng, nhưng sau một thời điểm nhất định, bạn phải biết rằng tệp không đang trên đường đến.

Một điều khác cần lưu ý là các bản tải xuống được quảng bá lên phía trước sẽ thất bại gần như ngay lập tức nếu có sự cố kết nối mạng.

Ứng dụng của chúng tôi không cần phải làm gì nhiều khi tải xuống không thành công.

Nó có thể trình bày giao diện người dùng hoặc lên lịch lại, nhưng đối với ví dụ này, hãy ghi lại rằng đã xảy ra sự cố.

Vì đại diện hiện đã được triển khai đầy đủ, hãy khởi chạy lại ứng dụng và xem nó trông như thế nào.

Chà, không có gì ngạc nhiên, nó trông giống hệt nhau, và đó là những gì chúng tôi thực sự muốn thấy ở đây.

Thêm Tài sản Nền thay cho URLSession khá dễ dàng.

Điều tiếp theo tôi sẽ chỉ cho bạn là cách triển khai tiện ích mở rộng ứng dụng để xử lý tải xuống nền.

Thêm tiện ích mở rộng ứng dụng này là cách bạn có thể tận dụng Tài sản nền để tìm nạp nội dung của mình trước khi ứng dụng của bạn được cài đặt hoặc cập nhật và là thứ cung cấp hỗ trợ xếp hàng các tài sản thiết yếu.

Về bản chất, tiện ích mở rộng là thứ chịu trách nhiệm lên lịch tải xuống trong khi ứng dụng của bạn không chạy.

Hãy cùng xem nào.

Ở đây chúng tôi đang ở trình xử lý tải xuống nền, nhận tin nhắn trong tiện ích mở rộng của bạn liên quan đến Tài sản nền.

Từ tiện ích mở rộng, điều đầu tiên tôi sẽ làm là tạo một trình ghi để chúng ta có thể thấy từ Console.app khi tiện ích mở rộng của chúng ta đang chạy.

Tiếp theo, tôi sẽ triển khai hàm contentForRequest là một phần của giao thức BADownloaderExtension.

Điều đầu tiên tiện ích mở rộng này sẽ làm là phân tích bản kê khai đã được tải xuống trước khi tiện ích mở rộng được khởi chạy.

Nếu bản kê khai đã được tải xuống bằng cách nào đó không hợp lệ, tiện ích mở rộng sẽ được định cấu hình để xếp hàng không tải xuống.

Khi tiện ích mở rộng biết rằng bản kê khai là hợp lệ, nó sẽ được lưu nguyên tử vào nhóm ứng dụng.

Điều này là để ứng dụng và tiện ích mở rộng có phiên bản mới nhất của bản kê khai cục bộ mà họ có thể tham khảo sau.

Vì việc lưu này được thực hiện bằng nguyên tử, nên việc sử dụng withExclusiveControl là không cần thiết.

Tiện ích mở rộng sau đó sẽ tạo ra một tập hợp các đối tượng tải xuống có thể thay đổi mà tiện ích mở rộng sẽ quay trở lại hệ thống để được lên lịch.

Như đã thảo luận trước đó, các bản tải xuống cần thiết chỉ được hỗ trợ trong quá trình cài đặt ứng dụng hoặc cập nhật ứng dụng.

Sau đó, tôi sẽ lặp lại bản kê khai cho tất cả các phiên từ xa, điều này có nghĩa là chúng không được tải xuống.

Một đối tượng BAURLDownload sau đó được tạo cho mọi lần tải xuống cần được lên lịch.

Việc tải xuống được cung cấp một mã định danh duy nhất, một URLRequest, một chú thích nếu tải xuống nên được tìm nạp là thiết yếu, kích thước tệp của nó, nhóm ứng dụng mà tài sản sẽ được tải xuống và ưu tiên tương đối để kiểm soát việc tải xuống nào mà bộ lập lịch sẽ bắt đầu trước.

Một điều quan trọng cần lưu ý là bất kỳ bản tải xuống nào được đánh dấu là cần thiết phải có kích thước tệp chính xác nếu không bản tải xuống sẽ được đánh dấu là không thành công.

Điều này nhằm hỗ trợ tiến trình suôn sẻ trên Màn hình chính iOS, macOS Launchpad và App Store.

Bây giờ chúng tôi đã hỗ trợ xếp hàng tải xuống, chúng ta hãy xem xét xử lý tải xuống thành công.

Tiện ích mở rộng xử lý tải xuống nếu ứng dụng không chạy hoặc nếu ứng dụng không có đại diện được chỉ định cho BADownloadManager.

Điều đầu tiên tôi sẽ thực hiện trong trình xử lý hoàn tất tải xuống sẽ là có được quyền kiểm soát độc quyền một cách không đồng bộ.

Vì việc có được quyền kiểm soát độc quyền là không đồng bộ, chúng tôi cần bám vào tệp tạm thời mà phần mở rộng vừa bán cho chúng tôi.

Như bạn có thể thấy, tôi đang thực hiện điều này bằng cách di chuyển tệp vào một vị trí tạm thời sẽ tồn tại lâu hơn phạm vi của chức năng này.

Tôi cũng sẽ thêm một sự trì hoãn Swift để đảm bảo rằng tệp tạm thời mà các bản tải xuống tiện ích mở rộng luôn được dọn dẹp.

Mặc dù hệ thống sẽ xóa tệp cho bạn, nhưng cách tốt nhất là bạn nên tự quản lý nó.

Sau đó tôi sẽ tải bản kê khai từ nhóm ứng dụng và xác minh tính hợp lệ của nó.

Tiện ích mở rộng sau đó sẽ kiểm tra để đảm bảo số nhận dạng đã tải xuống đang được xử lý khớp với phiên được mong đợi trong bản kê khai.

Sau đó, tiện ích mở rộng sẽ di chuyển tệp đó từ vị trí tạm thời của nó đến đích cuối cùng bên trong nhóm ứng dụng.

Một LocalSession sau đó được xây dựng để nhanh chóng xác nhận rằng phiên được tải xuống vị trí thích hợp của nó.

Điều cuối cùng cần xử lý là tải xuống không thành công.

Một điều quan trọng thường bị lãng quên là nếu BAManifestURL không tải xuống được, tiện ích mở rộng sẽ thực sự được thông báo về nó.

Loại của nó kế thừa từ BAURLDownload.

Tuy nhiên, đó không phải là loại nội bộ chính xác của nó.

Do đó, tiện ích mở rộng lọc để đảm bảo nó chỉ xử lý các đối tượng BAURLDownload.

Vì các tài sản thiết yếu tải xuống ở phía trước, chúng chỉ đợi vài giây để kết nối mạng vì những bản tải xuống đó ảnh hưởng đến tiến trình cài đặt ứng dụng.

Do đó, có thể là một ý tưởng tốt để xếp hàng lại các bản tải xuống cần thiết là không cần thiết nếu chúng xảy ra thất bại.

Một cách bạn có thể dễ dàng chuyển đổi một bản tải xuống thiết yếu thành không cần thiết là sử dụng hàm removingEssential() mới.

Hàm đó trả về một bản sao không cần thiết.

Sau đó, bạn chuyển bản sao đó sang chức năng Tải xuống lịch trình của BADownloadManager.

Hệ thống sau đó sẽ tải xuống vào thời điểm thích hợp.

Bây giờ ứng dụng của chúng tôi và tiện ích mở rộng của nó đã áp dụng đầy đủ Tài sản nền, hãy thêm một số giao diện người dùng chỉ ra rằng một phiên cụ thể đã được tải xuống là cần thiết.

Hãy nhớ rằng, điều cần thiết có nghĩa là cài đặt ứng dụng và cập nhật ứng dụng cấm khởi chạy ứng dụng cho đến khi tài sản được tải xuống đầy đủ.

Tuy nhiên, vì ứng dụng bị chặn khởi chạy chỉ xảy ra trong quá trình cài đặt từ App Store hoặc TestFlight, nên có một chỉ báo hiện diện là một cách tốt để nhận ra điều này một cách rõ ràng.

Chỉ báo này sẽ được triển khai trong SwiftUI trong chế độ xem VideoSelector.

Nếu phiên được đánh dấu là cần thiết trong bản kê khai, một vòng tròn màu xanh lá cây sẽ được vẽ trong chế độ xem điều hướng.

Và đó là tất cả những gì cần làm.

Bây giờ bạn đã thấy việc triển khai Tài sản nền dễ dàng như thế nào, chúng ta hãy xem gỡ lỗi tiện ích mở rộng và mô phỏng các điểm vào của nó.

Như tôi đã thảo luận trước đó, tiện ích mở rộng khởi chạy trong quá trình cài đặt ứng dụng, cập nhật ứng dụng hoặc định kỳ trong nền.

Vì cài đặt ứng dụng được kiểm soát bởi App Store và các sự kiện định kỳ được kiểm soát bởi thiết bị, bạn sẽ cần một cách để buộc tiện ích mở rộng của mình khởi chạy để gỡ lỗi nó.

May mắn thay, nhóm của chúng tôi đã tạo ra một công cụ đi kèm với Xcode, có thể được sử dụng để khởi chạy tiện ích mở rộng và mô phỏng các điểm vào của nó.

Công cụ có thể truy cập từ Terminal và có thể được khởi chạy bằng cách nhập xcrun backgroundassets-debug.

Ngoài ra còn có thông tin trợ giúp và một trang hướng đi kèm với nó.

Khi sử dụng backgroundassets-debug, bạn vượt qua một đối số mô phỏng cung cấp khả năng kích hoạt các loại BAContentRequests khác nhau.

Khi bất kỳ tin nhắn mô phỏng nào trong số này được gửi đến thiết bị, thời gian chạy tiện ích mở rộng của bạn sẽ được đặt lại để giúp bạn dễ dàng gỡ lỗi.

Backgroundassets-debug cung cấp nhiều tính năng, bao gồm hỗ trợ cho nhiều thiết bị.

Miễn là thiết bị được ghép nối với máy Mac của bạn, nó có thể được sử dụng để mô phỏng tiện ích mở rộng của bạn.

Các lệnh này có thể được gửi qua Bluetooth hoặc Wi-Fi để thiết bị của bạn không phải kết nối với máy Mac của bạn qua USB.

Cuối cùng, Chế độ Nhà phát triển phải được bật để thiết bị tôn trọng các sự kiện mô phỏng được kích hoạt bởi backgroundassets-debug.

Điều này có thể dễ dàng được kích hoạt từ phần Quyền riêng tư & Bảo mật trong ứng dụng Cài đặt trên thiết bị của bạn.

Bây giờ chúng ta hãy xem xét việc sử dụng công cụ gỡ lỗi tài sản nền với ứng dụng demo mà chúng tôi vừa xây dựng.

Chúng tôi đang ở đây tại Terminal.

Vì Xcode được cài đặt trên máy Mac này, tôi sẽ tiếp tục và liệt kê các thiết bị được kết nối.

Bạn sẽ thấy rằng hiện tại chỉ có một thiết bị được kết nối và đó là iPhone của tôi.

Bạn sẽ muốn sao chép UUID của thiết bị mà bạn đang chọn để mô phỏng.

Trong các đối số được cung cấp, bạn thấy rằng UUID của thiết bị có mặt cùng với mã định danh gói của ứng dụng.

Tôi sẽ gọi công cụ bằng cách sử dụng đối số mô phỏng trộn lẫn với đối số cài đặt ứng dụng.

Điều này sẽ khiến tiện ích mở rộng ứng dụng đánh thức như thể nó đang bị đánh thức trong một sự kiện cài đặt ứng dụng ban đầu.

Bây giờ tôi đã nhấn enter, công cụ cho bạn biết rằng sự kiện cài đặt ứng dụng đã được gửi đến thiết bị.

Hãy khởi chạy ứng dụng và xem nó trông như thế nào.

Như bạn có thể thấy, tất cả các video phiên đã được xếp hàng để tải xuống.

Một số người trong số họ, như tôi đang nói, đã tải xuống xong.

Và đó là Tài sản Nền đang hoạt động.

Nếu bạn giống tôi, có lẽ bạn đã bắt đầu suy nghĩ về nhiều cách tiềm năng để giảm sự chờ đợi trong các ứng dụng của mình.

Bây giờ tôi đã chỉ cho bạn cách gỡ lỗi tiện ích mở rộng ứng dụng của bạn, chúng ta hãy xem xét một số điều quan trọng cần nhớ.

Tải xuống các tài sản thiết yếu với ứng dụng và đóng góp vào tiến trình cài đặt ứng dụng.

Do đó, các loại tài sản này chỉ có thể được lên lịch trong sự kiện cài đặt hoặc cập nhật BAContentRequest trong tiện ích mở rộng.

Nếu bất kỳ bản tải xuống thiết yếu nào được xếp hàng bởi tiện ích mở rộng không thành công, ứng dụng cuối cùng vẫn có thể khởi chạy được.

Bạn phải đảm bảo rằng bạn xếp hàng lại các bản tải xuống cần thiết của mình là không cần thiết trong tiện ích mở rộng hoặc khi khởi chạy ứng dụng đầu tiên nếu bạn yêu cầu những nội dung đó.

Bất kỳ bản tải xuống nào không được đánh dấu là cần thiết đều được tải xuống sau khi ứng dụng được cài đặt hoặc cập nhật và nhận được ưu tiên tải xuống nền.

Điều quan trọng cần nhớ là tiện ích mở rộng bị giới hạn bởi việc sử dụng bộ nhớ của nó.

Vì vậy, hãy đảm bảo gỡ lỗi tiện ích mở rộng của bạn để đảm bảo rằng mã bạn viết thấp hơn ngưỡng bộ nhớ.

Nếu tiện ích mở rộng của bạn sử dụng quá nhiều bộ nhớ, bạn sẽ nhận thấy rằng nó sẽ gặp sự cố với ngoại lệ bộ nhớ trong khi gỡ lỗi.

Nếu tiện ích mở rộng gặp sự cố trong quá trình cài đặt ứng dụng hoặc yêu cầu cập nhật nội dung ứng dụng, thì ứng dụng sẽ có thể khởi chạy ngay lập tức.

Và cuối cùng, hãy nhớ làm cho ứng dụng của bạn trở thành một công dân tốt bằng cách quản lý các tài sản mà nó tải xuống một cách thích hợp.

Một cách để quản lý những tài sản đó là đặt chúng vào thư mục bộ nhớ cache của ứng dụng của bạn.

Vì vậy, đó là những gì chúng tôi có trong năm nay cho Tài sản Nền.

Nếu có bất cứ điều gì bạn nên lấy đi từ phiên này, đó là để loại bỏ sự chờ đợi trong ứng dụng của bạn.

Một cách bạn có thể loại bỏ sự chờ đợi là áp dụng Tài sản nền và sử dụng tính năng tài sản thiết yếu mới.

Đảm bảo sử dụng TestFlight trước khi gửi ứng dụng đến App Store.

Bằng cách sử dụng TestFlight, bạn sẽ có thể thấy nó trông như thế nào khi các tài sản thiết yếu của bạn tải xuống bằng ứng dụng của bạn.

Nếu tại bất kỳ thời điểm nào bạn thấy mình có câu hỏi, vui lòng xem tài liệu dành cho nhà phát triển và vui lòng liên hệ với Diễn đàn Nhà phát triển Apple.

Tôi cũng muốn khuyến khích bạn sử dụng Trợ lý Phản hồi.

Nhóm của chúng tôi không ngừng cải thiện Tài sản nền và chúng tôi mong muốn bạn áp dụng nó vào ứng dụng của mình.

Ồ, và nếu bạn chưa có, tôi khuyên bạn nên kiểm tra phiên trước của tôi nơi Tài sản nền được giới thiệu.

Có rất nhiều thông tin bổ sung trong đó.

Và với điều đó, cảm ơn vì đã tham gia cùng tôi hôm nay.

Thay mặt cho tất cả mọi người ở Apple, cảm ơn vì đã xem.