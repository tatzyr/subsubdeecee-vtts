10123

♪ ♪

Aiswariya:こんにちは、ようこそ。私の名前はAiswariyaで、あなたのゲームをMacに持ち込むことについてあなたと話すことにとても興奮しています。

このセッションは、ハイエンドゲームをMacに持ち込む方法についての3部構成のシリーズの最初のものです。

2回目と3回目のセッションでは、私の同僚はシェーダーをコンパイルするためのツールとテクニック、およびMetalでネイティブにレンダリングする際のベストプラクティスに焦点を当てます。

Apple Silicon Macの高度なグラフィックス、素晴らしいパフォーマンス、没入型オーディオ、素晴らしいディスプレイ、機能豊富なソフトウェアで、素晴らしいゲーム体験を提供するために必要なものがすべて揃っています。

Macがこれまで以上に人気があり、何百万人もの新しいプレイヤーにゲームをもたらすのにこれほど良い時期はありません。

WindowsゲームをMacに移植することがこれまで以上に速くなりました。

今年、新しいゲームポーティングツールキットは、既存の変更されていないWindowsゲームを実行するためのエミュレーション環境を提供し、Macで実行しているときにゲームのグラフィックス機能の使用状況とパフォーマンスの可能性をすばやく理解するために使用できます。

あなたのゲームがどのように見え、聞こえ、再生されるかを理解するのに何ヶ月もかかりません。

あなたはすぐにあなたのゲームの可能性を見ます。

Windowsゲームをまったく新しいプラットフォームに移植するには、通常、ソースコードの再コンパイル、HLSLから何千ものカスタムシェーダーの変換、グラフィックスサブシステムの再実装、オーディオ、入力、ディスプレイ、HDRレンダリングの使用を変換するなど、最初のシーンがネイティブに実行される前に、最初のシーンが実行される前に、多くのステップが必要です。

ゲームポーティングツールキットの助けを借りて、プラットフォーム上で実行されているゲームの最初のシーンをはるかに早く見ることができます。

ゲームポーティングツールキットには、既存のすべてのHLSL GPUシェーダーをメタルに自動的に変換するために使用できる新しいメタルシェーダーコンバーターが含まれています。

メタルシェーダーコンバーターを使用すると、シェーダーとグラフィックスをMacに持ち込む時間もはるかに少なくなります。

より早く出荷でき、MacとApple Siliconのユニークな機能を利用する時間が増えます。

ゲームがすぐに実行されるのを見ると、クロスプラットフォームエンジンを使用してほとんどの移植を処理するときにも役立ちます。

Windowsゲームがクロスプラットフォームエンジンで追加したプラットフォーム固有のコードやプラグインを移植する前に、ゲームの可能性を見ることができます。

ゲームをMacに移植することは、ゲームの評価から始まり、シェーダーをコンパイルし、Metalでレンダリングし、ゲームの入力、オーディオ、ディスプレイ、HDRレンダリングの使用を変換します。

最初のステップは、ゲームポーティングツールキットを使用してゲームを評価することです。

ゲームポーティングツールキットの環境は、ゲームのIntel命令と、キーボード、マウス、コントローラー入力用のWindows APIの使用を翻訳します。オーディオ再生用。ネットワークとファイルシステムの使用用。そしてもちろん、グラフィックス用。

GPU駆動のパイプラインやSIMD操作などの最新のグラフィックス機能や、テッセレーションやジオメトリシェーダーなどの古い機能はすべて翻訳されています。

これを実際に見てください。

Blooberのような開発者がGame Porting Toolkitを使用して、Windows DirectX 12ビルドの「The Medium」を調べる方法は次のとおりです。

「The Medium」は、Blooberによって開発され、公開された最近のゲームです。

彼らのネイティブのApple Silicon and Metalのリリースは、素晴らしく、美しく、超楽しいゲームです。

また、少し怖くて、プレイヤーに非常に没入感のあるグラフィックとオーディオ体験を提供します。

ツールキットをインストールした後、「The Medium」のWindowsビルドをMacにコピーし、ターミナルから起動します。

Game Porting Toolkitの翻訳環境で起動すると、ロギングとデバッグ情報がターミナルに表示されます。

ゲームを起動すると、このロギングには対処すべき潜在的な問題が含まれている可能性がありますが、Blooberの開発者にとって物事はここで明確に見えます。

ゲームポーティングツールキットのドキュメントを見て、ゲームのロギングで何が見つかるかの詳細を確認してください。

ここで開発者は、すべてのグラフィックス機能が有効になっている状態でゲームがうまく動作しており、期待どおりに動作していることがわかります。

彼らは、透明性、反射、ジオメトリシェーダー、テッセレーション、照明に対するユニークで不機嫌なグローバル照明アプローチなどの機能がすべてメタル3に変換され、鮮明でピクセルパーフェクトに見えることに気付くでしょう。

次のステップは、ベースラインのパフォーマンスの感覚を得るために少し遊ぶことです。

Windowsゲームを実行して観察するベースラインパフォーマンスには、ゲームポーティングツールキットのすべてのオーバーヘッドと、APIと命令セットの翻訳が含まれていることは注目に値します。

Blooberの場合、Windowsバージョンはもちろん、MetalFXアップスケーリングのようなパフォーマンス向上機能を使用していません。

非ネイティブゲームがこれらの翻訳層を通過すると、そのパフォーマンスと電力効率が影響を受ける可能性があります。

ゲームをネイティブにMacに持ち込むと、パフォーマンスが向上し、MetalFXなどの機能やAppleの内蔵ディスプレイの拡張ダイナミックレンジ機能など、Apple SiliconおよびMacハードウェアの多くの高度な機能を利用することができます。

ゲームを評価するための素晴らしいワークフローは、メタルパフォーマンスHUDを有効にしてプレイし、より深い外観を保証する可能性のある特定のスポットを探すことです。

開発者は、HUDが時折ドロップされたフレームとはるかに低い平均フレームレートを示している場所を見つけました。

その後、インストゥルメントを使用してメタルシステムトレースをキャプチャすることができます。

これは、パフォーマンスの問題を調査するのに最適な方法です。

Game Porting Toolkitで実行しているときに、Metal Performance HUDが強化されました。

HUDの標準部分はまだ一番上にあります。

レンダリングされるGPUと解像度、瞬間的なフレームレート、現在から現在までの間隔、および使用されているGPU時間の近似値に関する情報が表示されます。

これらの統計の高値と低値を強調し、メモリ使用量を示し、最後の数秒のデータのグラフを提供します。

以下に、HUDは、命令セットの翻訳と、どのDirect3D APIバージョンが使用されているか、使用されているレンダリングエンコーダの数、実行されているコマンドバッファとディスパッチの数、ジオメトリシェーダーやテッセレーションシェーダーなどの各タイプの機能の数について、各フレームでより詳細な詳細を示しています。

さらに、リソースのコピーとクリアがキャプチャされます。

ここでは、Instrumentsでトレースファイルを開き、フレームドロップが表示される場所をすばやく見つけます。

ここでは、GPUのタイムラインに大きなギャップがあり、使用率がほとんどなく、作業がまったく予定されていないフレームがいくつかあった領域です。

これを勉強した後、命令翻訳のオーバーヘッドやAPI翻訳によって引き起こされる違いによって引き起こされる可能性が非常に高いようです。

これらは、ゲームをMacにネイティブに持ち込むと消える種類の問題です。

あなたのゲームのパフォーマンスが向上し、より効率的に実行されることを確信できます。

さらに、Metalでレンダリングするためのベストプラクティスを使用し、MetalFXアップスケーリングを採用することで、ゲームのパフォーマンスをさらに向上させます。

これは、翻訳されたバージョンと並んで実行されている「The Medium」のネイティブバージョンで、Metal 3とApple Siliconをより最適に使用して、このシーンのフレームレートを劇的に改善します。

ゲームポーティングツールキットの使用を開始するには、developer.apple.comにアクセスしてください。

ゲームの評価を開始できるように、ツールキットの構築と設定の手順を含むパッケージがあります。

ゲームポーティングツールキットに関するフィードバック、質問、提案を提供し、フィードバックアシスタントを使用してゲームをMacに持ち込むことができます。

既存のWindowsゲームを実行してグラフィック機能とパフォーマンスを評価したので、その知識を活用してシェーダーパイプラインを移植してください。

メタルシェーダーコンバーターツールを使用して、ジオメトリ、テッセレーション、メッシュ、レイトレーシングステージなど、ゲームの高度なシェーディングパイプラインをすべて変換できます。

シェーダーをコンパイルすることは、それ自体が深いトピックなので、準備ができたら、このシリーズの2番目のトーク「シェーダーをコンパイルする」を見てください。メタルを使ったレンダリングを見てみましょう。 

Metal 3は、MetalFX、高速リソースロード、オフラインコンパイル、メッシュシェーダー、レイトレーシングなど、すべての高度なグラフィックスとコンピューティング機能を提供し、最新のハイエンドゲームで使用され、グラフィックスコードの変換が非常に簡単になります。

シリーズの3番目のセッション「Render with Metal」は、レンダラーをMetalに移植し、Apple Siliconから優れたパフォーマンスを得る方法についてです。

Game Porting Toolkitを通じて、ゲームの基本的な入力機能を評価しました。

今、それをネイティブに移植し、ランブルやハプティックスなどの高度な機能を活用する時が来ました。

Windowsゲームは、すでにクロスプラットフォームのゲームエンジンで構築されており、一般的な入力プラグインを使用しているか、XInputやGameInputなどの低レベルのWindows APIを直接使用しているか、ゲーム周辺機器用のカスタムSDKをバンドルしている可能性があります。

Appleプラットフォームでは、ゲームコントローラーフレームワークは、ゲームパッド、キーボード、マウス、レーシングホイール、アーケードスティックなど、さまざまな周辺機器にわたるゲーム入力のスレッドセーフで低レイテンシのサポートをゲームに提供します。

また、触覚やモーションなど、ゲームコントローラーの追加機能にもアクセスできます。

Appleプラットフォームは、アプリごとの入力再マッピングのシステムレベルのユーザー設定サポート、スクリーンショットの自動サポート、ビデオ録画のキャプチャ、および任意のゲームのコントローラーからのゲームプレイの15秒のハイライトを提供します。

ゲームの入力ロジックを簡単に移植できます。

詳細を学ぶ準備ができたら、これらの2つの以前の講演「仮想および物理的なゲームコントローラーをタップ」と「ゲームコントローラーの進歩」は、詳細とサンプルコードを見つけるのに最適な場所です。

オーディオは、魅惑的なゲーム体験のもう一つの重要な部分です。

既存のゲームのオーディオワークフローと機能をMacにネイティブに持ち込むのはとても簡単です。

Appleデバイスには最先端の内蔵スピーカーがあり、大音量のファンがそれらをかき消すことができないため、プレーヤーは大声ではっきりと聞くことができます。

また、低レイテンシの空間オーディオをサポートするAppleデバイスと互換性のある優れた有線および無線オーディオ周辺機器もたくさんあります。

既存のゲームは、すでにWwise、Unity、FMODなどのクロスプラットフォームのオーディオミドルウェアソリューションを使用している可能性があります。

これらのミドルウェア製品は、一般的にシステムオーディオAPIとフレームワークを抽象化します。

Windowsでは、DirectSound、XAudio2、WASAPIなどの低レベルのAPIよりもミドルウェアレイヤーを使用している可能性があります。

これらの同じミドルウェア製品は、Appleのプラットフォームに存在します。

これらは、Spatial Mixer Audio Unit、PHASE、AVAudioEngineなど、高レベルおよび低レベルのAppleオーディオフレームワークの豊富なセットを利用しています。

素晴らしいニュース：これらのミドルウェア製品はすべて、ネイティブのApple Silicon SDKで十分にサポートされていることがわかります。

あなたがする必要があることはほとんど、または何もありません。

しかし、ミドルウェアを使用していない場合は、もちろん、ミドルウェアと同じように、プラットフォームが提供するオーディオフレームワークとAPIを直接使用できます。

特に、このレベルで優れた空間オーディオを実現するには、PHASEドキュメントと、AUSpatialMixerを使用して12チャンネルの7.1.4 PCMデータから空間オーディオを作成することを示すサンプルコードを確認してください。

CoreAudio、AudioUnits、PHASEに関するこれらの以前の講演は、ゲームがオーディオミドルウェアに基づいていない場合、低レベルのシステムフレームワークの使用について学ぶのに最適なセッションです。

Appleのディスプレイは、プレイヤーに見事で没入感のあるゲーム体験を提供する上で不可欠な部分です。

ゲームポーティングツールキットを使用すると、翻訳された環境の基本的な標準ダイナミックレンジとフレームペーシングAPI上で実行されているゲームのレンダリングコードを見ることができます。

Windowsでは、ゲームがカラーマネジメントとトーンマッピングAPIを使用して、AdvancedColorInfo色空間APIなどのハイダイナミックレンジを実現している可能性があります。

また、IDXGISwapChainで利用可能なタイミングとフィードバックを使用して、SDRとHDRコンテンツのペースを調整している可能性があります。

CAMetalLayerの拡張ダイナミックレンジサポートにより、さらに高度なディスプレイ機能にアクセスできます。

浮動小数点または10ビットの整数範囲、またはHDR10またはPQ10シェーダーに基づいているかどうかにかかわらず、HDRとトーンマッピングロジックを簡単に移動できます。

CAMetalDisplayLink APIは、ゲームの入力と表示の待ち時間を最小にするためのきめ細かい制御を提供します。

メタルレンダリングにEDRサポートを追加することについてのこれらの講演をチェックしてください。

「iOSでEDRを探索する」は、macOSとiOSの間で一貫しているピクセルフォーマットとMetal APIを要約した素晴らしい講演です。

「EDRでHDRレンダリングを探索する」プレゼンテーションは、EDR APIと機能を最大限に活用する方法を理解するための素晴らしい基盤を提供します。

Apple Silicon Macプラットフォームには、ゲームをMacに持ち込むために必要なすべてのソフトウェアとハードウェア機能があります。

Game Porting ToolkitとMetal Shader Converterを使用すると、ゲームをMacに持ち込むのがこれまで以上に簡単になります。

パート2の「シェーダーのコンパイル」とパート3の「Render with Metal」を必ず続けてください。Macであなたのゲームをプレイするのが待ちきれません。

♪ ♪