10233

♪ ♪

スラジ：こんにちは。

このセッションでは、AirPodsでアプリのオーディオ体験を向上させる方法を探ります。

iOS 17とmacOS 14で発表したAirPodsの機能のいくつかを紹介します。

私の名前はスラージです。

私はここアップルのヘッドフォンとアクセサリーのソフトウェアエンジニアリングチームの一員です。

始めましょう。

世界中の人々がAirPodsを愛しています。なぜなら、彼らは一日を通して最高のパーソナルオーディオ体験を提供するからです。

毎日、何百万人もの人々がAirPodsを使って音楽を聴いたり、映画を見たり、家族や友人とFaceTimeをしたり、仕事の電話をしたり、仕事を終わらせるために落ち着いたりしています。

そして、彼らはApple WatchからMacまで、Appleのエコシステム全体でAirPodsを使用しています。

iOS 17とmacOS 14では、プラットフォーム間で毎日AirPodsをさらに簡単かつ便利に使用できるいくつかの素晴らしい機能を導入しています。

これらの機能がAirPodsの最も一般的なユースケースの1つをどのように変えるかを見てみましょう。

iPhoneでパーソナライズされた空間オーディオでAirPodsの音楽を楽しんでおり、仕事の会議に参加するための通知を受け取ります。

通話に参加するためにMacのロックを解除すると、AirPods Connectedバナーに迎えられ、AirPodsの準備が整い、Macに接続されていることを知らせます。

次に、会議に参加すると、期待どおりにAirPodsを介してMacからオーディオが再生され、iPhoneで聴いていた音楽が一時停止します。

仕事の電話の途中で、オフィスの誰かが話しに来るか、リモートワークで、誰かが配達のために自宅であなたのドアベルを鳴らします。

これで、AirPodsステムを押して通話中にミュートすることができます。そうすると、フレンドリーなマイクステータスバナーとオーディオチャイムも通知されます。

その後、予想通り、AirPodsのステムをもう一度押してミュートを解除し、会議を続けることができます。

そしてもちろん、あなたはバナーを見て、ミュート解除のチャイムを聞くでしょう。

最後に、仕事の会議が終わり、くつろぐ時間です。

iPhoneを手に取り、お気に入りのApple Musicプレイリストで再生を押すと、オーディオがiPhoneからシームレスにAirPodsに切り替わるので、ビートを逃すことなく一日を続けることができます。

では、あなたのアプリケーションのための魔法のAirPods体験のロックを解除し、AirPodsを持つ人々がプラットフォーム間で簡単にあなたのアプリを使用できるようにしたいですか?

このセッションでは、これらの機能を活用し、正確にそれを提供するためにアプリを最適化する方法について説明します。

macOS 14用のAirPodsの自動切り替えと、アプリがそれを最大限に活用するために従うことができるベストプラクティスから始めます。

次に、iOS 17とmacOS 14で、プレスからミュートとミュート解除のサポートを行います。

最後に、Spatial AudioとさまざまなAppleプラットフォームでのサポートについて説明します。

macOS用のAirPodsの自動切り替えから始めましょう。

macOS 14は、ユーザーの意図したアクティビティに基づいて、デバイス間でAirPodsの自動切り替えをサポートしています。

自動切り替えアルゴリズムは、「再生中」登録や入力オーディオアクティビティなどのインジケーターを使用して、これらの決定を行います。

良いニュースは、すべてのApp Storeアプリだけでなく、Appサンドボックスを使用するか、サンドボックスを持っていないことを選択したApp Store外のアプリは、それを採用するために何もする必要はありません。

彼らは、開発者からの変更を必要とせずに、この機能に完全に参加することができます。

それでは、これらの機能を持つ人々のための最適なAirPods体験のためのベストプラクティスについて話しましょう。

macOSで「Now Playing」に登録すると、自動ルーティングアルゴリズムは、たとえば、長い形式のオーディオが再生されているときに知ることができ、正しいルーティングの決定を下すことができます。

アプリがメディアまたはストリーミングアプリの場合は、それに応じてオーディオに優先順位を付けるために、Now Playingに登録することをお勧めします。

会議やゲームアプリの場合は、Now Playingに登録することはお勧めしません。

また、オーディオサービスAPIを使用して、通知やアプリ固有のチャイムを再生することをお勧めします。

これは、通知をメディアコンテンツと区別し、予期しない動作を避けるのに役立ちます。

会議アプリの場合は、会議または音声セッションの開始時にのみ入力マイクを使用し、ライブ会議または音声セッションの期間中のみ開いたままにしておくことをお勧めします。

メディアアプリの場合、ユーザーが選択したデフォルトのルートを使用してオーディオを再生することをお勧めします。

また、ユーザーがオーディオを一時停止した後は、無音を再生しないでください。

沈黙を再生する必要がある場合は、2秒未満に保つことをお勧めします。

では、AirPodsで押してミュートとミュート解除について話しましょう。

iOS 17とmacOS 14では、Press to MuteとUnmuteで通話中のAirPods体験に利便性を加えています。

AirPodsのステムを押すだけで、通話中にアプリケーションのマイクをミュートまたはミュート解除できるようになりました。

iOS 17以降、すべてのCallKitアプリは、追加の採用がまったく必要なく、プレス・トゥ・ミュートとミュート解除のサポートを受けるようになります。

CallKitを使用していない通信アプリについては、まもなく詳しく説明する新しいAPIを導入しました。

いずれの場合も、iOS 17はアップリンクオーディオをミュートし、トーンを再生することでミュートジェスチャーに応答します...

そして、それがミュートされたことをアプリケーションに通知します。

その後、誰かが再び同じジェスチャーをトリガーすると、iOS 17はアップリンクオーディオのミュートを解除し、トーンを再生します...

そして、ミュートが解除されたことをアプリケーションに通知します。

この機能は、人々にとって大きな利便性を追加します。

iOS17でどれだけ早く追加できるかをお見せしましょう。

AVAudioSessionファミリーの新しい兄弟であるAVAudioApplicationを紹介できることを嬉しく思います。

AVAudioApplicationは、アプリのアプリケーション全体のオーディオ動作を設定する方法です。

AVAudioApplicationを使用して、プレスをミュートとミュート解除に組み込むことができる速さをお見せしましょう。

まず、AVFAudioをインポートする必要があります。

次に、AVAudioApplicationの共有インスタンスを取得します。

その後、通知センターでミュートジェスチャー変更通知を登録する必要があります。

これにより、アプリケーションがプレス・トゥ・ミュートとミュート解除に選択されます。

これらの通知は、ミュートジェスチャーによってミュート状態が変更されたときに通知します。

そこから、ユーザー情報のAVAudioApplication入力muteStateKeyを内省して、新しい状態を決定します。

この通知を受け取った後、この通知が発火した結果、内部状態とUIを更新できます。

さらに、誰かがアプリケーション内でミュートアクションを実行すると、AVAudioApplicationが更新される必要があります。

予想通り、私たちはセッターとゲッターの両方を提供します。

iOS 17のアプリに組み込み、押してミュートとミュートを解除するのは簡単です。Macに移動します。

macOS 14では、プレス・トゥ・ミュートとミュート解除の動作が少し異なることに注意することが重要です。

iOSと同様に、ミュート状態が変更されるとアプリに通知されます。

ただし、macOSでは、ジェスチャーが実行されたときに、アプリケーションはアップリンクオーディオをミュートする責任があります。

オプトインにはいくつかの追加のAPIが必要ですが、すぐに詳しく説明します。

最後に、ミュートされたトーカーを検出しようとしているアプリケーションについては、それをサポートする新しいAPIの詳細については、「音声処理APIの新機能」セッションを参照してください。

Macでどのような採用が必要かを見てみましょう。

macOS 14では、ミュートジェスチャーの結果としてアップリンクオーディオをミュートするのはアプリケーションの責任であることを忘れないでください。

AVAudioApplicationの共有インスタンスでは、ミュート状態変更ハンドラを設定する必要があります。

このハンドラは、誰かがミュートジェスチャーを実行すると呼び出されます。

ここでは、アップリンクオーディオをミュートし、内部状態を更新します。

また、ミュートアクションがアプリケーションの現在の使用に適切でない場合は、拒否する機会も提供します。

ミュート状態が変更されると、入力ミュート状態変更通知が引き続き受信されるため、このハンドラはUIの更新には使用しないことをお勧めします。

さらに、CoreAudioフレームワーク内に新しいプロパティを提供し、プロセスへの入力オーディオをすばやくミュートできるようにしました。

このプロパティは、有効にすると、通常どおりIOを実行し続けながら、プロセスへの入力オーディオを無音にします。

最後に、AirPodsを使った空間オーディオについて話し合いましょう。

AirPodsの空間オーディオは、世界中の人々が音楽を聴く方法を変え、今日のApple Musicの加入者の80%以上が空間オーディオで聴いています。

そして、iOS 16の発売により、パーソナライズされた空間オーディオでこれを次のレベルに引き上げました。なぜなら、私たち全員が音を知覚する方法は、頭と耳のサイズと形に基づいてユニークだからです。

そして、パーソナライゼーションの向上に向けたこの推進は、人々に好評を得ています。

macOS 14、iOS 17、tvOS 17では、3つのプラットフォームすべての空間オーディオサポートを継続できることをうれしく思います。

macOSでは、AVPlayerのSpatial AudioとAVSampleBufferAudioRenderer APIをサポートしています。

iOSとtvOSは、上記のAPIとともに、AURemoteIOのSpatial AudioとAudioQueue APIをサポートしています。

Spatial Audio for AudioQueueとAURemoteIOにはAPIインターフェイスがないことに注意してください。

代わりに、Now Playingに登録するアプリに対して自動的に有効になります。

これにより、コントロールセンターを介して機能を設定するオプションがユーザーに提示されます。

物事を締めくくるために、人々やアプリがmacOS用のAirPodsの自動切り替えの恩恵を受けることがいかに簡単かを発見しました。

実際、ほとんどの場合、アップデートに参加するために何もする必要はありません。 

その後、AirPodsで一貫した自動切り替え体験を持つために、あなたのアプリができることも調べました。

AVAudioApplication APIと、プレスをミュートとミュート解除のサポートに追加する方法を紹介しました。

そして、すべてのプラットフォームでグローバルな顧客ベースにAirPods Spatial Audioを提供する方法について話し合いました。

関連するセッションでは、アプリに空間オーディオのサポートを追加し、再生中に登録する方法を学ぶこともできます。

私たちのチームがあなたにそれを持って来ることを楽しんだのと同じくらい、あなたがこのセッションを楽しんだことを願っています。

私たちは、これらの機能をお客様とお客様と共有できることをとても嬉しく思います。

私たちはあなたのアプリケーションで動作しているすべてを見るのが待ちきれません。

そして、ありがとう。