10150

こんにちは、私はCar Experience EngineeringのKartikです。「車両システムのCarPlayの最適化」へようこそ。

今日、私たちはあなたの車がドライバーに最高のCarPlay体験を提供する方法を共有することに興奮しています。

あなたが自動車メーカーまたは車両システムの開発者なら、これはあなたのためのセッションです。

CarPlayは、車内でiPhoneを使用するためのよりスマートで安全な方法です。

優れたCarPlay体験の大部分は、CarPlayを車両にどれだけ効果的に統合するかです。

今日のセッションは、これを達成するのに役立つ5つのトピックで構成されています。

ビジュアル統合は、CarPlayをシステムで自然に見せ、感じさせることです。

次に、優れたCarPlay体験のバックボーンとして機能する接続性、オーディオ、ビデオエンコーディングにおけるCarPlayインフラストラクチャの進歩について説明します。

そして、最後のトピックでは、CarPlayのEVルーティングについて確認します。

昨年、私たちは次世代のCarPlayのスニークピークを与えました。

本日導入するインフラストラクチャの進歩は、次世代のCarPlayに向けてシステムを準備するのに役立ちます。

視覚的な統合機能から始めましょう。

現代の車両は、ますます多様な形状とレイアウトを持つ大きなメインディスプレイを備えています。

広いディスプレイもあれば、背の高いディスプレイもあります。

ディスプレイの中には長方形ではないものもあれば、CarPlay UIと内蔵の車両UIを組み合わせて、すべてを示すものもあります。

CarPlayは、メインディスプレイのこれらすべてのバリエーションにうまく統合するように設計されています。

CarPlayをあなたの車の中でくつろげるように調整する方法を見てみましょう。

以前のWWDCビデオでは、CarPlayビューエリアを紹介しました。

今日、私たちはこのコンセプトに基づいて構築しています。

ビュー領域は、CarPlayがUIを描画する境界を定義します。

CarPlayはフルスクリーンで見栄えがします。

ただし、組み込みの車両UIには、CarPlayがウィジェットやその他の要素と一緒に表示される追加のレイアウトがある場合があります。

この場合、人々がレイアウトをシームレスに切り替えることができるように、動的な画面サイズ変更をサポートします。

システムがCarPlayの横にウィジェットを表示すると、CarPlayは自動的に挿入され、組み込みのUIでより多くの視覚的な間隔を作成します。

ビュー領域を挿入する必要はありません。できるだけ多くのスペースを与えるだけで、CarPlayは適切な量のパディングを作成します。

ディスプレイが非長方形の場合はどうなりますか?

この場合、ビュー領域をディスプレイを囲む最小の長方形として定義します。

また、安全領域をディスプレイ内の最大の長方形として定義します。

CarPlayは、すべての重要なUIが表示されるように、安全なエリア内にインタラクティブなコンテンツを描画します。

安全エリアの外では、ピクセルは黒です。

これで、CarPlayを有効にして、セーフエリアの外でUIを描画するオプションがあります。

CarPlayは、ディスプレイの端に背景を描き、ドライバーに視覚的に魅力的で没入感のある体験を提供します。

このセーフエリアフラグは、メインディスプレイでのみ使用可能であることを覚えておいてください。

CarPlayのステータスバーに注意を向けましょう。

CarPlayのステータスバーはCarPlayのUIに恒久的に表示され、ドライバーに常に利便性を提供します。

ステータスバーは、ディスプレイの解像度とアスペクト比に基づいてインテリジェントに配置されます。

CarPlayのUIの下端に沿って、垂直、ドライバー側、または水平に表示されます。

場合によっては、システムの組み込みUIによりよく適合するために、ステータスバーの位置をオーバーライドすることは理にかなっているかもしれません。

これは、ビューエリアフラグで行うことができます。

たとえば、ステータスバーをシステムのUI内の他の永続的なコントロールに合わせたいと思うかもしれません。

ステータスバーには、滑らかな丸みを帯びた角もあります。

私たちは、CarPlayで丸みを帯びたコーナーがどのように見えるかが大好きで、コーナークリッピングマスクは視覚的な魅力に役立ちます。

いくつかの文脈から始めましょう。

デフォルトでは、CarPlayの丸みを帯びた角の背景は黒で表示されます。

CarPlayがフルスクリーンのとき、これは素晴らしく見えます。

これは、CarPlayがウィンドウに描画されるシステムです。

CarPlayのUIの角を見ると、CarPlayの丸みを帯びた角の後ろに黒い背景が見えます。

これらの小さな黒い三角形が表示され、システムの壁紙とうまく調和しない可能性があります。

コーナークリッピングマスクをサポートすることで、あなたのシステムは魔法のようにこれらの黒い三角形を消すことができます。

これが機能する方法は、iPhoneは透明性情報を含むコーナーブレンディングマスクを提供することです。

車両システムは、CarPlayのUIの各コーナーにこのマスクを適用して、黒い三角形を削除します。

その後、CarPlayの丸みを帯びた角まで背景を描くことができます。

これにより、CarPlayは内蔵システムに本当に溶け込み、素晴らしい視覚的な魅力を生み出します。

CarPlayが安全なエリアの外で描画する場合、コーナークリッピングマスクは使用できないことに注意してください。

次の機能であるUIフォーカス転送に焦点を移す時が来ました。

一部のシステムは、入力デバイスとしてロータリーノブまたはタッチパッドをサポートしています。

ドライバーがこの入力デバイスを使用してCarPlayと対話すると、CarPlay UIは選択した要素にフォーカスハイライトを表示します。

ドライバーが内蔵UIをスクロールすると、システムが独自のフォーカスハイライトを表示する場合があります。

CarPlayはフォーカス転送をサポートしているため、ドライバーはCarPlayとシステムのUI要素間をシームレスに移動できます。

ドライバーは単にノブを押して焦点を移すことができます。

当社のAPIは、CarPlayとシステムの間でフォーカスを仲裁することにより、一度に1つのフォーカスハイライトのみが表示されることを保証します。

システムがウィンドウ構成でCarPlayを表示し、ノブまたはタッチパッドをサポートしている場合は、フォーカス転送をサポートします。

CarPlayプロトコルを使用してフォーカスがどのように調整されるかを見てみましょう。

CarPlayが起動すると、組み込みシステムはCarPlayにフォーカスを与えるべきかどうかを決定します。

ここでは、フォーカスがシステムに属していることがわかります。

ドライバーがCarPlayにフォーカスを向けると、システムはフォーカスを却下し、方向と位置情報をCarPlayに提供します。

CarPlayはこの情報を使用して、最も直感的なUI要素に重点を置いています。

ドライバーが組み込みのUIにフォーカスを戻すと、CarPlayはシステムにフォーカスを提供します。

システムがフォーカスを獲得した場合、CarPlayはフォーカスを却下し、システムは独自のフォーカスハイライトを表示します。

UIフォーカス転送を採用して、CarPlayと組み込みUIの間に継続性を作成します。

CarPlayの外観モードについて話しましょう。

CarPlay UIは、明るいテーマでも暗いテーマでも表示できます。

これは、人々がiPhoneで愛するおなじみの光と暗いUI体験をもたらします。

CarPlayの外観を組み込みのUIの外観と同期させます。

人々はCarPlayとあなたのシステムが調和しているのを見ることに感謝するでしょう。

CarPlayの外観は、車両の状態、ユーザー設定、時間帯によって変更される場合があります。

たとえば、システムが夜間に暗いテーマに移行した場合、システムは単に時間に基づいて外観を変更するようにCarPlayに通知します。

また、システムがナイトモードを有効にすると、CarPlayは自動的に暗い外観にシフトします。

マップUIには別の外観モードコントロールもあります。

これらすべてがどのように機能するかを説明するために、いくつかの例を見てみましょう。

この例では、組み込みのUIはメインディスプレイで暗いテーマを使用しています。

システムは、一貫した外観を作成するために暗い外観モードを使用するようにCarPlayに通知します。

システムがインストルメントクラスターにCarPlayナビゲーションUIを表示する場合は、各ディスプレイの外観を指定します。

この場合、メインディスプレイとインストルメントクラスターの両方が暗いUIテーマにあります。

システムがディスプレイごとに異なる外観モードを表示する場合は、CarPlayに一致するように通知します。

そして最後に、CarPlayのマップUIには別の外観設定があります。

ライトマップの外観に移行する際には、インストルメントクラスターから目を離さないでください。

CarPlayのマップUIの外観を、組み込みシステムのマップの外観と必ず同期してください。

UIの外観をシステムと同期させることについて説明したので、iPhoneがシステムのディスプレイ全体でどのようなコンテンツに電力を供給できるかを見てみましょう。

現代の車両システムでは、メインディスプレイ、インストルメントクラスターディスプレイ、ヘッドアップディスプレイの3種類の一般的なディスプレイについて説明します。

これらの各ディスプレイで今日利用可能なiPhoneのコンテンツを確認しましょう。

メインディスプレイで、CarPlayのビデオストリームを表示します。

さらに、システムの組み込みUIは、ルートガイダンス、電話、再生中の情報などのiAP2メタデータで電力を供給できます。

システムがマップウィジェットを表示する場合は、CarPlayナビゲーションがアクティブな間にCarPlayナビゲーションUIストリームをウィジェットに入力します。

このUIストリームは、ETA情報、制限速度標識、コンパスを表示するように設定できます。

インストルメントクラスターでは、CarPlayナビゲーションUIストリームを表示できます。

システムにインストルメントクラスターのマップズームレベルを変更するコントロールがある場合は、CarPlayマップズームサポートを追加します。

そして、メインディスプレイと同じように、iAP2メタデータを使用して組み込みUIを実装します。

ヘッドアップディスプレイでは、iAP2メタデータを使用して、運転中に視線でターンバイターンの方向などの情報を表示できるようにします。

信頼性が高くパフォーマンスの高いCarPlayシステムを作成するために、インフラストラクチャ機能を見てみましょう。

最終的には、これらの変更により、次世代のCarPlay用にシステムも設定されます。

私たちの最初のトピックは、iPhoneと車両システム間の接続性に関するものです。

ワイヤレス接続体験は、ドライバーが初めてペアになったときに始まります。

アウトオブバンドペアリングをサポートすることで、ドライバーの初めてのペアリング体験を容易にします。

アウトオブバンドペアリングにより、iPhoneを車に接続するだけで、ワイヤレスCarPlay用にデバイスをペアリングできます。

それは便利で、より少ない相互作用を必要とします。

人々は、すべてのワイヤレスCarPlayシステムがUSB経由のアウトオブバンドペアリングをサポートすることを期待しています。

あなたのシステムがデジタルカーキーをサポートしている場合、私たちはあなたのために何か新しいものを持っています。

iOS 17以降、iPhoneはカーキー接続によるCarPlayのペアリングをサポートしています。

これにより、車のキーとCarPlayのペアリング体験が統一されたフローに組み合わされるため、ペアリングがさらに簡単になります。

iPhoneに車のキーを追加した後、人々はワイヤレスCarPlayをペアリングするように求められます。

受け入れられた場合、ペアリングは車のキー接続を介して行われ、CarPlayはワイヤレスで接続されます。

1回限りのペアリングを行った後、ドライバーが車に入るたびに、車両は自動的にiPhoneに接続されます。

Bonjourは、IP接続を確立し、CarPlayセッションを開始するために、車両とiPhoneに使用されます。

CarPlayを接続するための好ましい方法である簡略化された接続フローを導入しました。

既存のiAP2接続を使用してIPアドレスとポート情報交換を実行することで、Bonjourは不要になり、実装がよりシンプルで高速になります。

これにより、WPA3のみのネットワークのサポートも追加されます。

簡略化された接続フローは、iOS 14以降を実行しているデバイスと接続できます。

お使いのシステムが以前のiOSバージョンに接続するように設計されている場合は、Bonjour接続フローを引き続きサポートしてください。

車のキーをサポートする人のために、私たちは別の機能で戻ってきました。

あなたのシステムは、ドライバーがデジタルカーキーで車両に入るとすぐにワイヤレスCarPlayに即座に接続できます。

iAP2メッセージを使用すると、システムはデジタルカーキーのペアリングをCarPlayデバイスにマッピングできます。

次にドライバーが車両に近づき、車のキー接続が作成されると、システムはCarPlayスタックを準備します。

その車のキーと対応するCarPlayのペアリングを確認することで、CarPlayをさらに早く起動できます。

ドライバーには、CarPlayが即座に表示されます。

私たちは、あなたが次のシステムでこれを利用することにとても興奮しています。

そして、私たちは皆、信頼できるCarPlay体験を作成するために、堅牢な接続がいかに重要であるかに同意していることを忘れないでください。

システムで堅牢なCarPlay接続を維持するために、干渉がWi-Fiのパフォーマンスに影響を与える可能性があるため、ワイヤレス干渉を処理するように設計します。

最初のステップは、ワイヤレスチャネル上の干渉を検出することです。

干渉が検出されたら、チャネルスイッチアナウンスを使用して干渉を避けてください。

システムが複数のワイヤレス無線をサポートしている場合は、BSS移行管理を使用してiPhoneを別のアクセスポイントに誘導できます。

5GHz帯で動作するとき、人々はワイヤレスCarPlayを最もよく体験することを覚えておいてください。

そして最後に、断続的な切断時にスムーズなエクスペリエンスを作成するために、システムはCarPlay TCPソケットのショートリンク切断を抑制する必要があります。

データリンク層の切断のみを理由に、これらのソケットを閉じないでください。

システムに接続した後、CarPlayは車両のスピーカーからオーディオの再生を開始できます。

お使いのシステムで利用可能なオーディオ機能をいくつか見てみましょう。

オーディオアプリは現在、iPhoneでより大きな再生体験を提供するために、AirPlayの強化されたオーディオバッファリングを採用しています。

人々はあなたの車でも同じオーディオの改善を体験したいと思っています。

これで、システムに強化されたバッファリングのサポートを追加することができ、車両は自動的にこれらの利点を利用します。

強化されたバッファリングは、音楽のようなオーディオを車のスピーカーにストリーミングするための好ましいプラットフォームです。

オーディオは、メインバッファオーディオと呼ばれる車両システムへの追加ストリームとして提供されます。

CarPlay通信プラグインには、iPhoneからのオーディオがリアルタイムの速度よりも速くストリーミングされる最大2分間のオーディオバッファが含まれています。

これにより、応答性が向上し、オーディオコンテンツは断続的な切断によって再生を継続できます。

オーディオアプリ開発者が利用できるものの詳細については、「AirPlayオーディオエクスペリエンスの調整」をご覧ください。

人々は、CarPlayのオーディオミキシングがiPhoneと同じように機能することを期待しています。

システムがさまざまなオーディオ出力ストリームをミックスして、一貫したオーディオ体験を作成できるようにします。

メインオーディオ、メインバッファオーディオ、代替オーディオ、および補助オーディオは、同時にアクティブおよびミックスすることができます。

強化されたSiriは、iPhoneでおなじみのSiri体験をCarPlayにもたらします。

人々はSiriを有効にするために「Siri」と言うことに慣れており、CarPlayでも機能することを期待しています。

システムが拡張Siriをサポートしていることを確認してください。

強化されたSiriは、車両のマイクを活用して、ドライバーが音声でSiriを起動しているときに確実に検出します。

また、オーディオアプリとラジオはSiriオーディオの背景にミックスされています。

人々は、結果として得られる途切れることのないオーディオ体験が大好きです。

そして最後に、ドライバーはプッシュ・トゥ・トークボタンを押すとSiriを即座に起動することができます。

強化されたSiriがシステムでどのように機能するかの詳細については、「CarPlayシステムの進歩」を参照してください。

ビデオエンコーディングに移りましょう。

歴史的に、CarPlay UIストリームはH.264エンコーディングを使用してきました。

CarPlayは、すべてのUIストリームのHEVCエンコーディングをサポートするようになりました。

HEVCはより効率的で、CarPlayが高解像度のディスプレイをサポートできるようにします。

お使いのシステムは、下位互換性のためにH.264を引き続きサポートする必要があります。

これらの接続性、オーディオ、ビデオエンコーディング機能はすべて、ドライバーの体験をはるかに良くします。

そのため、次世代のCarPlayをサポートするシステムに必要です。

私たちは最後のトピックをカバーするのに十分な範囲を持っています：EVルーティング。

Appleマップは、電気自動車を充電するための停留所を含む旅行を計画するのに役立ちます。

道順を取得すると、マップはルートやその他の要因を分析し、途中で充電ステーションを特定します。

今年は、オフラインマップのサポートに加えて、EVルーティングにはいくつかの素晴らしいアップデートがあります。

ユーザーは、どの充電ネットワークを好むかをマップに伝え、リアルタイムの充電ステーションの空き状況を地図上で確認できるようになりました。

EVルーティングをサポートするために、Appleマップは、EVルーティング体験を調整するために、電気自動車のいくつかの特性について知る必要があります。

さらに、車両の充電状態を伝えるためのインターフェースをサポートする必要があります。

自動車メーカーのアプリをお持ちの場合は、SiriKitのインテントをサポートして、車両の内外でEVルーティングを使用できるようにしてください。

さらに、運転中のリアルタイムの充電状態については、iAP2メッセージをサポートする必要があります。

私たちは、あなたの車両システムでCarPlay体験を豊かにすることができるすべての方法を乗り越えました。

すぐに、あなたの次の車が次世代のCarPlayをサポートしたいと思うかもしれません:車のための究極のiPhone体験。

それはあなたの車に完全に統合された没入型のiPhone体験をもたらします。

次世代のCarPlayはCarPlay上に構築され、このビデオで取り上げたインフラストラクチャの変更を十分に活用しています。

今日CarPlayでこれらの機能をサポートして、次世代のCarPlayのためにあなたの車を準備してください。

今日説明した機能は、最新のCarPlay仕様と通信プラグインで利用できます。

CarPlayシステムの開発の詳細については、developer.apple.com/carplayをご覧ください。

私たちは、あなたがあなたの次の車両システムでCarPlayが提供するものを最大限に活用することに興奮しています。

今日はご参加いただき、ありがとうございます。CarPlayで乗り続けてください。

。