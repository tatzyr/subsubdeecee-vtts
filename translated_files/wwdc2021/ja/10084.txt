10084

こんにちは、私の名前はアルンで、ワイヤレスチームのシステムエンジニアです。

今日は、UWBベースの車のキーを探索する旅にあなたを連れて行きます。

昨年、iPhoneやApple Watchを使って車のロックを解除、ロック、始動したり、家族や友人と鍵を共有したり、リモートで管理したりできる車のキーを発売しました。

そして、システムが安全でプライベートであるように設計されていることを知って、そのすべてを行うことができます。

今年は、車のキーの機能を拡張することに興奮しています。

このセッションでは、新機能とそれらの統合方法を見ていきます。

プロビジョニング、キー管理、NFCなど、車のキーの基本を学びたい場合は、昨年の講演「車のキーの紹介」をチェックしてください。

今年有効にしている主な機能の1つは、パッシブエントリーです。

UWBテクノロジーを使用すると、iPhoneをバッグやポケットに入れたり、Apple Watchを手首に置いたりしながら、車をロック、ロック解除したり、起動したりできます。

RKE、またはリモートキーレスエントリーコントロールを使用すると、iPhoneまたはWatchを使用して、車のBluetooth範囲内にいるときにロック、ロック解除、その他のアクションを実行できます。

また、車はどのデジタルキーがどのドアから車に入っているかを識別することで、設定をパーソナライズできるようになりました。

デバイスをカーキーやフレンドファーストアプローチとしてペアリングするなど、このセッションではカバーできない他の機能がありますが、これらの機能の経験もアップグレードされました。

では、これらの機能を可能にする技術を見てみましょう。

UWBテクノロジーを搭載したU1チップにより、車は近くの車のキーの正確な位置を判断できます。

UWBは、リプレイ攻撃やリレー攻撃に対するより強力な保護のための安全な範囲のプロトコルの基礎でもあります。

セキュアエレメントは、Appleデバイスに統合された保護されたハードウェアユニットです。

車のキーの保存と認証資格情報に加えて、セキュアエレメントの使用を拡大して、セッション固有のUWBレンジングキーを導き出しました。

Bluetooth LE、またはBLEは、認証中にデータを交換し、安全な範囲のセッションを管理するために、車とAppleデバイス間の通信チャネルとして使用されます。

BLEは、安全な範囲のタイムグリッドを初期化するためのアンカーポイントとしても使用されます。

そして最後に、クロスプラットフォームサポートを備えた共通のソリューションを確保するために、Appleは、他の業界パートナーとともに、カーコネクティビティコンソーシアムで標準仕様を作成する取り組みをリードしてきました。

Appleでは、セキュリティとプライバシーは私たちのコアバリューの一部です。

このUWBパッシブエントリーソリューションは、両方を念頭に置いて設計されています。

キーは各セッションに固有であり、各接続時に導出されます。

これらのセッションキーの中には、リンクレイヤーでメッセージを暗号化するために使用されるものもあれば、UWBまたはBLEを使用してデバイスを追跡できないようにするために使用されるものもあります。

これらのセッションキーから派生したランダムな識別子を使用します。

その後、これらの識別子は定期的にローテーションされます。

そして最も重要なことは、安全な範囲のプロトコルを構築することで、UWBベースのローカリゼーションのセキュリティを強化したことです。

このセキュアレンジングプロトコルは、3パケット交換を備えた双方向測距プロトコルです。

iPhoneが投票メッセージを送信し、車が応答メッセージで応答し、iPhoneが精度を高めるために別の投票メッセージを送信する「ピンポンピン」と考えてください。

これらのメッセージのそれぞれには、暗号化で生成された時間制限付きパケットであるスクランブルタイムスタンプ（STS）が搭載されています。つまり、検証済みのパケットでさえ、このSTSの生成に使用されたタイムスロットにのみ受け入れられ、リプレイおよびリレー攻撃に対する追加のセキュリティを提供します。

では、これらすべてをまとめるにはどうすればよいでしょうか?

さて、各車は一連の仮想ゾーンを定義しています。

これらのゾーンには、有効でアクティブなキーを持つデバイスがローカライズされてこれらのゾーンに出入りしたときにトリガーできる関連機能があります。

より広いゾーンは、車に近づいたときにライトをつけたり、キャビンを事前に温めたりするなど、ウェルカム機能を有効にします。

車に最も近いゾーンは、通常、近づくとドアのロックを解除します。

そして、ロックゾーンは、あなたが立ち去るときに車を固定します。

では、車はこれらのゾーンでどのようにあなたを検出しますか?

さて、これらの仮想ゾーン内でペアのデバイスをローカライズするために、車には複数のUWBとBLEトランシーバーが装備されており、360度のカバレッジを確保しています。

ユーザーが最初に車に近づくと、あなたのiPhoneまたはApple WatchはBLEを使用して検出されます。

近接検出時に、車との通信チャネルが確立されます。

接続すると、車はデバイスを認証し、共有測距キーが両側に導出されます。

この操作はSecure Element内で行われ、各セッションに固有のキーを生成します。

派生キーは、UWBトランシーバとのセキュアレンジセッションを開始するために使用され、車はデバイスをローカライズし、その軌道をマッピングすることができます。

これは、車内で実行されるローカリゼーションアルゴリズムによって計算されます。

私たちは後でそれに戻ります。

車は、ユーザーが車に近づくにつれて、デバイスの軌道をマッピングし続けます。

デバイスの位置と軌道に基づいて、車はライトの点灯や座席の調整などの歓迎機能をトリガーすることを決定できます。

また、デバイスがロック解除ゾーン内にローカライズされると、ユーザーがドアハンドルに触れる前に車がロック解除操作を開始できます。

ユーザーのデバイスが車内にあるか外にあるかを正確に知ると、有効なキーを持つデバイスが車内で検出された場合にのみエンジンが起動します。

そして、私のお気に入りの機能の1つは、携帯電話がパワーリザーブモードの場合でも、このUWBベースの体験を楽しむことができます。

だから、ハイキングやバックパッキングの長い一日の後、あなたの携帯電話を充電する必要があることがわかった場合、まだあなたを道路に戻すためにバッテリーに十分な電力があるかもしれません。

パッシブエントリーの仕組みを見たので、リモートキーレスエントリーコントロールを見てみましょう。

リモートアクションは、車から遠く離れているときに便利です。

冬にキャビンを予熱して使用したり、クラクションを鳴らして車を見つけることができます。

また、多くのアクションはウォレット内から直接トリガーできます。

また、デバイスを使用して、ロック状態、燃料レベル、バッテリー充電状態など、車に関する情報を表示することもできます。

リモートアクションはBluetooth LE経由で送信されます。

彼らはUWBから独立しているので、UWBの範囲外でも機能します。

そして最後に、リモートアクションはカーコネクティビティコンソーシアムで標準化されているため、すべての車とデバイスに共通の実装があります。

最高の体験のために、自動車メーカーは、リモートロックとロック解除だけでなく、適用されるすべてのリモートアクションを実装することをお勧めします。

リモートキーレスエントリーコントロールの仕組みを見てみましょう。

リモートコマンドをトリガーするために、デバイスは関連するアクションのチャレンジを要求し、デバイス署名を生成するための入力として使用されます。

車は、チャレンジ、関連するアクション、およびその他の情報に対してデバイスの署名を検証します。

検証が成功すると、車はアクションを実行し、デバイスに通知します。

デジタルカーキーを使用すると、どのデジタルキーが運転席のドアに近づいているかを観察することで、キャビンの温度、座席位置、座席暖房などの設定を自動的にパーソナライズできるようになりました。

今日の車のキーもパーソナライゼーションをサポートできますが、どのキーフォブにどのユーザー設定があるかを常に知っているドライバーに依存しています。

今、iPhoneやApple Watchの車のキーで、あなたはそれについて心配する必要はありません。

正確な軌道と、パーソナルデバイスが個々のユーザーに強く結びついているという知識と知識により、車はこれまで以上に自信を持って体験をパーソナライズすることができます。

そして、複数のユーザーが車に近づいている場合でも、これはシームレスに機能します。

要約すると、私たちはこれらの新機能に興奮しており、自動車メーカーがUWBベースの車を発売することを楽しみにしています。これにより、ユーザーはU1チップを搭載したiPhoneやApple Watchでこれらの機能を楽しむことができます。

さて、ギアをシフトして、自動車メーカーがAppleプラットフォームに乗船する方法と、カーキーソリューションを設計する際に重点を置きたい分野について話しましょう。

この議論の一環として、システムアーキテクチャ、時間同期、トランシーバ同期、および優れたローカリゼーションアルゴリズムの構築について説明します。

システムアーキテクチャから始めましょう。

パッシブエントリーソリューションは、信頼性が高く正確なローカリゼーションに依存しているため、システムが優れたパフォーマンスと低レイテンシを持っていることが不可欠です。

先に見たように、各車には複数のトランシーバーが装備されており、最初の決定の1つは適切なトランシーバーを選択することです。

まず、トランシーバーが十分なリンク予算を提供できることを確認する必要があります。

カーキープロトコルは双方向であるため、これは、良好なアップリンクとダウンリンクのパフォーマンスのためにTx放射電力とRx感度の両方を評価することを意味します。

アンテナの指向性を微調整することで、トランシーバーのアンテナが必要なカバレッジの視野全体を確実にサポートできます。

良好な動作範囲を達成するためには、アンテナの多様性が不可欠です。

たとえば、偏光または分離が異なる2つ以上のアンテナを使用すると、受信信号強度を向上させることができます。

最後に、3D飛行時間測定が非常に正確であることを確認する必要があります。

パッシブエントリーとローカリゼーション機能は、計算において飛行時間に依存しています。

したがって、精度は、アプローチ角度に関係なく、定義された範囲内にある必要があります。

適切に設計された個々のトランシーバーでさえ、車の周りのカバレッジが不十分な場合、または設置が不十分な場合は不要な領域でのカバレッジにつながる可能性があるため、必要なカバレッジを提供するために車の周りにトランシーバーを配置するための最良の位置を特定する必要があり、同時に、コストを抑えるためにトランシーバーの数を最小限に抑える必要があります。

高さと向きを必ず考慮してください。

一般的に、設置高さが大きければ大きいほど、フェージングポイントが遠くなり、範囲が向上します。

これは明らかに車の設計上の制約の範囲内で行わなければならない。

同様に、オリエンテーションが悪いと、車の上などの不要な領域でカバレッジやカバレッジのギャップが発生する可能性があります。

適切なトランシーバーと潜在的な位置を取得したら、次のステップはシステムのRFパフォーマンスを確認することです。

車の周りに設置されたトランシーバーの放射パターンを調べて、すべての側面に対称的なカバレッジを確保します。

また、システムでカバーされる最大範囲にも注意が必要です。

これは、ウェルカムライトやキャビンの事前調整など、長距離機能にとって重要です。

そして最も重要なことは、人体、チャネルシャドーイング、フェージング、またはその他の変数によって引き起こされる減衰に関係なく、ロック解除操作を確実に実行できるように、システムに十分なリンクマージンバッファがあることを確認する必要があります。

考慮すべきもう1つの分野は、システムのレイテンシです。

車に近づくと、BLE接続、認証、キー導出のセットアップから始まり、安全な範囲のセッションセットアップが続き、各UWBトランシーバーがスキャンを開始する複雑な一連のイベントが始まり、車はデバイスの位置を判断できます。

これらのタスクはすべて、ユーザーがドアを開ける前に完了する必要があります。

システムのレイテンシーを必要な範囲内に保つには、認証とキー管理のための高性能暗号プロセッサが必要です。

ECUを各トランシーバに接続するバスシステムは、低レイテンシでなければなりません。遅いバスは、システム操作のパフォーマンスに本当に影響を与える可能性があります。

最後に、マルチスレッドアプリケーションや時間同期の組み込みなど、最適化技術をサポートできる柔軟なソフトウェアアーキテクチャが必要になります。

では、時間の同期について簡単に話しましょう。

UWBトランシーバは、測距パケットを検出するために積極的にスキャンする必要があります。

適切な時間の同期がなければ、着信パケットを確実にキャプチャするには、長いスキャンウィンドウが必要です。

これは電力と処理時間を消費します。

システム全体に正確な時間同期を実装することで、各トランシーバは、着信パケットがいつ数十マイクロ秒の精度で予想されるかを知ることができます。

これらの時間枠の間にのみスキャンすることで、電力を節約し、マルチセッションや混雑した環境でのパフォーマンスを向上させることができるだけでなく、デバイスをより速くローカライズするのにも役立ちます。

トランシーバーをしっかりと同期させることで、最初に検出されたサイクルから成功を確実にすることで、それを行います。

もう1つの重要なテクニックは、トランシーバーの同期です。

場合によっては、一部のトランシーバが接続に失敗したり、同期しなくなったりすることがあります。

トランシーバ同期を実装することにより、デバイスと正常に同期されたトランシーバは、車内の他のトランシーバとタイミング情報を共有し、フルレンジサイクルを完了できなかった場合でも、すばやく接続したり、飛行時間を計算したりすることができます。

最後になりましたが、ローカリゼーションアルゴリズム。

パッシブエントリーソリューションを設計する際の最も重要なタスクの1つは、車に対して接近するデバイスの位置を特定できるローカリゼーションアルゴリズムの開発です。

ローカリゼーションアルゴリズムは、車のECUで実行されているコードです。

接続された各UWBトランシーバーからのデバイスの距離を収集し、それらを処理してiPhoneまたはApple Watchを宇宙に配置します。

これを行う方法はたくさんあります。

これの1つの簡単な例は、真の範囲のマルチラテレーションです。

ローカリゼーションアルゴリズムは、開発する必要があるソリューションの最も重要な部分の1つです。

したがって、ユーザーが車に近づくときにユーザーの軌道をたどるか、デバイスがキャビンの内側にあるか外側にあるかを判断するかにかかわらず、ローカリゼーションアルゴリズムが迅速かつ正確であることを確認する必要があります。

速度、精度、精度は、単一のトランシーバーベースのロック解除システムのサポートを追加する場合でも、優れたローカリゼーションソリューションの鍵です。

また、さまざまなキャビンタイプや車の物理的特性に合わせてローカリゼーションアルゴリズムを調整する必要があるかもしれません。

さて、あなたは車のキー機能がどのように機能するかを見ました。

開発に興味がある場合は、ソフトウェア開発と資格の有機的な進歩のために、次のワークフローをお勧めします。

まず、UWBの相互運用性に焦点を当て、仕様に従っていることを確認します。

これをテストするのに役立つツールを作成しました。

また、暗号操作を段階的に有効にできるため、段階的にシステムを開発できます。

次に、接続管理と所有者のペアリングのためにBLEレイヤーを統合します。

次に、パッシブエントリーに不可欠なセキュアレンジ管理に焦点を当てます。

最後になりましたが、遠距離で制御するためのリモートアクションをサポートします。

詳細を知りたい場合は、カーコネクティビティコンソーシアムに参加し、iPhoneとApple Watchでの作業に関する具体的な詳細については、MFiプログラムに登録することをお勧めします。

MFiプログラムは、開発を支援するための追加の文書やツールを入手できる場所です。

ありがとう、そして良い一日を!

[音楽]。