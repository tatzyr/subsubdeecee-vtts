10191

♪ベース音楽の演奏♪

♪

マックス・ステパノフ:こんにちは!私の名前はマックスで、tvOSチームのソフトウェアエンジニアです。

今日は、Apple TVのメディア再生UIのまったく新しい外観と、開発者として利用可能なこの新しい機能を最大限に活用するために何ができるかを皆さんと共有できることを嬉しく思います。

このセッションでは、tvOS 15の標準再生UIの機能強化の概要を説明します。新しいAPIを紹介します。最後に、アプリケーションで優れた再生体験を作成するのに役立つベストプラクティスについて説明します。

始めましょう。

AVPlayerViewControllerは、Apple TVのユーザーに標準的なメディア再生を提供します。

新しいクリックホイールリモコン、スキップ、スキャン、スクラブ機能、Siriコマンド、インタースティシャルサポートなど、さまざまなリモコンをサポートしています。

ユーザーがApple TVのファーストパーティアプリケーションと同様の体験をできるように、アプリケーションでAVPlayerViewControllerの使用を開始することをお勧めします。

AVPlayerViewControllerをまだ使用していない場合、またはリフレッシャーの恩恵を受ける場合は、WWDC 2019の「AVKitで直感的なメディア再生を提供する」を見ることをお勧めします。これは、AVPlayerViewControllerをアプリケーションに組み込む方法について詳しく説明します。

さて、今年導入する機能強化の概要を説明しましょう。

tvOS 15では、視聴者がより一貫性のあるインタラクティブな体験を通じてその瞬間にとどまるのを助けるために、標準の再生UIを完全に再設計しました。

トランスポートバーに関連するコントロールとオプションを追加することで、字幕をオンにしたり、オーディオ言語を変更したりするなど、一般的な再生タスクの見つけやすさが向上しました。

トランスポートバーコントロールは、本質的に普遍的であるだけでなく、アプリケーション固有のものでもあります。

また、新しいコンテンツタブを使用すると、ユーザーは情報やチャプターなどのサポート情報に簡単にアクセスでき、インラインナビゲーションにアクセスして検出可能にすることができます。

コンテンツタブは、関連するコンテンツを表示するためにも使用できます。

この例では、昨年のWWDCのセッションを見ていて、プレーヤーを離れることなくセッションのコンテンツの推奨事項を閲覧することができます。

最後に、再生中にユーザーが利用できるコンテキストアクションを追加しました。

これらのアクションには、Skip IntroやRecapなどの完璧な機能があります。

Apple TVの新しい再生UIを利用するには、アプリケーションをtvOS 15 SDKにリンクする必要があります。

私たちは、App Storeでユーザーが利用できる既存のアプリケーションとの互換性を維持するために、このアプローチを取りました。

これらのアプリケーションは、デフォルトのtvOS 14の再生UIと機能を取得します。

今では、メディアアプリケーションでこの新機能の一部を採用する方法を学ぶことに興奮しているでしょう。

では、tvOS 15の新しいAPIに飛び込みましょう...

...タイトルビューから始めます。

トランスポートバーのすぐ上に表示される新しいタイトルビューは、ユーザーが見ているものを即座に知るのに役立ちます。

タイトルビューを表示するには、現在のAVPlayerItemのメタデータからcommonIdentifierTitleとiTunesMetadataTrackSubtitleの値を使用します。

メディアアセットに埋め込まれたメタデータが含まれていない場合、またはそれを拡張する必要がある場合は、AVPlayerItemのexternalMetadataプロパティを使用してください。

ライブストリーミングコンテンツを再生する場合、タイトルビューには、視聴者にコンテンツの状態を示すバッジも表示されます。

最後に、アプリケーションがタイトルビューを表示したくない場合は、新しいプロパティtransportBarIncludesTitleViewの値をfalseに設定して、それを抑制します。

次に、トランスポートバーのコントロールを見てみましょう。

トランスポートバーコントロールは、トランスポートバースクラバーの真上にあるUI要素のコレクションです。

これらのコントロールは、ユーザーがアプリケーションが提供するすべての再生オプションを迅速かつ直感的に見つけるのに役立ちます。

字幕、オーディオ言語、ピクチャ・イン・ピクチャーなどの一部の標準コントロールは、システムによって提供されます。

開発者として、AVPlayerViewControllerの新しいプロパティであるtransportBarCustomMenuItemsを使用して、トランスポートバーコントロールのリストを拡張できます。

UIActionとUIMenuクラスのインスタンスをサポートしています。

トランスポートバーコントロールの使用例を見てみましょう。

ここでは、UIActionを使用して、ユーザーが現在のメディアアイテムをお気に入りに追加できるようにしています。

また、UIMenuクラスを使用して、アクションのより高度な配置を作成し、メニューに表示することもできます。

AVPlayerViewControllerによって提示されたUIMenusは、displayInlineオプションを使用して、最大1レベルのネストをサポートします。

UIMenuとUIActionクラスの使用の詳細については、WWDC 2019の「iOS 13のUIの近代化」を見ることをお勧めします。

では、コンテンツタブについて話しましょう。

コンテンツタブを使用すると、アプリケーションはより多くのコンテンツに関する補完的な情報や推奨事項を表示できます。

AVPlayerViewControllerは、メディアアセットに埋め込まれたメタデータが含まれている場合、またはAVPlayerItemで外部メタデータを補完する場合、情報タブを表示します。

また、navigationMarkerGroupsにAVPlayerItemを指定すると、AVPlayerViewControllerにチャプタータブが表示されます。

アプリケーションは、AVPlayerViewControllerの新しいプロパティであるcustomInfoViewControllersを使用して、追加のコンテンツタブを表示できます。

また、tvOS 15では、複数のビューコントローラを可能にする新しいプロパティを優先して、customInfoViewControllerプロパティを廃止しています。

コンテンツタブのサイズを適切に設定するには、preferredContentSizeプロパティを使用して高さを指定するか、適切な自動レイアウト制約を定義してください。

コンテンツタブを表示するために必要な高さを計算する場合、システムはすべてのビューコントローラーを最も高いコンテンツタブの高さにサイズ設定します。

複数のコンテンツタブで作業する場合は、カスタムビューコントローラーのサイズを一貫して設定するか、実行時にレイアウトが期待されていることを確認してください。

また、カスタムビューコントローラーにタイトルプロパティを設定することを忘れないでください。

コンテンツタブのタイトルに使用します。

見栄えの良いコンテンツタブを作成するために、今年はTVUIKitフレームワークに新しいコンテンツ構成を導入します。TVMediaItemContent ConfigurationとTVMonogramContent Configurationです。

これらの設定をコードでどのように使用できるかの例をいくつか見てみましょう。

たとえば、16:9のアスペクト比でメディアアイテムのリストを表示するには、TVMediaItem ContentConfigurationのワイドセルを使用できます。

画像、タイトル、セカンダリテキストなどのプロパティを設定します。

バッジと再生の進行状況を表示するように設定することもできます。

完了したら、contentConfigurationをコレクションビューセルに割り当てます。

それはとても簡単です。

現在のメディアコンテンツに関連付けられている人や文字を表示したい場合は、TVMonogramContentConfigurationを使用してください。

コンテンツ構成の使用の詳細については、WWDC 2020の「モダンセル構成」を見ることをお勧めします。

最後に、文脈上のアクション。

コンテキストアクションにより、アプリケーションは再生中に関連するコントロールを表示できます。

コンテキストアクションを表示するには、AVPlayerViewControllerの新しいcontextualActionsプロパティを使用し、1つ以上のUIActionsを提供します。

通常、アプリケーションは、コンテンツの関連セクション中にコンテキストアクションを表示したいと思うでしょう。

これを実現するには、周期的または境界時間オブザーバーを追加して、AVPlayerのタイミングを観察します。

コンテキストアクションを非表示にするには、プロパティを空の配列にリセットします。

アプリケーション内のスキップ機能のソリューションをすでに実装している人もいるかもしれません。

この新しいAPIを使用すると、コンテキストコントロールとのユーザーインタラクションはフォーカス動作と一致し、使用すると、アプリケーションの「再生中」ステータスも維持されます。

では、tvOS上のAVPlayerViewControllerのベストプラクティスについて話しましょう。

まず、そして最も重要なのは、プレイヤーに余分なジェスチャーを追加しないことです。

これは標準の再生UIに干渉し、将来的にはうまくいかないかもしれません。

第二に、不足しているメタデータを補足します。

時には、すべてのメタデータがアセットに組み込まれていないメディアがあります。

そのような場合は、AVPlayerItemのexternalMetadataプロパティを使用して、タイトル、アートワーク、説明など、すべての重要なメタデータを提供します。

そして、あなたがそうするとき、私たちはタイトルビューと情報タブにすべての関連情報を入力するために残りを行います。

最後に、tvOSアプリケーションでピクチャ・イン・ピクチャを有効にすることを検討してください。

ユーザーにマルチタスクの柔軟性を提供し、同時にビデオ再生を可能にし、フルスクリーンコンテンツとピクチャ・イン・ピクチャを切り替えることができます。

ピクチャー・イン・ピクチャーを始めるには、WWDC 2020の「Master Picture in Picture on tvOS」を見ることをお勧めします。

だから、要約します。

tvOS 15は、標準再生UIを使用して優れたメディア体験を構築することをこれまで以上に簡単にします。

強力な新しいAPIにより、AVPlayerViewControllerはこれまで以上に設定可能でカスタマイズ可能になります。

あなたのアプリケーションにそれを採用するのにこれほど良い時期はありません。

そして、始めるのは簡単です。

詳細については、開発者アプリのこのセッションの追加リソースを参照してください。

会議を見て楽しんでくれてありがとう。

♪