10231

♪ベース音楽の演奏♪

♪

ライアン・チャップマン:こんにちは、WWDCへようこそ。

こんにちは、私はライアン・チャップマンで、プロアクティブ・インテリジェンスチームで働いています。

今日は、意図的な寄付でアプリのプレゼンスを拡大する方法についてお話しします。

私たちのデバイスのオペレーティングシステムは、人々が日々使用するアプリとますます統合されています。

システムとアプリのこのコラボレーションは、ユーザーに超能力を与えるインテリジェントなシステム体験の中心にあります。

アプリがこのコラボレーションに参加し、システム全体でアプリのプレゼンスと機能を拡張できる主な方法の1つは、意図を寄付することです。

このセッションでは、意図的な寄付とは何かを定義し、意図的な寄付の生活を順を追って説明し、成功のために寄付を構造化し、最終的にシステム全体でアプリのプレゼンスを拡大する方法について話します。

先に進んで、意図的な寄付が何であるかを理解することから始めましょう。

3年前のiOS 12では、ショートカットを導入しました。

ショートカットを使用すると、アプリの機能をアクションとして公開できます。

彼らは、人々がオペレーティングシステム全体で新しい方法と場所であなたのアプリの機能を使用できるようにします。

これは、ユーザーを引き付け、アプリの範囲を超えてプレゼンスを拡大する本当に強力な方法です。

公開するすべてのアクションは、アプリの重要な機能を実行することで、加速的であるべきです。

つまり、ユーザーがすでにアプリでやりたかったことを取り、彼らがそれをさらに速く行うのを助けるべきだということです。

そして次に、あなたが公開するすべてのアクションは、反復可能であり、ユーザーにとって永続的な関心を持つものでなければなりません。

つまり、ユーザーが複数回やりたいことがあるはずです。

誰かが一度か二度したいと思うかもしれない何かのために行動を公開するのは良い考えではありません。

また、いつでもステートレスで実行可能なアクションのみを公開する必要があります。なぜなら、アクションが使用できるようになる前に、特定の状態にある誰かに頼ることはできないからです。

素晴らしいアクションを作るものの詳細については、WWDC 2021の「ショートカット、Siri、提案のための素晴らしいアクションをデザインする」というセッションを必ずチェックしてください。

したがって、公開するアクションを決定したら、ショートカットAPIをチェックする準備が整いました。

アプリのショートカットを採用するために使用できるAPIは2つあります。

1つ目はNSUserActivityです。

NSUserActivityは、アプリの状態を表す軽量な方法であり、SpotlightやHandoffなどの他のApple機能と統合されています。

そして2つ目は意図です。

インテントは、アプリが実行できるアクションの種類を詳細に表現する方法であり、Siriには、システムと統合するために使用できるさまざまな機能をサポートする多くの優れた組み込みインテントが含まれています。

インテントは、ショートカットで使用するための独自のカスタムインテントを定義する機能もサポートしています。

APIとアプリにショートカットを採用する方法の詳細については、WWDC 2018の「Siriショートカット入門」セッションを必ずご覧ください。

このセッションでは、インテントに焦点を当て、システム全体でアプリの機能を提供するための新規および既存の機会について説明します。

意図の寄付を行うための最初のステップは、どのような意図を採用するかを決定することです。

Siriには、メッセージング、予約、メディアなど、多くの素晴らしい組み込みの意図が含まれています。

Xcode for Shortcutsでカスタムインテントを定義する機能もあります。

したがって、構築したいアクションがデフォルトの組み込みのSiriKitインテントの1つに対応する場合は、それを採用する必要があります。

しかし、それ以外の場合は、Xcodeのインテント定義ファイルを使用して独自の定義を定義できます。

どの意図を採用するかを決定し、アプリで定義したら、意図的な寄付を開始できます。

意図的な寄付は、人がアプリでアクションを実行したときにシステムに伝える行為です。

システムはこれらの寄付を保存し、それらを使用して、システム全体でアプリの機能とプレゼンスを拡大します。

意図を寄付するアプリは、提案、ショートカット、フォーカス、スマートスタック、Siriなど、システム全体の場所に表示されます。

意図的な寄付が何であるかを高いレベルで理解したので、例を使って意図的な寄付の生活を通して、これをより具体的にしましょう。

天気アプリで天気をチェックする例を使ってみましょう。

このアプリでは、特定の場所の天気をチェックすることは、アクションを公開したいアプリの重要な機能です。

このアプリにはすでに既存のウィジェットがあり、私の意図を使って設定可能にしたいので、誰かがウィジェットで天気を見たい都市を選択することができます。

先に進んで、天気の意図を確認する方法、システムに寄付する方法、およびシステムが寄付をどのように使用するかを学びましょう。

Xcodeでインテントを定義する最初のステップは、インテント定義ファイルを作成することです。

これを行うには、新しいファイルを追加します...

...そして、SiriKit Intent Definition Fileを選択します。

次に、カスタムインテントを使用するターゲットを選択し、インテント定義ファイルを作成することを確認します。

インテント定義ファイルが作成されたら、インテントを定義できます。

天気をチェックするための既存の組み込みシステムの意図がなかったので、先に進んで新しい意図を追加することができます。

私は意図を「天気をチェック」と呼びます。

ここから、私は意図を定義し始めることができます。

このインテントをアプリの既存のウィジェットの構成として機能させたいので、「インテントはウィジェットの対象です」オプションをチェックすることから始めます。

このシステムは、私の意図的な寄付を使用して、スマートスタックウィジェットのインテリジェンスを強化することもできます。

ショートカットアプリもサポートしたい場合は、「ショートカットアプリでインテントがユーザー設定可能で、Siriに追加」オプションをチェックしてください。

このデモでは、このオプションのチェックを外し、ウィジェットと提案に焦点を当てます。

また、システムが私の意図のためにSiriの提案を表面化するために私の寄付を使用したいので、「意図はSiriの提案の対象です」オプションもチェックしたままにします。

次に、私の意図のパラメータを定義する必要があります。

天気をチェックする場所のパラメータを1つだけ定義できます。

次に、パラメータのタイプを選択する必要があります。

この場所は、アプリが天気を持っている都市に対応する私のアプリ内のオブジェクトを表すので、このパラメータを表すためにカスタムタイプを使用します。

先に進んで、識別子とdisplayStringを持つ都市のカスタムタイプを作成できます。

位置パラメータに戻りましょう。

場所のタイプが新しいカスタムシティタイプであることがわかります。

この意図をウィジェットの設定に使用したいので、ユーザーがウィジェットの値を編集できるようにするオプションを維持します。

このインテントは、このデモのSiriでの実行をサポートしていないため、「Siriは実行時に値を尋ねることができます」オプションのチェックを外します。

人々がウィジェットを設定すると、天気の場所のリストはアプリによって提供される必要があり、その人が保存した都市によって変更されるため、「オプションは動的に提供される」チェックボックスをオンにします。

最後に、提案のためにサポートされているパラメータの組み合わせを定義する必要があります。

システムは、インテント定義ファイルを読み取り、アプリが予測のためにサポートするインテントとパラメータの組み合わせを決定します。

この場合、アプリはロケーションパラメータが設定されたインテントをサポートします。

先に進み、そのパラメータをサポートされている組み合わせとして追加します。

次に、提案に示されている要約を定義します。

そして、それだけです。

ウィジェットや提案で使用できる天気をチェックするカスタムインテントを定義しました。

意図が定義されたので、誰かがアプリで特定の場所の天気をチェックするたびに、システムに意図を寄付する必要があります。

インテントを寄付するには、インテントクラスのインスタンスを作成し、そのパラメータ値を設定します。

インテントを作成した後、INInteractionオブジェクトのインスタンスを作成し、インテントを渡し、インタラクションオブジェクトのdonateメソッドを呼び出してインテントをシステムに寄付します。

舞台裏では、システムは、意図が寄付されたときに人がいた文脈とともに、時間の経過とともにこれらの寄付を保存します。

彼らが天気アプリで天気をチェックし続けるにつれて、アプリは意図的な寄付を続けています。

この場合、彼らはクパチーノとサンディエゴの天気をチェックしています。

システムは、インテントパラメータを使用して、インテントが同等であるかどうかを判断します。

寄付の色が示すように、2つのクパチーノの寄付は同等であり、2つのサンディエゴの寄付とは異なります。

実際には、システムはその人のデバイス上の他の多くのアプリからも寄付を受け取ります。

いつでも寄付を削除したい場合は、削除APIを使用して、単一の寄付または寄付のグループを削除できます。

たとえば、誰かが保存された天気の場所からサンディエゴの天気の場所を削除した場合、サンディエゴの場所に関連する意図を削除できます。

人々があなたのアプリで関連性のない行動の提案を受け取らないように、寄付を削除することが重要です。

インテントを寄付するとき、INInteraction識別子とグループ識別子を使用して、後で寄付した1つ以上のINInteractionを削除できます。

識別子の配列を渡して個々のインタラクションを削除するか、グループ識別子を渡してインタラクションのグループを削除することができます。

では、これらの意図的な寄付はすべてシステムによってどのように使用されていますか?

システムが数日間にわたって見る寄付履歴を高レベルで見てみましょう。

ここでは、人への3日間の寄付と、彼らが目を覚ましたときから始めて、1日を通して行われた寄付を見ることができます。

このシステムは、機械学習とオンデバイスインテリジェンスを使用して、データ内のパターンを見つけ、人の現在の状況と過去の行動パターンを考慮して、どのような意図が関連するかを予測します。

この場合、この人が目を覚ました後に天気をチェックすることに関連するパターンを持っていることがわかります。

デバイス上のインテリジェンスは、ユーザー向け機能と統合され、アプリの機能とプレゼンスをユーザーに公開します。

この露出がどこで行われるかの例をいくつか見てみましょう。

その前に、すべての機械学習とインテリジェンスがプライバシーを保護する方法でデバイス上で実行されることは注目に値します。つまり、Appleはユーザーを個人的に識別するために使用できるデータを収集しません。

そう言っても、天気の例に戻りましょう。

定義した意図を使用して、アプリの既存のウィジェットを設定可能にすることができます。

インテントを使用するようにウィジェットを設定した後、人々はウィジェットで天気を見たい場所を選択することができます。

ウィジェットの設定意図に一致するアプリの寄付インテントにより、システムはアプリのスマートスタックウィジェットインテリジェンスを人々に提供できるようになりました。

スマートスタックでホーム画面の設定をしている人がいるとしましょう。

iOS 15の新機能であるスマートスタックはウィジェットの提案をサポートしています。これにより、システムは、ユーザーがスタックに持っていないウィジェットを適切なタイミングでスタックの上に配置することで提案できます。

ウィジェットを提案する必要があるかどうかと提案を行う正しい時間を決定するために、システムはウィジェット構成の意図に合った意図の寄付を活用します。

天気の例では、人が目を覚ました後、スマートスタックはちょうど良いタイミングで天気ウィジェットをスタックの一番上に配置しました。

これは、人々があなたのウィジェットを発見し、 glance可能な情報を提供するための素晴らしい方法です。

すでにスタックにウェザーウィジェットがあれば、代わりにウェザーウィジェットに回転していただろう。

ウィジェットに構成とインテリジェンスを追加する方法の詳細については、2020年のWWDCセッションをご覧ください。

あなたの意図的な寄付は、ロック画面、スポットライト検索、Siri提案ウィジェットに表示されるSiri提案の背後にあるデバイス上のインテリジェンスにも電力を供給します。

これらの提案により、人々はワンタップでアプリの主要な機能を実行できます。

インテントは、macOS、iOS、watchOSのシンプルまたは複雑なマルチステップショートカットの一部として、組み込みのショートカットアプリでも使用できます。

また、寄付は、ショートカットアプリギャラリーで人々に提案されるアクションを決定するためにも使用されます。

また、Siriに尋ねるだけで、音声ショートカットを設定してカスタムインテントを実行することもできます。

組み込みのINSendMessageIntentを使用することを選択した場合、インテントの寄付は、ユーザーが自分にとって最も重要な人々やグループにコンテンツを簡単に入手できるようにするための提案を共有するために使用されます。

iOS 15の新機能、INSendMessageIntentsを寄付する場合、システムは寄付者を使用して、誰がユーザーの現在のフォーカスに強く関連しているかを判断します。

これらの強力な関連付けは、特定の人々をメッセージを受け取ったときに許可された通知リストに追加するための提案をするために使用できます。

この場合、Agaは、このユーザーがAgaとの過去のやり取りに基づいて、Work Focusの許可された通知リストに追加することを検討すべき人として提案されていることがわかります。

組み込みのINGetReservationDetailsIntentを使用することを選択した場合、インテントの寄付は、現在の交通状況に基づいてレストランの予約のために出発する時期と、フライトにチェックインする時期をユーザーに通知するために使用されます。

マップを開くとSiriの提案も表示されるので、ワンタップで空港への道順を調べるのにとても便利です。

iOS 15の新機能、組み込みのINPlayMediaIntentを使用することを選択した場合、インテントの寄付は、ロック画面、コントロールセンター、ホームアプリの新しい再生中UIに表示されます。

これは、ユーザーがアプリからお気に入りのコンテンツを聴いたり見たりするための素晴らしい方法です。

人々は、ポッドキャスト、テレビ番組、映画などの定期的なメディアコンテンツをアプリで消費する可能性があります。

このような場合、INUpcomingMediaManager APIを使用して、ユーザーが聴いたり見たりしていないコンテンツのメディアインテントのリストをシステムに提供することができるので、興味があるかもしれません。

このシステムは、過去のメディアの寄付とアプリの今後のメディアを組み合わせて、より良いメディアの提案を行います。

INRelevantShortcut APIを使用して、Siri Watch Faceにインテントを表示することもできます。

INRelevantShortcut APIを使用すると、ショートカットを時計の文字盤に表示する時間や場所など、関連性情報をシステムに公開できます。

Siriウォッチフェイスでショートカットを公開する方法の詳細については、2018年のWWDCセッションの「SiriウォッチフェイスのSiriショートカット」をご覧ください。

iOS 15の新機能では、WidgetKindプロパティがINRelevantShortcutオブジェクトに追加され、対応するウィジェットをスマートスタックに表示するタイミングをシステムにヒントに示すことができます。

このプロパティとその使用方法の詳細については、WWDC 2021の「ウィジェットにインテリジェンスを追加する」セッションをご覧ください。

要約すると、私たちは意図の寄付の生活を見て、スマートスタック、フォーカス、提案、ショートカット、Siriなどのますます多くの場所にシステム全体でアプリのプレゼンスと機能を拡大するためにそれらがどのように使用されているかを見ました。

意図的な寄付の生活を見て、成功のために寄付を構造化し、最終的にシステム全体でアプリのプレゼンスを拡大する方法について、より詳細に話しましょう。

コーヒーアプリでコーヒーを注文する新しい例を使ってみましょう。

これまでのところ、私は注文コーヒーの意図を定義し、コーヒーのサイズとコーヒーアイテムの2つのパラメータを公開しました。

この場合、大きなアイスラテがあります。

意図的な寄付に注文日を含めると、何がうまくいかないのかを見てみましょう。

2021年6月7日に大きめのアイスラテの寄付が入ってくるので、順調に始まります。

しかし、日付が変更されると、意図の日付パラメータは新しい値を持ち、システムは、両方の寄付が同じアイテムとサイズを持っているにもかかわらず、2回目の寄付をまったく異なる意図として扱います。

このシステムは、時間の経過とともに寄付を異なる方法で扱い続けており、寄付の色に基づいて、日ごとに同等ではないことがわかります。

システムが数日間にわたって見る寄付履歴の高レベルのビューを見ると、システムが大きなアイスラテを注文するために見つけることができる意味のあるパターンがないことがわかります。

何がうまくいかなかったのかを理解するために、意図定義ファイルにどのように記入したかを見てみましょう。

アイテム、サイズ、日付の3つのパラメータを定義しました。

そして、3つのパラメータすべてでサポートされているパラメータの組み合わせを追加しました。

これは、3つのパラメータすべてを使用して、予測のための意図的な寄付のパターンを見つける方法を決定する必要があることをシステムに伝えます。

この場合、サポートされているアイテムとサイズの組み合わせに日付を含めることで、システムは寄付全体のパターンを適切に見つけることができませんでした。

この問題を解決するために、代わりにサイズとアイテムのパラメータのみを含むサポートされている組み合わせを定義できます。

これにより、システムは、意図的な寄付を比較して時間の経過とともにパターンを見つけるときに、アイテムとサイズのパラメータのみを使用する必要があることを知っています。

今、システムには、日付を含まない大きなアイスラテの寄付が表示されます。

そして2日目に、システムは大きなアイスラテの同等の寄付を見ます。

そして3日目も同じです。

寄付履歴の高レベルのビューをもう一度見ると、目が覚めた直後に大きなアイスラテを注文することに関連するパターンがあることがわかります。

寄付の利益を最大化するために、意図的な寄付が繰り返される可能性が高く、寄付する意図のペイロードが寄付全体で一貫していることを確認してください。

つまり、タイムスタンプを含めないということです。

要約すると、システムは私たちが日々使用するアプリとますます統合されており、意図的な寄付は重要な統合ポイントです。

システム全体にアプリの機能とプレゼンスを拡大することで、意図を寄付することで利益を得ることができます。

聞いてくれてありがとう、WWDC 2021の素晴らしい残りをお過ごしください。

♪