10062

♪ベース音楽の演奏♪

♪

Mathieu Tozer: こんにちは、私はMathieu Tozerで、macOS SwiftUIチームのエンジニアです。

SwiftUIは、その中核となるマルチプラットフォームフレームワークであり、どこでも素晴らしいアプリを簡単に構築できるようにすることを目的としています。

新しいコンセプトやAPIに近づくときは、一歩下がって、各プラットフォームがその機能に何を期待しているかを検討します。

SwiftUIの素晴らしい点は、そのAPIと概念がすべてのプラットフォームに適用されることです。この講演では、それらがMacのためにどのように微調整されているかを紹介します。

これはコードアロングで、スケルトンプロジェクトをダウンロードして、私と一緒にMacアプリを書きます。

始める前に、アプリの作業中に参照する素晴らしいMacアプリに入る重要な原則のいくつかを見てみましょう。

これらは柔軟で、親しみやすく、広大で、正確です。

Macアプリは柔軟性があり、私たち一人一人が個別にそれらを使用する方法に適応します。

これは、キーボード、マウス、トラックパッド、スイッチコントロール、さらにはiPadからMacを物理的に使用する方法から始まり、ソフトウェア自体にまで及びます。

テーブルの列、サイドバー、詳細パネル、表示モード、ウィンドウを最適な方法で調整することで、ワークフローをカスタマイズでき、インターフェイスが適応します。

そして同時に、Macアプリは馴染みがあります。

システムと一致するコントロールとデザインパターンを使用すると、共通の視覚言語のおかげで、アプリがすぐに親しみやすくなります。

たとえば、ファイルメニューは、私が常に新しいものを作成するために到達する場所であり、検索バーはすべてのアプリツールバーに一貫した外観を持っています。

ウィンドウの領域をゾーニングし、ナビゲーションと階層をサイドバーに、コンテンツを中央に、ユーザー機能を上部と右側に配置することで、アプリをより親しみやすくすることができます。

しかし、その一貫性は、アプリがユニークで目立つ余地を残すことができます。

アプリのアクセントカラーなど、カスタマイズを追加できます。

また、カスタムコントロールが必要な場合は、システムコントロールに適合するように設計する必要があります。

Macアプリは広大です。

大型で、多くの場合、複数のディスプレイは、ドリルインスタイルのナビゲーションスタックに隠されることなく、より多くの情報を画面上に整理できることを意味します。

具体的には、アウトラインビューとサムネイルプレビュー付きのサイドバー、一時的な要素のポップオーバー、コントロールのペインを切り替えるタブ、コンテンツを表示するディスクロージャーグループなどのコントロールを使用することを意味します。

最後に、Macアプリは正確です。

彼らは大きなウィンドウを持っているだけでなく、彼らのビューはまた、コンテンツとコントロールの高密度をもたらすより狭い余白と間隔を持っており、これらのコントロールはマウスポインタで使用するように設計されています。

とはいえ、密度の増加は複雑さを増大させる必要はありません。シンプルで単一の目的を果たすアプリは、依然として素晴らしいMacアプリです。

あなたはおそらく、お気に入りのMacアプリからこれらのアイデアを認識するでしょう。

次に、これらのアイデアを実際に適用します。

私はあなたと一緒にMacアプリを作るつもりです。

ここで一時停止を押して、このセッションの開始点と終了点を含むプロジェクトをダウンロードします。

私はガーデニングが本当に好きです。

何年にもわたって私の庭を追跡するための専用アプリがあれば素晴らしいと思います。

私たちはMac用にこのアプリを構築するつもりです。

柔軟なウィンドウや高い情報密度などのプラットフォーム機能を活用し、macOSで素晴らしい方法でアプリのデータを本当にやり取りできるようにします。

左側には、すべてのガーデンプロジェクトのアウトラインビューを示すサイドバーがあります。

庭を選択して、テーブルビューまたはギャラリーですべての植物の詳細を見ることができます。

このアプリの実装を始めましょう。

スタータープロジェクトでSession1.workspaceを開きます。

私たちは植物の配列を含む庭の構造を持っており、私たちをスピードアップするためにいくつかのビューとヘルパーを持っていますが、私たちはContentViewで開始します。

サイドバーを折りたたんで、Xcodeのプレビューのためのスペースを作るつもりです。

私たちのMacアプリは2列のレイアウトになります。

このテキストビューをNavigationViewに埋め込みます。

パディングを削除して、テキストをサイドバーに変更します。

2番目の列は、私たちの植物テーブル用です。

この平坦化された階層は、Macの大画面での広範なナビゲーション体験のための強固な基盤を提供します。

サイドバーに行きましょう。

Commandキーを押しながらクリックすると、このビューを独自のサブビューに抽出し、名前を「サイドバー」に変更します。

私は自分の店にアクセスする必要があります。

そして、今年の私の庭のリストを見せたいです。

そして、葉のシステムイメージでラベルに各庭の名前を表示します。

どの庭園が最新であるかを確認し、歴史を独自のセクションに配置し、詳細表示三角形をクリックして表示するものを正確に制御できるようにしたいと思います。

複雑さを管理するための使い慣れた方法を提供しながら、ナビゲーションシステムをさらに平坦化するDisclosureGroupを使用します。

リストをForEachに変更し、Commandキーを押しながらクリックすると、リストに埋め込むことを選択できます。

反復するコンテンツはすでに定義されているので、それをクリアすることができます。

さて、この式は以前と同じですが、これでForEachをDisclosureGroupに埋め込むことができます。

そして、systemImageの場合、まあ、これは少し一口ですが、ここに行きます。

Chart.bar.doc.horizontal画像を使用します。

オーケー、いいね。私は自分の庭をアウトライン構造で整理し、私が見るものを制御する柔軟性を与えてくれます。

しかし、現在のグループをデフォルトで開いて、アプリを開くたびに拡張状態が持続するようにしたいので、アプリをより身近にします。

expansionStateを保存するには、サイドバーにプロパティを追加します。

@SceneStorageプロパティラッパーで注釈を付け、expensionStateのキーを提供します。

これは、アプリが終了したときにこのプロパティをオフロードし、ウィンドウが復元されたときにリロードするようにSwiftUIに指示します。

今、私は今年のディスクロージャーグループにバインディングを渡します。

...そして今、現在のグループが拡大されています。

サイドバーが少しきついと思うので、最小幅を設定するだけです。

セクションに履歴を表示し、先ほど作成したGardenHistoryOutlineビューを使用します。

私もその拡張状態を渡します。

私の貧しい植物が水を必要とするときに強調するためにバッジを追加するつもりです。

OK、右側の詳細を見るには、選択を追加する必要があります。

選択した庭のIDにバインディングを追加します。

そして、その選択をリストへの拘束力として提供できます。

サイドバーの親であるContentViewは、値を保持し、サイドバーとテーブルにバインディングを渡します。

だから私もこれをここにコピーして、実行の合間に持続するように@SceneStorageにポップするつもりです。

そして、サイドバーにも渡します。

私のサイドバーは良さそうだと思います。

ディスクロージャーの三角形で表示されるものを制御でき、Macが再起動すると、そのままに復元されます。

私たちは今、GardenDetailビューから始めることができます。

選択にもバインディングが必要です。

そして、Commandキーを押しながらクリックすると、ビューの定義にジャンプできます。

このビューには、すでにストアのプロパティと、まもなく使用する他のプロパティが含まれています。

また、庭の名前と年をナビゲーションタイトルとサブタイトルとして表示するように設定されています。

詳細ビューの独自の変数でテーブルを実装し、ここで本文から使用します。

庭の植物のリストを表示することから始めましょう。

他の植物のプロパティを水平スタックビューで表示できますが、表示するデータがたくさんあり、その多くはテキストです。

また、植物をアルファベット順または植えた順に並べ替える機能を追加したいと思います。

これらの理由から、植物をテーブルに表示します。

テーブルは、画面スペースをうまく活用して、広範なUIでデータを表示、フィルタリング、並べ替え、編集する正確な方法を提供します。

一般的に、表示する視覚的な要素があり、複雑なソートを必要としない場合は、リストを使用してください。

それ以外の場合は、複数の列が必要な場合は、テーブルを検討してください。

リストをテーブルに置き換え、各行を分割するためのいくつかの列を提供します。

そして、それと同じくらい簡単に、私は単一の列を持つテーブルを持っています!

では、さらにいくつかの列を追加しましょう。

各植物が成長するのにどれくらいの時間がかかるか知りたいので、そのための列を追加します。

重要なパスを提供する代わりに、TableColumnのコンテンツクロージャを開き、植物を手渡します。

これで、ここで好きなビューを提供できますが、daysToMaturityプロパティは整数なので、フォーマットされた文字列でテキストビューを提供します。

私はたくさんの植物を持っていて、いつももっと植えています。

行を選択して並べ替えることができることは、植物を整理しておくのに役立ちます。

したがって、まず選択範囲にバインディングを追加できます。

テーブルをソート可能にする場合は、sortOrderバインディングと各列へのキーパスを提供する必要があります。

そのため、daysToMaturity列にキーパスを追加する必要があります。

テーブルのパワーを本当に曲げるために、ViewsフォルダのTableColumnsファイルからさらにいくつかの列を貼り付けましょう。

彼らは私たちにいくつかの重要な日付を設定し、お気に入りとして植物にフラグを立てます。

とりあえずプレビューをオフにして、アプリを実行します。

このすべての植物データを見てください!

行を選択でき、列ヘッダーをクリックして並べ替えることができます。

これは素晴らしいことですが、今は、テーブルに新しい植物を追加したり、複数の植物に水やりとしてマークしたりするなど、庭を管理するために必要な多くの基本的なアクションを実行する方法がありません。

ツールバーは、この種のアクションに馴染みのある場所です。これは、macOSユーザーがアプリの使用方法を発見できる標準的な場所です。

植物を追加するボタンから始めて、ここにツールバーを追加できます。

「Add Plant」と「plus」というタイトルのラベルを付けます。

私は構築して実行するつもりです、そして今、私は私のテーブルに植物を追加することができます!

アプリのインターフェースのカスタマイズは、庭の表示方法など、ツールバーにも表示できます。

ここにDisplayModePickerを追加できます。

私はたくさんの植物を持っていますが、それらを注文することができますが、迅速かつ正確に行数を絞り込むのは素晴らしいことです。

私たちは常にMacのハードウェアキーボードにすぐにアクセスできるので、検索可能な修飾子をテーブルに追加し、searchTextにバインディングを渡します。

searchTextは、テーブルに渡される植物配列をフィルタリングするために使用する詳細ビューのプロパティです。

そして、検索フィルタリングを追加するために必要なのはそれだけです!

窓の構造が設定されていますが、野菜パッチと裏庭の花壇を同時に見たいです。本当に見たいです。

さて、私たちはすでにこの能力を持っていることがわかりました。

ファイルメニューから新しいウィンドウを開くことができ、各ウィンドウには独自の選択とサイドバーの展開状態があります。

もちろん、各ツールバーは独自のウィンドウに属しているので、野菜パッチや花壇に植物を追加できます。

私の植物は定期的に水をやる必要があります。

植物を並べ替えてろ過し、いくつかの行を選択し、一度に散水済みとしてマークできるようにしたいです。

これらのアクションを実行するためのコマンドをmacOSのメインメニューに追加します。

メニューは、検索することさえできるおなじみのUIであり、人々があなたのアプリを探索するのに役立ちます。

カスタムコマンドを追加する前に、システムが提供するコマンドを追加することから始めましょう。

GardenAppファイルに移動します。

WindowGroupにコマンド修飾子を追加し、SidebarCommands()を追加します。

これで、サイドバーは[表示]メニューまたはキーボードショートカットで切り替えることができます。

今、私たちのカスタムコマンドのために。

メインメニューフォルダでPlantCommandsファイルを開きます。

一番前の窓の庭にアクションを送信できるようにしたいので、庭の変数が必要です。

@FocusedBindingプロパティラッパーを使用して、FocusedValuesの拡張機能で定義したカスタムプロパティへのキーパスを渡します。

植物コマンドメニュー項目は、どの植物がテーブルで選択されているかを知る必要があるため、散水済みとしてチェックできるため、選択も渡す必要があります。

本体に移動すると、コマンドがビューと同様に宣言されていることに気付くでしょう。つまり、独自のコマンドを作成し、メニューを表すコマンドのカスタムツリーを構築できます。

まず、追加の植物アクションです。

これで、すでにツールバーから植物を追加できますが、メインメニューにはアプリが実行できるすべてのアクションが含まれているはずですが、ツールバーは通常、便宜上いくつかのサブセットにすぎません。

これは何かを作るためのアクションなので、おなじみの場所に置きます。

CommandGroupを使用して、ファイルメニューのnewItemの前に配置します。

私の散水アクションのために、私はそれを「植物」と呼ばれる新しいCommandMenuに入れたいです。

これは、アプリの表示メニューの横に表示されます。

これらのビューには、単に庭を変異させるボタンと、ボタンの動作を定義する修飾子が含まれています。

複数のウィンドウがありますが、メニューバーは1つしかありません。

花壇にニンジンを入れたくないので、メニューはどの庭にアクションを送るべきかをどうやって知ることができますか?

GardenDetailビューに戻って、フォーカスされたSceneValue修飾子をテーブルに追加し、キーパスとバインディングを渡します。

選考にも同じことをします。

これは、シーン全体がフォーカスされているときに、指定されたキーパスのこれらの値を公開するようにシステムに指示します。

最後に、GardenAppファイルでは、先ほど追加したSidebarCommands()の後に新しいコマンドを追加する必要があります。

SwiftUIは、それらをメインメニューに追加することを知っています。

メインメニューから一番前の窓の庭に植物を挿入できるようになりました。

また、水やりとしてマークする必要がある植物を選択し、植物メニューから選択することもできます。

すべてのアプリのアクションにメニューを追加すると、キーボードショートカットを有効にし、アプリで物事を成し遂げるためのさまざまな方法を提供することで、アプリの柔軟性が向上します。

また、アクションの発見可能性を支援し、人々がアプリの機能を探求し、発見できるようにします。

そういえば、パート2では、アクセントカラー、テーブル間のドラッグアンドドロップ、iOSデバイスで植物の写真を撮って添付する方法など、ジェフと一緒にアプリにより多くの機能と磨きを追加します。

今日は多くのことを取り上げました。

SwiftUIを使用してMacアプリのインターフェースを一から構築し、各コンポーネントが優れたMacアプリを作ることができるものにどのように貢献するかを示しました。

見てくれてありがとう!

♪