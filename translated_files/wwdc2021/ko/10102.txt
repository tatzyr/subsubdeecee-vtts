10102

안녕.

난 신디 클라리사야.

저는 Core Location의 소프트웨어 엔지니어입니다.

오늘, 나는 올해 Core Location에 대한 멋진 새로운 것들에 대해 이야기할 것이다.

우리는 많은 권한을 부여할 필요가 있는 사람들에 직면하지 않고도 앱에서 위치 기반 기능을 강화할 수 있는 두 가지 새로운 기능을 도입하고 있습니다.

첫 번째 기능을 시작으로, 우리는 지역 기반 사용자 알림을 watchOS 8에 가져오고 있습니다.

이제 Apple Watch 앱은 사람들이 체육관에 도착했을 때 운동을 시작하거나 집에 도착했을 때 개에게 먹이를 주도록 상기시킬 수 있습니다.

예를 들어, 여기에 이 새로운 기능을 사용하여 사람들이 공항에 도착했을 때 항공편에 대해 알리기 위해 Air 앱이 있습니다.

지역 기반 사용자 알림을 통해 시스템은 "항상" 권한 없이 앱을 대신하여 공간적으로 관련된 정보를 제공할 수 있습니다.

watchOS에 대한 지역 기반 사용자 알림을 채택하는 방법에 대해 자세히 알아보려면, "watchOS의 새로운 기능" 세션을 확인하세요.

이제 이 세션의 주요 주제에 대해 이야기해 봅시다.

우리는 사람들이 데이터를 더 잘 제어할 수 있지만 동시에 앱에 더 많은 기능을 제공하는 위치를 요청하는 새로운 방법을 도입하고 있습니다.

저는 오늘의 위치 허가 상태와 우리의 새로운 기능 뒤에 있는 동기에 대해 이야기하는 것으로 시작하겠습니다.

iOS 14에서 앱이 위치 인증을 요청할 때, 초기 프롬프트가 나타나고 사람들은 한 번 허용, 사용 중 또는 승인하지 않음 중에서 선택할 수 있습니다.

그리고 작년의 새로운 기능으로, 사람들은 당신의 앱으로 전송되는 위치의 정확성을 제어할 수 있습니다.

여러분 중 일부는 사람들이 앱에서 한 번 허용을 선택하는 것을 눈치챘을 수도 있으며, 앱에 사용 중 인증이 필요하다고 생각하지 않을 수도 있습니다.

예를 들어, 애완동물 가게 앱은 가장 가까운 애완동물 가게를 결정하기 위해 위치 승인을 요청할 수 있지만, 다른 고양이 사료 옵션을 검색할 때는 위치가 필요하지 않습니다.

이 경우, 이 앱을 사용하는 사람들은 한 번 허용하거나 권한을 허용하지 않는 것을 선택할 가능성이 더 높을 수 있습니다.

사람들이 한 번 허용을 선택하면, 우리는 그들이 당신의 앱을 사용하는 기간 동안 위치 권한을 부여할 것입니다.

하지만 당신의 앱은 백그라운드에 들어갈 때 인증을 잃게 될 것입니다.

이것은 여러 위치 인증 요청으로 이어질 수 있으며, 이는 사용자 경험에 부정적인 영향을 미칠 수 있다.

또 다른 경우, 프롬프트에 지친 사람이 프롬프트가 다시 표시되지 않도록 허용을 선택할 수 있다는 것을 알 수 있습니다.

이로 인해 나중에 위치를 승인하기 위해 사람들을 설정으로 보내야 할 수도 있습니다.

개인 정보 보호가 계속해서 애플의 중요한 우선 순위이기 때문에, 우리는 "어떻게 하면 사용자 경험을 방해하지 않고 더 많은 통제를 제공할 수 있을까?"라고 생각했습니다. 필요한 순간에만 위치를 승인할 수 있는 쉽고 친근한 방법을 제공할 수 있나요?

iOS 15부터, 우리는 내가 언급한 문제점을 해결하기 위해 UIKit용 CLLocationButton과 SwiftUI용 LocationButton을 도입하고 있습니다.

여기, 근처에 가장 가까운 공원을 찾을 수 있는 파크 파인더 앱이 있습니다.

하단에는 화살표 글리프 옆에 "현재 위치"라는 제목의 파란색 위치 버튼이 있습니다.

버튼을 누르면, 파크 파인더는 내 현재 위치를 확인하고 근처의 모든 공원의 지도 보기를 보여줄 수 있다.

왼쪽 상단의 위치 화살표는 방금 부여한 권한에 대해 사용자의 주의를 끌기 위해 파란색으로 바뀝니다.

주목해야 할 한 가지는 위치 버튼이 실제로 사람들이 매번 프롬프트를 거치지 않고 앱에 Allow-Once 권한을 부여하고 있다는 것입니다.

나중에, 이것이 당신의 기존 승인 상태에 어떤 영향을 미칠지 검토하겠습니다.

우리는 위치 버튼을 watchOS, iOS, Catalyst가 있는 macOS 및 Mac의 iPad 앱에 가져올 것입니다.

이제, API와 앱에 CLLocationButton을 추가하는 방법에 대해 알아봅시다.

CLLocationButton은 CoreLocationUI 프레임워크의 일부입니다.

UIButton과 마찬가지로, CLLocationButton은 UIControls에서 파생되었다.

그래서, 당신은 버튼으로 UIControl 기능을 사용할 수 있습니다.

게다가, 우리는 우리의 버튼에 특정한 네 가지 속성을 가지고 있다.

화살표 유형을 설정하는 CLLocationButtonIcon, 버튼의 라벨을 설정하는 CLLocationLabel, 버튼의 반원도를 설정하는 cornerRadius, 마지막으로 라벨 크기를 설정하는 fontSize가 있습니다.

이제 제가 간략한 개요를 살펴봤으니, 당신은 "CLLocationButton으로 어떻게 위치를 받을 수 있나요?"라고 궁금해 할 것입니다.

음, 그것은 UIButton으로 위치를 요청하는 것과 비슷하다.

나는 예시로 이해하는 것이 더 쉽다고 생각한다.

UIButton을 CLLocationButton으로 교체하는 방법을 보여드리겠습니다.

이 UIButton 예제에서, 나는 버튼 탭 시 사용 중 승인을 먼저 요청하여 위치를 요청하는 간단한 버튼을 만들 것이다.

UIButton을 인스턴스화하고 제목을 "현재 위치"로 설정하는 것으로 시작하겠습니다.

기능을 호출하는 대상 액션을 추가하고 버튼을 탭할 때마다 우리가 원하는 필요한 액션을 하고 싶습니다.

이 경우, 나는 근처의 모든 공원을 전시하고 싶다.

그러니 이 함수를 "showNearByParks"라고 부르자.

이 showNearByParks 기능에서, 저는 locationManager를 사용하여 requestWhenInUseAuthorization과 startUpdatingLocation을 호출할 것입니다.

이 기능 내에서, 나는 또한 그에 따라 지도 보기를 렌더링하기 위해 추가 논리를 추가할 것이다.

하지만, 간단히 말해서, 그것을 생략합시다.

처음 두 줄을 제거하고 CLLocationButton의 인스턴스화로 교체한 다음 라벨을 ".currentLocation"으로 설정하여 UIButton을 교체하는 것으로 시작합시다.

마지막으로, 우리는 requestWhenInUseAuthorization에 대한 호출에 대해 언급할 수 있으며, 이는 위치 버튼이 버튼을 성공적으로 탭할 때마다 당신을 대신하여 일회성 권한을 부여하기 때문입니다.

따라서 기존 UIButton이 있다면, 교체는 여기에 표시된 것처럼 간단할 것입니다.

하지만 우리는 그것을 더 쉽게 만들고 싶습니다, 그래서 당신은 이 이야기에 첨부된 파크 파인더 앱의 예를 볼 수 있습니다.

SwiftUI 앱을 사용하는 사람들을 위해, 위치 버튼은 SwiftUI에도 있습니다.

여기 예시와 같이 LocationButton을 사용할 수 있습니다.

저는 SwiftUI의 새로운 "symbolVariant"를 사용하여 화살표 유형을 설정하고, "틴트"를 사용하여 버튼의 배경색을 설정하고 있다는 것을 지적하고 싶습니다.

위치 버튼을 사용자 정의할 수 있는 방법에 대한 몇 가지 예를 살펴봅시다.

위치 버튼을 사용하면 배경색, 텍스트 및 글리프 색상, 둥근 모서리 등을 사용자 정의할 수 있습니다.

다음은 버튼으로 만들 수 있는 몇 가지 예시 스타일입니다.

위치 버튼을 사용자 정의하는 단계별 예를 살펴봅시다.

기본 버튼부터 시작합시다.

기본 모양은 여기에 표시된 것처럼 흰색의 "현재 위치" 제목과 시스템 파란색 배경색을 가지고 있습니다.

버튼 아이콘을 arrowFilled로 설정할 수 있습니다.

다음으로, tintColor를 흰색에서 검은색으로 설정하여 아이콘의 전경 색상을 변경할 수 있습니다...

그런 다음 배경색을 흰색으로 설정하세요.

그리고 마지막으로, 25.0으로 설정하여 모서리 반경을 둥근 모서리로 설정할 수 있습니다.

그리고 버튼의 제약 조건과 크기를 설정하는 방법에 따라, 버튼의 너비가 높이와 같다면, 모서리 반경이 너비의 절반일 때 완벽한 원을 만들 수 있습니다.

이제, 우리는 간단한 조정만으로 기본 위치 버튼을 흰색 원형 버튼으로 바꿨습니다.

우리는 방금 당신이 위치 버튼에 추가할 수 있는 몇 가지 문체 변화를 겪었습니다.

버튼을 사용자 정의하여 앱에 맞는 완벽한 모양을 만들 수 있습니다.

그러나, 큰 힘에는 큰 책임이 따른다.

위치 버튼을 사용자 정의할 때, 위치 버튼이 명확하고 보이는지 확인하기 위해 발생할 수 있는 몇 가지 제한이 있습니다.

버튼이 올바르게 그려지지 않거나 위치를 받지 못하는 경우 기대할 수 있는 몇 가지 예에 대해 이야기하고 싶습니다.

만약 그렇다면, 당신의 목표 행동들이 호출되는 동안, 당신은 승인을 받지 못할 것입니다.

하지만 걱정하지 마.

우리는 당신이 어떤 제한에 직면하고 있는지 알아낼 수 있도록 로그 메시지와 함께 많은 피드백을 제공할 것입니다.

예를 들어, 이것들은 버튼 크기, 알파 값 및 tintColor와 backgroundColor 사이의 색상 대비의 불충분을 나타내는 다른 로그 메시지일 뿐입니다.

이제 Xcode에서 인터페이스 빌더를 사용하는 경우 기대할 수 있는 피드백의 몇 가지 예를 살펴보겠습니다.

이전에 만든 버튼을 계속하면, 기존 버튼을 흰색 색조로 변경한다면, 버튼의 배경색이 이미 흰색이기 때문에 사람들은 이것을 볼 수 없을 것이다.

따라서 이렇게 하면 Xcode의 문제 탭 아래의 탐색 창에 이 문제가 표시됩니다.

대신, 원래 버튼을 되돌리고 이 버튼의 불투명도 또는 알파를 변경해 봅시다.

아마도 당신은 이것을 볼 수 있지만, 다른 사람들에게는 너무 투명하기 때문에 접근성 지침에 실패합니다.

비슷한 문제 진술이 Xcode에서 생성되어 알파 값을 높일 것을 권장합니다.

당신이 직면할 수 있는 또 다른 문제는 버튼 크기 조정이 불충분하다는 것입니다.

이것은 버튼의 내용이 버튼 크기에 비해 너무 작거나 너무 큰 경우입니다.

사용자의 현지화 설정에 따라 버튼의 텍스트 길이가 변경될 수 있습니다.

이제 언어를 변경하여 텍스트 크기를 늘리자.

구현이 자동 레이아웃 친화적인지 여부에 따라, 언어를 변경하면 텍스트 크기가 버튼을 능가할 수 있습니다.

텍스트가 독일어로 버튼에 맞지 않는다는 것을 주목하세요.

이런 일이 발생하면, 피드백을 위해 로그 메시지를 보세요.

위치 버튼을 정말 작거나 정말 큰 텍스트 크기로 테스트하고, 버튼이 모든 경우에 작동하는지 확인하기 위해 다른 언어로 테스트하는 것을 잊지 마세요.

그래서, 버튼을 사용자 정의할 때, 명확하고 눈에 띄는 것이 필수적이라는 것을 기억하세요.

버튼이 올바르게 그려지지 않거나 위치를 받지 못하는 것 같다면, 더 이상 읽을 수 없을 수 있습니다.

만약 그렇다면, 우리는 당신이 무엇이 잘못될 수 있는지 결정하는 데 도움이 되는 지침을 위한 로그 메시지를 제공합니다.

이제 위치 버튼을 구현하는 방법을 알았으니, 그것이 기존 인증 상태에 어떤 영향을 미칠지 궁금할 것입니다.

내가 전에 언급했듯이, 위치 버튼은 본질적으로 당신에게 한 번 허용 권한을 부여하고 있다.

앱에 어떤 종류의 인증 상태도 없는 경우, 개인 정보 보호 설정에서 "공유할 때"를 선택하여 "NotDetermined" 인증을 받게 됩니다.

이것이 앱의 현재 상태라면, 각 사용자가 처음으로 위치 버튼을 누를 때, 이 프롬프트는 그들이 탑승했는지 확인하도록 요청할 것입니다.

그러나, 앱이 이미 "앱을 사용하는 동안" 상태와 같은 위치에 대해 승인된 경우, 위치 버튼을 사용하면 기존 상태가 변경되지 않으며 다른 UIButton처럼 작동합니다.

그것이 작동하는 곳에서, 위치 버튼은 마법처럼 느껴질 수 있고 또한 안심할 수 있습니다. 왜냐하면 당신은 사람들이 언제 그리고 매번 그들의 위치를 사용할지 여부를 결정하게 하기 때문입니다.

위치 버튼이 훨씬 더 편안하기 때문에, 우리는 사람들이 이전보다 위치 버튼을 통해 앱 위치를 제공할 가능성이 더 높다고 생각합니다.

그래서 우리는 사용자와 당신의 앱에 오른발로 내릴 수 있는 또 다른 기회를 주고 싶습니다.

과거에 앱에서 "허용하지 않음" 인증을 선택한 사람이 새로운 위치 버튼을 탭하면, 이 버튼 소개 프롬프트를 보고 앱을 NotDetermined로 다시 이동하고 앞으로 위치 버튼을 사용할 수 있습니다.

그래서 이 세션에서, 저는 지역 기반 사용자 알림을 통해 watchOS 앱에 더 많은 동적 기능을 제공하는 것에 대해 이야기했습니다.

더 배우고 싶다면, 세션과 함께 자료를 보는 것을 잊지 마세요.

우리는 또한 위치를 요청할 수 있는 방법에 대한 게임을 바꿀 수 있는 몇 가지 멋진 새로운 기능을 다루었습니다.

사람들에게 데이터 개인 정보 보호에 대한 더 많은 통제권을 부여하는 것은 애플에게 중요하다.

사람들은 그들의 데이터가 어떻게 공유되고 있는지 점점 더 잘 알고 있다.

가장 놀라운 사용자 경험을 제공할 뿐만 아니라 고객과의 신뢰를 쌓기 위해 앱을 설계할 때, "내 앱에는 전통적인 인증이 필요한가요, 아니면 위치 버튼이 있는 일회성 위치 인증이 더 적합할까요?"라고 스스로에게 물어볼 수 있습니다.

그리고 대답은, 어떤 경우에는, 한 번이면 충분할 수도 있다.

위치 버튼을 사용하면 언제 위치를 공유하고 싶은지에 대해 더 많은 통제권을 부여함으로써 사람들과 신뢰를 얻을 수 있습니다.

고마워.

[음악].