10067

안녕하세요, 저는 게임 센터 팀의 해리슨입니다.

당신의 게임에서 반복되는 리더보드를 사용하는 것에 대해 배우기 위해 저와 함께 해주셔서 감사합니다.

게임 센터는 플레이어가 많은 게임에서 데이터에 액세스하는 데 사용할 수 있는 편리한 신원을 제공합니다.

개발자로서, Game Center를 사용하면 업적, 멀티플레이어 및 리더보드와 같은 기능을 쉽게 추가할 수 있으며, 이것이 제가 오늘 이야기할 것입니다.

이것은 코드와 함께 있기 때문에, 참여하려면 초기 설정을 해야 합니다.

그런 다음, 게임 센터의 리더보드 유형을 간략하게 요약하고 제공된 샘플 게임을 살펴보겠습니다.

마지막으로, 나는 App Store Connect에 반복되는 리더보드를 추가하고, 샘플 게임에서 그것을 사용하는 몇 가지 다른 방법을 보여줄 것이다.

몇 가지 설정으로 시작합시다.

우리는 당신이 시작할 수 있도록 개발자 포털에서 Xcode 13과 호환되는 프로젝트를 제공했습니다.

비디오를 일시 중지하고 지금 다운로드하는 것이 좋습니다.

다운로드한 후, 재개하고, 초기 설정을 안내해 드리겠습니다.

다운로드한 폴더에서 The Coast라는 Xcode 프로젝트를 찾을 수 있습니다.

가서 지금 열어봐.

게임 센터 기능을 사용하기 위해 이 앱을 수정할 것이기 때문에, 팀에 등록해야 합니다.

따라가세요, 필요에 따라 멈추세요.

먼저, 프로젝트 탐색기에서 TheCoast 프로젝트 파일을 선택하세요.

그런 다음, 대상 목록에서 TheCoast를 선택하세요.

서명 및 기능 창에서 팀 메뉴에서 팀을 선택하세요.

Apple ID 또는 팀이 메뉴에 없는 경우, 먼저 계정 추가를 선택하고 Apple ID 정보를 입력하십시오.

다음으로, 번들 ID를 고유 식별자로 설정하세요.

진행하려면 번들 ID를 변경해야 합니다.

메시지가 나타나면, 장치 등록을 클릭하여 프로비저닝 프로필을 만드세요.

성공적으로 등록하면, 상태 아래에 나열된 경고가 없을 것입니다.

이제 선택한 번들 ID가 등록되면, App Store Connect에 앱 레코드를 추가할 수 있습니다.

App Store Connect의 오른쪽 상단 모서리에서 번들 ID를 등록할 때 사용한 팀을 선택하세요.

그런 다음, 내 앱 섹션으로 이동하세요.

왼쪽 상단 모서리에 있는 더하기 버튼을 클릭하고, 새 앱을 선택하세요.

iOS 전용 앱에서 작업할 예정이므로, 플랫폼으로 iOS를 선택하세요.

적절한 이름, 기본 언어 및 SKU를 선택하세요.

번들 ID의 경우, Xcode에 등록한 번들 ID를 선택해야 합니다.

모든 필수 필드를 작성한 후, 생성을 선택하여 앱 레코드를 추가하십시오.

당신은 조금 있다가 App Store Connect로 돌아올 것입니다.

하지만 이제, 나는 리더보드를 간략하게 요약할 것이다.

우리의 모든 리더보드는 선수들이 전 세계의 친구와 선수들에 대해 얼마나 좋은 순위를 매겼는지 볼 수 있게 해준다.

우리의 리더보드 유형은 주로 리더보드가 활성화된 기간마다 다릅니다.

클래식 리더보드는 항상 활성화되어 있으며, 끝이 없다.

그들은 주간 및 일일 순위뿐만 아니라 사상 순위를 유지한다.

그들은 획득한 총 경험치 또는 현재 동전 수와 같은 누적 점수에 특히 유용합니다.

반면에 반복되는 리더보드는 5분마다 또는 30일마다 개발자가 정의한 일정에 따라 반복되는 수명이 짧은 리더보드이다.

현재 활성화된 리더보드 발생을 검색할 수 있으며, 종료 시간 후 최대 30일 동안 플레이어가 제출한 가장 최근에 완료된 발생을 검색할 수도 있습니다.

반복되는 리더보드는 매주 일요일 정오에 1시간 챌린지 또는 매주 새로운 리더보드와 같은 주기적인 시간제 이벤트에 유용합니다.

나는 세션 중에 반복되는 리더보드에 대한 구체적인 사용 사례를 강조할 것이다.

하지만 먼저, Xcode에서 열었던 프로젝트로 돌아가 봅시다.

iOS 기기나 시뮬레이터에서 구축하고 실행하세요.

이것은 해안의 제목 화면이다.

현재로서는, 이 화면에는 게임을 시작할 수 있는 버튼이 있습니다.

가서 "플레이"를 탭하세요.

게임플레이는 꽤 간단합니다: 배를 볼 때, 포인트를 얻기 위해 탭하세요.

각 세션은 60초 동안 지속된다.

마지막에, 당신은 다시 시도하거나 제목 화면으로 돌아갈 수 있는 옵션이 있습니다.

오른쪽 상단 모서리에 있는 메뉴 버튼을 선택하면, 일찍 끝낼 수 있습니다.

그래서, 이것은 어떻게 시행되나요?

나는 시작할 몇 가지 주요 수업을 강조할 것이다.

TitleScreenViewController는 제목 화면을 담당합니다.

조금 있으면, 그것은 게임 센터로 인증하는 데 사용될 것이다.

현재로서는, 그것은 주로 PLAY 버튼을 탭할 때 GameViewController를 제시할 책임이 있다.

GameViewController는 꽤 간단하다.

보기가 로드될 때 GameScene이라는 SpriteKit 장면을 가져오고, 제목 화면으로 돌아가기 위한 endGame이라는 위임 방법이 있습니다.

모든 게임플레이 논리를 관리하는 게임스케인을 살펴봅시다.

그것이 제시되면, 그것은 몇 개의 SpriteKit 노드를 설정합니다.

하나는 배경 이미지로 만들어진 노드이다.

이것은 장치의 화면 크기에 따라 조정되며, 다른 모든 노드는 어린이로 추가됩니다.

또 다른 하나는 현재 점수를 표시하는 화면 왼쪽 상단에 위치한 SKLabelNode인 scoreLabel이다.

마지막은 CountdownNode로, 플레이어에게 남은 시간을 보여주고 시간이 끝나면 GameScene에 알립니다.

이러한 노드가 추가되면, setupBoatNodeWithActions() 메서드가 호출됩니다.

이것은 세션 동안 보트 스프라이트를 페이드 인 및 페이드 아웃하는 일련의 SpriteKit 작업을 시작합니다.

터치엔드 방법은 탭하고 점수를 증가시킬 때 보트 스프라이트를 제거하기 위해 재정의됩니다.

카운트다운이 끝날 때, timeIsUp 방법에서, 모든 노드가 배경에서 제거되고 최종 점수가 있는 메뉴가 표시됩니다.

플레이어를 위한 코스트의 경험을 개선하기 위해 반복되는 리더보드를 활용할 수 있는 많은 방법이 있지만, 오늘은 세 가지에 집중할 것이다.

먼저, 24시간 반복되는 리더보드를 만들어 일일 경쟁을 설정하는 방법과 게임 센터의 기본 리더보드 UI에 연결하는 방법을 보여드리겠습니다.

이것은 아마도 반복되는 리더보드를 추가하는 가장 쉬운 방법일 것이며, 플레이어가 다른 사람들과 어떻게 쌓여 있는지 알 수 있는 좋은 방법입니다.

일일 케이던스는 모든 사람이 최고의 자리를 차지할 수 있는 새로운 기회를 가질 수 있도록 보장한다.

다음으로, 우리는 게임 플레이 중에 라이브 순위를 표시할 것이다.

이것은 플레이어들이 그들이 얼마나 잘 하고 있는지 그리고 그들이 최고의 자리에 얼마나 가까이 있는지 실시간으로 볼 수 있기 때문에 게임에 많은 흥분을 더한다.

마지막으로, 우리는 현재와 이전 사건의 순위를 사용하여 플레이어가 시간이 지남에 따라 어떻게 변하는지 보여줄 것입니다.

이것은 플레이어들에게 게임의 진행 상황을 알려주는 정말 간단한 방법이다.

시작하자.

나는 이전에 내가 매일 반복되는 리더보드를 사용할 것이라고 언급했다.

게임에서 리더보드를 사용하기 전에, App Store Connect에서 구성해야 합니다.

지금 사파리에서 그것을 꺼내서 앱을 여세요.

기능 탭으로 이동하여 게임 센터가 선택되었는지 확인하세요.

그런 다음, 리더보드 옆에 있는 더하기 버튼을 클릭하고, 반복되는 리더보드 옵션을 선택하세요.

클래식과 반복되는 리더보드 모두 구성해야 할 이 여섯 가지 필드가 있다.

리더보드 참조 이름은 App Store Connect에서 내부적으로 사용됩니다.

"DailyHighScore"와 같은 서술적인 것을 고르세요.

리더보드 ID는 앱 내에서 리더보드를 참조하는 데 사용됩니다.

간단히 말해서, 나는 참조 이름에 사용한 것과 동일한 설명 값을 사용할 것이다.

점수 형식 유형은 게임 센터 UI에서 점수가 어떻게 포맷되는지 결정합니다.

해안의 점수는 정수에 불과하지만, 다른 게임들은 시간이나 돈을 사용할 수 있다.

플레이어가 동일한 리더보드 발생에 여러 점수를 제출하는 경우, 점수 제출 유형은 어느 것이 순위가 매겨지는지 결정합니다: 최고의 점수 또는 가장 최근의 점수.

하루 동안 플레이어의 가장 높은 점수를 기록하고 싶기 때문에, 해안을 위해 최선을 사용하세요.

정렬 순서는 플레이어의 점수가 서로 어떻게 평가되는지를 결정한다.

해안의 경우, 높은 점수가 더 좋으므로, 높음에서 낮음으로 선택하세요.

유효한 점수에 대한 범위를 선택적으로 정의할 수 있습니다.

그 범위를 벗어난 모든 점수는 거부될 것이다.

이것은 부정 행위에 대한 완화로 유용하다.

나는 선수들이 그 범위를 벗어나 득점할 것으로 합리적으로 기대하지 않기 때문에 최소 0과 최대 200을 설정할 것이다.

반복되는 리더보드에는 이러한 추가 필수 필드가 있습니다.

시작 날짜와 시간은 UTC에서 리더보드가 처음 발생한 날짜와 시간입니다.

과거에는 시작을 선택할 수 없으므로, 1분 안에 가까운 미래에 날짜와 시간을 선택하여 바로 리더보드를 사용할 수 있습니다.

기간은 순위표에 점수를 게시할 수 있는 시간이다.

물론, 이것은 일일 리더보드를 위한 하루이다.

Restarts Every는 리더보드의 새로운 발생이 생성되는 빈도를 지정합니다.

빈도는 발생이 겹치지 않도록 지속 시간보다 크거나 같아야 한다.

해안은 발생 사이에 어떤 간격도 필요하지 않으므로, 이것을 기간과 동일하게 설정하세요.

여기 이 분야들이 발생을 일으키기 위해 어떻게 상호 작용하는지 보여주는 다이어그램이 있습니다.

당신이 선택한 시작 날짜에, 예를 들어 6월 11일 오전 9시에, 사건이 생성됩니다.

구성된 기간 때문에 하루 동안 이 사건에 제출할 수 있습니다.

그 발생이 만료된 직후, 6월 12일 오전 9시, 재시작이 지속 시간과 일치하도록 구성되어 있기 때문에 새로운 발생이 생성됩니다.

이 과정은 무기한으로 계속된다.

마지막으로 구성할 것은 현지화 정보이다.

리더보드는 게임 센터 UI에 제대로 표시하기 위해 이것이 필요하다.

적어도 하나의 언어를 구성해야 합니다.

나는 영어로 구성할 거야.

일일 리더보드의 "일일 최고 점수"와 같은 적절한 표시 이름을 선택하세요.

당신은 또한 점수 형식을 선택해야 합니다.

정수 유형의 경우, 마침표나 쉼표를 수천 구분 기호로 사용할 수 있습니다.

당신의 언어에 맞는 것을 선택하세요.

점수 형식 접미사는 점수나 안타와 같은 점수의 단위를 지정하는 방법입니다.

난 그냥 해안을 위해 이걸 비워둘 거야.

리더보드 이미지는 선택 사항이지만, 게임 센터 UI에서 게임에 대한 맞춤형 모양을 제공하기 때문에 권장됩니다.

프로젝트의 자산 디렉토리에 여기에 사용할 수 있는 leaderboardImage라는 이미지가 있습니다.

그거 업로드해.

리더보드를 저장하면, 게임 센터로 인증하고 게임에서 사용할 수 있습니다.

그럼, 게임 센터 인증을 활성화하는 것으로 시작합시다.

TitleScreenViewController에는 본문에 주석이 있는 authenticateLocalPlayer()라는 메서드가 있습니다.

가서 주석을 해제해.

이 코드는 로컬 플레이어의 인증 핸들러를 설정하여 시작 시 Game Center 로그인 흐름을 트리거합니다.

더 많은 정보가 필요하다면, 제공된 문서 링크를 따라가세요.

이제, 우리는 점수를 제출할 수 있다.

이전에, 저는 터치가 끝날 때 터치엔드라고 불리는 점수를 업데이트하는 GameScene의 방법을 보여주었습니다.

그걸로 이동해.

두 가지 제출 점수 방법이 있습니다.

하나는 클래스 메소드이고, 다른 하나는 인스턴스 메소드이다.

수업 방법에 제출할 때, 제출은 현재 활성화된 모든 사건으로 이동합니다.

그것은 활발한 사건이 없을 때만 실패할 것이다.

인스턴스 방법을 사용하려면, 먼저 현재 발생을 나타내는 GKLeaderboard를 로드합니다.

그런 다음, 완료 핸들러에 점수를 제출할 때, 그 발생이 여전히 활성화된 경우에만 성공할 것입니다.

시간마다 반복되는 리더보드를 사용하여 매 시간마다 독특한 도전을 제공하는 게임을 고려해 보세요.

플레이어의 장치와 서버 간의 네트워크 지연으로 인해 한 챌린지의 점수가 다음 챌린지의 발생으로 유출되는 것을 원하지 않을 것입니다.

인스턴스 제출 점수 방법은 그것이 일어나지 않도록 보장한다.

코스트의 일일 리더보드는 특정 게임 세션과 연결되어 있지 않으므로, 어떤 사건이 점수를 받는지는 중요하지 않다.

그냥 수업 방법을 사용하자.

이제, 점수는 현재 진행 중인 리더보드 발생에 제출될 것이다.

컨텍스트를 0으로 설정하고 있다는 점에 유의하세요.

컨텍스트는 게임별 정보를 인코딩하고 점수와 함께 저장하는 데 사용할 수 있습니다.

해안의 경우, 점수는 추가적인 맥락이 필요하지 않다.

이제 일일 리더보드에 제출하고 있으니, 제목 화면에서 Game Center UI의 리더보드를 표시하는 버튼을 추가해 봅시다.

먼저, TitleScreenViewController로 가세요.

새로운 IBAction 방법을 만들어야 합니다.

그것을 showLeaderboardVC라고 불러.

GKGameCenterViewController를 인스턴스화하세요.

리더보드 ID, 플레이어스코프를 전달하세요-- 저는 글로벌-- 그리고 타임스코프를 사용하고 있습니다.

반복되는 리더보드의 경우, timeScope는 항상 있어야 합니다.

gameCenterDelegate를 "self"로 설정하세요.

그럼, 그걸 제시해.

당신은 또한 UIButton을 만들어야 합니다.

난 그냥 내 리더보드 버튼을 부르고 있어.

그런 다음, 메인 스토리보드에 모든 것을 연결하세요.

우리는 당신이 자산 디렉토리에서 사용할 수 있도록 리더보드 글리프를 제공했습니다.

그 이미지로 버튼을 추가하고, 텍스트를 제거하세요.

나는 글리프가 늘어나지 않도록 종횡비 제약을 설정할 것이다.

그런 다음, PLAY 버튼 옆에 놓으세요.

Touch Up Inside 이벤트를 새로운 방법으로 설정하세요.

그리고 새 버튼에 새 참조 콘센트를 설정하세요.

이제, 앱을 빌드하고 실행하여 새로운 리더보드를 사용해 보세요.

게임 센터에 로그인하라는 메시지가 표시될 수 있습니다.

리더보드가 작동하려면 인증된 계정이 필요하기 때문에, 지금 그렇게 하세요.

리더보드 글리프를 탭하면 게임 센터 UI의 리더보드로 바로 이동합니다.

아직 플레이하지 않았다면, 리더보드는 비어 있을 것이다.

간단히 플레이하고, 리더보드에서 새로운 점수를 다시 확인하세요.

이제 리더보드가 있고 점수를 제출하고 있으니, 게임 플레이 중에 라이브 점수를 추가해 봅시다.

리더보드노드 클래스를 보세요.

이것은 이름과 점수로 구성된 리더보드 항목 목록을 가져간 다음 순위에 따라 표시하는 SpriteKit 노드입니다.

항목으로 초기화하고 항목을 변경해야 할 때 업데이트할 수 있습니다.

GameScene의 멤버로 선택적 리더보드 노드를 추가하세요.

우리는 setupInitialGameplay에서 리더보드 위치를 초기화합니다.

그 바로 아래에 있는 노드를 초기화하세요.

나는 그것을 다섯 줄로 구성하고, 초기 항목을 비워두고 있다.

배경 노드에 추가하여 장면에 표시하세요.

이제, 우리는 항목을 로드하고 리더보드를 업데이트해야 합니다.

나는 이것을 위한 updateLeaderboardNode 함수를 만들 것이다.

먼저, DailyHighScore 리더보드를 로드하세요.

완료 핸들러에서, 리더보드를 사용하여 글로벌 리더보드에서 상위 5개의 항목을 로드하세요.

이것은 반복되는 리더보드이기 때문에, timeScope는 항상 항상 있을 것이다.

이것들이 로드되면, 항목이 nil이 아닌 경우 GameKit 항목을 LeaderboardNode가 사용하는 LeaderboardEntry 구조체로 변환해야 합니다.

그런 다음, LeaderboardNode의 updateEntries 메소드를 호출하세요.

마지막 단계는 게임 플레이 전반에 걸쳐 리더보드노드를 업데이트하는 것이다.

이 게임에서는 플레이어의 점수가 자주 바뀌며, 리더보드 노드를 동기화해야 합니다.

그렇게 하려면, submitScore의 완료 핸들러에서 updateLeaderboardNode()를 호출하세요.

플레이어가 득점하기 전에 리더보드를 올바르게 표시하려면, 노드가 생성된 직후에 호출하세요.

이제, 나는 다시 짓고 달릴 거야.

나는 나와 함께 게임을 하는 친구가 몇 명 있다.

점수가 증가함에 따라 리더보드가 지속적으로 업데이트되는 것을 볼 수 있습니다.

내가 만들고 있는 마지막 변화는 플레이어의 현재 일일 순위가 이전 일일 순위와 어떻게 다른지 보여주는 것이다.

시간이 다 되면 이걸 GameMenuNode에 넣을 거야.

나는 이것을 구현하기 위해 일련의 중첩된 완성 핸들러를 사용할 수 있지만, GameKit의 새로운 비동기 메소드를 사용하면 이 코드를 더 읽기 쉽게 만들 것이다.

새로운 비동기 방법을 만드세요.

그것을 addRankToGameMenu()라고 부르자.

GameKit의 비동기 방법은 던질 수 있기 때문에, 오류를 포착하고 싶을 것입니다.

난 그냥 그것들을 기록할 거야.

일일 리더보드를 로드하고 성공적으로 반환되었는지 확인하세요.

그 리더보드 인스턴스로, 두 가지를 하세요.

먼저, 비동기적으로 항목을 비동기적으로 로드하세요.

나는 지역 선수의 점수에만 관심이 있기 때문에 매개 변수를 비워두고 있다.

둘째, 리더보드의 이전 발생을 비동기적으로 로드하고 그것을 사용하여 항목을 로드하세요.

이 정보를 표시하려면 gameMenuNode에 방법을 작성해야 합니다.

그것을 addRankNode라고 부르자.

현재와 이전 순위를 통과하세요.

당신은 그들이 준비될 때까지 기다리기 위해 시도를 사용해야 할 것입니다.

timeIsUp에서 분리 블록에서 새로운 비동기 메소드를 호출하세요.

그런 다음, GameMenuNode로 가서 addRankNode를 구현하세요.

addRankNode는 이전 순위와 현재 순위의 차이를 사용하여 간단한 텍스트를 생성할 것이다.

두 순위가 모두 0이면, 그냥 돌아갈 수 있습니다.

라벨 노드에 텍스트를 표시하세요.

나는 그것을 만들기 위해 도우미 기능을 사용하고 있다.

그것을 적절하게 배치하세요.

나는 그것을 수평으로 중앙에 두고 수직으로 중심 약간 아래에 추가할 것이다.

그런 다음, 그것을 배경에 추가하세요.

이제, 결과를 봅시다.

나는 어제 경기를 했기 때문에, 이전 순위를 사용할 수 있다.

보시다시피, 제 순위는 오늘 조금 떨어졌고, 계속 플레이해야 할 좋은 이유입니다.

이 세션에서는 App Store Connect에서 반복되는 리더보드를 설정하는 방법과 점수를 제출하고, Game Center의 자체 리더보드 UI에 연결하고, 리더보드 API를 사용하여 라이브 글로벌 순위와 이전 발생의 순위를 표시하여 게임에서 사용하는 방법을 보여주었습니다.

반복되는 리더보드에 대한 자세한 내용은 작년 WWDC의 "게임 센터 탭: 리더보드, 업적 및 멀티플레이어"를 참조하십시오.

그리고 올해 WWDC에서 "게임 센터의 새로운 기능"을 꼭 확인하세요.

[타격적인 음악].