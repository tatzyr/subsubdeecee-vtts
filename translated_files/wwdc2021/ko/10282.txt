10282

♪ 베이스 음악 연주 ♪

♪

에릭 혼버거: 연구 및 관리 앱 코드의 세 번째이자 마지막 할부에 다시 오신 것을 환영합니다!

따라가고 싶다면, 세션 리소스에서 이 앱의 소스 코드를 찾을 수 있습니다.

로그인해서 시작하자.

지난 세션에서, 우리는 앱에 몇 가지 작업을 추가했습니다.

그 이후로, 나는 제이미로부터 모든 종류의 알림을 받고 있다.

뭔가 문제가 있는 것 같아.

어디 보자.

제이미는 10분 안에 병원에 도착할 것이다.

제이미는 동기 부여 재생 목록을 공유했다.

와! 보시다시피, 열정적인 제이미는 지금 임상의들을 만나러 가고 있습니다.

제이미가 우리에게 몇 가지 변경을 하고 두 가지 새로운 기능을 추가하라고 요청한 것 같다.

첫 번째 부분은 우리가 세션 2에서 시행한 설문 조사를 강화하는 것이다.

제이미는 테스터들로부터 그들에 대한 피드백을 받았다고 말한다.

그는 우리에게 그가 받은 피드백은 테스터들이 사실 이후에 어떤 대답을 했는지 말할 수 있기를 원한다는 것이었다.

지금 당장, 그 카드는 설문 조사가 완료되었음을 보여주지만, 며칠 동안 시간을 거슬러 올라가면, 당신이 그날 어떤 대답을 했는지 알 수 있는 방법이 없습니다.

그들은 또한 우리가 편집을 현재 날짜로 제한하는 것을 원합니다.

과거에 설문 조사 답변을 삭제하거나 모션 테스트 범위를 다시 실행해서는 안 됩니다.

마찬가지로, 아직 오지 않은 날에 미래와 사전 답변 설문 조사로 스크롤할 수 있다는 것은 말이 되지 않습니다.

그래서 우리는 그 피드백을 다루고 설문 조사를 조금 향상시키는 것으로 시작할 것입니다.

우리는 또한 여전히 조금 외로워 보이는 인사이트 탭을 가지고 있습니다.

제이미는 우리가 거기에 한 쌍의 차트를 표시해 달라고 요청했다.

하나는 수면과 통증 사이의 관계를 포착할 것이고, 다른 하나는 시간이 지남에 따라 운동 범위의 개선을 보여줄 것이다.

마지막으로, 제이미는 의사들이 참가자들이 찢어진 반월상 연골이 무엇인지 이해할 수 있도록 교육 콘텐츠를 포함할 것을 요청했고, ResearchKit이 우리를 도울 수 있을 것이라고 말한다.

우리는 설문 조사를 강화하는 것으로 시작할 것이다.

환자가 준 답을 보여주는 것을 다루자.

우리는 계속해서 주어진 답을 카드에 텍스트로 표시할 것이다.

이제 CareKit에서 작업 카드의 모양을 조정하는 것은 viewSynchronizer를 이니셜라이저에 전달하여 수행됩니다.

사용자 지정 뷰 동기화를 만드는 방법을 살펴봅시다.

우리는 기존 OCKSurveyTaskViewSynchronizer를 서브클래스할 것이다.

이 클래스에는 재정의할 수 있는 두 가지 방법이 있습니다: makeView와 updateView.

updateView는 저장소의 데이터가 변경될 때마다 호출되며, 보기에 사용자 지정을 적용할 수 있는 곳입니다.

우리는 항상 슈퍼클래스의 구현을 호출하는 것으로 시작하고 그 위에 개선 사항을 적용합니다.

우리는 완료된 결과가 있는 이벤트가 있는지 확인할 것입니다.

만약 있다면, 그것은 설문 조사가 끝났다는 것을 의미한다.

우리는 2부에서 설정한 종류의 속성을 참조하여 고통의 대답과 수면의 대답을 잡을 것이다.

나는 친절한 속성을 설정함으로써 그것이 나중에 우리에게 도움이 될 것이라고 언급했고, 이것은 내가 암시했던 응용 프로그램 중 하나이다.

이제 답변이 편리해졌으니, 문자열 보간을 사용하여 카드의 지시 라벨에 답변을 삽입할 수 있습니다.

그리고 그것은 답을 보여주는 것을 처리할 것이다.

제이미는 또한 우리가 과거 작업의 편집을 비활성화할 것을 요청했다.

우리가 할 수 있는 한 가지 방법은 먼저 설문조사 작업 카드의 대리인으로 설정한 다음 이 위임 방법을 작성하는 것입니다: 작업을 위한 viewController shouldAllowDeleting OutcomeForEvent.

우리의 임무는 CareKit에게 특정 이벤트의 결과를 삭제해야 하는지 여부를 알려주는 부울을 반환하는 것입니다.

우리는 그 행사가 열리는 날짜를 살펴볼 것이다.

날짜가 오늘보다 빠르다면, 우리는 그것을 삭제할 수 없다고 말할 것이다.

만약 그것이 오늘이나 그 이후에 있다면, 우리는 그것을 삭제할 수 있도록 허용할 것이다.

그리고 그렇게, 우리는 과거 데이터의 삭제를 막았다.

제이미가 세 번째로 요청한 것은 참가자들이 향후 날짜에 설문 조사를 완료하는 것을 막는다는 것이다.

그렇게 하기 위해, 우리는 작업 보기 컨트롤러를 만들기 직전에 같은 파일에서 조금 더 높이 올라갈 것이며, 일부 캘린더 유틸리티를 사용하여 콘텐츠를 채우는 날이 미래인지 아닌지 확인할 것입니다.

만약 그것이 미래의 날짜라면, 우리는 작업 카드와의 상호 작용을 비활성화할 것이며, 비활성화되었음을 시각적으로 나타내기 위해 불투명도를 줄일 것입니다.

좋아, 좋아!

이제 우리는 미래의 작업도 완료할 수 없어야 한다.

우리가 어디에 서 있는지 보자.

당신이 가장 먼저 알게 될 것은 설문 조사에 주어진 답변이 이제 설문 조사 작업 카드에 표시된다는 것입니다.

우리는 여전히 현재 날짜에 설문조사를 삭제하거나 다시 할 수 있는 옵션이 있지만, 과거로 다시 스와이프하면 더 이상 다시 할 수 없습니다.

그리고 우리가 미래로 나아가면, 우리는 앞으로 일어날 일을 미리 볼 수 있지만, 아직 어떤 설문 조사도 완료할 수 없습니다.

우리 앱은 지금 정말 함께 오고 있어!

우리가 해야 할 마지막 두 가지는 차트와 교육 콘텐츠이며, 둘 다 인사이트 탭에 있습니다.

우리는 통증 등급과 수면 시간을 나란히 보여주는 두 시리즈 막대 차트로 시작할 것입니다.

우리는 두 개의 OCKDataSeriesConfiguration 객체를 만들어야 합니다.

첫 번째는 고통 시리즈를 위한 것이다.

ID는 CareKit에게 차트에 어떤 작업의 데이터를 플로팅할 것인지 알려줍니다.

우리는 또한 범례 제목, 색상, 마커 크기 - 막대의 폭을 결정하는 - 그리고 이벤트 애그리게이터를 전달할 것입니다.

이벤트 애그리게이터는 주어진 날에 발생하는 모든 이벤트를 보고 그 날에 어떤 Y 값을 사용해야 하는지 결정할 책임이 있다.

체크인 작업을 위해, 우리는 하루에 하나의 이벤트만 있을 것이라는 것을 알고 있으므로, 첫 번째 이벤트를 진행하여 고통스러운 질문에 대한 답을 얻을 수 있습니다.

그래서 그게 통증 시리즈 구성이야.

우리는 또한 수면을 위해 하나가 필요할 것이다.

수면 시리즈는 거의 동일하다.

우리는 정확히 같은 체크인 작업에서 데이터를 플로팅하고 있습니다.

차이점은 우리가 고통의 대답 대신 수면의 대답을 표시한다는 것이다.

이 두 가지를 모두 가지고, 우리는 차트 뷰 컨트롤러를 구성할 수 있다.

우리는 막대 차트를 선택하고 날짜를 오늘로 설정할 것이다.

물론, 우리는 또한 두 시리즈와 매장 관리자가 변경됨에 따라 차트를 최신 상태로 유지하는 데 사용되는 매장 관리자에 대한 참조를 전달해야 합니다.

좋아, 그게 우리의 첫 번째 차트야.

하나 더 만들자!

이번에는 운동 범위에 대한 분산형 차트가 될 것이다.

우리는 이전과 마찬가지로 데이터 시리즈 구성을 만들어야 하지만, 이번에는 하나만 필요할 것이다.

이번에 유일한 차이점은 체크인 작업 대신 모션 작업 범위에서 데이터를 플로팅하고 있으며, Y 축에 대한 범위 답변을 사용하고 있다는 것입니다.

다음으로, 우리는 뷰 컨트롤러를 만들 것이다.

이번에는 산점도가 될 것이며, 우리는 데이터 시리즈가 하나밖에 없다.

그리고 그렇게, 우리는 두 차트를 모두 설정했습니다.

그들이 어떻게 생겼는지 보자.

인사이트 탭을 건너뛰면, 두 차트가 모두 렌더링되고 있는 것을 볼 수 있습니다.

그들은 정말 멋져 보여!

우리가 뒤로 물러서서 몇 가지 결과를 추가하거나 삭제하면 - 여기서, 우리는 화요일에 두 결과를 모두 삭제할 것입니다 - 그런 다음 인사이트 탭으로 돌아가면, 우리는 차트가 자동으로 업데이트되는 것을 볼 수 있습니다.

그리고 그들은 가지고 있어!

화요일에는 더 이상 데이터가 표시되지 않습니다.

좋아! 그래서 차트가 좋아 보여.

제이미는 또한 참가자들에게 임상 파트너로부터 받은 설명 텍스트와 함께 무릎과 메니스커스의 3D 모델을 볼 수 있는 옵션을 제공하도록 요청했다.

ResearchKit은 우리를 도울 수 있다.

이번에는 ResearchKit 설문 조사를 CareKit 일정과 묶지 않는다는 점에 유의하기 위해 잠시 멈추고 싶습니다.

참가자들이 이 콘텐츠를 보기를 원하는 특별한 시간이 없기 때문에, 우리는 일정의 개념이 필요하지 않습니다.

마찬가지로, CareKit의 스토어에 지속할 수 있는 결과가 없으므로 CareKit 작업을 만들거나 CareKit의 설문 조사 작업 보기 컨트롤러를 사용할 필요가 없습니다.

즉, 우리는 내 팀 동료 Gavi가 작년에 WWDC에서 소개한 FeaturedContent 보기를 사용할 수 있다.

우리는 참가자가 추천 콘텐츠 카드를 탭할 때 알 수 있도록 우리 자신을 대리인으로 설정해야 합니다.

그들이 할 때, 우리는 kneeModelTask를 만들고, ORKTaskViewController로 감싸고, 참가자에게 제시할 것이다.

그들이 모델 보기를 마치면, 우리는 바로 여기서 콜백을 받을 것이며, 그것을 ResearchKit 뷰 컨트롤러를 무시하고 참가자를 Insights 탭으로 다시 데려올 수 있는 기회로 사용할 수 있습니다.

좋아, 아주 좋아!

하지만 우리는 이 무릎 작업에 대한 정의를 놓치고 있다.

Surveys.swift에서 그것을 작성하러 가자.

그것은 단지 두 단계가 될 것이며, 첫 번째는 지시 단계가 될 것이다.

우리가 오늘 이미 그것들을 여러 번 사용했기 때문에, 나는 이것들이 적어도 지금쯤 당신에게 조금 친숙하게 느껴지기 시작했기를 바랍니다.

두 번째 단계는 3D 모델 단계이다.

우리가 3D 모델 단계를 만들 때마다, 우리는 또한 modelManager를 전달해야 하므로, 그 바로 위에, 우리는 전달할 USDZ 모델 관리자를 만들 것입니다.

우리는 모든 것이 작동하는지 확인하기 위해 장난감 로봇을 전시하는 것으로 시작할 것입니다.

마지막 부분은 우리의 두 단계로 정렬된 작업을 조립하고 그것을 반환하는 것이다.

이제 앱을 실행하면 인사이트 탭에서 추천 콘텐츠 카드를 볼 수 있으며, 탭하면 지침 단계가 표시되고 장난감 로봇 모델이 표시됩니다.

우리는 회전하고 확대하여 상호 작용할 수 있습니다...

꽤 깔끔해!

3D 모델 관리자가 어떻게 작동하는지 또는 자신의 버전을 구현하는 방법에 대해 더 알고 싶다면, 작년의 Pariece의 WWDC 세션을 확인할 수 있습니다.

앱을 완성하기 위해, 나는 우리의 장난감 로봇을 바이오디지털의 모델 매니저로 바꿀 것이다.

당신이 세부 사항을 알고 싶어할 경우를 대비하여, 우리는 프로젝트의 Read Me에 이것에 대한 몇 가지 메모를 포함할 것입니다.

이 버전의 모델 관리자를 통해, 우리는 임상의의 교육 텍스트를 제공할 수 있습니다.

여기서 당신은 우리의 임상 파트너가 제공하는 몇 가지 콘텐츠를 볼 수 있습니다.

우리는 또한 참가자의 참조를 위해 메니스커스를 강조하여 부상과 회복 경로가 무엇인지에 대해 더 많이 이해할 수 있도록 도울 수 있습니다.

우리 앱은 지금 정말 함께 오고 있어!

사실, 그게 다야, 그게 다야!

우리는 모든 상자를 확인했어!

그리고 순식간에, 그것도!

제이미한테 또 전화가 온 것 같아.

안녕 제이미, 좋은 타이밍이야!

우리는 방금 당신이 우리에게 요청한 모든 것을 마무리했습니다.

제이미: 오 와우, 그래. 나 지금 그거 보고 있어, 에릭.

어디 보자...

응, 이건 정말 잘 되고 있어.

나머지 팀원들은 흥분할 것이고, 이것은 많은 연구 기회를 열어줄 것이다!

당신을 위한 간단한 질문입니다.

다음 회의에 가기 전에, 그들이 당신에게 질문이 있다면 팀에게 무엇을 하라고 말해야 할까요?

에릭: 야, 그거 좋은 질문이야!

그래서 ResearchKit과 CareKit은 모두 오픈 소스이며, 우리 팀은 GitHub에서 활동하고 있습니다.

그들이 프레임워크에 대해 질문이 있거나, 새로운 기능을 요청하거나, 기여하고 싶다면, GitHub 저장소에서 새로운 이슈를 열라고 말하세요.

제이미: 그래, 그거 환상적이야.

내가 그 정보를 팀에 전달할게.

에릭: 그건 그렇고 제이미, 너는 우리에게 너의 공부에 대해 더 많이 말하는 것을 고려해야 해!

Researchandcare.org에 가면, 당신의 연구가 누구에게 도움이 되는지에 대한 세부 사항을 Apple에 알려주는 데 사용할 수 있는 링크를 찾을 수 있습니다.

우리는 우리의 프레임워크가 지역 사회에서 어떻게 사용되고 있는지 듣고 싶습니다!

우리는 또한 새로운 연구 연구를 제안하는 기관에 Apple Watch 보조금을 제공하는 조사관 지원 프로그램이 있습니다.

그들이 지원하고 싶다면, 우리 웹사이트에서도 세부 사항을 찾을 수 있습니다.

제이미: 정말? 그거 환상적이야!

나는 그들이 확실히 그것을 이용하고 싶어할 것이라고 생각한다.

하지만, 에릭, 좋아 나는 다른 회의에 참석해야 해.

나중에 네가 운영하고 싶은 두 번째 앱에 대한 큰 아이디어가 엄청 많아.

Apple Watch용 앱이 얼마나 걸릴 것 같아요?

에릭: 좋아, 하지만 따라잡고 나중에 논의하자; 며칠 후에.

나는 한동안 나를 바쁘게 할 만큼 충분히 가지고 있는 것 같아!

제이미: 오 그래, 네가 올해 WWDC를 위해 코드를 하고 있다고 들었어?

행운을 빌어!

나중에 얘기하자!

에릭: 더 많은 정보를 원하시면, researchandcare.org에서 찾을 수 있습니다.

소스 코드는 GitHub에서 사용할 수 있으며, 올해 당신이 방금 본 세션으로 이어지는 두 개의 다른 세션이 있습니다.

음, 그게 우리가 너희들을 위해 가진 전부야.

우리의 코드와 함께 해주셔서 감사합니다!

우리는 형제 프레임워크인 ResearchKit과 CareKit을 어떻게 함께 사용하여 앱에서 빠르게 반복할 수 있는지 보았습니다.

우리는 또한 몇 가지 새로운 기능과 최신 모범 사례를 다루었습니다.

나는 네가 그 과정에서 몇 가지 팁과 요령을 얻을 수 있기를 바란다.

여기 팀에 있는 우리 모두로부터, 우리는 당신이 훌륭한 WWDC를 갖기를 바랍니다!

♪