10101

안녕하세요, "ReplayKit으로 롤링 클립을 발견하세요"에 오신 것을 환영합니다.

제 이름은 어니스트이고, 저는 ReplayKit 팀의 소프트웨어 엔지니어입니다.

오늘, 저는 당신에게 당신의 애플리케이션 하이라이트를 포착하는 새로운 방법을 보여주게 되어 정말 기쁩니다.

ReplayKit에 대한 개요를 제공하는 것으로 시작하겠습니다.

ReplayKit은 애플리케이션의 화면과 오디오를 녹음할 수 있는 프레임워크입니다.

사람들이 교육용 비디오를 만들고 싶을 때, 아니면 단순히 게임플레이를 자랑하고 싶을 때, 인앱 화면 녹화는 저장하고 친구들과 공유할 수 있는 비디오를 만듭니다.

그리고 사람들이 만드는 비디오 콘텐츠에 대한 더 많은 통제권을 원한다면 어떨까요?

필터나 오버레이를 추가할 수 있습니다.

인앱 화면 캡처로 이것을 할 수 있습니다.

인앱 화면 캡처는 오디오 및 비디오 샘플을 신청 프로세스에 직접 제공하므로, 생성되는 콘텐츠를 완벽하게 제어할 수 있습니다.

그리고 우리 모두는 게임을 하는 것 다음으로 가장 좋은 것은 게임플레이를 라이브로 보는 것이라는 것을 알고 있다.

인앱 방송을 사용하면 사람들이 애플리케이션을 타사 방송 서비스로 쉽게 스트리밍하여 전 세계에서 볼 수 있습니다.

우리의 현재 녹음 기능은 다양한 사용 사례를 다루지만, 현재 우리가 하지 않는 것이 있다.

그래서, 당신의 선수들이 모든 적과 싸우고 게임에서 레벨의 열쇠를 잠금 해제했다고 상상해 보세요. 그리고 이제 그들은 그 순간을 친구들과 공유하고 싶어합니다.

하지만 그들이 이 레벨을 플레이하는 것은 처음이기 때문에, 그들은 뭔가 신나는 일이 일어날지 몰랐고, 그 순간을 포착할 수 없었다.

현재, 플레이어는 기억에 남는 하이라이트를 모두 저장하기 위해 전체 게임플레이를 기록해야 합니다.

이것은 많은 공간을 차지할 뿐만 아니라 더 짧은 클립으로 다듬는 데 시간이 걸리는 큰 녹음을 초래한다.

모든 하이라이트가 일어날 때 바로 기록할 수 있다면 멋지지 않을까요?

아니면 더 나은 것은, ReplayKit이 당신을 위해 이것을 하고, 당신에게 매 순간의 비디오 클립을 제공한다면 어떨까요?

올해, 우리가 작업하고 있는 새로운 기능인 클립 녹화를 보여드리게 되어 기쁩니다.

클립 녹화는 오디오 및 비디오 샘플의 롤링 버퍼를 유지합니다.

클립 내보내기가 호출되면, 최대 15초 전의 샘플을 짧은 비디오 클립으로 내보낼 수 있습니다.

그래서 이제, 언제 녹음을 시작해야 하는지 알아야 하는 대신, 언제 내보내고 싶은지 알기만 하면 됩니다.

비디오 클립을 내보내는 방법에는 여러 가지가 있습니다.

UI 버튼이나 게임 컨트롤러 지원을 애플리케이션에 추가할 수 있으므로, 사람들은 클립을 캡처할 때를 수동으로 제어할 수 있습니다.

버튼을 탭하면, 그들은 원할 때 정확히 클립을 얻을 수 있다.

애플리케이션에 클립을 자동으로 캡처하는 트리거를 추가할 수도 있습니다.

이것으로, 당신은 그들이 완벽한 콤보를 얻거나, 최종 보스를 물리치거나, 최고의 스피드 런을 이길 때 항상 흥미진진한 순간을 포착할 것입니다.

그리고 이 모든 클립으로, 당신은 개인화된 사용자 경험을 만들 수 있습니다.

녹음 컬렉션에 열리는 사용자 지정 오버레이를 추가하거나, 플레이어가 보고 공유할 수 있도록 레벨 끝에 캡처된 모든 클립이 있는 하이라이트 릴을 제공할 수 있습니다.

클립 녹화는 iOS 및 macOS에서 사용할 수 있으며, 기존 녹화, 캡처 및 방송 API와 함께 사용할 수 있는 강력한 기능입니다.

다른 기능과 마찬가지로, 클립 녹화는 동일한 HD 품질, 저성능 영향 및 내장된 개인 정보 보호 장치를 제공합니다.

클립 녹화는 후드 아래에서 어떻게 작동하나요?

한 번 보자.

클립 녹화에는 시작, 중지 및 내보내기의 세 가지 API가 포함되어 있습니다.

클립 버퍼링을 시작하려면, 애플리케이션은 RPScreenRecorder를 호출하여 sharedRecorder 싱글톤 인스턴스를 가져와야 합니다.

공유 인스턴스를 사용하면 startClipBuffering API를 호출할 수 있습니다.

이 시점에서, ReplayKit은 애플리케이션의 화면과 오디오 샘플을 롤링 버퍼에 저장합니다.

ReplayKit이 새로운 샘플을 받을 때마다, 15초보다 오래된 샘플은 폐기됩니다.

롤링 버퍼가 시작된 후, ReplayKit은 애플리케이션이 내보내라고 말할 때까지 기다립니다.

응용 프로그램이 내보내기 클립 API를 호출할 때, ReplayKit은 나머지를 처리하고 그 순간의 비디오 클립을 반환합니다.

롤링 버퍼가 더 이상 필요하지 않거나 인앱 브로드캐스트와 같은 다른 ReplayKit 기능을 사용하고 싶을 때, 정지 API를 호출할 수 있으며, ReplayKit은 세션을 중단할 것입니다.

이 정보를 염두에 두고, 새로운 클립 API를 구현하는 샘플 프로젝트를 보여드리겠습니다.

당신은 이미 작년 우리 세션의 이 샘플 프로젝트에 익숙할 것입니다.

업데이트된 샘플 프로젝트에는 이제 클립 코드가 포함되어 있습니다.

이 코드를 살펴봅시다.

다른 녹음 세션과 마찬가지로, 메인 스토리보드의 "클립 시작" 버튼과 관련된 IBAction이 있습니다.

이 버튼은 아직 활성화되어 있지 않은 경우 클립 버퍼링을 시작하고, 활성 상태인 경우 클립 버퍼링을 중지하는 데 사용됩니다.

이제, 클립 버퍼링을 시작할 때 어떤 일이 일어나는지 살펴봅시다.

여기 클립 버퍼링을 시작하는 코드가 있습니다.

RPScreenRecorder에서 공유 레코더 인스턴스를 가져오고 완료 핸들러로 startClipBuffering을 호출할 것입니다.

여기서, 완료 핸들러 내에서, UI 업데이트를 포함하여 시작하려고 시도하는 동안 발생한 모든 오류를 처리해야 합니다.

오류가 없다면, 녹화가 현재 활성화되어 있음을 보여주기 위해 UI를 업데이트해야 합니다.

시작과 마찬가지로, 샘플 프로젝트에는 정지 클립 버퍼링 방법이 있습니다.

이곳은 공유 인스턴스를 얻을 수 있는 곳이지만, 이번에는 stopClipBuffering API를 호출할 것입니다.

완료 핸들러에서, 중지를 시도하는 동안 발생한 오류를 처리해야 하며, 더 이상 기록하지 않는다는 것을 보여주기 위해 UI를 업데이트해야 합니다.

이제 클립 버퍼링을 시작하고 중지하기 위한 코드를 살펴봤으니, 클립을 내보내는 데 필요한 코드를 살펴봅시다.

이것은 "클립 내보내기" 버튼과 관련된 IBAction의 코드입니다.

그 행동은 사람이 클립을 생성하고 싶다고 결정할 때 촉발된다.

이 접근 방식에 제한되지 않으며 자신의 애플리케이션 트리거에 따라 클립을 자동으로 내보낼 수 있습니다.

여기서, 당신이 적극적으로 녹음하고 있고 이전 startClipBuffering 방법에서 버튼이 활성화되어 있다면, exportClip 함수가 호출될 것입니다.

exportClip API를 호출하려면, URL과 클립 기간을 지정해야 합니다.

시작 및 중지 API와 마찬가지로, 당신은 completionHandler의 오류를 처리할 것입니다.

오류가 없다면, 지정된 URL에 클립이 있어야 합니다.

클립에 액세스하면, 자신만의 사용자 경험을 구축하고 구성할 수 있습니다.

여기 내 샘플 코드에서, 클립은 단순히 사진에 저장됩니다.

그리고 그게 다야!

이 세 가지 API를 사용하면 이제 애플리케이션에 녹화 클립을 추가할 수 있습니다.

지정된 URL의 클립에 직접 액세스할 수 있으므로, 자신만의 인앱 경험을 구축할 수 있습니다.

앞서 언급했듯이, 클립을 얻는 또 다른 방법은 게임 컨트롤러 지원을 추가하는 것이다.

게임 컨트롤러 프레임워크에는 이제 클립 녹화가 내장되어 있습니다.

게임 컨트롤러에서 내보낸 클립은 사진이나 데스크톱에 직접 저장됩니다.

따라서, 생성된 클립으로 자신만의 인앱 경험을 만들려면, ReplayKit 클립 API를 구현해야 합니다.

ReplayKit과 게임 컨트롤러 프레임워크를 모두 통합할 때, RPScreenRecorder에서 사용 가능한 속성과 기록 속성 모두에 대해 키 값 관찰을 사용하는 것이 좋습니다.

또한 필요에 따라 애플리케이션의 상태를 업데이트할 수 있도록 RPScreenRecorderDelegate 프로토콜을 따르십시오.

그리고 응용 프로그램에 클립 녹화를 통합하는 것은 간단합니다.

클립 녹화를 통해, 당신의 애플리케이션은 모든 흥미진진한 순간을 포착할 준비가 될 것입니다.

저는 당신이 만들 모든 클립과 새로운 사용자 경험을 보기를 기대합니다.

우리 세션을 봐줘서 정말 고마워.

나는 네가 멋진 WWDC를 보내길 바라.

[타격적인 음악].