10191

♪ Nhạc bass đang phát ♪

♪

Max Stepanov: Xin chào! Tên tôi là Max, và tôi là một kỹ sư phần mềm trong nhóm tvOS.

Hôm nay, tôi rất vui được chia sẻ với bạn một giao diện hoàn toàn mới tuyệt vời về giao diện người dùng phát lại phương tiện trên Apple TV và những gì bạn có thể làm để tận dụng tối đa chức năng mới này có sẵn cho bạn với tư cách là nhà phát triển.

Trong phiên này, chúng tôi sẽ tổng quan các cải tiến cho giao diện người dùng phát lại tiêu chuẩn trong tvOS 15; chúng tôi sẽ giới thiệu các API mới; và cuối cùng, chúng tôi sẽ thảo luận về các phương pháp hay nhất sẽ giúp bạn tạo ra trải nghiệm phát lại tuyệt vời trong ứng dụng của mình.

Hãy bắt đầu nào.

AVPlayerViewController cung cấp khả năng phát lại phương tiện tiêu chuẩn cho người dùng trên Apple TV.

Nó hỗ trợ nhiều loại điều khiển từ xa, bao gồm điều khiển từ xa Click Wheel mới, cũng như chức năng bỏ qua, quét, cọ rửa, lệnh Siri, hỗ trợ xen kẽ và hơn thế nữa.

Chúng tôi khuyến khích bạn bắt đầu sử dụng AVPlayerViewController trong ứng dụng của mình để cho phép người dùng có trải nghiệm tương tự như với các ứng dụng của bên thứ nhất trên Apple TV.

Nếu bạn chưa sử dụng AVPlayerViewController - hoặc sẽ được hưởng lợi từ việc bồi dưỡng - tôi khuyên bạn nên xem "Cung cấp phát lại phương tiện trực quan với AVKit" từ WWDC 2019, chi tiết hơn về cách kết hợp AVPlayerViewController vào ứng dụng của bạn.

Bây giờ, hãy tổng quan về những cải tiến mà chúng tôi đang mang lại trong năm nay.

Trong tvOS 15, chúng tôi đã thiết kế lại hoàn toàn giao diện người dùng phát lại tiêu chuẩn để giúp người xem ở lại thời điểm này thông qua trải nghiệm tương tác, nhất quán hơn.

Bằng cách thêm các điều khiển và tùy chọn có liên quan vào thanh truyền tải, chúng tôi đã cải thiện khả năng khám phá các tác vụ phát lại phổ biến, chẳng hạn như bật phụ đề hoặc thay đổi ngôn ngữ âm thanh.

Các điều khiển thanh vận chuyển đều phổ biến về bản chất cũng như có thể dành riêng cho ứng dụng.

Và với các tab nội dung mới, giờ đây người dùng có thể dễ dàng truy cập thông tin hỗ trợ - như Thông tin hoặc Chương - giúp điều hướng nội tuyến có thể truy cập và khám phá được.

Các tab nội dung cũng có thể được sử dụng để hiển thị nội dung liên quan.

Ở đây trong ví dụ này, tôi đang xem một phiên từ WWDC năm ngoái và có thể duyệt các đề xuất nội dung cho phiên mà không cần rời khỏi trình phát.

Cuối cùng, chúng tôi đã thêm các hành động theo ngữ cảnh có sẵn cho người dùng trong quá trình phát lại.

Những hành động đó có chức năng hoàn hảo, như Bỏ qua phần giới thiệu hoặc Tóm tắt.

Để tận dụng giao diện người dùng phát lại mới trên Apple TV, ứng dụng của bạn phải được liên kết với tvOS 15 SDK.

Chúng tôi đã thực hiện cách tiếp cận này để duy trì khả năng tương thích với bất kỳ ứng dụng hiện có nào có sẵn cho người dùng trong App Store.

Những ứng dụng đó sẽ nhận được giao diện người dùng và chức năng phát lại tvOS 14 mặc định.

Đến bây giờ, có lẽ bạn rất hào hứng khi học cách áp dụng một số chức năng mới này trong ứng dụng truyền thông của mình.

Vì vậy, hãy đi sâu vào các API mới trong tvOS 15...

...Bắt đầu với Chế độ xem Tiêu đề.

Chế độ xem tiêu đề mới được hiển thị ngay phía trên thanh vận chuyển sẽ giúp người dùng biết ngay những gì họ đang xem.

Để trình bày Chế độ xem Tiêu đề, chúng tôi sẽ sử dụng các giá trị cho commonIdentifierTitle và iTunesMetadataTrackSubtitle từ siêu dữ liệu của AVPlayerItem hiện tại.

Nếu một nội dung phương tiện không chứa siêu dữ liệu được nhúng hoặc bạn cần tăng cường nó, hãy sử dụng thuộc tính externalMetadata của AVPlayerItem.

Khi phát nội dung phát trực tiếp, Chế độ xem tiêu đề cũng sẽ hiển thị huy hiệu để chỉ ra trạng thái nội dung cho người xem.

Cuối cùng, nếu ứng dụng của bạn không muốn hiển thị Chế độ xem tiêu đề, hãy ngăn chặn nó bằng cách đặt giá trị của thuộc tính mới transportBarIncludesTitleView thành sai.

Tiếp theo, chúng ta hãy xem xét các điều khiển thanh vận chuyển.

Điều khiển thanh vận chuyển là một tập hợp các yếu tố giao diện người dùng nằm ngay trên đầu máy chà sàn thanh vận chuyển.

Những điều khiển đó sẽ giúp người dùng nhanh chóng và trực quan tìm thấy tất cả các tùy chọn phát lại mà ứng dụng của bạn có thể cung cấp.

Một số điều khiển tiêu chuẩn - chẳng hạn như phụ đề, ngôn ngữ âm thanh và Picture in Picture - được cung cấp bởi hệ thống.

Là một nhà phát triển, bạn có thể mở rộng danh sách các điều khiển thanh vận chuyển, sử dụng thuộc tính mới của AVPlayerViewController, transportBarCustomMenuItems.

Nó hỗ trợ các trường hợp của các lớp UIAction và UIMenu.

Hãy xem xét một ví dụ về việc sử dụng các điều khiển thanh vận chuyển.

Ở đây, tôi đang sử dụng UIAction để cho phép người dùng thêm mục phương tiện hiện tại vào Mục yêu thích của họ.

Bạn cũng có thể tạo các sắp xếp hành động nâng cao hơn và trình bày chúng trong một menu, sử dụng lớp UIMenu.

UIMenus được trình bày bởi AVPlayerViewController hỗ trợ lên đến một cấp độ lồng nhau, sử dụng tùy chọn displayInline.

Để biết thêm chi tiết về việc sử dụng các lớp UIMenu và UIAction, tôi khuyên bạn nên xem "Hiện đại hóa giao diện người dùng của bạn cho iOS 13" từ WWDC 2019.

Bây giờ, hãy nói về các tab nội dung.

Các tab nội dung sẽ cho phép ứng dụng của bạn hiển thị thông tin bổ sung hoặc các đề xuất cho nhiều nội dung hơn.

AVPlayerViewController sẽ hiển thị tab Thông tin khi nội dung phương tiện chứa siêu dữ liệu được nhúng hoặc khi bạn bổ sung siêu dữ liệu bên ngoài bằng AVPlayerItem.

Ngoài ra, khi bạn cung cấp navigationMarkerGroups với AVPlayerItem, AVPlayerViewController sẽ hiển thị tab Chương.

Ứng dụng của bạn có thể trình bày các tab nội dung bổ sung bằng cách sử dụng thuộc tính mới của AVPlayerViewController, customInfoViewControllers.

Và trong tvOS 15, chúng tôi đang phản đối thuộc tính customInfoViewController để ủng hộ thuộc tính mới cho phép nhiều bộ điều khiển chế độ xem.

Để định cỡ các tab nội dung của bạn một cách thích hợp, vui lòng chỉ định chiều cao bằng cách sử dụng thuộc tính preferredContentSize hoặc xác định các ràng buộc bố cục tự động thích hợp.

Khi tính toán chiều cao cần thiết để hiển thị các tab nội dung, hệ thống sẽ kích thước tất cả các bộ điều khiển chế độ xem theo chiều cao của tab nội dung cao nhất.

Khi làm việc với nhiều tab nội dung, hãy kích thước bộ điều khiển chế độ xem tùy chỉnh của bạn một cách nhất quán hoặc xác minh rằng bố cục được mong đợi trong thời gian chạy.

Và đừng quên đặt thuộc tính tiêu đề trên bộ điều khiển chế độ xem tùy chỉnh của bạn.

Chúng tôi sẽ sử dụng nó cho tiêu đề của tab nội dung.

Để giúp bạn tạo các tab nội dung đẹp mắt, năm nay, chúng tôi sẽ giới thiệu các cấu hình nội dung mới trong khung TVUIKit: Cấu hình TVMediaItemContent và Cấu hình TVMonogramContent.

Hãy cùng xem một vài ví dụ về cách các cấu hình này có thể được sử dụng trong mã của bạn.

Ví dụ, để trình bày danh sách các mục phương tiện ở tỷ lệ khung hình 16:9, bạn có thể sử dụng ô rộng từ TVMediaItem ContentConfiguration.

Đặt các thuộc tính của nó, như hình ảnh, tiêu đề hoặc văn bản phụ.

Bạn cũng có thể cấu hình nó để hiển thị huy hiệu và tiến trình phát lại.

Khi bạn hoàn tất, hãy gán Cấu hình nội dung cho ô xem bộ sưu tập của bạn.

Thật dễ dàng.

Nếu bạn muốn hiển thị mọi người hoặc nhân vật được liên kết với nội dung phương tiện hiện tại, hãy sử dụng TVMonogramContentConfiguration.

Để biết thêm thông tin về việc sử dụng cấu hình nội dung, tôi khuyên bạn nên xem "Cấu hình ô hiện đại" từ WWDC 2020.

Cuối cùng, các hành động theo ngữ cảnh.

Các hành động theo ngữ cảnh cho phép ứng dụng của bạn hiển thị các điều khiển có liên quan trong quá trình phát lại.

Để hiển thị các hành động theo ngữ cảnh, hãy sử dụng thuộc tính Hành động theo ngữ cảnh mới của AVPlayerViewController và cung cấp một hoặc nhiều UIActions.

Thông thường, ứng dụng của bạn sẽ muốn trình bày các hành động theo ngữ cảnh trong một phần có liên quan của nội dung.

Để đạt được điều này, hãy quan sát thời gian AVPlayer bằng cách thêm các quan sát thời gian định kỳ hoặc ranh giới.

Để ẩn các hành động theo ngữ cảnh, hãy đặt lại thuộc tính thành một mảng trống.

Một số bạn có thể đã triển khai các giải pháp cho chức năng bỏ qua trong các ứng dụng của mình.

Với API mới này, sự tương tác của người dùng với các điều khiển theo ngữ cảnh phù hợp với hành vi tập trung và khi được sử dụng, nó cũng sẽ duy trì trạng thái Đang phát cho ứng dụng của bạn.

Bây giờ, hãy nói về một số phương pháp hay nhất với AVPlayerViewController trên tvOS.

Đầu tiên - và quan trọng nhất - tránh thêm các cử chỉ bổ sung cho người chơi.

Điều này sẽ can thiệp vào giao diện người dùng phát lại tiêu chuẩn và chắc chắn có thể không hoạt động trong tương lai.

Thứ hai, bổ sung siêu dữ liệu bị thiếu.

Đôi khi chúng ta có phương tiện truyền thông không có tất cả siêu dữ liệu được gắn với tài sản.

Trong những trường hợp đó, hãy cung cấp tất cả siêu dữ liệu cần thiết - như tiêu đề, tác phẩm nghệ thuật hoặc mô tả - bằng cách sử dụng thuộc tính externalMetadata của AVPlayerItem.

Và khi bạn làm như vậy, chúng tôi sẽ làm phần còn lại để điền vào tab Xem Tiêu đề và Thông tin với tất cả thông tin liên quan.

Cuối cùng, hãy cân nhắc bật Picture in Picture trong ứng dụng tvOS của bạn.

Nó sẽ cung cấp cho người dùng của bạn sự linh hoạt đa nhiệm, cho phép phát lại video đồng thời và khả năng hoán đổi giữa nội dung toàn màn hình và Ảnh trong Ảnh.

Để bắt đầu với Picture in Picture, tôi khuyên bạn nên xem "Master Picture in Picture trên tvOS" từ WWDC 2020.

Vì vậy, để tóm tắt lại.

tvOS 15 giúp việc xây dựng trải nghiệm phương tiện tuyệt vời trở nên dễ dàng hơn bao giờ hết bằng cách sử dụng giao diện người dùng phát lại tiêu chuẩn.

Các API mới mạnh mẽ giúp AVPlayerViewController có thể cấu hình và tùy chỉnh hơn bao giờ hết.

Chưa bao giờ có thời điểm tốt hơn để áp dụng nó vào các ứng dụng của bạn.

Và thật dễ dàng để bắt đầu.

Để biết thêm thông tin, hãy xem các tài nguyên bổ sung cho phiên này trong ứng dụng Nhà phát triển.

Cảm ơn vì đã xem và tận hưởng hội nghị.

♪