10013

♪ ♪

Xin chào và chào mừng.

Tôi là Brian Goldberg, một kỹ sư trong nhóm App Clips.

Tôi nóng lòng muốn chỉ cho bạn một số mẹo và kỹ thuật tuyệt vời để xây dựng App Clips nhẹ và nhanh chóng.

Hãy bắt đầu nào.

App Clips là một cách tuyệt vời để khách hàng của bạn nhanh chóng truy cập và trải nghiệm những gì ứng dụng của bạn cung cấp.

App Clip là một phần nhỏ trong ứng dụng của bạn có thể phát hiện và tải xuống tại thời điểm cần thiết.

App Clips được tích hợp sâu vào hệ điều hành.

Chúng có thể được gọi trong Safari và Tin nhắn cũng như trong thế giới thực bằng cách quét Mã clip ứng dụng, mã QR hoặc bằng cách nhấn vào thẻ NFC.

Các clip ứng dụng cũng xuất hiện trong các đề xuất Bản đồ và Siri.

Phiên này được tải với các phương pháp hay nhất và các mẹo khắc phục sự cố sẽ giúp bạn xây dựng và mang lại trải nghiệm tuyệt vời cho khách hàng của mình.

Tôi sẽ chỉ cho bạn một kế hoạch để kẹp của bạn dưới giới hạn kích thước.

Có thể App Clip của bạn không xuất hiện trên trang web của bạn hoặc thẻ App Clip không xuất hiện khi bạn quét mã.

Có lẽ bạn đang tìm kiếm một số mẹo để duy trì chất lượng trong cơ sở mã của mình, đồng thời đảm nhận sự phức tạp gia tăng đi kèm với việc áp dụng các tính năng mới.

Và có lẽ bạn tò mò muốn biết chức năng nào bạn có thể tận dụng cụ thể và độc đáo cho App Clips.

Cho dù bạn đang xây dựng từ đầu hay thêm mục tiêu clip vào một ứng dụng hiện có, tôi sẽ hướng dẫn bạn các vấn đề trong thế giới thực mà các nhà phát triển phải đối mặt hàng ngày và tôi sẽ cung cấp cho bạn các bước tiếp theo có thể hành động để xây dựng các clip và ứng dụng tốt hơn.

Ngay cả khi người dùng của bạn ở những khu vực có vùng phủ sóng mạng di động tốt, tốc độ tải xuống của họ có thể thay đổi.

Để đảm bảo rằng App Clips có thể được cung cấp theo yêu cầu tại một thời điểm thông báo, kích thước tối đa của App Clip bị giới hạn.

Do đó, với tư cách là một nhà phát triển, điều quan trọng là phải tối ưu hóa nội dung của bạn cho kích thước.

Thật tốt khi biết sớm và thường xuyên trong quá trình phát triển nếu clip của bạn đủ nhỏ gọn để được giao theo yêu cầu.

Nhiều người trong số các bạn đã quen thuộc với quá trình lặp đi lặp lại của việc lập hồ sơ và tối ưu hóa trong phát triển phần mềm.

Tôi muốn chỉ cho bạn một quy trình mà bạn có thể sử dụng Xcode để tạo báo cáo kích thước và xuất IPA cho mỗi biến thể thiết bị.

Sau đó, tôi sẽ hướng dẫn bạn một bộ tối ưu hóa cơ bản và nâng cao mà bạn có thể thực hiện để giảm kích thước của App Clip của mình.

Mục tiêu là để tránh bị ngạc nhiên về thời gian gửi ứng dụng nếu clip của bạn vượt quá giới hạn.

Tôi đã tập hợp một ví dụ thú vị để chúng ta xem xét.

Đó là một phiên bản của mẫu Fruta có một số gotchas khiến nó vượt quá giới hạn kích thước.

Gotchas rất đơn giản để minh họa một số điểm chính.

Các ứng dụng của bạn chắc chắn phức tạp hơn và có nhiều tính năng hơn, vì vậy vui lòng sử dụng ví dụ của tôi làm điểm khởi đầu để khám phá thêm.

Hãy bắt đầu bằng cách khởi chạy vào Xcode để thực hiện các bước tạo báo cáo kích thước và xuất các tệp IPA, và chúng ta sẽ khám phá những gotchas này và tìm hiểu cách khắc phục chúng cùng nhau.

Đầu tiên hãy chọn sơ đồ ứng dụng đầy đủ.

Sau đó vào menu Sản phẩm và chọn Lưu trữ.

Điều này xây dựng dự án bằng cách sử dụng cấu hình được chỉ định trong trình chỉnh sửa sơ đồ.

Khi người tổ chức mở ra, hãy nhấp vào Phân phối ứng dụng.

Chọn Phát Triển.

Bây giờ hãy chọn App Clip của bạn.

Trong danh sách thả xuống App Thinning, chọn tất cả các biến thể thiết bị tương thích.

Đảm bảo rằng việc xây dựng lại từ mã bit được kiểm tra.

Khi kho lưu trữ được chuẩn bị xong, hãy nhấp vào Xuất.

Sau đó chọn một vị trí trên hệ thống tệp để xuất sang.

Bây giờ hãy mở thư mục Xuất trong Finder...

Và sau đó mở App Thinning Size Report.txt.

Có một phần cho mỗi biến thể thiết bị.

Dòng thứ hai đến dòng cuối cùng trong mỗi phần sẽ cho chúng ta biết kích thước không nén cho biến thể đó.

Đó là những gì chúng tôi quan tâm.

Nhìn vào kích thước, điều này cho tôi biết hai điều.

Một, tôi đã vượt quá giới hạn kích thước.

Hai, tôi không thấy ảnh hưởng của việc làm mỏng ứng dụng vì tất cả các biến thể của thiết bị đều có cùng kích thước.

Hãy đóng báo cáo kích thước và đào sâu hơn một chút để xem tại sao lại như vậy.

Mở thư mục con Ứng dụng.

Đổi tên một trong các phần mở rộng IPAs biến thể thành .zip và xác nhận.

Nhấp đúp chuột để giải nén.

Mở thư mục Payload và Control-click để hiển thị nội dung gói.

Hãy nhìn kỹ.

Có vẻ như hình ảnh của tôi là các tài nguyên gói riêng lẻ.

Có lẽ tôi sẽ tiết kiệm được một số không gian nếu tôi đưa những thứ này vào danh mục tài sản.

Tôi thấy một zip tài liệu và một tệp README không thuộc về sản phẩm có thể cài đặt ở đây.

Có một khuôn khổ đang được sử dụng bởi clip của tôi.

Tôi cá là điều đó cũng đang chiếm một số không gian.

Tôi thấy một số thư mục bản địa hóa hiện diện và tôi biết rằng đôi khi các tệp này có thể phát triển nếu không được chọn.

Tệp thực thi được biên dịch tương đối nhỏ...

Nhưng có lẽ có một cách để làm cho nó thậm chí còn nhỏ hơn.

Từng chút một đều có ích.

Hãy tiếp tục và xem có thể làm gì để khắc phục một số vấn đề này.

Quá trình tạo báo cáo kích thước và xem qua IPA rất hữu ích vì nó đã xác định một số bước tôi có thể thực hiện để giảm kích thước App Clip.

Trước tiên hãy bắt đầu với một số bước cơ bản, và sau đó chúng ta sẽ chuyển sang các kỹ thuật nâng cao hơn.

Chúng tôi sẽ kiểm tra kỹ cài đặt xây dựng, chúng tôi sẽ xem xét các lợi ích của việc sử dụng danh mục tài sản, chúng tôi sẽ loại trừ bất kỳ tệp nào khỏi việc chuyển đến sản phẩm cuối cùng không thuộc về và chúng tôi sẽ xem xét mã và cài đặt của mình và tái cấu trúc để giảm kích thước.

Hãy nhớ rằng các tối ưu hóa mà chúng tôi sẽ đề cập áp dụng cho cả ứng dụng của bạn và App Clip, vì vậy hãy thoải mái áp dụng các mẹo này cho cả hai loại sản phẩm.

Bây giờ hãy khám phá từng chủ đề chi tiết hơn.

Phần mã được biên dịch của gói App Clip chắc chắn không phải là phần đóng góp lớn nhất cho kích thước của clip.

Đó chắc chắn là tài sản, mà chúng ta sẽ đến trong giây lát.

Nhưng mỗi chút một đều có ích.

Theo mặc định, Xcode sẽ xây dựng bằng cách sử dụng cài đặt tối ưu hóa nhỏ nhất, nhanh nhất, nhưng hãy kiểm tra kỹ để đảm bảo đó là những gì được đặt trong dự án của tôi.

Đảm bảo ứng dụng đầy đủ được đặt làm sơ đồ đang hoạt động và nhấp vào Tùy chọn để hiển thị cài đặt sơ đồ.

Bản dựng kho lưu trữ của chúng tôi nên được thiết lập để phát hành, nhưng có vẻ như tôi đã thay đổi nó vào một lúc nào đó và quên thay đổi lại.

Tôi cũng đã thử nghiệm một chút trong cài đặt xây dựng và chuyển mức tối ưu hóa phát hành ra khỏi mặc định.

Hãy thay đổi nó trở lại để chúng ta đang sử dụng sự kết hợp tốt nhất giữa kích thước nhị phân nhỏ và thực thi thời gian chạy nhanh.

Hầu hết thời gian, như trong trường hợp của tôi, các tài sản như hình ảnh, âm thanh và video chiếm nhiều dung lượng nhất.

Bước quan trọng nhất bạn có thể thực hiện để giảm tác động của các tài sản này đối với kích thước App Clip của mình là sử dụng danh mục tài sản và điều này là vì hai lý do.

Một, phương tiện bạn thêm vào danh mục tài sản được tự động tối ưu hóa như một phần của quy trình xây dựng Xcode.

Và hai, khi khách hàng tải xuống ứng dụng hoặc clip của bạn, sản phẩm họ tải xuống sẽ đủ nhỏ để chỉ chứa nội dung phù hợp với thiết bị của họ.

Điều này còn được gọi là làm mỏng ứng dụng, và chúng ta chắc chắn nên tận dụng nó.

Trong dự án của mình, tôi thực sự nên đưa những hình ảnh đó vào danh mục tài sản.

Chúng ta thực sự có thể làm tốt hơn nữa.

Tôi sẽ tạo một danh mục nội dung thứ hai và tôi sẽ di chuyển tất cả các hình ảnh được chia sẻ giữa ứng dụng của tôi và App Clip vào danh mục này.

Hãy mang cả hai danh mục cạnh nhau.

Chúng tôi sẽ chuyển các biểu tượng và màu sắc vào danh mục được chia sẻ.

Sau đó, chúng tôi sẽ đưa thành phần và hình ảnh sinh tố vào danh mục được chia sẻ.

Vì hình ảnh công thức chỉ cần thiết cho ứng dụng đầy đủ, tôi sẽ đưa chúng vào danh mục không được chia sẻ để chúng không được tính vào kích thước của Clip ứng dụng của tôi.

Tôi sẽ đảm bảo xóa những hình ảnh mà tôi đã sao chép vào thư viện nội dung.

Và cuối cùng, tôi sẽ sử dụng trình chỉnh sửa thành viên mục tiêu để loại trừ danh mục nội dung chưa được chia sẻ khỏi App Clip của mình.

Để tìm hiểu sâu hơn về danh mục tài sản, hãy xem các phiên về tối ưu hóa lưu trữ trong ứng dụng của bạn và tối ưu hóa nội dung ứng dụng.

Trước đó, chúng tôi đã kiểm tra IPA trên hệ thống tệp và chúng tôi thấy một vài thứ không thuộc về tệp README và tệp zip chứa tài liệu.

Hãy tiếp tục và sử dụng trình chỉnh sửa thành viên mục tiêu trong Xcode để loại trừ các tệp này khỏi tất cả các sản phẩm xây dựng của chúng tôi.

Đảm bảo bạn chỉ bao gồm mã trong mục tiêu App Clip của mình cần thiết cho nhiệm vụ đang được thực hiện.

Tôi thấy hữu ích khi xem xét các giai đoạn xây dựng để có cái nhìn tổng quan về mọi tệp nguồn đang đóng góp vào App Clip của tôi.

Nếu tôi thấy thứ gì đó trông không cần thiết, tôi sẽ xóa nó khỏi danh sách các nguồn và xây dựng lại.

Công thức và chức năng phần thưởng của Fruta là cần thiết cho toàn bộ ứng dụng nhưng không cần App Clip, vì vậy hãy xóa các tệp đó.

Bạn thậm chí có thể để trình biên dịch hỗ trợ.

Nếu có lỗi xây dựng, hoặc tệp là cần thiết, có nhiều thứ hơn để xóa hoặc có thể có mã cần được biên dịch có điều kiện từ mục tiêu App Clip.

Theo thời gian, các tệp chuỗi được bản địa hóa có thể bị thổi phồng bằng các chuỗi trùng lặp và không sử dụng.

Kiểm tra các tệp chuỗi và xóa bất kỳ thứ gì không cần thiết.

Tương tự như những gì chúng tôi đã làm cho danh mục tài sản, bạn có thể tạo một tệp chuỗi chuyên dụng để bạn không bao gồm các chuỗi được bản địa hóa của ứng dụng đầy đủ với App Clip của mình.

Tôi đã đề cập đến một số tối ưu hóa cơ bản mà bạn có thể thực hiện ngay hôm nay để chuẩn bị sẵn sàng cho App Clip của mình để gửi.

Bây giờ giả sử, như một phần của quá trình lặp lại này, bạn đo lại, bạn nhìn vào báo cáo kích thước và bạn vẫn không ở nơi bạn cần đến.

Không sao đâu.

Tôi có một số chiến lược tối ưu hóa nâng cao để bạn cân nhắc.

Đầu tiên, hãy đánh giá các phụ thuộc bên ngoài của bạn và xem xét kích thước của chúng.

Hãy nhớ rằng, App Clips là phiên bản nhỏ của ứng dụng của bạn, vì vậy hãy đảm bảo rằng bạn chỉ liên kết những gì cần thiết cho chức năng của clip của mình.

Bạn có nhớ rằng khung SmoothieAccountLogin đã được thêm vào kích thước App Clip của tôi không?

Hầu hết thời gian, có một khung Apple đã được tích hợp vào hệ điều hành sẽ giúp bạn hoàn thành mục tiêu của mình.

Sử dụng một trong những khung tích hợp này là miễn phí và nó sẽ làm cho ứng dụng và App Clip của bạn nhẹ hơn và nhanh hơn, có nghĩa là nó sẽ tải xuống nhanh hơn, khởi chạy nhanh hơn và cho phép khách hàng của bạn hoàn thành nhiệm vụ trong tầm tay nhanh hơn.

Sử dụng Đăng nhập bằng Apple để giúp người dùng dễ dàng đăng nhập vào dịch vụ của bạn chỉ bằng ID Apple của họ.

Đối với thanh toán, Apple Pay nhanh chóng và dễ dàng cho cả bạn, nhà phát triển và khách hàng của bạn.

Để liên lạc qua mạng, hãy sử dụng NSURLSession.

Đối với đồ họa 3D, hãy tận dụng RealityKit và Metal.

Để biết thêm các luồng xác thực chuyên sâu, hãy xem ASWebAuthenticationSession.

Nó hầu như luôn luôn là tài sản chứ không phải mã đẩy kích thước của Clip ứng dụng vượt quá giới hạn.

Thường xuyên hơn không, những tài sản đó là hình ảnh.

Trong các bước cơ bản, tôi đã chuyển tất cả hình ảnh của mình sang danh mục tài sản để tận dụng tối ưu hóa tích hợp và làm mỏng ứng dụng.

Đôi khi điều đó là không đủ và bạn cần thực hiện thêm hành động để giảm kích thước hình ảnh của mình.

Định dạng và các tùy chọn bạn sử dụng khi lưu hình ảnh nguồn thường có thể có ảnh hưởng sâu sắc đến cả kích thước và chất lượng.

Vậy làm thế nào để bạn đưa ra lựa chọn tốt nhất?

Nói chung, hình ảnh PNG sẽ tiêu tốn nhiều dung lượng hơn hình ảnh JPEG, vì vậy hãy sử dụng PNG nếu bạn cần một tính năng cụ thể mà định dạng cung cấp như độ trong suốt...

Hoặc khi việc nén mất dữ liệu của JPEG sẽ dẫn đến mất chất lượng không thể chấp nhận được.

Những ví dụ này chứa các tính năng tần số cao, các cạnh sắc nét và các điểm nổi bật được xác định.

Việc nén không mất dữ liệu của PNG sẽ bảo tồn các tính năng này tốt hơn nhiều so với JPEG.

Và trong khi chúng ta đang nói về chủ đề PNG, hãy xem xét PNG8 cho tài liệu phi nhiếp ảnh.

Hình ảnh bên phải đã được lưu dưới dạng PNG8 để giảm đáng kể kích thước tệp.

Khi bạn xuất hình ảnh của mình, hãy so sánh song song để đảm bảo tối ưu hóa của bạn được duy trì.

Việc giảm độ sâu màu có thể tiết kiệm rất nhiều không gian nhưng chỉ thích hợp cho một số hình ảnh nhất định sẽ không bị ảnh hưởng bởi các hiện vật lượng tử hóa.

Đối với tài liệu chụp ảnh, khi bạn cần tiết kiệm dung lượng, hãy sử dụng JPEG và dựa một chút vào độ nén mất dữ liệu.

Bạn không cần phải chấp nhận mặc định của công cụ tạo nội dung khi lưu hình ảnh của mình.

Trong trường hợp của tôi, tôi đã giảm đáng kể kích thước tệp mà không làm giảm chất lượng.

Hãy để tôi chỉ cho bạn một mẹo nhỏ mà bạn có thể sử dụng trong dự án của mình để đảm bảo chất lượng hình ảnh của bạn được tối ưu hóa khác nhau.

Tôi tạm thời thay thế dứa bằng một quả xoài đã được lưu lại dưới dạng tỷ lệ nén cao hơn.

Điều này cho phép tôi thực hiện so sánh A/B nhanh chóng trong ứng dụng thực tế để xác minh những thay đổi của tôi không dẫn đến mất chất lượng.

Đối với video, hãy mã hóa bằng các tiêu chuẩn mới nhất như HEVC.

Theo nguyên tắc chung, nén âm thanh bằng codec AAC hoặc MP3 và thử nghiệm với tốc độ bit giảm.

Khá thường xuyên, tốc độ bit siêu cao là không cần thiết và clip tốc độ bit thấp hơn sẽ không dẫn đến giảm chất lượng rõ rệt.

Đối với một số loại hình ảnh nhất định như điều khiển giao diện, biểu trưng và biểu tượng, việc thể hiện chúng ở định dạng SVG có thể dẫn đến tiết kiệm không gian đáng kể và vì đó là định dạng vectơ, nó sẽ trông tuyệt vời khi hiển thị ở mọi kích thước.

Nói về định dạng SVG, chúng tôi yêu thích nó rất nhiều, chúng tôi đã chọn nó để hỗ trợ các Biểu tượng SF, điều mà tôi thực sự khuyên bạn nên làm.

Có hơn 2.000 biểu tượng có thể cấu hình để lựa chọn.

Chúng có nhiều loại trọng lượng và cân tự động căn chỉnh với nhãn văn bản và loại động được hỗ trợ ngay lập tức.

Đây là một số mã để giúp bạn bắt đầu sử dụng các ký hiệu SF trong dự án của mình.

Đoạn mã này cho thấy cách một kiểu văn bản tương tự có thể được áp dụng cho cả nhãn và hình ảnh biểu tượng.

Một ràng buộc cơ bản giữ cho nhãn và hình ảnh biểu tượng được căn chỉnh hoàn hảo.

Thay vì bao gồm một số biến thể của một hình ảnh trong danh mục tài sản của bạn, hãy bao gồm một hình ảnh cơ sở và xây dựng các biến thể cần thiết trong thời gian chạy.

Kiểm tra mẫu Fruta để có một ví dụ tuyệt vời về cách điều này được đưa vào thực tế.

Thay vì sử dụng một hình ảnh riêng biệt cho mỗi bản trình bày của thành phần màu cam - một cho chế độ xem bộ sưu tập này, một hình ảnh khác cho chế độ xem hình ảnh đầy đủ với văn bản dọc và điều khiển, và hình ảnh thứ ba cho mặt sau thẻ thành phần...

Một hình ảnh duy nhất này đóng vai trò là tài sản hỗ trợ cho ba mục đích sử dụng riêng biệt.

Kết quả là tiết kiệm không gian đáng kể đạt được bằng cách xây dựng các biến thể trong thời gian chạy.

Cuối cùng, nếu bạn đã hoàn thành tất cả các bước khác và vẫn có nội dung khiến clip của bạn vượt quá giới hạn kích thước, hãy cân nhắc việc lười biếng tải những nội dung đó từ mạng phân phối nội dung.

Ví dụ: vận chuyển nội dung giữ chỗ chất lượng tốt nhưng độ phân giải thấp hơn với App Clip của bạn và sử dụng API hình ảnh không đồng bộ mới để thay thế dần các tài sản này sau khi khởi chạy.

Kiểm tra có gì mới trong phiên SwiftUI để biết thêm.

Và một mẹo: sử dụng điều hòa liên kết mạng để kiểm tra Clip ứng dụng của bạn theo nhiều tình huống băng thông khác nhau để đảm bảo bạn không gây ra bất kỳ sự chậm trễ nào cho khách hàng của mình trong việc hoàn thành nhiệm vụ trước mắt.

Với những tối ưu hóa nâng cao này, chúng tôi đã đi đến cuối chủ đề đầu tiên.

Bạn có thể khám phá thêm và khám phá thêm các kỹ thuật trong tài liệu dành cho nhà phát triển để giảm kích thước ứng dụng của bạn.

Giả sử bạn đã phát hành App Clip của mình để sản xuất và bạn không thấy nó được cung cấp như mong đợi khi bạn xem trang web của mình trong Safari.

Hoặc có thể bạn đã quét mã QR và được chuyển đến Safari thay vì nhìn thấy thẻ App Clip.

Nói chung, những vấn đề này rơi vào một vài nhóm khác nhau: đăng ký trải nghiệm và cấu hình miền liên quan.

Hãy làm bồi dưỡng thuật ngữ nhanh chóng, và sau đó tôi sẽ xem xét một số bước bạn có thể thực hiện để khắc phục sự cố.

Trong App Store Connect, bạn có khả năng thêm hai loại trải nghiệm.

Tất cả các clip ứng dụng phải có trải nghiệm mặc định.

Đối với trải nghiệm mặc định, bạn chỉ định siêu dữ liệu điền vào thẻ App Clip khi được gọi từ trang web của bạn trong Safari hoặc khi ai đó gửi liên kết đến trang web của bạn trong Tin nhắn.

Để tận dụng lợi thế của lời gọi vật lý như quét QR, NFC và Mã kẹp ứng dụng, bạn cần đảm bảo thêm trải nghiệm nâng cao.

Hãy nhớ rằng, việc đăng ký cần có thời gian để lan truyền đến các thiết bị, vì vậy những thay đổi được thực hiện trong App Store Connect sẽ không có sẵn ngay lập tức.

Để có cái nhìn sâu sắc về việc đăng ký trải nghiệm, vui lòng xem các phiên có gì mới trong App Store Connect and Configure và liên kết Your App Clips.

Trước khi hiển thị giao diện người dùng hiển thị App Clip của bạn, hệ điều hành sẽ kiểm tra để đảm bảo rằng miền gọi được liên kết có thể kiểm chứng với App Clip của bạn.

Nói cách khác, điều đó có nghĩa là URL được xem trong Safari hoặc được mã hóa trong mã QR phải có liên kết an toàn thông qua các quyền và tệp AASA với ứng dụng và App Clip của bạn.

Nếu điều này không được cấu hình đúng cách, clip của bạn sẽ không được hiển thị.

Để biết thêm thông tin về việc thiết lập liên kết an toàn này, vui lòng xem phiên Có gì mới trong Liên kết chung và phiên Cấu hình và liên kết các clip ứng dụng của bạn.

Giả sử bạn đã định cấu hình mọi thứ và bạn kiểm tra Safari và bạn mong đợi thấy thẻ App Clip của mình được trình bày nội tuyến như thế này.

Nhưng thật không may, bạn chỉ nhìn thấy trang web của mình và không có gì khác xuất hiện.

Vậy vấn đề có thể là gì, và bạn có thể thực hiện những bước khắc phục sự cố nào?

Đầu tiên, hãy xác minh cú pháp của thẻ meta của bạn và đảm bảo rằng nó trông giống với mẫu này.

Thay thế các trình giữ chỗ màu vàng bằng ID App Store của ứng dụng đầy đủ và bundleID của App Clip tương ứng.

Tôi sẽ chỉ cho bạn một kỹ thuật mà tôi sử dụng để đảm bảo thẻ meta được xây dựng chính xác.

Điều hướng đến trang web của bạn trong Safari và mở trình kiểm tra web.

Mở rộng phần tử đầu và nhìn kỹ vào nguồn.

Sau đó kiểm tra các thuộc tính nút để đảm bảo thẻ meta của bạn được phân tích cú pháp chính xác và App Clip bundleID của bạn hoàn toàn giống với những gì được hiển thị trong Xcode và App Store Connect.

Chuyển tiếp hoặc chuyển hướng có can thiệp vào xác thực miền không?

Example.com không được coi là bằng www.example.com liên quan đến bộ máy xác thực tên miền.

Điều quan trọng cần nhớ ở đây là tên miền phục vụ nội dung, tên miền ở cuối chuỗi chuyển hướng, phải là tên miền phục vụ tệp AASA và được bao gồm trong quyền của tên miền được liên kết của bạn.

Cũng nên nhớ rằng Safari sẽ không hiển thị toàn bộ thẻ App Clip hoặc biểu ngữ Ứng dụng Thông minh nếu tính năng duyệt web riêng tư được bật.

Nếu bạn vẫn bị mắc kẹt, hãy xác minh AASA vượt qua xác thực trong cổng thông tin ASC.

Bạn có thể sử dụng công cụ dòng lệnh SWCutil để truy xuất tệp AASA từ trang web của mình tại vị trí dự kiến.

Điều này rất giống với thao tác được thực hiện bởi App Store Connect.

Bạn có thể sử dụng cái này để đảm bảo không có lỗi nào ngăn App Store Connect truy xuất tệp.

Kiểm tra đầu ra JSON để tìm các lỗi phổ biến như bundleID được chỉ định thay vì applicationID.

Để biết thêm thông tin, vui lòng xem phiên Có gì mới trong App Store Connect cũng như phiên Có gì mới trong Universal Links.

Bây giờ đối với lời gọi vật lý như Mã kẹp ứng dụng, mã QR và thẻ NFC, đây là trải nghiệm được mong đợi.

Nếu không được cấu hình đầy đủ, trang web của bạn sẽ được cung cấp trong Safari thay vì khách hàng của bạn nhìn thấy thẻ App Clip trong Camera.

Nhiều lần lý do điều này xảy ra là vì trải nghiệm nâng cao chưa được tạo cho URL được mã hóa trong mã vật lý của bạn.

Ngay cả khi URL mã QR của bạn giống với URL trang web của bạn và trải nghiệm của bạn hiển thị hoàn hảo trong Safari, vẫn cần tạo trải nghiệm nâng cao trong App Store Connect để cấp nguồn cho mã vật lý của bạn.

Bạn có nhớ slide này từ khi chúng tôi đang khắc phục sự cố Safari invocation không?

Đối với lưu lượng truy cập web, tất cả các chuyển hướng được theo dõi trước khi xác thực tên miền.

Tôi muốn làm cho bạn biết về sự khác biệt tinh tế nhưng quan trọng trong cách xử lý xác thực miền cho các mã vật lý.

Giả sử bạn đã sử dụng một miền duy nhất trong URL mã QR của mình và đã chuyển tiếp tên miền đó đến trang web của bạn để cung cấp tính nhất quán trên các nền tảng.

Bạn đã phục vụ tệp AASA từ miền đó cho những khách hàng nhập trực tiếp qua web.

Bây giờ, đây là sự khác biệt tinh tế.

Để quét mã, cần phải thêm miền chính xác vào quyền của App Clip của bạn và cũng phục vụ tệp AASA từ miền này.

Lý do đằng sau điều này là để đưa ra phản hồi nhanh chóng cho người dùng đang quét mã vật lý.

Và chúng tôi tránh thực hiện các yêu cầu mạng thường dẫn đến việc tuân theo chuỗi chuyển hướng.

Những thay đổi đối với trải nghiệm nâng cao hoặc liên kết trang web cần có thời gian để lan truyền đến các thiết bị.

Nếu bạn chắc chắn rằng URL bạn đang quét đã được thêm vào như một trải nghiệm nâng cao và bạn vẫn không thấy thẻ App Clip, hãy thử xóa bộ nhớ cache trải nghiệm trong cài đặt Nhà phát triển.

Về chủ đề tiếp theo.

Bạn đã thực hiện một số phức tạp bổ sung trong dự án của mình và ưu điểm là bây giờ bạn có trải nghiệm hiện đại hơn, theo dõi nền tảng.

Tôi muốn chỉ cho bạn một số bước bạn có thể thực hiện để nắm bắt chức năng bổ sung trong khi vẫn duy trì mức chất lượng mà bạn đã làm việc rất chăm chỉ để đạt được cho đến thời điểm này.

Chúng ta hãy xem sơ đồ hiển thị chức năng cho một ứng dụng nhà hàng cơ bản.

Trong ví dụ này, khách hàng bắt đầu bằng cách duyệt qua thực đơn của nhà hàng.

Tiếp theo, họ có thể tùy chỉnh một chiếc bánh mì kẹp thịt hoặc một ly cocktail và sau đó thanh toán.

Sau đó, họ thấy trạng thái đơn hàng và các tùy chọn nhận đơn hàng.

Bây giờ giả sử nhà hàng muốn nâng cao trải nghiệm bằng cách thêm hai tính năng: thanh toán tại bàn bằng mã QR và gửi bánh mì kẹp thịt bạn đã tùy chỉnh cho bạn bè dưới dạng liên kết để họ cũng có thể đặt hàng.

Điều này sẽ yêu cầu một số thiết kế lại đáng kể vì cả hai tính năng này đều dựa vào việc khởi chạy trực tiếp đến bước thanh toán.

Các tính năng được yêu cầu thực sự là cơ hội tuyệt vời cho một App Clip, nhưng việc đưa nó vào thiết kế hiện tại sẽ tạo ra rất nhiều sự phức tạp bổ sung.

Những bước nào có thể được thực hiện để làm cho ứng dụng linh hoạt hơn?

Đầu tiên, tôi muốn khuyến khích bạn tạo ra chức năng mô-đun, phẳng trong đó mỗi thành phần của ứng dụng của bạn là độc lập và có thể được khởi chạy trực tiếp.

Cách tiếp cận này phù hợp hơn nhiều với liên kết sâu, đây là nền tảng cho cách các clip ứng dụng được gọi và cung cấp trạng thái.

Thiết kế mô-đun thanh toán được gọi trực tiếp bằng cách cung cấp, ví dụ, một danh sách các mục menu mà bạn có thể mã hóa trong URL.

Bằng cách biểu diễn đơn đặt hàng dưới dạng URL được nhúng trong mã trực quan, bạn cung cấp cho khách hàng của mình khả năng thanh toán séc của họ tại bàn.

Khi một mặt hàng thực phẩm có thể mã hóa trong URL, bạn có thể sử dụng mô hình này để khuyến khích khách hàng chia sẻ những gì họ đã đặt hàng với bạn bè của họ để họ cũng có thể mua cùng một thứ.

Với rất ít chi phí còn lại, bạn có thể áp dụng App Clips và tăng phạm vi tiếp cận của mình bằng cách cung cấp chức năng này theo yêu cầu cho những khách hàng chưa tải xuống ứng dụng của bạn.

Tôi chỉ chỉ ra một số cách để suy nghĩ hơi khác về thiết kế ứng dụng của bạn, để mở khóa chức năng bổ sung trong khi vẫn giữ chi phí ở mức tối thiểu.

Bây giờ chúng ta hãy xem cách giảm thiểu một số mã mẫu liên quan đến việc cung cấp App Clip.

Trong mã ứng dụng của bạn, bạn có thể phản hồi các sự kiện vòng đời, thường bằng các phương pháp này được gọi khi ứng dụng của bạn được khởi chạy hoặc tiếp tục từ nền.

Việc áp dụng App Clips bổ sung thêm một bộ khác của các phương pháp vòng đời chính xác này.

Bạn có thể bị cám dỗ để đặt mã trong các phương thức vòng đời của App Clip để trích xuất URL từ UserActivity và sử dụng URL được trích xuất đó để lấy một số trạng thái và hiển thị một số giao diện người dùng.

Khái niệm này rất hợp lý, nhưng trước khi làm điều đó, tôi khuyên bạn nên tái cấu trúc để mã xử lý cả ứng dụng của bạn và khởi chạy App Clip được chia sẻ.

Điều này giúp loại bỏ toàn bộ loại lỗi và đau đầu khi cố gắng duy trì chức năng tương tự trong các đường dẫn khởi chạy riêng biệt giữa App Clip của bạn và ứng dụng đầy đủ.

Cân nhắc tạo một phương pháp như respondTo lấy hoạt động của người dùng làm tham số.

Sử dụng phương pháp này làm điểm vào chính của ứng dụng và clip của bạn bằng cách gọi trực tiếp từ tất cả các phương pháp vòng đời có liên quan.

Bây giờ bạn đang thực thi mã phổ biến cho cả ứng dụng và clip của bạn, điều này làm giảm đáng kể chi phí.

Có lẽ bạn phản hồi hoạt động của người dùng đó bằng cách trích xuất các mục trong thực đơn nhà hàng từ URL để tạo điều kiện thuận lợi cho khách hàng thanh toán séc tại bàn.

Vì đây là tất cả mã được chia sẻ, bạn có thể thực hiện thay đổi một lần và nhận được các lợi ích trong cả ứng dụng và App Clip của mình.

Bất kỳ cuộc thảo luận nào về việc áp dụng các tính năng hiện đại trong dự án của bạn trong khi vẫn duy trì chất lượng sẽ không hoàn chỉnh nếu không đề cập đến thử nghiệm.

Có hai kỹ thuật cụ thể cho App Clips mà tôi muốn nhắc bạn.

Để phát triển lặp đi lặp lại, khi xây dựng và chạy trong Xcode, hãy đặt biến môi trường _XCAppClipURL thành URL gọi bạn chọn.

Khi bạn chạy clip của mình, URL bạn đặt ở đây sẽ được chuyển đến clip của bạn giống như trên thiết bị của khách hàng.

Để xem clip đang phát triển của bạn được hiển thị bởi hệ điều hành tương tự như các thiết bị sản xuất, hãy điều hướng đến cài đặt Nhà phát triển và tạo trải nghiệm cục bộ.

Bạn thực sự cần dùng thử điều này trước khi gửi clip của mình để hiểu rõ hơn về cách khách hàng của bạn sẽ sử dụng App Clip của bạn trên thiết bị của họ.

Nếu không, bạn đang bỏ lỡ một số cơ hội tuyệt vời để kiểm tra nhiều cách gọi clip của bạn, chẳng hạn như quét mã trong Camera.

Đó cũng là một cách tuyệt vời để thử các tính năng mới trong các bản dựng hạt giống trước khi chúng có sẵn trong sản xuất như trải nghiệm thẻ App Clip mới trong Safari.

Tôi vừa lướt qua bề mặt về những trải nghiệm địa phương tuyệt vời như thế nào khi thử nghiệm App Clips.

Để biết thêm, vui lòng xem phiên Có gì mới trong App Clips năm nay và để biết mô tả chi tiết về thử nghiệm App Clips, vui lòng xem tài liệu dành cho nhà phát triển có tiêu đề Thử nghiệm trải nghiệm khởi chạy App Clip của bạn.

Cuối cùng, có một số chức năng dành riêng cho App Clips mà tất cả các nhà phát triển nên tận dụng.

Khi App Clips được giới thiệu, hai mục quyền được sắp xếp hợp lý đã được cung cấp chỉ dành cho App Clips.

Những mục này được gọi là thông báo tạm thời và xác nhận vị trí.

Bạn có thể cung cấp ủy quyền trước cho khách hàng của mình để tận dụng quyền trên thẻ App Clip.

Thông báo tạm thời cho phép bạn gửi thông báo trong 24 giờ kể từ khi App Clip của bạn được khởi chạy lần cuối và xác nhận vị trí giúp bạn xác nhận khách hàng đang ở trong khu vực bạn mong đợi mà không cần yêu cầu hoặc cần biết vị trí chính xác của họ.

Điều này giúp ngăn chặn việc vô tình thanh toán tại trạm xăng sai hoặc đặt một ly sinh tố từ một cửa hàng Fruta ở sai thị trấn.

Là một nhà phát triển, bạn chọn tham gia chức năng này trong Info.plist của mình.

Giờ đây, App Clips của bạn có quyền truy cập vào các quyền duy nhất này mà không làm gián đoạn việc khởi chạy trải nghiệm của bạn với các cảnh báo yêu cầu nhiều hơn những gì bạn thực sự cần.

Xác nhận vị trí chỉ có sẵn cho các lệnh gọi vật lý như thẻ NFC, Mã kẹp ứng dụng hoặc mã QR.

Khách hàng có thể chọn không tham gia xác nhận vị trí cho phiên hiện tại hoặc cho tất cả các yêu cầu.

Vui lòng đảm bảo xử lý các trạng thái này một cách thích hợp bằng cách kiểm tra lỗi từ confirmAcquired và cung cấp cho khách hàng hướng dẫn hữu ích về những gì đã xảy ra và có thể là các tùy chọn để tiếp tục giao dịch của họ trong các điều kiện thuận lợi hơn.

Ghi chú nhanh về hồ sơ và đăng nhập Xcode.

Hầu hết các bạn đã bật tính năng tự động quản lý đăng nhập trong phần Đăng nhập và Khả năng trong cài đặt dự án của mình, điều này thật tuyệt vời.

Nếu bạn đang quản lý việc ký kết theo cách thủ công, hãy đảm bảo rằng bạn có được một hồ sơ gần đây.

Một lợi ích ngay lập tức là khi khách hàng của bạn nâng cấp từ App Clip lên ứng dụng đầy đủ của bạn, dữ liệu của họ sẽ được di chuyển nhanh hơn.

Đây là một trong nhiều lợi ích cho bạn mà chúng tôi liên tục làm việc.

Có một hồ sơ gần đây đảm bảo rằng ứng dụng và clip của bạn có các khả năng cần thiết để tận dụng những cải tiến này.

Bây giờ bạn đã học được một số kỹ thuật tuyệt vời để xây dựng các clip ứng dụng nhẹ và nhanh chóng.

Đã đến lúc kết thúc tất cả.

Tôi đã đề cập đến các kỹ thuật cơ bản và nâng cao để làm cho clip của bạn đủ nhỏ để được giao nhanh chóng theo yêu cầu.

Tôi đã chỉ cho bạn cách đảm bảo App Clip của bạn đang được gọi ở đâu và như thế nào bạn mong đợi.

Tôi đã chỉ ra một số phương pháp hay nhất để chuẩn bị sẵn sàng cho dự án của bạn để liên kết sâu, để áp dụng App Clips và các liên kết phổ quát.

Và tôi đã đề cập đến chức năng độc đáo và được sắp xếp hợp lý cho App Clips.

Tôi hy vọng bạn có thể khởi chạy Xcode ngay hôm nay và sử dụng một số mẹo này để làm cho App Clip của bạn nhẹ hơn và nhanh hơn.

Hãy chắc chắn kiểm tra phiên họp của đồng nghiệp Yongjun của tôi về Có gì mới trong App Clips năm nay.

Cảm ơn bạn, và chúc bạn có một WWDC tuyệt vời.

[Nhạc lạc quan].