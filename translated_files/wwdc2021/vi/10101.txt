10101

Xin chào, và chào mừng đến với "Khám phá các clip cuộn với ReplayKit."

Tên tôi là Ernest, và tôi là một kỹ sư phần mềm trong nhóm ReplayKit.

Hôm nay, tôi thực sự vui mừng được chỉ cho bạn một cách mới để nắm bắt những điểm nổi bật của ứng dụng.

Hãy để tôi bắt đầu bằng cách cung cấp cho bạn cái nhìn tổng quan về ReplayKit.

ReplayKit là một khuôn khổ cho phép bạn ghi lại màn hình và âm thanh của ứng dụng.

Khi mọi người muốn tạo một video hướng dẫn, hoặc đơn giản là chỉ muốn thể hiện lối chơi của họ, việc ghi màn hình trong ứng dụng sẽ tạo ra một video mà họ có thể lưu và chia sẻ với bạn bè của mình.

Và điều gì sẽ xảy ra nếu bạn muốn kiểm soát nhiều hơn đối với nội dung video mà mọi người tạo ra?

Bạn có thể muốn thêm các bộ lọc bổ sung hoặc lớp phủ.

Bạn có thể làm điều này với tính năng chụp màn hình trong ứng dụng.

Chụp màn hình trong ứng dụng sẽ cung cấp các mẫu âm thanh và video trực tiếp cho quy trình đăng ký của bạn, vì vậy bạn sẽ có toàn quyền kiểm soát nội dung đang được tạo.

Và tất cả chúng ta đều biết điều tốt nhất tiếp theo để chơi một trò chơi là xem trực tiếp trò chơi.

Phát sóng trong ứng dụng giúp mọi người dễ dàng phát trực tuyến ứng dụng của bạn đến các dịch vụ phát sóng của bên thứ ba, để được xem trên toàn thế giới.

Mặc dù các tính năng ghi âm hiện tại của chúng tôi bao gồm nhiều trường hợp sử dụng khác nhau, nhưng có một trường hợp mà chúng tôi hiện không có.

Vì vậy, hãy tưởng tượng người chơi của bạn vừa chiến đấu với tất cả kẻ thù và mở khóa chìa khóa đến một cấp độ trong trò chơi của bạn, và bây giờ họ muốn chia sẻ khoảnh khắc đó với bạn bè của họ.

Nhưng bởi vì đây là lần đầu tiên họ chơi cấp độ này, họ không biết điều gì đó thú vị sẽ xảy ra và họ không thể ghi lại khoảnh khắc đó.

Hiện tại, người chơi sẽ cần ghi lại toàn bộ trò chơi của họ để lưu tất cả những điểm nổi bật đáng nhớ của họ.

Điều này dẫn đến một bản ghi lớn không chỉ chiếm nhiều dung lượng mà còn cần thời gian để cắt thành các clip ngắn hơn.

Sẽ thật tuyệt vời nếu bạn có thể ghi lại tất cả những điểm nổi bật ngay khi chúng xảy ra?

Hoặc thậm chí tốt hơn, điều gì sẽ xảy ra nếu ReplayKit làm điều này cho bạn và cung cấp cho bạn video clip của từng khoảnh khắc?

Năm nay, tôi rất vui được giới thiệu cho bạn một tính năng mới mà chúng tôi đang thực hiện, ghi lại các clip.

Ghi âm các clip sẽ giữ một bộ đệm quay của các mẫu âm thanh và video.

Khi xuất clip được gọi, các mẫu trước tối đa 15 giây có thể được xuất thành một video clip ngắn.

Vì vậy, bây giờ, thay vì cần biết khi nào nên bắt đầu ghi âm, bạn chỉ cần biết khi nào bạn muốn xuất.

Có một số cách để xuất một video clip.

Bạn có thể thêm các nút giao diện người dùng hoặc hỗ trợ bộ điều khiển trò chơi vào ứng dụng của mình, vì vậy mọi người có thể kiểm soát thủ công khi nào cần chụp clip.

Chỉ với một nút bấm, họ có thể lấy clip chính xác khi họ muốn.

Bạn cũng có thể thêm các trình kích hoạt trong ứng dụng của mình để tự động chụp các clip.

Với điều này, bạn sẽ luôn ghi lại những khoảnh khắc thú vị đó khi họ có được một sự kết hợp hoàn hảo, đánh bại trùm cuối hoặc đánh bại tốc độ chạy tốt nhất của họ.

Và với tất cả các clip này, bạn có thể tạo ra trải nghiệm người dùng được cá nhân hóa.

Bạn có thể thêm một lớp phủ tùy chỉnh mở ra một bộ sưu tập các bản ghi âm hoặc bạn có thể trình bày một cuộn nổi bật với tất cả các clip được ghi ở cuối cấp độ để người chơi của bạn xem và chia sẻ.

Ghi âm clip sẽ có sẵn cho iOS và macOS, và là một tính năng mạnh mẽ sẽ nằm bên cạnh các API ghi, ghi và phát sóng hiện có của chúng tôi.

Tương tự như các tính năng khác của chúng tôi, ghi clip sẽ cung cấp cùng chất lượng HD, tác động hiệu suất thấp và các biện pháp bảo vệ quyền riêng tư tích hợp.

Ghi âm clip hoạt động như thế nào dưới mui xe?

Hãy cùng xem nào.

Ghi clip bao gồm ba API: bắt đầu, dừng và xuất.

Để bắt đầu bộ đệm clip, ứng dụng của bạn nên gọi vào RPScreenRecorder để lấy phiên bản singleton sharedRecorder.

Với phiên bản được chia sẻ, bạn có thể gọi startClipBuffering API.

Tại thời điểm đó, ReplayKit sẽ lưu trữ các mẫu màn hình và âm thanh từ ứng dụng của bạn trong một bộ đệm lăn.

Mỗi khi ReplayKit nhận được mẫu mới, bất kỳ mẫu nào cũ hơn 15 giây sẽ bị loại bỏ.

Sau khi bộ đệm lăn bắt đầu, ReplayKit đợi ứng dụng của bạn yêu cầu nó xuất.

Khi ứng dụng gọi API clip xuất, ReplayKit sẽ lo phần còn lại và trả lại cho bạn video clip của thời điểm đó.

Khi bạn không còn cần bộ đệm lăn hoặc khi bạn muốn sử dụng một tính năng ReplayKit khác, chẳng hạn như phát sóng trong ứng dụng, bạn có thể gọi API dừng và ReplayKit sẽ hủy phiên.

Với thông tin này, hãy để tôi chỉ cho bạn một dự án mẫu triển khai các API clip mới.

Bạn có thể đã quen thuộc với dự án mẫu này từ phiên họp của chúng tôi năm ngoái.

Dự án mẫu được cập nhật hiện bao gồm mã cho các clip.

Hãy cùng xem mã này.

Cũng giống như các phiên ghi âm khác, đây là IBAction được liên kết với nút "bắt đầu clip" trong bảng phân cảnh chính.

Nút này được sử dụng để bắt đầu bộ đệm clip nếu bạn chưa hoạt động và dừng bộ đệm clip nếu bạn đang hoạt động.

Bây giờ, chúng ta hãy tiếp tục và xem điều gì sẽ xảy ra khi bạn bắt đầu đệm clip.

Đây là mã để bắt đầu bộ đệm clip.

Bạn sẽ lấy phiên bản máy ghi được chia sẻ từ RPScreenRecorder và gọi startClipBuffering với trình xử lý hoàn thành của bạn.

Tại đây, trong trình xử lý hoàn thành, bạn sẽ cần xử lý bất kỳ lỗi nào xảy ra trong khi cố gắng khởi động, bao gồm cả việc cập nhật giao diện người dùng.

Nếu không có lỗi, thì bạn cũng nên cập nhật giao diện người dùng để hiển thị rằng bản ghi hiện đang hoạt động.

Tương tự như start, có một phương pháp đệm clip dừng trong dự án mẫu.

Đây là nơi bạn sẽ nhận được phiên bản được chia sẻ, nhưng lần này, bạn sẽ gọi stopClipBuffering API.

Trong trình xử lý hoàn thành, bạn sẽ cần xử lý bất kỳ lỗi nào xảy ra trong khi cố gắng dừng và nên cập nhật giao diện người dùng để cho thấy rằng bạn không còn ghi nữa.

Bây giờ tôi đã xem qua mã để bắt đầu và dừng bộ đệm clip, hãy xem mã cần thiết để xuất clip.

Đây là mã cho IBAction được liên kết với nút "xuất clip".

Hành động được kích hoạt khi một người quyết định họ muốn tạo một clip.

Chỉ là một lời nhắc nhở rằng bạn không bị giới hạn bởi cách tiếp cận này và có thể xuất các clip tự động dựa trên các trình kích hoạt ứng dụng của riêng bạn.

Ở đây, nếu bạn đang chủ động ghi âm và nút được bật từ phương thức startClipBuffering trước đó, hàm exportClip sẽ được gọi.

Để gọi exportClip API, bạn sẽ cần chỉ định URL và thời lượng clip.

Tương tự như API bắt đầu và dừng, sau đó bạn sẽ xử lý bất kỳ lỗi nào trong trình xử lý hoàn thành.

Nếu không có lỗi, thì bạn nên có clip tại URL được chỉ định.

Với quyền truy cập vào các clip, sau đó bạn có thể xây dựng và sắp xếp trải nghiệm người dùng của riêng mình.

Trong mã mẫu của tôi ở đây, clip chỉ đơn giản được lưu vào Ảnh.

Và thế là xong!

Với ba API này, giờ đây bạn có thể thêm bản ghi clip vào ứng dụng của mình.

Bạn sẽ có quyền truy cập trực tiếp vào các clip trong URL được chỉ định, vì vậy bạn có thể xây dựng trải nghiệm trong ứng dụng của riêng mình.

Như đã đề cập trước đó, một cách khác để có được các clip là thêm hỗ trợ bộ điều khiển trò chơi.

Khung điều khiển trò chơi bây giờ sẽ có bản ghi clip tích hợp.

Hãy nhớ rằng, các clip được xuất từ bộ điều khiển trò chơi sẽ lưu trực tiếp vào Ảnh hoặc Máy tính để bàn.

Vì vậy, để tạo trải nghiệm trong ứng dụng của riêng bạn với các clip được tạo, bạn sẽ cần triển khai API clip ReplayKit.

Khi tích hợp cả ReplayKit và khung bộ điều khiển trò chơi, bạn nên đảm bảo rằng bạn đang sử dụng quan sát giá trị chính cho cả các thuộc tính có sẵn và ghi trên RPScreenRecorder.

Ngoài ra, hãy đảm bảo tuân theo giao thức RPScreenRecorderDelegate để bạn có thể cập nhật trạng thái ứng dụng của mình khi cần thiết.

Và thật đơn giản để tích hợp ghi clip trong các ứng dụng của bạn.

Với việc ghi lại các clip, ứng dụng của bạn sẽ sẵn sàng ghi lại tất cả những khoảnh khắc thú vị khi chúng xảy ra.

Tôi mong muốn được xem tất cả các clip và trải nghiệm người dùng mới mà bạn sẽ tạo ra.

Cảm ơn bạn rất nhiều vì đã xem phiên của chúng tôi.

Tôi hy vọng bạn có một WWDC tuyệt vời.

[Nhạc gõ].