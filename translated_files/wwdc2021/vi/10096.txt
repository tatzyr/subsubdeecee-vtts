10096

♪ Nhạc bass đang phát ♪

♪

Tommy Pauly: Xin chào, tôi là Tommy Pauly, và cùng với đồng nghiệp của tôi, Delziel, tôi sẽ giới thiệu cho bạn một tính năng mới thú vị trong quyền riêng tư trên internet.

iCloud Private Relay là một dịch vụ mới ngăn chặn các mạng và máy chủ giám sát hoạt động của người dùng trên internet.

Và nó có sẵn như một phần của mọi đăng ký iCloud+.

Private Relay không chỉ bảo vệ người dùng khi họ duyệt web mà còn tăng cường bảo vệ lưu lượng truy cập do ứng dụng của bạn tạo ra để đảm bảo bạn không vô tình rò rỉ thông tin người dùng hoặc khiến người dùng bị tấn công bảo mật.

Hôm nay, bạn sẽ tìm hiểu iCloud Private Relay là gì và nó ảnh hưởng đến ứng dụng của bạn như thế nào; cách đảm bảo rằng ứng dụng của bạn hoạt động tốt với Private Relay; cách chuẩn bị các trang web và máy chủ của bạn; và cuối cùng, cách quản lý mạng và giám sát lưu lượng truy cập của bạn khi Private Relay được bật.

Hãy bắt đầu nào.

Private Relay được tích hợp vào iOS và macOS, vì vậy bạn không cần phải làm bất cứ điều gì để áp dụng nó từ ứng dụng của mình.

Điều quan trọng là phải hiểu rằng nó không phải lúc nào cũng ảnh hưởng đến ứng dụng của bạn.

Nó sẽ chỉ áp dụng khi người dùng là người đăng ký iCloud+ và đã bật Private Relay.

Có lẽ bạn đang tự hỏi, Nó thực sự làm gì?

Đây là cách mọi thứ hiện đang hoạt động mà không cần Private Relay.

Khi ai đó truy cập internet, bất kỳ ai trên mạng cục bộ của họ đều có thể thấy tên của tất cả các trang web mà họ truy cập dựa trên việc kiểm tra các truy vấn DNS.

Thông tin này có thể được sử dụng để lấy dấu vân tay của người dùng và xây dựng lịch sử hoạt động của họ theo thời gian.

Không ai có thể âm thầm thu thập tất cả thông tin này, cho dù đó là nhà điều hành Wi-Fi công cộng, người dùng khác trên mạng hay nhà cung cấp dịch vụ internet.

Khi các kết nối đến các máy chủ chạy các trang web, các máy chủ đó có thể thấy địa chỉ IP của người dùng.

Điều này cho phép các máy chủ xác định vị trí người dùng mà không cần sự cho phép rõ ràng.

Tệ hơn nữa, các máy chủ có thể lấy dấu vân tay danh tính người dùng và nhận dạng người dùng trên các trang web khác nhau, ngay cả khi các công cụ như Ngăn chặn theo dõi thông minh trong Safari đang ngăn chặn mối tương quan thông qua cookie.

Đây là những vấn đề lớn đối với quyền riêng tư của người dùng và để khắc phục chúng, chúng tôi cần một cách tiếp cận mới có quyền riêng tư được tích hợp bởi thiết kế.

iCloud Private Relay bổ sung nhiều proxy an toàn để giúp định tuyến lưu lượng truy cập của người dùng và giữ nó ở chế độ riêng tư.

Các proxy được điều hành bởi các thực thể riêng biệt.

Một là Apple, và một là nhà cung cấp nội dung.

Bây giờ, khi ai đó truy cập internet, chỉ có địa chỉ IP của khách hàng được hiển thị cho cả nhà cung cấp mạng và proxy đầu tiên.

Proxy thứ hai chỉ nhìn thấy tên mà người dùng đang yêu cầu và sử dụng nó để xây dựng kết nối với máy chủ.

Điều quan trọng cần lưu ý là không ai trong chuỗi này - kể cả Apple - có thể nhìn thấy cả địa chỉ IP của khách hàng và những gì người dùng đang truy cập.

Các cơ hội lấy dấu vân tay đã bị loại bỏ.

Đây là sự riêng tư theo thiết kế.

Private Relay sử dụng các giao thức vận chuyển mới nhất và xác thực bảo vệ quyền riêng tư để đảm bảo rằng mọi giao dịch đều an toàn và nhanh chóng.

Bạn có thể tìm hiểu thêm về công nghệ này trong phiên "Tập trung vào các trụ cột quyền riêng tư của Apple".

Private Relay tập trung vào việc đảm bảo lưu lượng nhạy cảm nhất trên hệ thống mà không ảnh hưởng đến trải nghiệm người dùng.

Trong iOS 15 và macOS 12, Private Relay sẽ áp dụng cho tất cả các trình duyệt web trong Safari, tất cả các truy vấn độ phân giải tên DNS và một tập hợp con nhỏ lưu lượng truy cập từ các ứng dụng.

Cụ thể, điều này sẽ bao gồm tất cả lưu lượng HTTP không an toàn, chẳng hạn như cổng TCP 80.

Nếu ứng dụng của bạn cung cấp bộ lọc nội dung hoặc bộ lọc kiểm soát của phụ huynh, nó sẽ vẫn thấy lưu lượng truy cập trước khi đi qua Private Relay, vì vậy bạn có thể áp dụng bộ lọc của mình giống như trước đây.

Bạn có thể tìm hiểu thêm về điều này trong phiên "Gặp gỡ API Thời gian Sử dụng Màn hình".

Không phải tất cả các mạng được thực hiện bởi ứng dụng của bạn đều xảy ra qua internet công cộng, vì vậy có một số loại lưu lượng truy cập không bị ảnh hưởng bởi Private Relay.

Bất kỳ kết nối nào mà ứng dụng của bạn thực hiện qua mạng cục bộ hoặc với tên miền riêng sẽ không bị ảnh hưởng.

Tương tự, nếu ứng dụng của bạn cung cấp tiện ích mở rộng mạng để thêm VPN hoặc khả năng proxy ứng dụng, tiện ích mở rộng của bạn sẽ không sử dụng Private Relay và lưu lượng ứng dụng sử dụng tiện ích mở rộng của bạn cũng vậy.

Lưu lượng truy cập sử dụng proxy cũng được miễn.

Tiếp theo, hãy đề cập đến những gì bạn cần làm để đảm bảo ứng dụng của bạn đã sẵn sàng hoạt động tốt với Private Relay.

Tin tuyệt vời là đối với hầu hết mọi ứng dụng, bạn không cần phải làm bất cứ điều gì mới!

Private Relay sẽ chỉ hoạt động.

Tuy nhiên, có một số phương pháp hay nhất mà bạn nên biết.

Private Relay hoạt động bất kể bạn đang sử dụng API mạng nào.

Trong nhiều năm, chúng tôi đã khuyến nghị các ứng dụng của bạn sử dụng các API hiện đại như URLSession và NWConnection.

Bây giờ, bạn có thêm một lý do để áp dụng chúng trong các ứng dụng của mình.

Các API này cung cấp cho bạn các công cụ tốt nhất để hiểu cách Private Relay đang áp dụng cho lưu lượng truy cập của bạn.

Nếu bạn sử dụng URLSession, bạn có thể sử dụng Network Xcode Instrument để kiểm tra các tác vụ của mình, ngay cả khi chúng đang thông qua Private Relay.

Bạn có thể tìm hiểu thêm về cách thực hiện điều này trong phiên "Phân tích lưu lượng HTTP trong Công cụ".

Và bạn có thể sử dụng các API số liệu trong cả URLSession và Network.framework để hiểu khi nào các kết nối của bạn sử dụng Private Relay.

Trong TaskTransactionMetrics, bạn có thể kiểm tra xem nhiệm vụ của bạn có sử dụng proxy hay không.

Trong Báo cáo thành lập của NWConnection, bạn cũng có thể kiểm tra thời gian phân giải tên DNS và từng giai đoạn của thiết lập kết nối proxy.

Private Relay thực hiện một bước tiến lớn hướng tới việc biến các kết nối HTTP không được mã hóa và không an toàn thành dĩ vãng.

Bạn cũng có thể tham gia vào nỗ lực này!

Nếu bạn vẫn đang sử dụng HTTP không an toàn - đó là các kết nối trên cổng TCP 80 - bây giờ là lúc để thay đổi.

Khi Private Relay được bật, các kết nối không an toàn này sẽ được proxy, điều này bảo vệ chúng khỏi những kẻ tấn công trên mạng cục bộ giữa máy khách và proxy.

Tuy nhiên, tốt nhất là các kết nối của bạn được bảo mật từ đầu đến cuối cho tất cả người dùng.

Để làm điều này, hãy đảm bảo máy chủ của bạn hỗ trợ TLS và thay đổi URL của bạn từ http:// sang https://.

Ứng dụng của bạn có thể có ngoại lệ đối với Bảo mật Vận chuyển Ứng dụng để cho phép lưu lượng truy cập không an toàn.

Bạn có thể xem danh sách này để kiểm tra lưu lượng truy cập không an toàn mà ứng dụng của bạn sử dụng và loại bỏ những ngoại lệ này.

Nếu ứng dụng của bạn cung cấp chức năng dựa trên vị trí, đây cũng là thời điểm tuyệt vời để đảm bảo rằng bạn đang sử dụng API từ Core Location thay vì dựa vào các máy chủ suy ra vị trí từ địa chỉ IP.

Vị trí địa lý địa chỉ IP thường không đáng tin cậy và không chính xác.

Vị trí cốt lõi cho phép bạn chỉ định độ chính xác của vị trí bạn cần và dựa trên sự cho phép rõ ràng của người dùng.

Bạn có thể tìm hiểu thêm về những cải tiến mới nhất để truy cập vị trí trong phiên "Tập trung vào trụ cột quyền riêng tư của Apple".

Khi bạn đã chắc chắn rằng ứng dụng của mình đã sẵn sàng cho Private Relay, hãy dùng thử!

Đăng nhập vào iPhone, iPad hoặc Mac bằng đăng ký iCloud+ và đảm bảo Private Relay được bật trong phần iCloud của ứng dụng Cài đặt hoặc trong Tùy chọn Hệ thống.

Bạn có thể cung cấp phản hồi với thẻ "iCloud Private Relay" trong ứng dụng phản hồi.

Bây giờ tôi sẽ giao nó cho đồng nghiệp của tôi, Delziel.

Delziel Fernandes: Cảm ơn, Tommy.

Xin chào, tôi là Delziel Fernandes, và tôi sẽ nói về cách chuẩn bị máy chủ của bạn và quản lý mạng của bạn với Private Relay.

Nếu bạn có các máy chủ mà ứng dụng của bạn dựa vào hoặc người dùng truy cập trong Safari, có một vài điều bạn có thể làm để chuẩn bị cho Private Relay.

Máy chủ của bạn có thể xác định các kết nối đi vào bằng Private Relay bằng cách nhận ra địa chỉ IP proxy.

Các địa chỉ IP proxy này có thể được chia sẻ bởi nhiều người dùng trong một khu vực.

Mỗi địa chỉ được ánh xạ đến một thành phố hoặc khu vực cụ thể.

Vì vậy, nếu bạn áp dụng cơ sở dữ liệu bản đồ IP địa lý chính xác, máy chủ của bạn vẫn sẽ có thông tin liên quan.

Private Relay đảm bảo rằng người dùng không thể sử dụng hệ thống để giả vờ đến từ một khu vực khác, vì vậy bạn có thể tiếp tục thực thi các hạn chế truy cập dựa trên khu vực.

Chi tiết về các địa chỉ IP proxy sẽ có sẵn dưới dạng một bài viết liên quan đến phiên này.

Bây giờ chúng ta hãy xem xét các kết nối mạng từ các thiết bị sử dụng Private Relay.

Khi một thiết bị cố gắng truy cập máy chủ, trước tiên nó sẽ thiết lập kết nối mạng với proxy xâm nhập.

Kết nối này được thiết lập bằng cách sử dụng địa chỉ IP được chỉ định bởi nhà cung cấp mạng.

Thiết bị sau đó sử dụng proxy đầu vào để chuyển tiếp các yêu cầu mạng đến proxy đầu ra bằng cách sử dụng địa chỉ IP proxy đầu vào.

Proxy đầu ra sau đó chuyển tiếp các yêu cầu này đến các máy chủ đích bằng cách chọn một địa chỉ IP ánh xạ đến thành phố hoặc khu vực của thiết bị.

Nói chung, các máy chủ và trang web của bạn nên ngừng chỉ dựa vào địa chỉ IP của khách hàng để xác định vị trí hoặc danh tính của người dùng.

Nếu bạn cần truy cập vị trí, hãy cân nhắc yêu cầu vị trí của người dùng một cách rõ ràng và chỉ ở mức độ chi tiết bạn cần.

Nếu bạn cần xác định người dùng, hãy yêu cầu đăng nhập hoặc một số hình thức nhận dạng rõ ràng khác thay vì giả định rằng địa chỉ IP được gắn với danh tính.

Cuối cùng, hãy đề cập đến một số mẹo để quản lý mạng của bạn khi Private Relay đang được sử dụng.

Nếu bạn đang chạy theo dõi gói trên mạng cục bộ của mình khi Private Relay đang được sử dụng, bạn sẽ thấy một số mẫu lưu lượng truy cập mới.

Bây giờ bạn sẽ thấy nhiều lưu lượng truy cập hơn đang chạy trên cổng UDP 443.

Đây là lưu lượng QUIC - hoặc HTTP/3 - đang được sử dụng để giao tiếp với proxy Private Relay.

Bạn có thể đảm bảo lưu lượng truy cập của mình hoạt động tốt bằng cách cho phép cổng UDP 443 trên mạng của bạn và bằng cách đảm bảo bộ định tuyến hoặc Trình dịch địa chỉ mạng của bạn được điều chỉnh để xử lý tốt.

Bạn cũng sẽ thấy ít truy vấn DNS UDP văn bản rõ ràng hơn trên mạng của mình.

Hãy xem qua một yêu cầu kết nối mạng điển hình từ một thiết bị khi Private Relay không được sử dụng.

Khi một thiết bị cố gắng truy cập máy chủ, trước tiên nó sẽ gửi truy vấn DNS cho tên máy chủ của máy chủ.

Khi tên máy chủ được phân giải thành địa chỉ IP, thiết bị sẽ kết nối với địa chỉ IP của máy chủ bằng giao thức vận chuyển như TCP.

Thiết bị sau đó thực hiện bắt tay ba chiều TCP với máy chủ, sau đó là trao đổi TLS để thiết lập kết nối an toàn với máy chủ.

Nhưng như bạn có thể thấy, nếu không có Private Relay, tên máy chủ của máy chủ và địa chỉ IP của thiết bị kết nối với máy chủ sẽ hiển thị bằng cách quan sát các gói tin trên mạng.

Với Private Relay, trước tiên thiết bị thiết lập kết nối với proxy xâm nhập bằng QUIC hoặc HTTP/3.

Trong quá trình chụp gói, bạn sẽ nhận thấy các gói UDP được gửi đến cổng 443 của proxy xâm nhập.

Khi kết nối mạng được thiết lập với proxy xâm nhập, quyền truy cập vào máy chủ được bảo mật trong kết nối với proxy xâm nhập.

Ở cuối máy chủ, không có thay đổi trong giao thức.

Trao đổi TCP/TLS tương tự như lưu lượng không có Private Relay.

Sự khác biệt duy nhất là máy chủ nhìn thấy kết nối đến từ địa chỉ IP proxy thay vì địa chỉ IP của thiết bị.

Hầu hết các mạng không cần kiểm tra hoặc giám sát tất cả lưu lượng truy cập của người dùng.

Tuy nhiên, nếu bạn điều hành mạng doanh nghiệp hoặc trường học, mạng của bạn có thể có các chính sách yêu cầu chặn tất cả lưu lượng truy cập.

Để hỗ trợ trường hợp sử dụng này, bạn có thể chặn tên máy chủ của máy chủ proxy iCloud Private Relay.

Sau đó, khi một thiết bị kết nối với mạng của bạn, người dùng sẽ nhận được lời nhắc cho biết Private Relay bị chặn trên mạng hiện tại.

Sau đó, họ có thể chọn tắt Private Relay cho mạng đó hoặc chuyển đổi mạng.

Thông tin về tên máy chủ proxy sẽ có sẵn dưới dạng một bài viết liên quan đến phiên này.

Đối với kiểm soát của phụ huynh, giải pháp tốt nhất là sử dụng API bộ lọc nội dung được cung cấp bởi khung NetworkExtension.

Điều này cho phép kiểm tra lưu lượng truy cập trên thiết bị ngay cả khi Private Relay được bật.

Để biết thêm thông tin về API Bộ lọc nội dung, hãy xem các phiên "Gặp gỡ API thời gian sử dụng màn hình" và "Phần mở rộng mạng cho máy Mac hiện đại".

Để kết thúc mọi thứ, hãy sử dụng các API mạng an toàn hiện đại như URLSession trong ứng dụng của bạn; kiểm tra ứng dụng của bạn với Private Relay; và đảm bảo các máy chủ và trang web của bạn hoạt động tốt khi chúng nhận được các kết nối được định tuyến qua Private Relay.

Cảm ơn vì đã xem, mọi người!

♪