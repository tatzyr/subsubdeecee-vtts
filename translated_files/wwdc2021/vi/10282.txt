10282

♪ Nhạc bass đang phát ♪

♪

Erik Hornberger: Chào mừng trở lại phần thứ ba và cuối cùng của mã ứng dụng Nghiên cứu và Chăm sóc của chúng tôi!

Nếu bạn muốn theo dõi, bạn có thể tìm thấy mã nguồn cho ứng dụng này trong tài nguyên phiên.

Hãy đăng nhập và bắt đầu.

Trong phiên cuối cùng của chúng tôi, chúng tôi đã thêm một vài tác vụ vào ứng dụng.

Kể từ đó, tôi đã nhận được tất cả các loại thông báo từ Jamie.

Tôi có cảm giác rằng có điều gì đó đang xảy ra.

Hãy xem nào.

Jamie sẽ đến phòng khám trong 10 phút nữa.

Jamie đã chia sẻ một Danh sách phát Động lực.

Ồ! Như bạn có thể thấy, Jamie luôn nhiệt tình đang trên đường đến gặp các bác sĩ lâm sàng ngay bây giờ.

Có vẻ như Jamie đã yêu cầu chúng tôi thực hiện một vài thay đổi và thêm hai tính năng mới.

Phần đầu tiên là về việc tăng cường các cuộc khảo sát mà chúng tôi đã thực hiện trong phiên hai.

Jamie nói rằng anh ấy đã nhận được một số phản hồi về chúng từ những người thử nghiệm.

Anh ấy nói với chúng tôi phản hồi mà anh ấy nhận được là những người thử nghiệm muốn có thể cho biết những câu trả lời mà họ đã đưa ra sau sự thật.

Ngay bây giờ, thẻ chỉ cho thấy rằng cuộc khảo sát đã được hoàn thành, nhưng nếu bạn cuộn ngược thời gian một vài ngày, không có cách nào để biết bạn đã đưa ra câu trả lời nào vào ngày hôm đó.

Họ cũng muốn chúng tôi hạn chế chỉnh sửa đến ngày hiện tại.

Bạn thực sự không thể xóa các câu trả lời khảo sát hoặc làm lại phạm vi các bài kiểm tra chuyển động trong quá khứ.

Tương tự, thật vô nghĩa khi bạn có thể cuộn ra tương lai và trả lời trước các cuộc khảo sát vào những ngày chưa đến.

Vì vậy, chúng tôi sẽ bắt đầu bằng cách giải quyết phản hồi đó và tăng cường các cuộc khảo sát một chút.

Chúng tôi cũng có tab Insights này trông vẫn còn hơi cô đơn.

Jamie yêu cầu chúng tôi hiển thị một cặp biểu đồ ở đó.

Một cái sẽ nắm bắt được mối quan hệ giữa giấc ngủ và cơn đau, và cái còn lại sẽ cho thấy sự cải thiện về phạm vi chuyển động theo thời gian.

Cuối cùng, Jamie nói với tôi rằng các bác sĩ đã yêu cầu chúng tôi bao gồm một số nội dung giáo dục để giúp những người tham gia hiểu sụn chêm bị rách là gì và ResearchKit sẽ có thể giúp chúng tôi ở đó.

Chúng ta sẽ bắt đầu bằng cách tăng cường các cuộc khảo sát.

Hãy giải quyết việc hiển thị các câu trả lời mà bệnh nhân đã đưa ra.

Chúng tôi sẽ tiếp tục và hiển thị các câu trả lời đã cho dưới dạng văn bản trong thẻ.

Bây giờ, trong CareKit, việc điều chỉnh giao diện của thẻ tác vụ được thực hiện bằng cách chuyển trình đồng bộ hóa chế độ xem vào trình khởi tạo của nó.

Hãy cùng xem cách chúng ta có thể tạo Trình đồng bộ hóa chế độ xem tùy chỉnh.

Chúng tôi sẽ phân lớp OCKSurveyTaskViewSynchronizer hiện có.

Lớp này có hai phương thức mà chúng ta có thể ghi đè: makeView và updateView.

updateView sẽ được gọi mỗi khi dữ liệu trong cửa hàng thay đổi và đó là nơi chúng tôi có thể áp dụng các tùy chỉnh cho chế độ xem của mình.

Chúng tôi luôn bắt đầu bằng cách gọi việc triển khai siêu lớp và áp dụng các cải tiến của chúng tôi lên trên đó.

Chúng tôi sẽ kiểm tra xem liệu có sự kiện nào với kết quả hoàn thành hay không.

Nếu có, điều đó có nghĩa là cuộc khảo sát đã kết thúc.

Chúng tôi sẽ nắm bắt được câu trả lời đau đớn và câu trả lời về giấc ngủ bằng cách tham khảo thuộc tính tử tế mà chúng tôi đặt lại trong phần hai.

Tôi đã đề cập rằng bằng cách thiết lập thuộc tính tử tế, nó sẽ giúp chúng tôi sau này và đây là một trong những ứng dụng mà tôi đang ám chỉ.

Bây giờ chúng ta đã có sẵn câu trả lời, chúng ta có thể sử dụng nội suy chuỗi để chèn câu trả lời vào nhãn hướng dẫn của thẻ.

Và điều đó sẽ quan tâm đến việc hiển thị các câu trả lời.

Jamie cũng yêu cầu chúng tôi vô hiệu hóa việc chỉnh sửa các tác vụ trong quá khứ.

Một cách chúng ta có thể làm điều đó là trước tiên hãy đặt mình làm đại diện cho các thẻ nhiệm vụ khảo sát của chúng ta và sau đó điền vào phương pháp đại diện này: viewController cho nhiệm vụ shouldAllowDeleting OutcomeForEvent.

Công việc của chúng tôi là trả lại một boolean cho CareKit biết liệu nó có cho phép xóa kết quả của một sự kiện cụ thể hay không.

Chúng ta sẽ xem xét ngày diễn ra sự kiện.

Nếu ngày sớm hơn hôm nay, chúng tôi sẽ nói rằng nó không thể bị xóa.

Nếu nó vào hoặc sau ngày hôm nay, chúng tôi sẽ cho phép xóa nó.

Và cứ như vậy, chúng tôi đã ngăn chặn việc xóa dữ liệu trong quá khứ.

Điều thứ ba Jamie hỏi là chúng tôi cũng ngăn người tham gia hoàn thành các cuộc khảo sát vào những ngày trong tương lai.

Để làm điều đó, chúng tôi sẽ leo lên cao hơn một chút trong cùng một tệp đến ngay trước khi chúng tôi tạo bộ điều khiển chế độ xem tác vụ của mình và chúng tôi sẽ sử dụng một số tiện ích Lịch để kiểm tra xem ngày chúng tôi điền nội dung có phải là trong tương lai hay không.

Nếu đó là một ngày trong tương lai, chúng tôi sẽ vô hiệu hóa tương tác với thẻ nhiệm vụ và chúng tôi sẽ giảm độ mờ để chỉ ra trực quan rằng nó đã bị vô hiệu hóa.

Được rồi, tốt quá!

Bây giờ chúng ta cũng không thể hoàn thành các nhiệm vụ trong tương lai.

Hãy xem chúng ta đang đứng ở đâu.

Điều đầu tiên mà bạn sẽ nhận thấy là các câu trả lời được đưa ra cho các cuộc khảo sát hiện được hiển thị trong thẻ nhiệm vụ khảo sát.

Chúng tôi vẫn có tùy chọn xóa hoặc làm lại các cuộc khảo sát vào ngày hiện tại, nhưng nếu chúng tôi vuốt lại quá khứ, chúng tôi không thể làm lại chúng nữa.

Và nếu chúng ta nhảy về phía trước trong tương lai, chúng ta có thể xem trước những gì sắp xảy ra, nhưng chúng ta chưa thể hoàn thành bất kỳ cuộc khảo sát nào.

Ứng dụng của chúng tôi hiện đang thực sự kết hợp với nhau!

Hai điều cuối cùng chúng ta cần làm là biểu đồ và nội dung giáo dục, và cả hai đều nằm trong tab Insights.

Chúng ta sẽ bắt đầu với biểu đồ thanh hai loạt hiển thị xếp hạng cơn đau và số giờ ngủ cạnh nhau.

Chúng ta sẽ cần tạo hai đối tượng OCKDataSeriesConfiguration.

Đầu tiên là cho loạt phim đau đớn.

ID cho CareKit biết dữ liệu của nhiệm vụ nào được vẽ trên biểu đồ.

Chúng tôi cũng sẽ vượt qua tiêu đề huyền thoại, màu sắc, kích thước điểm đánh dấu - xác định độ rộng của các thanh - và trình tổng hợp sự kiện.

Trình tổng hợp sự kiện chịu trách nhiệm xem xét tất cả các sự kiện xảy ra vào một ngày nhất định để xác định giá trị Y nào nên được sử dụng vào ngày đó.

Đối với nhiệm vụ đăng ký, chúng tôi biết sẽ chỉ có một sự kiện mỗi ngày, vì vậy chúng tôi chỉ có thể thực hiện sự kiện đầu tiên và nhận được câu trả lời cho câu hỏi đau đớn.

Vậy đó là cấu hình chuỗi đau đớn.

Chúng ta cũng sẽ cần một cái để ngủ.

Chuỗi giấc ngủ gần như giống hệt nhau.

Chúng tôi đang vẽ biểu đồ dữ liệu từ cùng một nhiệm vụ đăng ký.

Sự khác biệt là chúng ta hiển thị câu trả lời về giấc ngủ, thay vì câu trả lời đau đớn.

Với cả hai thứ này trong tay, chúng ta có thể xây dựng một bộ điều khiển chế độ xem biểu đồ.

Chúng tôi sẽ chọn một biểu đồ thanh và đặt ngày đến hôm nay.

Tất nhiên, chúng ta cũng cần vượt qua hai loạt bài của mình và một tham chiếu đến người quản lý cửa hàng, được sử dụng để cập nhật biểu đồ khi nội dung của cửa hàng thay đổi.

Tuyệt vời, vì vậy đó là biểu đồ đầu tiên của chúng tôi.

Hãy làm thêm một cái nữa!

Lần này, nó sẽ là một biểu đồ phân tán cho phạm vi chuyển động.

Chúng ta sẽ cần tạo một cấu hình chuỗi dữ liệu giống như chúng ta đã làm trước đây, nhưng lần này, chúng ta sẽ chỉ cần một cấu hình.

Sự khác biệt duy nhất lần này là chúng tôi đang vẽ biểu đồ dữ liệu từ nhiệm vụ phạm vi chuyển động thay vì nhiệm vụ đăng ký và chúng tôi đang sử dụng câu trả lời phạm vi cho trục Y.

Tiếp theo, chúng tôi sẽ tạo bộ điều khiển chế độ xem của mình.

Lần này nó sẽ là một biểu đồ phân tán, và chúng ta chỉ có một chuỗi dữ liệu.

Và cứ như vậy, chúng tôi đã thiết lập cả hai biểu đồ của mình.

Hãy xem chúng trông như thế nào.

Nhảy qua tab Insights, chúng ta có thể thấy cả hai biểu đồ của chúng ta hiện đang hiển thị.

Chúng trông rất đẹp!

Nếu chúng tôi quay lại và chúng tôi thêm hoặc xóa một số kết quả - ở đây, chúng tôi sẽ xóa cả hai kết quả cho Thứ Ba - và sau đó quay lại tab Thông tin chi tiết, chúng tôi sẽ thấy biểu đồ của mình được cập nhật tự động.

Và họ có!

Không còn bất kỳ dữ liệu nào được hiển thị cho thứ Ba.

Tuyệt vời! Vì vậy, các biểu đồ trông rất đẹp.

Jamie cũng yêu cầu chúng tôi cung cấp cho những người tham gia một tùy chọn để xem mô hình 3D của đầu gối và sụn chêm, cùng với một số văn bản giải thích mà anh ấy nhận được từ các đối tác lâm sàng của chúng tôi.

ResearchKit có thể giúp chúng tôi với điều đó.

Tôi muốn tạm dừng một chút để lưu ý rằng lần này, chúng tôi không ràng buộc cuộc khảo sát ResearchKit với lịch trình CareKit.

Không có thời gian cụ thể nào mà chúng tôi muốn người tham gia xem nội dung này, vì vậy chúng tôi không cần khái niệm về lịch trình.

Tương tự, không có bất kỳ kết quả nào để chúng tôi kiên trì vào cửa hàng của CareKit, vì vậy chúng tôi không cần tạo tác vụ CareKit hoặc sử dụng bộ điều khiển chế độ xem tác vụ khảo sát của CareKit.

Điều đó nói rằng, chúng ta có thể sử dụng chế độ xem Nội dung nổi bật mà đồng đội Gavi của tôi đã giới thiệu tại WWDC năm ngoái.

Chúng ta sẽ cần đặt mình làm đại biểu để chúng ta có thể được thông báo khi người tham gia nhấn vào thẻ nội dung nổi bật.

Khi họ làm vậy, chúng tôi sẽ tạo một kneeModelTask, bọc nó trong ORKTaskViewController và trình bày nó cho người tham gia.

Khi họ xem xong mô hình, chúng tôi sẽ nhận được cuộc gọi lại ngay tại đây và chúng tôi có thể sử dụng điều đó như một cơ hội để loại bỏ bộ điều khiển chế độ xem ResearchKit và đưa người tham gia trở lại tab Insights.

Được rồi, rất tuyệt!

Nhưng chúng tôi đang thiếu một định nghĩa ở đây cho nhiệm vụ đầu gối này.

Hãy đi điền vào đó trong Khảo sát.swift.

Nó sẽ chỉ là hai bước, trong đó bước đầu tiên sẽ là một bước hướng dẫn.

Tôi hy vọng những thứ này bắt đầu cảm thấy ít nhất một chút quen thuộc với bạn bây giờ, vì chúng tôi đã sử dụng chúng vài lần ngày hôm nay.

Bước thứ hai là bước mô hình 3D.

Bất cứ khi nào chúng tôi tạo một bước mô hình 3D, chúng tôi cũng cần phải vượt qua một modelManager, vì vậy ngay phía trên nó, chúng tôi sẽ tạo một trình quản lý mô hình USDZ để vượt qua.

Chúng ta sẽ bắt đầu bằng cách trưng bày một robot đồ chơi chỉ để đảm bảo rằng mọi thứ đang hoạt động.

Phần cuối cùng là tập hợp một nhiệm vụ được đặt hàng với cả hai bước của chúng tôi và trả lại nó.

Bây giờ, khi chúng tôi chạy ứng dụng của mình, chúng tôi sẽ thấy thẻ nội dung nổi bật trong tab Thông tin chi tiết và nhấn vào nó sẽ hiển thị bước hướng dẫn của chúng tôi, tiếp theo là mô hình robot đồ chơi của chúng tôi.

Chúng ta có thể tương tác với nó bằng cách xoay, phóng to nó...

Khá gọn gàng!

Nếu bạn muốn biết thêm về cách trình quản lý mô hình 3D hoạt động hoặc cách bạn có thể triển khai phiên bản của riêng mình, bạn có thể xem phiên WWDC của Pariece từ năm ngoái.

Để hoàn thành ứng dụng của chúng tôi, tôi sẽ đổi robot đồ chơi của chúng tôi cho người quản lý mô hình của BioDigital.

Chúng tôi sẽ bao gồm một số ghi chú về điều này trong Read Me của dự án, trong trường hợp bạn muốn biết chi tiết.

Với phiên bản quản lý mô hình này, chúng tôi có thể cung cấp văn bản giáo dục từ các bác sĩ lâm sàng.

Tại đây bạn có thể xem một số nội dung được cung cấp bởi các đối tác lâm sàng của chúng tôi.

Chúng tôi cũng có thể làm nổi bật sụn chêm để người tham khảo để giúp họ hiểu thêm về chấn thương của họ và con đường phục hồi sẽ là gì.

Ứng dụng của chúng tôi hiện đang thực sự kết hợp với nhau!

Thực ra, đó là nó, đó là tất cả!

Chúng tôi đã kiểm tra tất cả các hộp!

Và cũng chỉ trong thời gian ngắn thôi!

Có vẻ như chúng tôi đang nhận được một cuộc gọi khác từ Jamie.

Này Jamie, thời điểm tốt!

Chúng tôi vừa kết thúc mọi thứ mà bạn yêu cầu chúng tôi làm.

Jamie: Ồ wow, vâng. Tôi đang xem nó ngay bây giờ, Erik.

Hãy xem nào...

Vâng, điều này thực sự đang diễn ra tốt đẹp.

Phần còn lại của nhóm sẽ rất vui mừng, và điều này sẽ mở ra rất nhiều cơ hội nghiên cứu!

Câu hỏi nhanh cho bạn.

Trước khi tôi tham gia cuộc họp tiếp theo này, tôi nên nói gì với nhóm để làm nếu họ có bất kỳ câu hỏi nào cho bạn?

Erik: Này, đó là một câu hỏi hay!

Vì vậy, ResearchKit và CareKit đều là mã nguồn mở và nhóm của chúng tôi đang hoạt động trên GitHub.

Nếu họ có bất kỳ câu hỏi nào về các khuôn khổ, nếu họ muốn yêu cầu một tính năng mới hoặc nếu họ muốn đóng góp, hãy yêu cầu họ mở một vấn đề mới trên kho lưu trữ GitHub của chúng tôi.

Jamie: Được rồi, thật tuyệt vời.

Tôi sẽ chuyển thông tin đó cho nhóm.

Erik: Nhân tiện Jamie, bạn nên cân nhắc cho chúng tôi biết thêm về việc học của bạn!

Nếu bạn truy cập researchandcare.org, bạn sẽ tìm thấy một liên kết ở đó mà bạn có thể sử dụng để cho Apple biết chi tiết về việc nghiên cứu của bạn giúp ích cho ai.

Chúng tôi thích nghe về cách các khuôn khổ của chúng tôi đang được cộng đồng sử dụng!

Chúng tôi cũng có một Chương trình Hỗ trợ Điều tra viên cung cấp các khoản tài trợ của Apple Watch cho các tổ chức đề xuất các nghiên cứu mới.

Nếu họ muốn đăng ký, họ cũng có thể tìm thấy thông tin chi tiết trên trang web của chúng tôi.

Jamie: Thật sao? Thật tuyệt vời!

Tôi nghĩ họ chắc chắn sẽ muốn tận dụng điều đó.

Nhưng, Erik, được rồi, tôi phải tham gia một cuộc họp khác.

Tôi có rất nhiều ý tưởng lớn cho ứng dụng thứ hai mà tôi muốn bạn điều hành sau.

Bạn nghĩ một ứng dụng cho Apple Watch sẽ mất bao lâu?

Erik: Được rồi, nhưng chúng ta hãy bắt kịp và thảo luận về điều đó sau; như, trong một vài ngày tới.

Tôi nghĩ tôi có đủ để khiến tôi bận rộn trong một thời gian!

Jamie: Ồ vâng, tôi nghe nói bạn đang làm một mã cùng trong năm nay cho WWDC?

Chúc may mắn với điều đó!

Tôi sẽ nói chuyện với bạn sau!

Erik: Nếu bạn muốn biết thêm thông tin, bạn có thể tìm thấy nó trên researchandcare.org.

Mã nguồn có sẵn trên GitHub và chúng tôi có hai phiên khác trong năm nay dẫn đến phiên bạn vừa xem.

Chà, đó là tất cả những gì chúng tôi có cho các bạn.

Cảm ơn bạn đã tham gia cùng chúng tôi cho mã của chúng tôi!

Chúng tôi đã thấy cách các khuôn khổ anh chị em của chúng tôi, ResearchKit và CareKit, có thể được sử dụng song song để nhanh chóng lặp lại trên một ứng dụng.

Chúng tôi cũng đề cập đến một số tính năng mới và các phương pháp hay nhất mới nhất của chúng tôi.

Tôi hy vọng bạn có thể chọn một vài mẹo và thủ thuật trên đường đi.

Từ tất cả chúng tôi ở đây trong đội, chúng tôi hy vọng rằng bạn có một WWDC tuyệt vời!

♪