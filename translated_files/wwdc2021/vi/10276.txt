10276

♪ Nhạc bass đang phát ♪

♪

Ron Santos: Này, mọi người. Tôi là Ron Santos.

Tôi là một kỹ sư phần mềm làm việc trên Bàn phím.

Và tôi ở đây để chỉ cho bạn cách tận dụng tối đa một tính năng mới cho phép bạn nhập văn bản, không phải bằng cách nhập hoặc đọc chính tả, mà bằng cách sử dụng máy ảnh.

Vì vậy, chúng tôi đã làm việc rất chăm chỉ cho bản phát hành mới này và bây giờ WWDC cuối cùng cũng ở đây, tôi đã sẵn sàng cho một kỳ nghỉ.

Ngay khi nó an toàn, tôi muốn nghỉ ngơi một chút và đi du lịch.

Tuy nhiên, một điều về việc đi du lịch khiến tôi khó chịu là xử lý tất cả các văn bản phi kỹ thuật số đó.

Bạn hiểu ý tôi chứ?

Hóa đơn, tờ rơi hoạt động và chất kết dính khổng lồ mà họ để lại cho bạn trong phòng khách sạn?

May mắn thay, iOS 15 có một tính năng mới cho phép bạn chụp văn bản từ thế giới xung quanh.

Hãy để tôi cho bạn thấy ý tôi là gì.

Kiểm tra nó đi!

Tôi đang xây dựng ứng dụng nhật ký du lịch này.

Tôi sẽ sử dụng nó để ghi lại các chuyến đi tôi đã thực hiện và những nơi tôi đã ở, như chuyến đi cuối cùng của tôi đến Hawaii.

Ở trên cùng ở đây, tôi có thể thêm tiêu đề hình ảnh; có thể là một bức ảnh phong cảnh đẹp từ Camera Roll của tôi.

Sau đó tôi có các trường thông tin khách sạn như tên, số điện thoại và địa chỉ.

Tôi thực sự có tất cả thông tin đó trên một tài liệu ngay trước mặt tôi.

Tôi không muốn phải gõ tất cả ra, và bây giờ tôi không cần phải làm vậy.

Ví dụ, nếu tôi nhấn hai lần vào trường Số điện thoại, tôi sẽ thấy một tùy chọn mới trong menu chỉnh sửa để sử dụng Văn bản từ Máy ảnh.

Khi nó khởi động, máy ảnh sẽ ngay lập tức nhận ra nhóm văn bản này trên tài liệu.

Tôi có thể đóng băng nó và chỉ chọn số điện thoại.

Sau đó tôi nhấn Chèn và tôi đã hoàn tất.

Tôi nghĩ điều đó khá tuyệt vời.

Làm tôi nhớ đến câu nói rằng một bức tranh đáng giá ngàn lời nói như thế nào.

Nhưng với tính năng này, chúng ta thực sự có thể lấy một nghìn từ từ một bức ảnh.

Dù sao, như tôi đã nói trước đó, tôi rất muốn chỉ cho bạn cách tận dụng tối đa tính năng này.

Hãy bắt đầu bằng cách nói về việc lọc nội dung.

Nếu bạn còn nhớ, tôi đã phải kéo-chọn số điện thoại từ khối văn bản lớn.

Chà, tôi không cần phải làm điều đó nếu ứng dụng biết tôi đang tìm kiếm một số điện thoại.

Nó nên bỏ qua mọi thứ khác và chỉ cần lấy số.

Vì vậy, trước tiên, tôi sẽ chỉ cho bạn cách lọc nội dung bạn muốn đơn giản như thế nào.

Việc lọc được thực hiện bằng cách sử dụng các thuộc tính TextContentType và KeyboardType có sẵn trên các trường văn bản và chế độ xem văn bản.

Trên thực tế, có lẽ bạn đã sử dụng các thuộc tính này để hỗ trợ những thứ như Tự động điền.

Nếu vậy, tuyệt vời.

Bạn sẽ nhận được thêm lợi ích cho đầu vào máy ảnh.

Và nếu bạn chưa sử dụng chúng, đây là một số video từ những năm trước chỉ cho bạn cách thực hiện.

OK, quay lại TextContentType.

TextContentType có thể là bất kỳ một trong những giá trị khác nhau này.

Nhưng máy ảnh sẽ không lọc cho tất cả các loại này.

Nó sẽ lọc chỉ trên bảy cái này.

Hãy xem xét một số ví dụ.

Bốn cái đầu tiên này - số điện thoại, địa chỉ đường phố đầy đủ, URL và email - tất cả chúng đều tồn tại từ trước trong iOS ngày nay.

Mới trong iOS 15, chúng tôi đã thêm ba loại bổ sung: số chuyến bay, số theo dõi lô hàng và sự kết hợp của ngày, giờ và thời lượng.

Bạn có thể tưởng tượng số chuyến bay có thể hữu ích như thế nào đối với các ứng dụng du lịch hoặc số theo dõi sẽ thú vị như thế nào đối với các ứng dụng theo dõi gói hàng.

Dù sao, đây là cách bạn sẽ sử dụng các loại nội dung này.

Nó cực kỳ đơn giản.

Nếu bạn đang ở trong Trình tạo Giao diện, hãy tìm Loại Nội dung và Loại Bàn phím trong trình kiểm tra Thuộc tính.

Nếu bạn đang làm điều này trong mã, chỉ cần gán các giá trị bạn muốn.

Ở đây trong ứng dụng nhật ký du lịch của tôi, trường Số điện thoại đang sử dụng bàn phím bàn phím điện thoại và trường Địa chỉ có textContentType of fullStreetAddress.

Và lưu ý rằng đối với số điện thoại, tôi đặt autocorrectionType thành không.

Bởi vì nếu không có ứng cử viên tự động sửa hoặc văn bản dự đoán, iOS sẽ cung cấp cho bạn một nút để truy cập nhanh vào máy ảnh.

Được rồi, chúng ta hãy quay lại ứng dụng của tôi và chúng ta có thể thử chụp lại số điện thoại khách sạn, nhưng lần này, với những thay đổi của chúng ta.

Bây giờ, khi tôi đưa máy ảnh lên, nó sẽ bỏ qua tất cả các văn bản khác một cách thông minh ngoại trừ số điện thoại.

Hãy thử lại lần nữa với trường Địa chỉ.

Điều đó nhanh hơn rất nhiều.

Khai thác và vuốt ít hơn rất nhiều.

Vậy đó là cách bạn lọc nội dung.

Hãy chuyển sang một thử thách khác.

Làm thế nào để chúng ta làm cho chức năng này dễ khám phá hơn để thực sự khuyến khích việc sử dụng nó?

Là nhà phát triển ứng dụng, chúng tôi thích có giao diện người dùng được sắp xếp hợp lý.

Điều đó có nghĩa là đôi khi chúng ta có chức năng bổ sung ẩn sau các menu và cử chỉ mà người dùng không biết.

Ví dụ, nếu tôi sử dụng trường Ghi chú trong ứng dụng của mình, không rõ ràng là tôi có thể sử dụng máy ảnh để nhập ở đây.

Trình đơn chỉnh sửa chỉ xuất hiện trong lần nhấn thứ hai.

Và thanh ứng cử viên có văn bản dự đoán thay vì nút tôi đã chỉ cho bạn trước đó.

Vì vậy, nếu bạn muốn một nút trên màn hình gợi ý về đầu vào máy ảnh, bạn sẽ muốn thêm nút khởi chạy chuyên dụng của riêng mình.

Để làm điều đó, trước tiên chúng ta cần tạo một UIAction bằng cách sử dụng phương pháp captureTextFromCamera factory, mới trong iOS 15.

Hành động biết cách khởi chạy máy ảnh, nhưng cũng cung cấp hình ảnh và nhãn khi nó được sử dụng cùng với các nút và menu.

Hãy thêm một menu vào ứng dụng của tôi với một mục để chèn văn bản từ máy ảnh.

Vậy đây lại là ứng dụng của tôi.

Khi chỉnh sửa trường ghi chú, tôi có thanh công cụ này được hiển thị phía trên bàn phím.

Khi mục thứ hai có biểu tượng máy ảnh được nhấn, tôi muốn một menu xuất hiện cho một loạt các hành động liên quan đến máy ảnh, như tính năng mới của chúng tôi, Văn bản từ Máy ảnh.

Ở đây chúng tôi tạo ra hành động.

Và lưu ý, ngoài mã định danh tùy chọn, phương thức nhà máy chỉ yêu cầu người trả lời chấp nhận văn bản.

Sau đó, tôi tạo các hành động cho các mục menu khác.

Cuối cùng, tôi tập hợp menu và điền nó vào từng hành động tôi vừa tạo, bao gồm cả hành động textFromCamera.

Hãy nhớ rằng, tôi không cần phải chỉ định tiêu đề hoặc hình ảnh nào để sử dụng.

Đó là tất cả được cung cấp bởi hành động.

Tiêu đề thậm chí sẽ được bản địa hóa cho tôi.

Được rồi, hãy thử nó.

Chúng tôi đã trở lại ứng dụng.

Đây là trường Ghi chú và thanh công cụ với menu máy ảnh của chúng tôi.

Hãy để tôi chèn một số văn bản từ một tờ rơi hoạt động trước mặt tôi.

Và xong rồi!

Một trình khởi chạy có thể phát hiện được bởi người dùng chỉ với một vài dòng mã.

Tuy nhiên, có một điều cần ghi nhớ.

Trước khi bạn thêm bất kỳ trình khởi chạy máy ảnh nào, trước tiên bạn sẽ muốn kiểm tra kết quả của canPerformAction withSender.

Đó là bởi vì UIAction của chúng tôi hoạt động bằng cách gọi một phương thức mới trên các đối tượng UIResponder được gọi là captureTextFromCamera, hoạt động tương tự như các hành động chỉnh sửa tiêu chuẩn như cắt, sao chép và dán.

Và những hành động đó không phải lúc nào cũng có sẵn, tùy thuộc vào ngữ cảnh.

Ví dụ, bạn không thể cắt văn bản nếu bạn không chọn gì cả.

Điều tương tự cũng xảy ra ở đây; hành động captureTextFromCamera có một số điều kiện tiên quyết.

Một phương pháp đó sẽ đảm bảo tất cả các yêu cầu đều được đáp ứng.

Nhưng chúng ta hãy xem qua từng người trong số họ.

Bằng cách đó, bạn có ý tưởng tốt hơn về lý do tại sao phương pháp đó có thể trả về sai.

Đầu tiên, có một số yêu cầu phần cứng; không phải tất cả các thiết bị chạy iOS 15 đều hỗ trợ tính năng này.

Thiết bị phải là một chiếc iPhone.

Và không chỉ bất kỳ chiếc iPhone nào, một chiếc có siêu năng lực học máy của Neural Engine.

Ngoài phần cứng, người trả lời của bạn phải xử lý việc chèn văn bản.

Chúng ta sẽ nói nhiều hơn về điều đó sau.

Tiếp theo, và điều này có thể hiển nhiên, nhưng nếu người trả lời của bạn là chế độ xem văn bản hoặc trường văn bản, nó phải có thể chỉnh sửa được.

Và cuối cùng, người dùng phải có ít nhất một trong bảy ngôn ngữ được hỗ trợ này trong danh sách các ngôn ngữ ưa thích của họ.

Bây giờ bạn đã được trang bị tốt để xử lý đầu vào máy ảnh.

Nhưng trước khi chúng ta kết thúc, hãy để tôi cho bạn thấy điều gì đó thú vị mà tôi đã thêm vào ứng dụng của mình.

Nhớ ảnh tiêu đề không?

Thật tuyệt, nhưng tôi nghĩ sẽ rất tuyệt nếu thêm chú thích lên nó.

Có thể là một chú thích được lấy từ máy ảnh.

Vì vậy, tôi đã thêm một nút khởi chạy ở đây giống như những gì chúng tôi đã làm với mục menu.

Và bây giờ, tôi có thể chụp văn bản và đặt nó lên trên hình ảnh.

Nhưng làm thế nào tôi có thể làm điều đó, mặc dù?

Ý tôi là, đó là chế độ xem hình ảnh chứ không phải điều khiển văn bản.

Hãy lùi lại và tìm hiểu cách các điều khiển văn bản hoạt động.

Và sau đó chúng ta sẽ nói về lượt xem hình ảnh sau.

Điều khiển văn bản áp dụng một giao thức gọi là UIKeyInput.

Nó xác định một bộ phương pháp cơ bản để người trả lời chấp nhận nhập bàn phím.

Giao thức có ba phương thức, một trong số đó là phương thức insertText.

Và phương pháp đó chính xác là những gì được sử dụng để truyền văn bản từ máy ảnh đến ứng dụng của bạn.

Vì vậy, để người phản hồi hỗ trợ đầu vào máy ảnh, nó cần áp dụng giao thức này.

Tôi biết tôi vừa nói điều khiển văn bản áp dụng UIKeyInput.

Nhưng trên thực tế, họ áp dụng một giao thức gọi là UITextInput, đây là một phần mở rộng của UIKeyInput.

Nếu bạn áp dụng UITextInput, bạn sẽ nhận được một tính năng bổ sung khi sử dụng máy ảnh: xem trước văn bản sẽ được chèn vào.

Và điều đó được thực hiện với phương thức setMarkedText được hiển thị ở đây.

Tuy nhiên, có một bản xem trước là tùy chọn.

Nếu bạn chọn không có nó, bạn chỉ cần áp dụng UIKeyInput.

Có một giao thức cuối cùng cần đề cập, và bạn có thể đã bắt gặp nó vài phút trước.

Bản thân UIKeyInput mở rộng UITextInputTraits.

Giao thức đó chỉ bao gồm các thuộc tính tùy chọn như KeyboardType và TextContentType, mà bạn biết từ trước đó được sử dụng để lọc đầu vào máy ảnh cho nội dung cụ thể.

Vì vậy, đối với đầu vào máy ảnh, bạn sẽ muốn áp dụng UIKeyInput và, tùy chọn, tùy thuộc vào mức độ chức năng bạn đang theo đuổi, hãy áp dụng UITextInputTraits hoặc UITextInput.

OK. Bây giờ, hãy mang nó trở lại ImageView của chúng ta.

Tôi sẽ tạo một lớp mới gọi là HeadlineImageView phân lớp UIImageView và áp dụng UIKeyInput.

Đây là nó trong mã.

Đó là một lớp con đơn giản của UIImageView và nó có chế độ xem con UILabel mà chúng tôi sẽ sử dụng để hiển thị chú thích.

Hãy nhớ rằng, để áp dụng UIKeyInput, chúng ta cần ba phương thức: hasText, deleteBackward và insertText.

Thông thường, những người phản hồi áp dụng UIKeyInput để triệu hồi bàn phím.

Nhưng bởi vì tôi chỉ muốn đầu vào máy ảnh chứ không phải đầu vào bàn phím, chúng tôi chỉ phải triển khai insertText.

hasText chỉ có thể trả về false và deleteBackward không cần phải làm gì cả.

Đối với insertText, việc triển khai nó thực sự đơn giản.

Nó chỉ lấy văn bản từ máy ảnh và đưa nó vào nhãn của chúng tôi.

Đó là tất cả những gì cần làm!

Bây giờ chúng ta có chế độ xem hình ảnh với cách hiển thị chú thích được chụp từ máy ảnh.

Cảm ơn vì đã thực hiện chuyến đi này với tôi!

Đây là những gì tôi hy vọng bạn sẽ thoát khỏi.

Tận dụng các loại nội dung văn bản.

Chúng giúp đỡ theo nhiều cách, bao gồm cả việc lọc văn bản từ máy ảnh.

Tạo trình khởi chạy của riêng bạn khi bạn thực sự muốn quảng bá đầu vào máy ảnh.

Chúng tôi cung cấp nhãn và hình ảnh cho giao diện nhất quán mà người dùng có thể liên kết với đầu vào máy ảnh trên các ứng dụng.

Nhưng hãy chắc chắn rằng trước tiên bạn kiểm tra xem chức năng có khả dụng hay không.

Cuối cùng, hãy nhớ rằng bạn có thể sử dụng đầu vào máy ảnh cho các phản hồi tùy chỉnh của riêng bạn mà không phải là điều khiển văn bản.

Bạn chỉ cần áp dụng giao thức UIKeyInput.

Du lịch an toàn và tận hưởng phần còn lại của WWDC 2021!

♪