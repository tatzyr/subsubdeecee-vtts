10183

♪ Nhạc bass đang phát ♪

♪

Pierre de Filippis: Xin chào. Tên tôi là Pierre.

Tôi là người quản lý trong nhóm Ứng dụng Truyền thông của chúng tôi và sau đó tôi sẽ được đồng nghiệp Bhaskar tham gia.

Tôi rất hân hạnh được chào đón bạn đến với "Gặp gỡ các hoạt động nhóm". Tôi nghĩ tất cả chúng ta đều có thể nhận ra rằng trong năm qua, việc tìm cách duy trì kết nối cảm thấy cần thiết hơn bao giờ hết.

Điều này cực kỳ quan trọng đối với chúng tôi tại Apple và chúng tôi muốn cung cấp cho người dùng những cách kết nối mới có ý nghĩa.

Kết quả là, trong iOS 15, chúng tôi đang tạo ra một cách mới để tận hưởng các hoạt động cùng nhau khiến bạn cảm thấy như mình đang ở cùng phòng với những người chia sẻ với bạn.

Và chúng tôi gọi nó là "SharePlay."

SharePlay được cung cấp bởi khuôn khổ Hoạt động Nhóm và trong phiên này, chúng ta sẽ nói về cách bạn có thể áp dụng nó trong ứng dụng của mình.

Trước khi chúng ta đi sâu vào một số chi tiết đó, hãy để tôi cho bạn biết thêm một chút về các thành phần chính của SharePlay.

Hãy bắt đầu với giao tiếp.

Chúng tôi nghĩ rằng giao tiếp năng động và tự nhiên là một phần cực kỳ quan trọng của trải nghiệm được chia sẻ có ý nghĩa, vì vậy chúng tôi đã xây dựng SharePlay ngay trong FaceTime và Tin nhắn.

Chúng tôi liên tục bị thổi bay bởi cách các ứng dụng này trở thành trung tâm trong cuộc sống và các mối quan hệ của mọi người, đặc biệt là trong năm qua.

Và mọi người không chỉ sử dụng FaceTime và Tin nhắn để kết nối với người bạn đó từ 30 năm trước một lần trong một thời gian.

Thay vào đó, người dùng của chúng tôi dành một lượng thời gian đáng kể để giao tiếp với những người gần gũi nhất với họ; những người bạn thân nhất và gia đình thân thiết nhất của họ.

Ví dụ, đó là loại người bạn sẽ mời vào phòng khách của mình để xem phim, và đó chính xác là những gì chúng tôi muốn tạo điều kiện với SharePlay.

Hãy để tôi cho bạn một ý tưởng về cách thức hoạt động của nó.

Tất cả bắt đầu với khái niệm về một phiên.

Trước khi một nhóm bắt đầu một hoạt động, họ cần tham gia một phiên để mọi người ở bên nhau và sẵn sàng chia sẻ.

Khi người dùng đang ở trong một phiên, họ có thể giao tiếp qua văn bản, âm thanh và video trong Tin nhắn và FaceTime giống như họ đã quen.

Việc chuyển đổi giữa các chế độ giao tiếp này rất năng động và trôi chảy, vì vậy họ có thể dễ dàng chọn cách giao tiếp phù hợp với thời điểm đó.

Chúng tôi cũng cung cấp cho người dùng một cách nhất quán trên toàn hệ thống để quản lý phiên của họ.

Người dùng có thể mời những người mới một cách nhanh chóng hoặc rời khỏi phiên hoàn toàn.

Khi bạn đang ở trong một phiên, người dùng có thể điều hướng toàn bộ hệ thống và ghé vào bất kỳ ứng dụng nào.

Là một nhà phát triển, bạn nhận được nó miễn phí với Hoạt động nhóm.

Vậy đó là giao tiếp.

Lĩnh vực tiếp theo mà chúng tôi nghĩ là quan trọng là trải nghiệm nền tảng.

Chúng tôi muốn trải nghiệm này đơn giản, nhất quán và có sẵn trên hệ thống và thiết bị của chúng tôi.

Với Hoạt động Nhóm, chúng tôi đang xây dựng một trải nghiệm thống nhất hoạt động trên iOS, iPadOS, macOS, nơi Hoạt động Nhóm có sẵn ngay cả cho trang web của bạn với WebKit.

Nó cũng hoạt động rất tốt trên AppleTV, vì vậy bạn có thể thưởng thức nó trên màn hình lớn.

Tất cả các thiết bị của bạn đều biết khi bạn đang ở trong một phiên, vì vậy bạn có thể tham gia từ bất kỳ thiết bị nào và bạn có thể sử dụng nhiều thiết bị một cách liền mạch.

Cuối cùng, chúng tôi cũng đã thiết kế nó để cung cấp âm thanh tuyệt vời cho các thiết bị Bluetooth, bao gồm cả AirPods.

Là một phần của trải nghiệm nền tảng, chúng tôi đang làm điều gì đó đặc biệt để phát lại nội dung.

Mặc dù chúng tôi hy vọng bạn tận dụng tối đa tính biểu cảm của API để tạo ra nhiều loại hoạt động SharePlay khác nhau, chúng tôi đã tạo ra một số cải tiến thực sự thú vị giúp trải nghiệm truyền thông được chia sẻ dễ dàng xây dựng.

Cốt lõi của bất kỳ trải nghiệm truyền thông nào là nút phát; đó là thời điểm người dùng của bạn quyết định họ muốn dành thời gian cho nội dung nào.

Mục tiêu của chúng tôi là mọi nút phát trên toàn hệ thống hoạt động với SharePlay.

Chúng tôi muốn mọi người cảm thấy rằng bất kỳ phần phương tiện nào trong ứng dụng của bạn đều sẵn sàng bắt đầu trải nghiệm được chia sẻ bất cứ khi nào họ sử dụng FaceTime với bạn bè của họ, đó là nơi bạn đến.

Chúng tôi đang cung cấp các API mới được thiết kế để phù hợp với các đường dẫn mã hiện có của bạn.

Bằng cách áp dụng Hoạt động nhóm, các nút phát của bạn giờ đây có thể bắt đầu những trải nghiệm truyền thông được chia sẻ này bất cứ khi nào cuộc trò chuyện nhóm hoạt động.

Và chúng tôi sẽ sử dụng trí thông minh theo thời gian để thích ứng với hành vi của người dùng, giúp chia sẻ trải nghiệm trở nên dễ dàng.

Tiếp theo là phát lại được đồng bộ hóa theo thời gian.

Chúng tôi nghĩ rằng điều cực kỳ quan trọng là mọi người cười cùng nhau, mỉm cười cùng nhau và phản ứng với nội dung cùng một lúc.

SharePlay xử lý việc đồng bộ hóa thời gian phát lại ở cấp độ nền tảng, vì vậy bạn có thể chỉ cần áp dụng và không phải lo lắng về việc tự cuộn.

Bây giờ, đây là một vấn đề đầy thách thức cần giải quyết khi nói đến việc tiêu thụ nội dung với SharePlay.

Chúng tôi muốn cho phép mọi người trải nghiệm những khoảnh khắc giống hệt nhau, ngay cả khi họ đã đi được nửa vòng trái đất.

Hãy tưởng tượng nhìn thấy và nghe bạn bè của bạn cười vào điều gì đó chưa xảy ra.

Cảnh báo spoiler!

Vì vậy, chúng tôi đã xây dựng một giao thức đồng bộ hóa phát lại hoàn toàn mới với sự tích hợp sâu vào ngăn xếp AVFoundation trên thiết bị.

Điều đó có nghĩa là ai đó nhấn play, và mọi người trong nhóm ngay lập tức bắt đầu phát lại cùng một lúc.

Chuyển đến một cảnh yêu thích và mọi người khác cũng nhìn thấy nó, cho phép mọi người trải nghiệm những khoảnh khắc cùng nhau một cách đồng bộ hoàn hảo, như thể họ đang ở trong cùng một phòng.

Điều kỳ diệu đằng sau việc đồng bộ hóa phát lại này có nghĩa là chúng tôi sẽ không truyền lại phương tiện của bạn theo bất kỳ cách nào.

Mọi người sẽ nhận được video có độ trung thực đầy đủ của bạn vì nó đang phát ngay từ ứng dụng của bạn và phát trực tuyến từ máy chủ của bạn như mọi khi.

Và bằng cách đảm bảo rằng tất cả người xem đang xem video chất lượng cao nhất, họ sẽ có được trải nghiệm xem xã hội nhập vai mà không bao giờ ảnh hưởng đến chất lượng nội dung của bạn.

Chúng tôi cũng đang thực hiện một số công việc đột phá để làm cho giao tiếp cảm thấy tự nhiên trong quá trình phát lại.

Với âm lượng thông minh, khi mọi người lên tiếng trong khi phát lại, chúng tôi sẽ tự động loại bỏ âm thanh của nội dung và đưa nó trở lại khi thích hợp.

Vì vậy, mọi người có thể giao tiếp qua giọng nói, video và văn bản một cách tự nhiên, giống như họ sẽ làm nếu họ ngồi trong cùng một phòng.

Và tất nhiên, nó hoạt động rất tốt với Picture in Picture, vì vậy người dùng có thể mang theo nội dung của bạn khi họ đa nhiệm trên thiết bị.

Vì vậy, đó là một cái nhìn tổng quan ngắn gọn về những gì chúng tôi đang làm trên nền tảng.

Và cuối cùng, nội dung. Và đó là nơi bạn bước vào.

Chúng tôi muốn người dùng có thể thưởng thức nội dung tốt nhất mà bạn đã cung cấp trong ứng dụng của mình.

Khi mọi người đang thực hiện cuộc gọi FaceTime, họ sẽ mong đợi có thể vào ứng dụng của bạn và chia sẻ nội dung của bạn.

SharePlay sẽ cho phép bạn mở rộng các điểm tiếp xúc của sản phẩm và tăng thời gian ứng dụng của bạn có liên quan đến người dùng của bạn.

Và điều này sẽ xảy ra rất hữu cơ.

Người dùng hiện tại sẽ truyền bá cho ứng dụng của bạn khi họ đang sử dụng SharePlay với những người khác.

Bây giờ tôi đã cung cấp cho bạn một cái nhìn tổng quan ngắn gọn về một số thành phần chính của SharePlay, hãy chuyển sự chú ý của chúng ta sang Hoạt động Nhóm, một khái niệm cốt lõi của khuôn khổ.

Hoạt động nhóm là một đối tượng đại diện cho thứ gì đó có thể được chia sẻ và thưởng thức với mọi người trong cuộc gọi FaceTime bằng SharePlay.

Hãy để tôi hướng dẫn bạn cách người dùng sẽ bắt đầu Hoạt động Nhóm trong ứng dụng của bạn.

Trong khi thực hiện cuộc gọi, người dùng có thể điều hướng đến ứng dụng của bạn và nếu bạn đã áp dụng Hoạt động nhóm, họ sẽ được thông báo rằng ứng dụng hỗ trợ SharePlay.

Để định cấu hình hoạt động bạn muốn chia sẻ, trước tiên bạn cần tạo một đối tượng triển khai giao thức GroupActivity.

Khi bạn đã định cấu hình hoạt động của mình, bạn gọi prepareForActivation API để bắt đầu chia sẻ hoạt động đó.

API này sẽ cung cấp cho người dùng tùy chọn chia sẻ hoạt động đó với mọi người trong cuộc gọi FaceTime hoặc chỉ giữ nó cục bộ.

Nếu họ quyết định chia sẻ với nhóm, Hoạt động nhóm sẽ thông báo cho bạn và cho phép bạn tham gia đối tượng GroupSession.

Khi người dùng đã tham gia Phiên nhóm, video của họ sẽ được giữ đồng bộ với nhóm, ngay cả khi họ phát, tạm dừng hoặc tìm kiếm.

Bất cứ khi nào những sự kiện đó xảy ra, Hoạt động nhóm sẽ tự động thông báo cho người dùng như được hiển thị ở đây.

Và cuối cùng, một khi người dùng hoàn tất, họ có thể chọn kết thúc hoạt động cho chính họ hoặc cho cả nhóm.

Nó đơn giản như vậy!

Bây giờ, hãy để tôi giao nó cho Bhaskar, người sẽ hướng dẫn bạn phần còn lại của bài thuyết trình này.

Bhaskar Sarma: Cảm ơn bạn, Pierre.

Xin chào, tên tôi là Bhaskar, và tôi là một kỹ sư trong nhóm FaceTime.

Bây giờ hãy nói về một số khái niệm và kiến trúc cấp cao đằng sau khuôn khổ mới này.

GroupActivities là một khung Swift-native cho phép bạn tạo trải nghiệm được chia sẻ giữa những người dùng ứng dụng của mình khi họ đang thực hiện cuộc gọi FaceTime.

Ngoài ra, khuôn khổ cũng có sự tích hợp chặt chẽ với AVFoundation, cho phép bạn dễ dàng tạo trải nghiệm phát lại video và âm thanh được chia sẻ.

Trước khi chúng ta xem xét các khái niệm cấp cao đằng sau API, tôi muốn nói về hai phần chính của API, và đó là GroupActivity và GroupSession.

GroupActivity là những gì ứng dụng của bạn sử dụng để xác định trải nghiệm được chia sẻ.

Nó chứa thông tin mà ứng dụng của bạn cần cho trải nghiệm được chia sẻ.

Ví dụ: nếu bạn đang thực hiện trải nghiệm phát lại âm thanh hoặc video được chia sẻ, nó có thể giữ URL của nội dung đang được phát.

Hoặc ứng dụng của bạn có thể cung cấp trải nghiệm được chia sẻ tùy chỉnh.

Ví dụ, bạn có thể cung cấp trải nghiệm hòa mình.

Trong trường hợp đó, điều này sẽ chứa thông tin về những gì người dùng đang vẽ.

GroupSession về cơ bản là một đại diện của nhóm tham gia vào trải nghiệm được chia sẻ.

Nó cung cấp quyền truy cập vào những thứ như những người tham gia trong nhóm.

Và có các API bổ sung trong khuôn khổ mà bạn có thể sử dụng cùng với GroupSession để gửi và nhận dữ liệu trên các thiết bị.

Xin lưu ý rằng GroupSession không có nghĩa là trao đổi một lượng lớn dữ liệu.

Ví dụ, nếu bạn đang tạo ra trải nghiệm nghe được chia sẻ, GroupSession không được sử dụng để trao đổi nội dung của bài hát.

Thay vào đó, kênh này được AVFoundation sử dụng để giữ nội dung đồng bộ bằng cách trao đổi các lệnh phát, tạm dừng hoặc tìm kiếm.

Ngoài ra, phương tiện giao tiếp do GroupSession cung cấp được mã hóa đầu cuối.

Điều này có nghĩa là không ai khác ngoài ứng dụng của bạn trên thiết bị có thể đọc dữ liệu được trao đổi qua kênh này.

Ở đây tôi có hai chiếc điện thoại trên màn hình.

Cái bên trái là điện thoại của tôi, và cái bên phải là điện thoại của đồng đội Pierre của tôi.

Và chúng tôi đang thực hiện một cuộc gọi FaceTime.

Ngoài ra, chúng tôi có một ứng dụng mẫu được gọi là "Ứng dụng tuyệt vời" trên màn hình và ứng dụng đã sẵn sàng để bắt đầu trải nghiệm được chia sẻ giữa tôi và Pierre.

Vì vậy, trong trường hợp này, ứng dụng trên thiết bị bên trái sẽ bắt đầu hoạt động.

Điều đầu tiên ứng dụng cần làm là tạo một đối tượng phù hợp với giao thức GroupActivity.

Trong ví dụ được hiển thị ở đây, đó là đối tượng AwesomeActivity phù hợp với GroupActivity.

Như tôi đã đề cập trước đó, đối tượng này phù hợp với giao thức GroupActivity chứa thông tin về hoạt động được chia sẻ.

Ví dụ, nếu bạn đang tạo trải nghiệm phát lại được chia sẻ, nó sẽ có thông tin về nội dung cần phát.

Hoặc nếu bạn đang tạo ra một trải nghiệm tùy chỉnh - như vẽ một cái gì đó cùng nhau - nó sẽ có thông tin về những gì cần vẽ.

Khi ứng dụng đã tạo một hoạt động, điều tiếp theo nó cần làm là gọi prepareForActivation trên hoạt động đó.

Điều này khiến người dùng thấy lời nhắc xin phép nếu họ muốn bắt đầu một hoạt động.

Chúng tôi muốn có sự đồng ý của người dùng trước khi bắt đầu một hoạt động vì chúng tôi không muốn gây bất ngờ cho họ.

Do đó, bước này rất cần thiết.

Và cuối cùng, sau khi người dùng đã cấp quyền bắt đầu hoạt động, ứng dụng của bạn cần gọi kích hoạt trên đối tượng hoạt động.

Điều này cho hệ thống biết rằng ứng dụng của bạn muốn bắt đầu trải nghiệm được chia sẻ.

Tiếp theo, hãy nói về các phiên quan sát.

Ở đây chúng tôi có cùng một ứng dụng mà chúng tôi đã xem trước đó.

Ứng dụng tại thời điểm này đã gọi kích hoạt trên đối tượng hoạt động.

Ứng dụng của bạn sau đó cần lặp lại các phiên đến thông qua AsyncSequence trên lớp GroupSession.

Và sau đó, khi có một phiên, ứng dụng sẽ được trao đối tượng GroupSession cho trải nghiệm được chia sẻ.

Xin lưu ý rằng đây là bước tương tự mà ứng dụng của bạn sẽ thực hiện cho dù đó là ứng dụng khởi tạo hay trên thiết bị từ xa nhận phiên.

Để đi vào chi tiết hơn về việc bắt đầu và quan sát các phiên nhóm, tôi khuyên bạn nên xem phiên WWDC này.

Bây giờ ứng dụng đã được trao một phiên, nó cần phải tự thiết lập trước khi tham gia phiên.

Thiết lập ứng dụng trước khi tham gia có thể có nghĩa là những điều khác nhau dựa trên trường hợp sử dụng cụ thể của ứng dụng.

Ví dụ: nếu bạn đang tạo trải nghiệm tùy chỉnh - như vẽ một cái gì đó cùng nhau - điều này có thể có nghĩa là tải lên các nội dung cần thiết cho trải nghiệm được chia sẻ trước khi người dùng của bạn có thể tham gia trải nghiệm.

Tuy nhiên, nếu ứng dụng của bạn đang cung cấp trải nghiệm phát lại phương tiện được chia sẻ, thì nó sẽ liên quan đến một cái gì đó như thế này.

Ứng dụng của bạn sẽ kết nối AVPlaybackCoordinator của AVPlayer của bạn với GroupSession để AVPlayer được liên kết của nó có thể đồng bộ hóa nội dung qua kênh giao tiếp được cung cấp bởi khung.

Hãy nhớ rằng, hỗ trợ đồng bộ hóa này không chỉ giới hạn ở AVPlayer, mà bạn có thể sử dụng bất kỳ trình phát video tùy chỉnh nào khác mà bạn có ngày hôm nay và vẫn nhận được hỗ trợ đồng bộ hóa thông qua AVDelegating PlaybackCoordinator.

Và cuối cùng, khi bạn đã thiết lập xong ứng dụng của mình, ứng dụng của bạn sẽ tham gia vào GroupSession.

Sau khi tham gia được gọi, hệ thống sẽ thiết lập các kênh được mã hóa đầu cuối giữa các ứng dụng chạy trên các thiết bị khác nhau.

Tại thời điểm này, ứng dụng của bạn đã sẵn sàng đồng bộ hóa dữ liệu và cho phép người dùng của bạn tham gia vào trải nghiệm được chia sẻ.

Nếu bạn đang tạo trải nghiệm tùy chỉnh, ứng dụng của bạn có thể sử dụng kênh này để trao đổi dữ liệu để giữ cho người dùng của bạn đồng bộ.

Kênh này cũng được AVFoundation sử dụng để giữ cho phát lại phương tiện đồng bộ bằng cách trao đổi trạng thái phát lại khi người dùng nhấn phát, tạm dừng, bỏ qua, v.v.

Lưu ý rằng kênh này không được sử dụng để trao đổi một lượng lớn dữ liệu.

Thay vào đó, hãy sử dụng nó để trao đổi thông tin để giữ cho người dùng của bạn đồng bộ.

Bây giờ ứng dụng của bạn đang trong một phiên và người dùng của bạn đang tận hưởng trải nghiệm được chia sẻ.

Có một điều nữa bạn có thể làm để làm phong phú thêm trải nghiệm cho người dùng của mình và đó là đăng các sự kiện bằng cách sử dụng khuôn khổ.

Các sự kiện cho phép người dùng của bạn biết những gì đang diễn ra trong trải nghiệm được chia sẻ.

Ví dụ: bạn có thể đăng các sự kiện để cho người dùng của mình biết khi ai đó phát, tạm dừng hoặc bỏ qua một bản nhạc.

Đăng một sự kiện khiến hệ thống đưa ra thông báo cho người dùng của bạn biết về sự kiện đó.

Trong API hiện tại của chúng tôi, chúng tôi chỉ cho phép bạn đăng các sự kiện để có trải nghiệm phát lại phương tiện.

Bạn nhận được cái này miễn phí nếu bạn sử dụng AVPlayer hoặc sử dụng AVDelegating PlaybackCoordinator.

Tuy nhiên, nếu bạn không sử dụng một trong hai thứ này, ứng dụng của bạn vẫn có thể đăng các sự kiện bằng cách sử dụng khuôn khổ.

Để tìm hiểu thêm về việc cung cấp trải nghiệm tùy chỉnh của riêng bạn và về việc đăng các sự kiện, tôi khuyên bạn nên xem phiên WWDC này.

Vì vậy, để kết thúc, Hoạt động nhóm là một khuôn khổ Swift-native hoàn toàn mới cho phép bạn tạo trải nghiệm được chia sẻ qua FaceTime.

Khung này đa nền tảng và có sẵn trên iOS, macOS, iPadOS và tvOS.

Nó có sự tích hợp chặt chẽ với AVFoundation cho phép ứng dụng của bạn cung cấp trải nghiệm phát lại phương tiện được chia sẻ.

Và cuối cùng, nó cũng có hỗ trợ đồng bộ hóa phát lại qua web trên macOS.

Và với điều đó, tôi muốn cảm ơn bạn đã xem phiên của chúng tôi.

Và có một WWDC21 tuyệt vời!

♪