110380

♪ ♪

Prashant: Này, mọi người. Tôi là Prashant.

Tôi là một Kỹ sư AVFoundation, và chào mừng đến với WWDC2022.

Với sự ra đời của SharePlay, bạn có thể cung cấp cho mọi người trải nghiệm xem được kết nối cho phép họ điều hướng và tương tác với nội dung trong thời gian thực trong khi vẫn hoàn toàn đồng bộ với nhóm SharePlay.

Tuy nhiên, một số bạn có thể đã lên lịch quảng cáo được nhắm mục tiêu hoặc các quảng cáo xen kẽ khác trong dòng thời gian nội dung, khiến việc phối hợp phát lại giữa những người tham gia nhận quảng cáo có thời lượng khác nhau trở thành một thách thức hoặc nói giữa một nhóm người tham gia hỗn hợp mà một số người nhận được quảng cáo và một số thì không.

Vì vậy, nếu bạn quan tâm đến việc lên lịch quảng cáo và các quảng cáo xen kẽ khác để phát lại phối hợp trong SharePlay, bạn đã điều chỉnh đúng phiên.

Trong buổi nói chuyện này, chúng ta sẽ bắt đầu bằng cách xem xét cách phát lại phối hợp hoạt động.

Sau đó, chúng tôi sẽ xem xét các thách thức liên quan đến quảng cáo và các quảng cáo xen kẽ khác trong phát lại phối hợp.

Sau đó, chúng ta sẽ thảo luận về những trải nghiệm xem khác nhau có thể có khi xem quảng cáo.

Sau đó, chúng ta sẽ xem làm thế nào một người có thể đạt được những điều này cho các quảng cáo được khâu lại.

Và chúng ta cũng sẽ xem quảng cáo xen kẽ HLS hoạt động như thế nào với phát lại phối hợp.

Và để kết luận, chúng ta sẽ xem xét một số phương pháp hay nhất mà bạn có thể sử dụng để cung cấp cho mọi người trải nghiệm SharePlay thực sự hấp dẫn.

Hãy xem cách phát lại phối hợp hoạt động trong SharePlay.

Vì vậy, trong khi những người tham gia đang thực hiện cuộc gọi FaceTime, các lệnh điều khiển phát lại bắt nguồn từ thiết bị của một người tham gia được chia sẻ giữa các nhóm để tất cả họ chơi đồng bộ.

Mặc dù điều này hoạt động tốt nếu tất cả những người tham gia đang xem cùng một nội dung, điều gì sẽ xảy ra nếu một số người trong số họ có quảng cáo?

Bây giờ chúng ta hãy xem xét trường hợp Alice và Bob đang cố gắng xem một số nội dung chương trình.

Bây giờ những gì chúng ta thấy ở đây là các mốc thời gian trình bày ở cuối tương ứng của chúng.

Nếu đó chỉ là nội dung chương trình mà họ đang xem, thì việc phát lại phối hợp sẽ khá đơn giản.

Bạn chỉ cần liên kết groupSession với Điều phối viên phát lại và bạn đã sẵn sàng.

Bây giờ giả sử mỗi người trong số họ có một phân đoạn tóm tắt chương trình được khâu vào, trước đó là phòng thu hoặc biểu ngữ mạng.

Điều này khá điển hình, và vì các phân đoạn tóm tắt và biểu ngữ phù hợp với Alice và Bob, việc phát lại phối hợp vẫn có thể đạt được.

Nhưng bây giờ, giả sử địa lý của Alice yêu cầu dịch vụ hiển thị một số cảnh báo theo luật định trước khi bắt đầu chương trình và cũng có thể có quảng cáo được lên lịch tại các điểm khác nhau trong chương trình.

Có thể là những quảng cáo này có thời lượng khác nhau.

Bây giờ chúng ta có thể thấy điều này có thể đặt ra một thách thức như thế nào khi cố gắng khiến họ chơi đồng bộ.

Đối với Bob, biểu ngữ mạng có thể xuất hiện ngay từ đầu, nhưng đối với Alice, nó sẽ chỉ xuất hiện sau khi các cảnh báo được hiển thị.

Và nếu chúng ta xem xét một số thời gian tùy ý trong dòng thời gian trình bày, họ sẽ xem các phần hoàn toàn khác nhau của nội dung.

Bây giờ chúng ta hãy dành một chút thời gian để suy nghĩ về trải nghiệm người dùng có thể xảy ra trong các tình huống như thế này.

Đối với điều này, hãy xem xét một dòng thời gian đơn giản hơn, nơi mỗi người trong số họ chỉ có một quảng cáo duy nhất được khâu vào.

Trong trường hợp lý tưởng, trải nghiệm không nên quá khác biệt so với nơi họ đang xem chương trình một mình.

Để điều đó có thể xảy ra, chúng tôi mong đợi thời lượng của quảng cáo sẽ khớp.

Đây cũng sẽ là trải nghiệm ưa thích của chúng tôi.

Bây giờ, sau khi xem quảng cáo, cả hai sẽ tiếp tục phát lại đồng bộ.

Nhưng đôi khi họ có thể nhận được quảng cáo có thời lượng khác nhau hoặc một trong số họ có thể không có bất kỳ quảng cáo nào cả.

Vì vậy, bây giờ, nếu họ chơi đồng bộ, một trong hai trải nghiệm là có thể.

Khi Alice hoàn thành quảng cáo của mình, cô ấy có thể đợi quảng cáo của Bob kết thúc trước khi tiếp tục đồng bộ hóa với nhau.

Hoặc cô ấy có thể tiếp tục với chương trình chính và Bob sau đó sẽ nhảy lên để bắt kịp Alice để họ luôn đồng bộ.

Trong kịch bản này, Bob cuối cùng sẽ bỏ lỡ một số nội dung chương trình khi bắt kịp Alice.

Bây giờ bạn sẽ kích hoạt những trải nghiệm này như thế nào?

Bạn có thể chỉ định các chính sách chờ này tại AVPlaybackCoordinator bằng cách bạn điền vào mảng suspensionReasonsThatTriggerWaiting.

Hành vi mặc định là để nhóm không chờ đợi trong khi một số người tham gia đang xem quảng cáo.

Khi những người tham gia này hoàn thành quảng cáo của họ, họ sẽ bỏ lỡ một số nội dung để bắt kịp với những người còn lại trong nhóm.

Ngoài ra, nếu bạn muốn nhóm đợi trong khi những người tham gia xem quảng cáo, bạn có thể chỉ cần bao gồm lý do đình chỉ "chơi xen kẽ" như một phần của mảng đình chỉ Lý do đó Kích hoạt Chờ đợi.

Với chính sách này, khi một người tham gia đang chờ những người khác hoàn thành quảng cáo của họ, thời gian của người chơi của họ ControlStatus sẽ chờPlayAtSpecifiedRate và waitingReason sẽ chờ đợiCoordinatedPlayback.

Vì vậy, quay trở lại nội dung được mô tả trước đó, làm thế nào để chúng ta xác định các khoảng thời gian này sẽ bị loại khỏi dòng thời gian phát lại phối hợp?

Ví dụ, cảnh báo theo luật định là điều mà chỉ Alice có và Bob thì không.

Và cũng có thể các ngắt quảng cáo có thời lượng khác nhau.

Bạn có thể biết rằng HLS cung cấp hai cách lên lịch quảng cáo.

Một trong số đó sẽ là ghép trực tiếp các phân đoạn quảng cáo vào danh sách phát của nội dung chính.

Vì vậy, đối với nội dung video theo yêu cầu có quảng cáo được ghép nối bằng cách sử dụng thẻ gián đoạn, bạn có thể đặt phạm vi thời gian quảng cáo trên AVPlayerPlaybackCoordinator bằng API AVFoundation.

Vì vậy, chúng tôi đã thêm phương pháp đại diện sau đây vào - sử dụng phương pháp mà bạn có thể chỉ định một mảng các phạm vi thời gian chính xác mẫu đại diện cho quảng cáo và quảng cáo xen kẽ trong nội dung.

Điều phối viên phát lại AVPlayer sau đó sẽ sử dụng thông tin này để phối hợp phát lại trong nhóm.

Khi một người tham gia vào phạm vi thời gian này, việc phát lại sẽ được phối hợp theo chính sách chờ được chỉ định.

Ngoài ra, tùy thuộc vào loại quảng cáo xen kẽ, bạn có thể cho phép ai đó điều hướng vào các khoảng thời gian này.

Vì vậy, nếu họ tìm kiếm các khoảng thời gian này trong SharePlay, toàn bộ nhóm sau đó sẽ chuyển sang đầu phạm vi thời gian đó.

Điều này cho thấy một ví dụ danh sách phát trong đó phạm vi thời gian quảng cáo được điền bằng cách tổng hợp thời gian được báo cáo trong thẻ EXTINF của danh sách phát.

Điều này giả định rằng các khoảng thời gian được báo cáo như một phần của thẻ EXTINF phản ánh chính xác thời lượng phương tiện của các phân đoạn đó.

Vậy, bây giờ tài sản sẽ trông như thế nào để phát lại phối hợp hoạt động?

Vì vậy, nếu bạn nhìn vào ví dụ này, Alice và Bob có các quảng cáo thời lượng khác nhau được ghép vào, dẫn đến thời hạn tài sản khác nhau.

Để những thứ này được coi là tương thích với SharePlay, chúng tôi mong đợi thời lượng nội dung thực tế của tài sản sẽ khớp.

Lưu ý rằng điều này chỉ áp dụng cho nội dung video theo yêu cầu, đối với nội dung trực tiếp có quảng cáo được ghép nối, chúng tôi hy vọng thời lượng của thời gian nghỉ quảng cáo sẽ khớp với tất cả những người tham gia.

Nếu bạn nghĩ rằng có thể là một thách thức để có được phạm vi thời gian chính xác của mẫu hoặc nếu bạn muốn tự động lên lịch quảng cáo được nhắm mục tiêu trong nội dung trực tiếp, thì bạn có thể sử dụng quảng cáo xen kẽ HLS để lên lịch quảng cáo.

Vào năm 2021, chúng tôi đã giới thiệu quảng cáo xen kẽ HLS cung cấp một cách tiếp cận khác, linh hoạt hơn để lên lịch quảng cáo.

Để biết thêm chi tiết, hãy xem Khám phá các cuộn trước động và giữa các cuộn trong cuộc nói chuyện HLS từ WWDC2021.

Nói tóm lại, quảng cáo và quảng cáo xen kẽ được coi là các đối tượng riêng biệt bên ngoài dòng thời gian nội dung.

Các đối tượng này có thể được tham chiếu trực tiếp thông qua danh sách phát đa biến thể của chúng và người ta có thể thực hiện Chèn quảng cáo phía máy chủ chỉ bằng cách bao gồm URI danh sách phát đa biến thể như một phần của thẻ phạm vi ngày trong danh sách phát phương tiện của nội dung chính hoặc thậm chí bạn lên lịch quảng cáo ở phía máy khách bằng API AV

Nếu bạn sử dụng quảng cáo xen kẽ HLS để lên lịch quảng cáo, AVFoundation sẽ tự động xử lý chúng trong quá trình phát lại phối hợp.

Tất cả những gì bạn cần làm là chỉ định chính sách chờ đợi.

Khi sử dụng quảng cáo xen kẽ HLS để lên lịch quảng cáo, một lần nữa, chúng tôi hy vọng thời lượng nội dung chính sẽ khớp với tất cả những người tham gia để nội dung được coi là tương thích với SharePlay.

Bây giờ hãy xem qua một số phương pháp hay nhất mà bạn có thể sử dụng để cung cấp cho mọi người trải nghiệm SharePlay thực sự tốt.

SharePlay có nghĩa là cung cấp trải nghiệm xem được kết nối liền mạch, nơi mọi người tương tác với nội dung như thể họ đang tự xem nội dung đó.

Vì vậy, với kinh nghiệm này, người ta nên cố gắng giảm thiểu sự chờ đợi và bỏ qua nội dung càng nhiều càng tốt.

Vì vậy, để đạt được mục đích này, bạn nên cố gắng căn chỉnh thời lượng ngắt quảng cáo sao cho thời gian chờ đợi hoặc bỏ qua được giảm thiểu.

Khi bạn có các nhóm người tham gia hỗn hợp, nơi một số người có quảng cáo và một số thì không và tất cả đều đang xem nội dung trực tiếp, bạn có thể sử dụng quảng cáo xen kẽ HLS để lên lịch quảng cáo trong khi sử dụng chính sách chờ mặc định.

Bây giờ, nếu bạn không chỉ định độ lệch sơ yếu lý lịch trong khi lên lịch quảng cáo, nội dung sẽ tiếp tục ở mức bù bằng với thời lượng quảng cáo.

Trong trường hợp như vậy, người tham gia không có quảng cáo sẽ tiếp tục xem nội dung chính và những người khác sẽ tham gia cùng người tham gia đó sau khi họ xem xong quảng cáo của mình.

Ở đây chúng ta có Alice, Bob và Charlie đang xem một số nội dung trực tiếp.

Alice là người đăng ký cao cấp cho dịch vụ đó không có bất kỳ quảng cáo nào, trong khi Bob và Charlie có quảng cáo có thời lượng khác nhau, tất cả đều được lên lịch bằng quảng cáo xen kẽ HLS.

Bạn có thể thấy Alice tiếp tục xem chương trình như thế nào trong khi Bob và Charlie đồng bộ hóa với Alice khi họ hết quảng cáo.

Bây giờ nếu đây là một trò chơi thể thao trực tiếp, bạn có thể tưởng tượng Alice có thể đang xem nguồn cấp dữ liệu trực tiếp trong sân vận động trong khi Bob và Charlie đang xem quảng cáo như thế nào.

Và khi họ ra khỏi giờ nghỉ quảng cáo, nó sẽ đúng lúc để bắt đầu chơi.

Đối với các luồng Video theo yêu cầu, nơi những người tham gia không thể bỏ lỡ bất kỳ nội dung chương trình nào, bạn có thể sử dụng chính sách chờ đợi.

Bây giờ bạn có thể chia sẻ lịch quảng cáo giữa những người tham gia bằng cách sử dụng GroupSessionMessenger.

Và khi ai đó đang đợi những người khác xem xong quảng cáo của họ, bây giờ bạn sẽ biết chính xác họ sẽ phải đợi bao lâu vì bạn đã chia sẻ lịch trình.

Vì vậy, bây giờ trong khi họ đang chờ đợi, có lẽ bạn có thể sử dụng một người chơi khác để hiển thị một số nội dung thú vị, như các điểm tham quan sắp tới trong dịch vụ của bạn để giữ cho họ tham gia.

Để kết thúc, để lên lịch quảng cáo và các quảng cáo xen kẽ khác trong quá trình phát lại phối hợp, tất cả những gì bạn cần làm là chỉ định chính sách chờ và nếu bạn đã ghép quảng cáo, bạn có thể đặt phạm vi thời gian của chúng trên điều phối viên phát lại bằng API AVFoundation hoặc bạn có thể sử dụng quảng cáo xen kẽ HLS để

Kịch bản lý tưởng sẽ liên quan đến tất cả những người tham gia xem cùng một nội dung.

Chúng tôi rất muốn điều này có thể xảy ra, điều này có thể không phải lúc nào cũng đúng.

Bạn có thể có một cấp thuê bao cao cấp không nhận được quảng cáo và bạn cũng có thể có những người tham gia nhận được quảng cáo có thời lượng khác nhau.

Trong những tình huống như thế này, những người đăng ký cao cấp của bạn không cần phải nhìn chằm chằm vào màn hình chờ.

Bạn có thể cho họ xem một số nội dung thú vị như chúng ta đã thấy trước đó hoặc thậm chí bạn có thể xây dựng những trải nghiệm khác để giúp họ giải trí.

Để biết thêm ý tưởng về cách xây dựng trải nghiệm tùy chỉnh trong SharePlay, hãy xem bài nói chuyện tạo trải nghiệm SharePlay tuyệt vời.

Hy vọng bạn thấy phiên này có nhiều thông tin.

Tận hưởng phần còn lại của WWDC.

Cảm ơn bạn.