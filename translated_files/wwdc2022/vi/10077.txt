10077

♪ ♪

Tommy Pauly: Xin chào, tôi là Tommy Pauly, và tôi rất vui được chia sẻ cách các ứng dụng và trang web của bạn có thể hoạt động cùng với Apple và các nhà cung cấp dịch vụ phòng chống gian lận trong toàn ngành để giảm nhu cầu về CAPTCHA.

Hôm nay, tôi sẽ nói về: Mã thông báo truy cập riêng tư và cách chúng có thể là công cụ mạnh mẽ để ngăn chặn gian lận; cách bật hỗ trợ Mã thông báo truy cập riêng tư trên các máy chủ bạn vận hành; và cách bạn có thể sử dụng các mã thông báo này trong ứng dụng của mình.

Để giới thiệu Mã thông báo truy cập riêng tư, tôi sẽ bắt đầu bằng cách giải thích lý do tại sao CAPTCHA được sử dụng ngay từ đầu.

Rất có thể, nếu bạn đã đăng ký một tài khoản mới trên một trang web hoặc cố gắng đăng nhập bằng một tài khoản hiện có, bạn đã gặp phải những CAPTCHA như thế này vào một lúc nào đó.

Đôi khi, CAPTCHA chỉ là một nút để nhấn, nhưng những nút khác có thể là một thách thức để điền vào.

Bạn có thể không thích bị gián đoạn bởi những thứ này.

Tôi chắc chắn là không.

Lý do những trải nghiệm này tồn tại là để ngăn chặn hoạt động gian lận.

Nếu bạn chạy một máy chủ, bạn không muốn nó bị quá tải bởi gian lận.

Một số nỗ lực tạo tài khoản hoặc mua sản phẩm đến từ những người dùng hợp pháp.

Nhưng những nỗ lực khác có thể là từ những kẻ tấn công hoặc bot.

Thật không may, các công cụ phổ biến để ngăn chặn gian lận, như CAPTCHA, thường khiến mọi người khó sử dụng ứng dụng hoặc trang web của bạn hơn.

Tìm kiếm sự cân bằng phù hợp giữa trải nghiệm tốt và ngăn chặn gian lận là một thách thức.

CAPTCHA thường dẫn đến trải nghiệm người dùng chậm hơn và phức tạp hơn.

Bằng cách cố gắng ngăn chặn các cuộc tấn công, bạn cũng có thể mất đi những khách hàng có giá trị.

CAPTCHAs cũng có thể gây ra rủi ro về quyền riêng tư.

Để xác định xem khách hàng có đáng tin cậy và có thể nhận được CAPTCHA dễ dàng hơn hay không, các máy chủ thường dựa vào việc theo dõi hoặc lấy dấu vân tay của khách hàng bằng cách sử dụng địa chỉ IP của họ.

Kiểu theo dõi này mâu thuẫn với hướng bảo mật internet được thực hiện bởi Safari, Bảo vệ quyền riêng tư thư và Chuyển tiếp riêng tư iCloud.

Và CAPTCHAs có thể gây ra một vấn đề nghiêm trọng cho khả năng tiếp cận.

Bằng cách cố gắng ngăn chặn quyền truy cập từ bot, họ cũng chặn những người thực sự bị khuyết tật hoặc rào cản ngôn ngữ.

Có một cách tốt hơn.

Ngay cả khi ai đó tương tác với trang web của bạn lần đầu tiên, nếu họ đang tải nó thông qua một ứng dụng hoặc trình duyệt như Safari, họ đã thực hiện nhiều hành động mà bot khó bắt chước.

Đầu tiên, họ có iPhone, iPad hoặc Mac và họ đã mở khóa thiết bị bằng mật khẩu, Touch ID hoặc Face ID.

Họ hầu như luôn đăng nhập vào thiết bị bằng ID Apple của họ.

Và họ đã ra mắt một ứng dụng có chữ ký mã.

Thông tin này có thể giúp máy chủ của bạn tin tưởng các khách hàng hợp pháp và ngăn chặn gian lận, mà không cần dựa vào CAPTCHA và không ảnh hưởng đến quyền riêng tư bằng cách theo dõi khách hàng.

Mã thông báo truy cập riêng tư là thứ cho phép máy chủ của bạn tự động tin tưởng khách hàng, mới trong iOS 16 và macOS Ventura.

Trước khi giải thích cách các mã thông báo này hoạt động, tôi sẽ cho chúng thấy hành động.

Bạn sẽ thích điều này.

Tôi muốn đọc một bài báo trên trang web Financial Times.

Tôi rất hào hứng với những chiếc bánh quế này.

Và tôi đã tải trang web trên hai điện thoại khác nhau: một chạy iOS 15 và một chạy iOS 16, hỗ trợ Mã thông báo truy cập riêng tư.

Bắt đầu với điện thoại iOS 15, tôi nhấp vào Đăng nhập và điền vào tài khoản và mật khẩu của mình.

Nhưng sau đó, tôi bị trúng CAPTCHA.

Tôi cần gõ các chữ cái trước khi có thể đọc bài báo đó.

Khi tôi làm chính xác điều tương tự trên điện thoại iOS 16 hỗ trợ Mã thông báo truy cập riêng tư, tôi sẽ vượt qua ngay.

Điều này sẽ tiết kiệm rất nhiều người, rất nhiều thời gian và khách hàng của bạn sẽ đánh giá cao sự tin tưởng.

Mã thông báo truy cập riêng tư cho phép các máy chủ tránh CAPTCHA, như bạn vừa thấy, bằng cách sử dụng công nghệ được chuẩn hóa trong nhóm làm việc IETF Privacy Pass.

Apple đang làm việc với các công ty trong toàn ngành để biến điều này thành có thể.

Sử dụng giao thức này, các máy chủ có thể yêu cầu mã thông báo bằng phương pháp xác thực HTTP mới, PrivateToken.

Các mã thông báo này sử dụng Chữ ký mù RSA để ký bằng mật mã sự thật rằng khách hàng đã có thể vượt qua kiểm tra chứng thực.

Những chữ ký này "không thể liên kết", có nghĩa là các máy chủ nhận mã thông báo chỉ có thể kiểm tra xem chúng có hợp lệ hay không, nhưng chúng không thể phát hiện danh tính khách hàng hoặc nhận dạng khách hàng theo thời gian.

Đây là cách giao thức hoạt động.

Đầu tiên, khi máy khách iOS hoặc macOS truy cập máy chủ qua HTTP, máy chủ sẽ gửi lại thử thách bằng cách sử dụng sơ đồ xác thực PrivateToken.

Điều này chỉ định một nhà phát hành mã thông báo được máy chủ tin cậy.

Khi khách hàng cần tìm nạp mã thông báo, nó sẽ liên hệ với trình kiểm tra iCloud và gửi yêu cầu mã thông báo.

Yêu cầu mã thông báo này bị "mù" nên nó không thể được liên kết với thử thách máy chủ.

Người kiểm tra thực hiện chứng thực thiết bị, sử dụng chứng chỉ được lưu trữ trong Secure Enclave của thiết bị và xác minh rằng tài khoản đang ở trạng thái tốt.

Máy kiểm tra này cũng có thể thực hiện giới hạn tốc độ, để nhận biết liệu thiết bị khách hàng có tuân theo các mẫu bình thường hay không, hoặc có thể đã bị xâm phạm hoặc sử dụng như một phần của trang trại thiết bị.

Nếu khách hàng có thể được xác thực, người kiểm tra sẽ gửi yêu cầu mã thông báo mới đến nhà phát hành.

Khi nhà phát hành mã thông báo nhận được yêu cầu, nó không biết gì về khách hàng.

Nhưng vì nó tin tưởng người kiểm tra iCloud, nó ký mã thông báo.

Sau đó, khách hàng nhận được mã thông báo đã ký và chuyển đổi nó thành một quy trình gọi là "unblinding" để máy chủ ban đầu có thể xác minh nó.

Và cuối cùng, khách hàng trình bày mã thông báo đã ký cho máy chủ.

Máy chủ có thể kiểm tra xem mã thông báo này có được ký bởi Nhà phát hành hay không, nhưng nó không thể sử dụng mã thông báo để xác định hoặc nhận dạng khách hàng.

Vậy làm thế nào bạn có thể tận dụng công nghệ này trên máy chủ của mình?

Có ba bước để áp dụng Mã thông báo truy cập riêng tư trên máy chủ của bạn.

Đầu tiên, bạn sẽ cần chọn một nhà phát hành mã thông báo.

Thứ hai, máy chủ của bạn sẽ cần gửi các thử thách xác thực HTTP khi bạn muốn xác thực khách hàng.

Và thứ ba, máy chủ của bạn sẽ cần xác thực các mã thông báo do khách hàng gửi.

Nhà phát hành mã thông báo bạn chọn là nhà cung cấp đáng tin cậy có thể ký mã thông báo mà máy chủ của bạn xác thực.

Đây có thể là nhà cung cấp CAPTCHA hiện tại của bạn, dịch vụ lưu trữ web hoặc mạng phân phối nội dung của bạn, còn được gọi là CDN.

Trong iOS 16 và macOS Ventura betas, có hai công cụ phát hành mã thông báo mà bạn đã có thể bắt đầu thử nghiệm.

Fastly và Cloudflare là hai CDN đã và đang phát triển các tiêu chuẩn Privacy Pass và đã cung cấp các dịch vụ phát hành của họ.

Các nhà cung cấp CAPTCHA khác, dịch vụ lưu trữ web và CDN cũng sẽ có thể chạy các công cụ phát hành mã thông báo hoạt động với các thiết bị Apple.

Các nhà phát hành sẽ có thể đăng ký vào cuối năm nay tại register.apple.com.

Điều quan trọng là việc sử dụng một công cụ phát hành mã thông báo cụ thể không trở thành một cách để xác định những trang web mà khách hàng đang truy cập - đó sẽ là một vấn đề đối với quyền riêng tư.

Vì vậy, mỗi nhà phát hành mã thông báo cần phải là một dịch vụ lớn hoạt động với ít nhất hàng trăm máy chủ.

Khi khách hàng truy cập vào máy chủ của bạn, bạn có thể yêu cầu mã thông báo bằng cách gửi thử thách xác thực HTTP với sơ đồ PrivateToken.

Để làm điều này, bạn có hai lựa chọn: Hoặc bạn có thể làm việc với CAPTCHA hiện tại của mình hoặc nhà cung cấp phòng chống gian lận để xây dựng thử thách vào tập lệnh của họ, vì vậy nó được xử lý tự động cho bạn hoặc bạn có thể chọn gửi những thử thách này trực tiếp từ máy chủ của mình.

Nếu bạn đang làm điều này như một phần của trang web của mình, thách thức phải đến từ tên miền của bên thứ nhất - tên miền phụ của URL chính của bạn chứ không phải tên miền của bên thứ ba riêng biệt được nhúng trên trang web của bạn.

Khi khách hàng trả lại mã thông báo cho bạn, bạn sẽ cần kiểm tra tính hợp lệ của chúng bằng khóa công khai của nhà phát hành.

Bạn cũng có thể muốn thực thi kiểm tra để ngăn chặn các cuộc tấn công phát lại, nơi khách hàng có thể cố gắng xuất trình mã thông báo nhiều lần.

Mã thông báo chỉ được sử dụng một lần.

Bạn có thể ngăn chặn các cuộc tấn công phát lại bằng cách ghi nhớ những mã thông báo nào đã được gửi trước đó hoặc yêu cầu mã thông báo ký một giá trị duy nhất được gửi trong thử thách của bạn.

Trang web của bạn vẫn cần làm việc với các khách hàng cũ sẽ không phản hồi thách thức xác thực này.

Vì vậy, điều quan trọng là xác thực không nên chặn tải trang chính của bạn, mà thay vào đó được coi là một cách tùy chọn để tin tưởng khách hàng.

Các máy chủ web được truy cập thông qua Safari và WebKit sẽ hoạt động tự động, nhưng bạn cũng có thể sử dụng Mã thông báo truy cập riêng tư trực tiếp trong ứng dụng của mình.

Mã thông báo truy cập riêng tư yêu cầu iOS 16 hoặc macOS Ventura trên thiết bị đã đăng nhập ID Apple.

ID Apple này chỉ được sử dụng để chứng thực và không được chia sẻ với các máy chủ nhận mã thông báo.

Trong ứng dụng của bạn, mã thông báo có sẵn nếu bạn sử dụng WebKit hoặc URLSession để liên hệ với máy chủ của mình bằng HTTP.

Sau đó, bất cứ khi nào ứng dụng của bạn nhận được thử thách khi nó ở phía trước, hệ thống sẽ tự động gửi mã thông báo làm xác thực.

Nếu bạn đang sử dụng URLSession, bạn không cần phải làm bất cứ điều gì một cách rõ ràng để làm cho Mã thông báo truy cập riêng tư hoạt động.

URLSession sẽ tự động phản hồi các thách thức bằng cách sử dụng sơ đồ xác thực HTTP PrivateToken.

Tuy nhiên, nếu có lỗi trong việc tìm nạp mã thông báo, chẳng hạn như nếu ứng dụng của bạn không ở phía trước hoặc thiết bị không có ID Apple đã đăng nhập, ứng dụng của bạn sẽ nhận được phản hồi 401 HTTP bao gồm thử thách mã thông báo.

Điều này cho phép ứng dụng của bạn biết rằng thử thách mã thông báo đã được nhận và cung cấp cơ hội xử lý lỗi một cách chính xác cho trường hợp sử dụng của bạn.

Làm cho các ứng dụng và trang web trải nghiệm tốt hơn cho mọi người bằng cách tránh CAPTCHA bất cứ khi nào Mã thông báo truy cập riêng tư có sẵn.

Đi và cho phép máy chủ của bạn gửi các thử thách mã thông báo và xác thực mã thông báo.

Và, trong các ứng dụng của bạn, hãy sử dụng URLSession hoặc WebKit để tự động hỗ trợ Mã thông báo truy cập riêng tư.

Tôi đang mong chờ những trải nghiệm không có CAPTCHA mà bạn sẽ xây dựng.