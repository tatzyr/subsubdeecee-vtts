10038

♪インストゥルメンタルヒップホップ音楽♪

こんにちは、WWDCへようこそ。

私はNikhilです。今日は、SKAdNetworkの変更点をお伝えします。

未来に飛び込む前に、私たちがどこにいるのか、どうやってここにたどり着いたのかを思い出しましょう。

Appleでは、プライバシーは基本的人権であり、その保護はここで行うすべてのことに織り込まれていると信じています。

それが私たちがSKAdNetworkを作った理由です。

SKAdNetworkは、Appleのプライバシー保護インストールアトリビューションシステムです。

アトリビューションデータは、ユーザーのプライバシーを保護しながら広告主に送り返されます。

SKAdNetworkには、広告ネットワーク、パブリッシャーアプリ、広告主アプリの3つのアクターが関与しています。

また、SKAdNetwork内で一般的に使用される用語も定義しましょう。

インプレッション：このディスカッションのコンテキストでのインプレッションは、パブリッシャーアプリからSKAdNetworkに入力されます。

エンゲージメント: エンゲージメントは、ユーザーが広告主アプリと対話するときに発生します。

広告主アプリは、コンバージョン値の更新の形でこれらのエンゲージメントをキャプチャします。

そして最後に、ポストバックとも呼ばれるコンバージョン。

ポストバックには、広告ネットワークに送信されるアトリビューションデータが含まれています。

アトリビューションデータは、これが元の広告の成功した変換であったというシグナルを広告ネットワークに提供します。

広告ネットワークは、広告主アプリの署名付きインプレッションを生成します。

パブリッシャーアプリはこのインプレッションを使用し、この広告を表示します。

その後、ユーザーは広告をタップしてアプリをインストールします。

初めて起動すると、アプリはAPIを呼び出してコンバージョンを通知します。

その後、アプリはこのAPIを繰り返し呼び出して、コンバージョン値を更新し、さまざまなレベルのエンゲージメントと広告のリターンをキャプチャできます。

タイマーの有効期限が切れると、アトリビューションデータを含むポストバックを広告ネットワークに送信します。

SKAdNetworkのバージョン履歴を簡単に見てみましょう。

SKAdNetwork 2.0は、プライバシーを保護する広告アトリビューションを導入しました。

2.2 パブリッシャーアプリがカスタム広告を表示できるようにしました。

3.0は、非勝利のインプレッションのためのポストバックを追加しました。

そして、iOS 15.0では、SKAdNetworkのすべてのバージョンの開発者向けのポストバックコピーを導入しました。

SKAdNetworkの歴史の詳細については、WWDC 2021のセッション「プライバシー保護広告アトリビューションを満たす」を参照してください。

さて、未来、SKAdNetwork 4.0について話しましょう。

新機能を見てみましょう。 では、新機能を見てみましょう

まず、広告主により多くのデータを提供するように設計されたAPIのいくつかの変更を検討します。

これに続いて、物事の変換面を見ていきます。

次に、ウェブ上の広告のアトリビューションに移り、SKAdNetworkのテスト可能性について話して締めくくります。

階層IDとコンバージョン値は、SKAdNetwork 4.0に登場する最初の新機能です。

新機能に飛び込む前に、群衆の匿名性を定義したいと思います。

群衆の匿名性は、SKAdNetworkがアトリビューションデータを配信するプライバシー保護方法を指すために使用する用語です。

インストールの数は、アプリを使用している人に保証されるプライバシーのレベルを決定します。

下端では、ポストバックの広告主へのアトリビューションデータの送信が少なくなります。

インストール数が少ない場合は、返送される追跡可能な情報を制限することで、プライバシーを保護するために追加の措置を講じます。

カウントがスケールアップし、ユーザーの独自性が群衆に溶け込み始めると、より多くのデータを送り返します。

最後に、カウントが最高層に達すると、プライバシーを維持しながら、最も多くのデータを送り返すことができます。

SKAdNetwork 4.0では、プライバシー保護を維持しながら、より多くのデータを送信する方法があります。

このため、キャンペーン識別子フィールドを変更しています。

現在、これは2桁のフィールドです。

このフィールドの範囲を4桁に増やし、名前をソース識別子に変更します。

新しい名前は、キャンペーンを識別するためだけでなく、使用することを選択したものを表現できるとして、この分野についての私たちの考え方を反映しています。

これは単一の数字ですが、3つの階層的な数字、2、3、4桁の数字として考えることをお勧めします。

ソース識別子フィールドを階層的な数字のセットとして考えることは、異なる数字に意味を割り当てるのに役立ちます。

例として、2桁は広告キャンペーンを表し、3桁はユーザーのバケット化された場所を表し、4桁は画面上の広告配置を表すことができます。

あるいは、2桁は治療を表すことができ、3桁はバケットされた時刻を表すことができ、4桁は表示される広告のサイズを表すことができます。

これらは単なる例であり、最終的に、私たちがここで望んでいたのは、あなたのニーズに最も合うようにこのフィールドをあなたに開放することでした。

より多くのデータを提供するというテーマを継続して、変換値も変化しています。

現在、これは6ビットの値です。

SKAdNetwork 4.0では、きめ細かい値と粗い値の2つの変換値を導入しています。

きめ細かい値は、今日の変換値と同じです。

粗い粒の値は、3つの値のいずれかを想定できます。

高42の変換値を考慮すると、高は粗い値であり、42は細かい値であり、粗い値を受け取るために必要なインストールカウントは、細かい値に必要なインストール数よりも低い。

その結果、アプリは前者を後者よりもはるかに速く受け取ります。

ただし、これらのうちの1つだけが広告主に送り返されることに注意してください。

群衆の匿名性がこれらの新しい分野にどのように影響するかを見てみましょう。

ソース識別子として5739の以前の例を使用して、群衆の匿名性のローエンドで、ソース識別子の2桁のコンポーネントを受け取ることが期待できます。この場合は39です。

中レベルでは、3桁のコンポーネントを受け取ることが期待できます。

そして、最高レベルでは、完全な4桁のソース識別子を受け取ることが期待できます。

群衆の匿名性レベルが増加するにつれて、ソース識別子のより多くの桁が送り返されます。

そして、コンバージョン値の高42の以前の例を取ると、群衆の匿名性のローエンドでは、ポストバックでコンバージョン値を受け取ることはありません。

中レベルでは、粗い変換値を受け取ります。

そして、最高レベルでは、ポストバックできめ細かいコンバージョン値を受け取ります。

群衆の匿名性が高まるにつれて、変換値は変更を返しました。

APIの変更を見てみましょう。 では、APIの変更を見てみましょう。

SKAdImpressionのインスタンスを使用して広告を表示している場合は、SKADImpressionインスタンスに新しいsourceIdentifierプロパティを設定できます。

辞書でインプレッションを設定する場合は、新しいソース識別子キーを使用してsourceIdentifier値を設定できます。

アドバタイズされたアプリの場合、ここに示すように細かい変換値に加えて、粗い変換値を取るように変更された新しいupdatePostbackConversionValueメソッドを呼び出します。

ポストバックのコンバージョン値を更新した後、完了ハンドラを使用してフォローアップタスクを実行することをお勧めします。

新しい階層IDと変換値APIの採用に関する推奨事項をいくつか紹介します。

インストールのプライバシーレベルに応じて、ソース識別子の異なる部分が返されます。

インプレッションのソース識別子を作成するときは、これを考慮してください。

粗い変換値は、細かい変換値よりもはるかに低い粒度です。

彼らの価値観に意味をもたらすときは、これを考慮してください。

変換値は増減する可能性があります。

そして最後に、SKAdNetwork 4.0のポストバックを処理するためにサーバーに変更を加えるときは、新しいソース識別子と粗い変換値を解析できるようにします。

これにより、階層IDとコンバージョン値の紹介が終わり、プライバシー保護を維持しながら、より多くのデータを広告主に提供します。

アトリビューションフローの別の重要な分野、コンバージョンに焦点を当てましょう。

SKAdNetworkは現在、単一のコンバージョンモデルを使用しています。

インストール時から、コンバージョン値を更新して、さまざまなユーザーエンゲージメントをキャプチャします。

そして、一定の時間が経過すると、ポストバックを広告ネットワークに送信します。

例を見てみましょう。 例を見てみましょう。

フードトラックを使いましょう。

フードトラックは、あなたのフードトラックをコントロールできるようにします。

独自のドーナツ配達体験をカスタマイズ、制御、作成します。

フードトラックの開発者として、私は広告費の価値を知りたいです。

この例として、ユーザーがフードトラックを起動すると、変換値を更新してこれをマークします。

彼らが配達のために最初のバッチを受け取ったら、私は再び変換値を更新します。

このドーナツのバッチは、熟成に一定の時間を必要とするため、ユーザーは待ちます。

エージング時間のどこかで、コンバージョンは広告ネットワークとオプションで私の両方にポストバックの形で送信されます。

しかし、ユーザーが最終的にドーナツを届けたとき、ポストバックがすでに送信されているため、これやそれ以上のユーザーの行動を測定する方法はありません。

言い換えれば、再エンゲージメントは失われます。

これが私たちが変えているものです。

1つのポストバックから3つのポストバックに移行しています。

ポストバックは明確な時間ウィンドウに結び付けられ、それらのウィンドウの最後に送信されます。

前の例をもう一度見てみましょう。

以前と同様に、ユーザーはフードトラックを開始し、配達のために最初のバッチをピックアップします。

最初のポストバックの時間枠が経過し、私たちはそれを送信します。

ユーザーはドーナツを配達します。

以前は、これはキャプチャされなかったでしょうが、今、私たちは2番目のポストバックのタイムウィンドウにいます。

これをキャプチャするためにコンバージョン値を更新します。

2番目のポストバックのタイムウィンドウが過ぎ、私たちはそれを送信します。

アプリのツールを使用して、ユーザーはまったく新しいドーナツレシピを作成し、新鮮なバッチを提供するために再び向かいます。

3番目のウィンドウが経過し、3番目のポストバックが送信されます。

変換の価値を測定し、これらの測定値をより頻繁に受け取る機会が増えています。

複数のコンバージョンについて注意すべきいくつかのポイント：最初のポストバックのみが細かいコンバージョン値を取得します。

追加のポストバックは、粗い変換値を運ぶことができます。

勝者と開発者だけが追加のポストバックを受け取ります。

次に、ウェブ上の広告のSKAdNetworkアトリビューションを確認しましょう。

パブリッシャーアプリは、App Storeで製品ページを開く広告を表示することを知っています。

App Storeは、ユーザーが依存するプライバシー保護を提供しながら、SKAdNetworkと連携してインストールをアトリビュートします。

私たちは、ウェブページに表示される広告に同じプライバシーを拡張したいと考えています。

これがどのように機能するかを見てみましょう。 

ユーザーはSafariで広告のリンクをタップします。

SafariはApp Storeを起動し、広告されたアプリの製品ページに着陸します。

ここで2つのことが起こります。

App Storeは広告ネットワークサーバーから広告インプレッションを取得し、ユーザーはアプリをインストールします。

これに続いて、すべてが今日のように流れ、最終的にSKAdNetworkはポストバックを送信します。

リンクがどのように構成されているかを見てみましょう。

href部分には、宣伝されているアプリのApp Storeリンクが含まれています。

attributionDestinationは、署名された広告インプレッションをどこから取得するかをAppleに伝えます。

また、attributionSourceNonceは、広告ネットワークが返送する正確な広告インプレッションを見つけるのに役立ちます。

このリンクは、ファーストパーティサイトと埋め込まれたクロスサイトiframeで提供できることに注意してください。

URLの構築を詳しく見てみましょう。 

アトリビューション先からeTLD+1コンポーネントを抽出します。

これに、よく知られている修飾子とさらに2つのパスコンポーネントを追加します。

これにより、署名されたインプレッションを取得するためにHTTP POSTリクエストを行うURLが表示されます。

プロトコルと強調表示されたパスコンポーネントは固定されていることに注意してください。

広告ネットワークは、ホストコンポーネントの価値を決定します。

SKAdNetworkは、先ほど説明したように構築されたURLにHTTP POSTリクエストを行います。

POST本文はJSONになります。

Source_nonceは元の広告リンクと同じものとして認識されます。

この値は、広告ネットワークが提供したい署名されたインプレッションを識別するために使用するものです。

このPOSTリクエストから受け取ることを期待しているものを見てみましょう。

これは署名された印象であり、SKAdNetworkが消費する準備ができています。

インプレッションのソースドメインフィールドに注意してください。

これは、アプリ駆動のSKAdNetworkフローのソースアプリIDのリンクアナログです。

SKAdNetworkシステムへのこの新しいエントリの使用を開始する方法を見て、広告ネットワークは次のことを行う必要があります。リンクの一意に識別可能な部分とリンク自体を作成します。

前に説明したように、構築された場所で署名されたインプレッションを提供できるエンドポイントを公開します。

ポストバックサーバーを更新して、新しいオプションのソースドメインフィールドを解析して理解します。

SKAdNetworkへのリンクを使用したいウェブページの場合は、広告ネットワークから提供された広告リンクを埋め込むだけです。

これは、ウェブ上の広告のSKAdNetworkアトリビューションの紹介でした。

私たちは、この機能がより広い広告エコシステム全体に採用されることに非常に興奮しています。

次に、SKAdNetworkの実装をテストする方法について説明します。

高レベルでは、SKAdNetworkはインプレッションとポストバックを扱います。

開発者コミュニティとの協力から、インプレッションの側では、署名と設定が摩擦のポイントであったことを知っています。

そして、ポストバックでは、テストに優しい方法でそれらを受け取り、検証することは改善のための領域でした。

SKAdNetworkの開発者体験を向上させるために、Xcode 13.3でSKAdNetworkのテスト可能性の変更をリリースしました。

これは、StoreKitTest内の単体テストフレームワークとして利用でき、多くの人がすでにStoreKit実装のさまざまな部分をテストするために使用しています。

印象を検証することを見てみましょう。

SKAdImpressionのインスタンスを作成して設定します。

署名の生成に使用される秘密鍵の公開鍵のカウンターパートを提供し、SKAdTestSessionインスタンスでvalidateメソッドを呼び出します。

これにより、インプレッションが検証され、インプレッションが誤って設定されている場合、または署名が無効な場合はエラーが発生します。

テストするもう1つの主な領域は、ポストバックの受信です。

ここには2つのステップがあります。

ステップ1：テストセッションにテストポストバックを追加します。

SKAdTestPostbackのインスタンスを作成し、ポストバックで必要な値で設定します。

ポストバックが送信される場所であるため、ポストバックURLに特別な注意を支払います。

これは、リモートまたはローカルサーバーを指す場合があります。

次に、SKAdTestSessionのsetPostbacksメソッドを使用して、これをテストセッションに追加します。

ステップ2は、実際にポストバックを送信することです。

ここで行う必要があるのは、SKAdTestSessionのflushPostbacksメソッドを呼び出すだけで、ポストバックは途中でオフになります。

SKAdTestSessionは、ポストバックの作成時に指定したサーバーにネットワーク経由でポストバックを送信することに注意してください。

これらは、今年後半にSKAdNetworkのテスト可能性に登場するいくつかのことです。新しいソース識別子フィールドのサポート。

細かい変換値と粗い変換値のサポート。

複数のコンバージョンをテストするためのサポート。

そして、それはXcode 13.3で最初に利用可能だったSKAdNetworkのテスト可能性の変更を簡単に見ることでした。

今日は、階層IDと変換値について話し、より多くのデータをより早く入手することを目指しました。

そして、複数のコンバージョンについて話し、より長い期間にわたる再エンゲージメントを測定することができます。

次に、リンク駆動型のアトリビューションと、SKAdNetworkにブリッジを追加し、同じプライバシー保護をもたらす方法について話しました。

そして、XcodeでのSKAdNetworkのテスト可能性について話して終わりました。

そして、それはSKAdNetwork 4.0を通して私たちの旅を締めくくります。

最後に、私たちが構築するすべてのものは、素晴らしい開発者コミュニティからのフィードバックによって推進されています。

ユーザーのためのプライバシー第一の広告体験を構築するあなたの経験について聞くことは、信じられないほど充実し、謙虚でした。

ありがとうございます。

♪ ♪