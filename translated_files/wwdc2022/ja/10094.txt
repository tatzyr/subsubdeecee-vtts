10094

♪ ♪

Karthik: こんにちは、私はメッセージチームのエンジニア、Karthikです。

このビデオでは、あなたと共有し、それをアプリに採用する方法を紹介します。

Shared with YouはiOS 15で発表されました。

友人や家族がメッセージで送信するリンクを再訪しやすくするように設計されています。

Shared with Youを採用したシステムアプリケーションは、Safari、ニュース、音楽、ポッドキャスト、テレビアプリ、写真です。

あなたと共有は、あなたがコンテンツを消費している場所であなたに会います。

多くの場合、コンテンツを消費する準備ができていないときにコンテンツが受信されます。

例えば、あなたが食料品の買い物に出かけている間、友人がテレビ番組の推薦を送りますが、それは一日の過程で忘れられます。

Shared with Youを使用すると、テレビアプリで視聴するテレビ番組を閲覧しているときに、後でこのテレビ番組を簡単に発見できます。Shared with Youは、アプリ内から直接メッセージの会話を拾うのが便利になり、アプリを離れることなく共有コンテンツのコンテキストにとどまることができます。

コンテンツはメッセージに固定できます。

「あなたと共有」と「検索」のコンテンツが昇格します。

これは、コンテンツが重要であり、自動共有同意の流れを開始するというシグナルです。

それについては後で詳しく説明します。

iOS 16では、Shared with Youは、アプリ、リンク、コンテンツを含むように拡張されています。

これはあなたと共有の利便性を取り、あなたのアプリに入れます。

まず、アプリで「Shared with You」のデザインについて話し、それがどのように機能するかを示し、次に「Shared with You」を採用する方法を説明します。

デザインから始めます。

Shared with Youには、アプリエクスペリエンスの一部である「Shared with You」シェルフと「Shared with You」アトリビューの2つの部分があります。

Shared with Youシェルフは、メッセージで共有されたコンテンツを強調表示するアプリのブラウジングエクスペリエンスの専用スペースです。

たとえば、テレビアプリの「今すぐ視聴」タブには、Shared with Youシェルフがあります。

音楽とポッドキャストの「今すぐ聴く」タブも同様です。

Shared with Youが提供するコンテンツは、ランク付けされた順序付けされたリストです。

後でビデオで確認します。

「Shared with You」シェルフの各アイテムについて、アトリビューションビューとともにリッチなプレビューを表示します。

リッチプレビューには、サムネイル、タイトル、および該当する場合はサブタイトルがあります。

この例では、リッチプレビューはポッドキャストアート、エピソード名、ショー名で構成されています。

また、Shared with Youシェルフには、各共有コンテンツのアトリビューションビューもあります。

これは、コンテキストを一目で収集できるすべての情報です。

ビューを展開したり、アプリのすべての共有コンテンツを表示したりできる「Moreを表示」要素があります。

アトリビューションビューは、共有した人の名前とアバターを安全に表示するプロセス外ビューです。

また、コンテンツがメッセージに固定されたかどうかも表示されます。

コンテンツの詳細ビューにアトリビューを表示します。

これにより、アプリのコンテンツを共有されたメッセージの会話に接続できます。

例えば、私が見るためにテレビ番組を閲覧しているとき、アトリビューは友人がそれを勧めたことを思い出すのに役立ちます。

私はすぐにそのショーを見ようとしていることを友達に伝えることができます。

これはすべてアプリで起こり、返信した後、私はすぐにコンテンツに戻ります。

アトリビューはインタラクティブです。

ビューをタップすると、アプリケーション内から直接メッセージの会話に移動します。

アトリビューションビューには、「返信」や「削除」などのコンテキストメニューオプションも表示されます。

「返信」コンテンツメニューオプションは、ビューをタップするのと同様の機能です。

「削除」コンテキストメニューオプションは、共有したコンテンツの一部を今後表示しないように指示する方法です。

同じコンテキストメニューが利用可能になり、コンテンツのコンテキストメニューに追加できます。

削除コンテキストメニューのタイトルはカスタマイズできます。

たとえば、Safariでは、Webページのコンテキストメニューに「リンクを削除」と表示されます。

このビデオの後半で、アプリでこれを行う方法について説明します。

これで、Shared with Youシェルフを表示する場所と、アトリビューを表示する場所がわかりました。

Shared with Youの仕組みをお見せしましょう。

メッセージで友人や家族が共有したリンクは、あなたと共有で表面化されます。

グループ会話のリンクは、少なくとも1人の参加者が連絡先である場合に浮上します。

Shared with Youは、ユニバーサルリンクの背後にある同じ技術に基づいています。

ユニバーサルリンクを使用すると、アプリやウェブサイトのコンテンツにシームレスにリンクできます。

ユーザーは、あなたと共有されたコンテンツをきめ細かく制御できます。

彼らは、会話ごと、アプリごと、またはグローバルに、メッセージの外で共有されるコンテンツを選択できます。

この許可は事前に要求する必要はありません。

それは有機的に起こります。

ピン留めリンクは、Shared with Youのコンテンツを表面化するための暗黙の許可です。

ピン留めされたコンテンツは、アプリであなたと共有するために常に利用できます。

アプリのコンテンツがメッセージに固定されたときのヒューリスティックに基づいて、自動共有を有効にするオプションが表示されます。

自動共有がオンになっていると、アプリであなたと共有されたさらなるコンテンツが自動的に利用可能になります。

「あなたと共有」のコンテンツは順序付けられています。

Shared with Youシェルフの最初のアイテムは、システムからのさまざまな信号に基づいてSiriの提案によってキュレーションされています。

これに続いてピン留めされたアイテムが続き、リストの残りの部分は時系列順に並べられています。

Siriの提案は、「ユーザーはコンテンツを閲覧または操作しましたか？」などの信号を使用します。

コンテンツはピン留めされていますか?

コンテンツはどの文脈で提示されていますか?

あなたのアプリは、このフィードバックを提供する役割を果たしています。

後でビデオで詳しく説明します。 後で説明します。

これはすべて、コンテンツがあまりにも一時的または古くないようにするために行われます。

リンクが複数回共有される会話では、Shared with Youは最新のメッセージのみを表示します。

リンクが複数のメッセージの会話で共有されている場合、あなたと共有はアトリビューを介して視覚的にそれを表します。

例えば、エンリケとサラの両方がトップ25シカゴのプレイリストを共有しました。

アトリビューションビューには、両方の連絡先アバターが表示されます。

アトリビューをタップすると、曖昧さ回避メニューが表示され、返信するメッセージの会話を選択できます。

セキュリティとプライバシーは、あなたと共有を設計する際の主な考慮事項と焦点でした。

アトリビューションビューと曖昧さ回避ビューは、プロセスからあなたに代わって引き出されます。

Shared with Youは、ユニバーサルリンクアソシエーションを介してアプリのコンテンツを保護するため、アプリのみがアクセスできます。

アプリはメッセージの受信者や会話にアクセスできません。

これで、Shared with Youの仕組みがわかりました。

最もエキサイティングな部分に、アプリで「Shared with You」を採用する方法。

まず、ユニバーサルリンクを採用します。

次に、Xcodeの「Capabilities」タブの下に、新しいShared with You Capabilityを追加します。

次に、アプリにShared with Youシェルフを置き、コンテンツにアトリビューを追加します。

ユニバーサルリンクの採用について簡単にお話ししましょう。

ユニバーサルリンクを使用すると、ユーザーはアプリやウェブサイトのコンテンツへのリンクをインテリジェントにフォローできます。

ユニバーサルリンクをサポートするには、次の手順を実行します。

まず、アプリとウェブサイトの間に双方向の関連付けを作成し、アプリが処理するURLを指定します。

関連するドメインのエンタイトルメントをアプリに追加し、WebサーバーにJSONファイルを追加して作成します。

次に、ユニバーサルリンクがアプリにルーティングされたときに、システムが提供するユーザーアクティビティオブジェクトに応答するように、アプリデリゲートを更新します。

詳細については、「ユニバーサルリンクの新機能」ビデオをご覧ください。

iOS 16では、Shared with Youという新しいフレームワークを導入しました。

Shared with Youフレームワークには、SWHighlightCenter、SWHighlight、SWAttributionViewの3つの主要なクラスがあります。

SWHighlightCenterは、アプリのShared with Youコンテンツを取得するのに役立つクラスです。

SWHighlightは、アプリの共有コンテンツをラップするモデルオブジェクトです。

SWAttributionViewは、コンテンツをメッセージの会話に接続し、アトリビューション情報を表示するのに役立つビューです。

ハイライトセンターは、SWHighlightオブジェクトの配列であるハイライトで構成されるシンプルなオブジェクトです。また、Shared with Youによってコンテンツが追加、削除、または更新されたときにアプリが通知を受け取るデリゲートプロパティ。

ハイライトはSWHighlightクラスで表されます。

メッセージで共有されたアプリのコンテンツのURLを渡すために使用されます。

それを使用して、コンテンツを参照し、リッチなプレビューをレンダリングし、アプリ内のコンテンツに移動します。

アプリでShared with Youコンテンツを列挙する方法をお見せしましょう。

まず、SWHighlightCenterのインスタンスを作成します。

次に、デリゲートプロパティを設定します。

SWHighlightCenterDelegateメソッドを実装します。

ハイライトセンターのハイライトプロパティを使用して、アプリのShared with Youコンテンツにアクセスします。

アプリは、そのリストを最新のリストとすばやく差分するために、以前のハイライトリストを保持することを選択できます。

各ハイライトのURLプロパティを使用して、アプリのコンテンツのリッチプレビューを生成します。

そして、アプリでShared with Youのコンテンツを列挙するのと同じくらい簡単です。

次に、アプリのShared with Youコンテンツにアトリビューアトリビューを追加およびカスタマイズする方法を紹介します。

SWAttributionViewは、コンテンツを共有した人の名前とアバターを示すビューです。

各ハイライトには、対応するアトリビューションビューがあります。

アトリビューにハイライトプロパティを設定すると、アトリビューション情報のプロセス外レンダリングがトリガーされます。

アトリビューが取ることができる最大幅を指定します。

アトリビューションビューは、必要に応じてスペースを埋めたり収めたりします。

最大スペース内でアトリビューのアトリビューのアライメントを設定します。

例をお見せしましょう。

SWAttributionViewのインスタンスを作成し、ハイライトプロパティを設定します。

優先するMaxLayoutWidthを設定します。

この例では、共有コンテンツのサムネイルの下部にまたがっています。

このビューの幅アンカーを制限するか、フレーム幅を設定して、コンテンツの最大幅を制御します。

UIViewのminimumContentSizeCategoryまたはmaximumContentSizeCategoryプロパティを使用して、必要に応じてビューの最大AXコンテンツサイズカテゴリを設定します。

このビューの周りに十分な垂直スペースを提供します。

ビューの高さは、preferredContentSizeCategoryと結果のフォントサイズに依存します。

ビューの高さが不必要に制限されている場合、ビューがクリップされるか、描画されない可能性があります。

この場合、水平アライメントは先頭に設定されています。

センターまたはトレーリングに設定することもできます。

次に、アトリビューションビューをカスタマイズする方法を紹介します。

表示コンテキストを設定すると、ユーザーが帰属コンテンツをどのように消費しているかをシステムに通知するのに役立ちます。

また、アプリのShared with Youコンテンツのランキングにも影響します。

ウィンドウに追加される前にこれを設定してください。

アトリビューの背景スタイルは、使用されているコンテンツの背景に基づいてカスタマイズできます。

例をお見せしましょう。

displayContextプロパティのデフォルト値はsumeraryです。

これは、コンテンツが消費のために表示されていることを示しています。

映画を見たり、ポッドキャストを聴いたりするなど、ユーザーがコンテンツを積極的に消費しているときに、displayContextを詳細に設定します。

displayContextの設定は、アプリが提供できるフィードバックです。

これは、Siriの提案があなたのアプリのコンテンツをランク付けするのに役立ちます。

この例のように、モノクロの背景にアトリビューを配置するときに、アトリビューの背景スタイルを色に設定します。

色とりどりの背景にアトリビューを配置するときは、素材を使用してください。

これにより、ビューの内容に素材の背景のぼかしが設定されます。

この例では、Safariのランディングページに背景画像があります。

アトリビューのコンテンツは、正しい背景スタイルを設定することでより見やすくなります。

次に、アプリのコンテンツにShared with Youコンテキストメニューを追加し、タイトルをカスタマイズする方法を紹介します。

アプリのコンテンツに添付されている既存のコンテキストメニューは、アトリビューのメニューで補完できます。

このメニューは、拡張するコンテキストメニューとインラインまたは末尾に追加する必要があります。

コンテキストメニューの削除オプションのカスタムタイトルを提供できます。

文字列には、正しくローカライズされた「削除」という単語を含める必要があります。

この例では、Safariは末尾のコンテンツのコンテキストメニューで「削除」メニューのタイトルを「リンクを削除」にカスタマイズしました。

例を通してこれを行う方法をお見せしましょう。

まず、アトリビューのインスタンスを作成し、ハイライトプロパティを設定します。

menuTitleForHideActionを使用して、コンテキストの削除メニューのカスタムタイトルを提供します。

コンテンツのコンテキストメニューを設定するときは、補足メニュープロパティを介してアトリビューからメニューを取得します。

次に、コンテンツのコンテキストメニューに追加します。

これらの簡単な手順により、アプリはアトリビューで利用可能なコンテキストメニューオプションをコンテンツのコンテキストメニューに追加できます。

これで、アプリでShared with Youを採用するために必要なことがすべてわかりました。

アプリで「Shared with You」を採用するための3つの簡単なステップをまとめてみましょう。

ユニバーサルリンクを採用してください。

次に、アプリのXcodeに新しいShared with You Capabilityを追加します。

新しいShared with Youフレームワークをインポートして使用します。

メッセージであなたのコンテンツを共有し、あなたのアプリであなたと共有することを楽しみにしています。

お時間とご清聴ありがとうございました。