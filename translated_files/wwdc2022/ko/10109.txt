10109

♪ 부드러운 기악 힙합 음악 ♪

♪

안녕하세요, 제 이름은 조나단입니다.

macOS 개발자는 악성 소프트웨어로부터 고객을 보호하기 위해 공증 서비스에 소프트웨어를 제출합니다.

작년에 우리는 notarytool CLI 또는 명령줄 인터페이스로 공증을 위한 앱을 제출하는 더 빠르고 간단한 방법을 도입했습니다.

올해 우리는 공증 서비스와의 상호 작용에 대한 몇 가지 주요 개선으로 성과와 유연성을 계속 옹호하게 되어 기쁩니다.

이 세션에서, 우리는 세 가지 주요 주제에 대해 이야기할 것이다.

먼저, 우리는 공증을 위해 altool을 사용하는 것에서 notarytool을 사용하는 것으로의 마이그레이션을 위한 중요한 마감일을 통과할 것입니다.

다음으로, 우리는 notarytool의 제출 속도를 Xcode로 가져오는 다가오는 Xcode 14와의 Xcode 통합 개선에 대해 논의할 것입니다.

그리고 마지막으로, 우리는 공증인 서비스와 상호 작용하는 유연한 새로운 방법인 REST API에 대해 이야기할 것이며, 업로드할 수 있는 장소를 확장하고, 상태를 확인하고, 제출을 검토할 수 있습니다.

작년에 우리는 공증을 위한 altool을 대체하는 notarytool을 도입했다.

이 이야기의 뒷부분에서, 저는 Xcode 14로 업데이트된 백엔드로 이동하는 Xcode에 대해 논의할 것입니다.

Altool과 Xcode 13을 통한 공증을 위한 마이그레이션 경로와 함께, 우리는 이러한 오래된 방법으로 공증의 일몰 날짜를 2023년 가을로 발표합니다.

Altool에서 notarytool로 이동하는 데 도움이 필요하면, 작년 프레젠테이션 "Mac 앱을 위한 더 빠르고 간단한 공증"을 참조하십시오.

몇 가지 세부 사항을 강조하기 위해, notarytool CLI는 Xcode 13에 번들로 제공되는 것을 포함하여 2023년 가을 마감일을 지나도 계속 작동할 것이다.

그러나 항상 그렇듯이, 최신 개선 사항과 수정 사항을 받기 위해 업데이트하는 것이 좋습니다.

Xcode 13 UI를 사용하여 공증인 서비스에 업로드하면 마감일 이후에 작동이 중지됩니다.

Xcode 14의 성능 개선에 대해 계속 지켜봐 주시기 바랍니다. 하지만 대부분 워크플로우가 변경되지 않을 것으로 예상할 수 있습니다.

마지막으로, 모든 형태의 알툴을 사용한 공증은 2023년 가을에 작동을 멈출 것이다.

다시 말하지만, notarytool로의 마이그레이션에 대한 자세한 내용은 작년 WWDC 프레젠테이션을 참조하십시오.

다음으로, 우리는 Xcode 14의 공증 변경 사항을 다룰 것입니다.

우리는 작년에 도입한 notarytool CLI와 동일한 신뢰할 수 있는 백엔드를 사용하기 위해 Xcode에 내장된 공증 지원을 마이그레이션했습니다.

이 때문에, 우리는 작년에 notarytool에 대해 발표한 것과 동일한 약 4배의 성능 향상을 Xcode 14에 가져오게 되어 기쁩니다.

가장 좋은 점은 업데이트 외에도 이 성능 향상을 받기 위해 프로젝트 설정이나 워크플로우를 변경할 필요가 없다는 것입니다.

이 프레젠테이션의 마지막 주제를 위해, 우리는 공증인을 위한 REST API라는 새로운 서비스를 발표하게 되어 기쁩니다.

이 새로운 서비스를 사용하면 더 많은 장소에서 공증 서비스와 더 유연하게 상호 작용할 수 있습니다.

몇 가지 중요한 개념을 검토하기 위해, 이 새로운 API는 공증인 서비스에 대한 보다 유연한 인터페이스를 허용하기 위한 것이다.

JSON 기반 웹 서비스로서, 통합은 대부분의 언어에서 상당히 간단해야 한다.

이 API를 사용하면 현재 macOS를 실행하지 않을 수 있는 지속적인 통합 서버를 포함하여 인터넷 연결이 있는 모든 곳에서 제출물을 업로드할 수 있습니다.

또한, 제출 내역이나 과거 제출 세부 사항을 검색하는 것과 같은 공증인 서비스와의 다른 상호 작용도 이 API에서 지원됩니다.

REST API를 도입하는 우리의 목표는 더 많은 플랫폼에서 공증 소프트웨어를 제출하고 자동화 시스템에서 공증인과 더 쉽게 상호 작용할 수 있도록 지원하는 것입니다.

이것은 리눅스 기반 지속적인 통합과 같이 오늘날 실행할 수 없는 현재의 제출 방법, Xcode 및 공증 도구를 보완합니다.

예를 들어, 배포 파이프라인이 배포 전에 공증인에 신청서를 제출하기를 원한다고 상상해 보세요.

이 새로운 API와 기본 스크립트를 사용하면 프로세스를 쉽게 자동화할 수 있습니다.

내가 뛰어들기 전에, 한 가지 중요한 주제는 인증이다.

다른 App Store Connect API와 마찬가지로 JSON 웹 토큰 또는 JWT를 사용하여 API로 인증할 수 있습니다.

인증 또는 제가 보여주려는 코드에 대한 자세한 내용은 아래에 링크된 REST API 문서를 방문하십시오.

이 스니펫에서, 나는 당신이 토큰 변수로 함수에 전달된 유효한 JWT를 가지고 있다고 가정할 것입니다.

파이썬으로 공증인에게 파일을 제출하는 예를 살펴봅시다.

이 같은 기본 흐름은 다른 프로그래밍 언어에도 적용된다.

공증인에 파일을 업로드하는 두 가지 주요 단계가 있다.

첫 번째 단계는 공증인에게 파일을 업로드하고 싶다고 알리는 것입니다.

여기에는 이름과 SHA-256과 같은 파일에 대한 몇 가지 기본 정보가 포함되어 있습니다.

응답에는 파일을 업로드하는 데 필요한 정보와 파이프라인을 통해 제출을 추적하는 데 필요한 ID가 포함되어 있습니다.

두 번째 단계는 실제로 아마존 S3를 통해 공증을 위해 파일을 업로드한다.

당신이 가장 좋아하는 S3 SDK를 가져와야 합니다.

이 예시에서, 나는 boto3 라이브러리를 사용할 것이다.

여기서 우리는 이전 호출에서 반환된 임시 자격 증명을 사용하여 클라이언트를 인증하고 만듭니다.

그런 다음 클라이언트를 사용하여 첫 번째 단계의 응답에 지정된 버킷과 객체에 파일을 업로드합니다.

일단 업로드되면, 제출은 공증 파이프라인을 통해 진행될 것이다.

이 과정은 대부분의 제출에 대해 15분 이내에 완료되어야 합니다.

업로드 후, 배포 전에 공증 서비스가 제출을 성공적으로 처리했는지 확인해야 합니다.

대체로 말하자면, 이것에 대한 두 가지 접근 방식이 있다.

첫 번째이자 가장 간단한 것은 동일한 API를 통해 결과를 확인하는 것이다.

다른 옵션은 notarytool과 함께 도입된 웹훅 지원을 통한 것이다.

먼저, API 접근 방식을 살펴봅시다.

공증인에 대한 제출 상태를 확인하는 것은 매우 간단합니다. 업로드 과정에서 받은 제출 ID로 요청할 수 있습니다. 응답의 일부는 제출의 현재 상태이며, 공증인이 처리를 마칠 때까지 "진행 중"으로 유지됩니다.

그런 다음 상태는 수락 또는 무효와 같은 제출의 최종 상태로 전환됩니다.

제출이 완료되면, API를 사용하여 이 업로드에 대한 공증 로그를 검색할 수 있습니다.

이러한 엔드포인트에 대한 자세한 내용은 공증인 REST API 문서를 참조하십시오.

다음으로, 우리는 당신의 상태를 얻기 위한 두 번째 접근 방식에 대해 이야기할 것입니다: 웹훅.

웹훅 워크플로우에서 프로세스는 대부분 동일하지만, 이번에는 업로드 초기 요청에서 웹훅 URL을 제공할 것입니다.

형식에 대한 자세한 내용은 공증인 REST API 문서에서 찾을 수 있습니다.

이전과 마찬가지로, 이것은 당신의 제출을 분석하기 위해 공증인을 촉발할 것입니다.

자동화된 분석이 마무리됨에 따라, 티켓이 생성되고, 최종 상태가 저장됩니다.

완료되면, 공증 서비스는 제공된 웹훅 URL을 호출할 것이다.

이 통화의 내용에는 제출 ID, 팀 ID, 그리고 그것이 우리에게서 왔는지 확인하기 위한 서명이 포함됩니다.

그 알림을 받으면, 다음에 무엇을 할지 선택할 수 있습니다.

예를 들어, 원래 제출자에게 알리거나 자동화된 유통 파이프라인을 시작할 수 있습니다.

Notarytool에서 기다리는 것과 비교할 때, 공증 후 작업을 자동화하는 시스템에서 파일을 업로드하는 시스템을 분리할 수 있습니다.

우리는 이 새로운 REST API가 macOS용 소프트웨어를 구축하기 위한 지속적인 통합 시스템 및 기타 도구와의 더 많은 통합의 문을 열게 되어 기쁩니다.

다시 한 번 더 알려드리자면, Xcode 14, notarytool 또는 REST API를 직접 사용하는 것으로 마이그레이션하는 마감일은 2023년 가을입니다.

마지막으로, 아직 배포 파이프라인에서 notarytool을 사용할 수 없다면, 오늘 공증인 REST API를 시도하여 자동화를 시작할 수 있는 기회입니다.

아래 문서에 대한 링크를 찾을 수 있습니다.

고마워, 그리고 나는 네가 WWDC22의 나머지를 즐기길 바라 ♪