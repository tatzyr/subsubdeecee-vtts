702

안녕하세요, 저는 NFC 팀의 로렌스입니다.

이 코어 NFC 업데이트에 오신 것을 환영합니다.

우리는 올해 NFC 경험을 향상시킬 뿐만 아니라 애플리케이션 내에서 NFC 태그를 처리하는 과정을 크게 단순화하는 Core NFC의 새로운 기능을 가지고 있습니다.

코어 NFC를 처음 접한다면, 작년에 출시된 "코어 NFC 소개" 비디오를 보는 것이 좋습니다.

새로운 배경 태그 읽기 기능을 통해 iPhone은 NFC 태그를 자동으로 읽고 적절한 앱에 전달할 수 있습니다.

이 메커니즘은 필요한 앱 실행을 수행하거나 애플리케이션을 전경 상태로 가져올 수 있다.

우리는 이것이 어떻게 사용자 경험을 더 좋게 만들고 앱이 NFC 태그를 더 쉽게 처리할 수 있는지 보게 되어 기쁩니다.

이 비디오에서는 NFC 태그 데이터 요구 사항, 예상되는 사용자 경험, 백그라운드 태그 읽기가 지원되는 경우, 그리고 시작하기 위한 몇 가지 예제 코드 스니펫에 대해 논의할 것입니다.

백그라운드 태그 읽기는 NDEF 메시지에 URL 레코드가 포함된 모든 NDEF 형식의 태그에서 작동합니다.

NDEF 메시지에서 처음 발견된 URL 레코드만 처리됩니다.

메시지가 애플리케이션으로 라우팅되도록 하려면 URL 레코드에 유효한 Apple Universal Link URL이 포함되어야 합니다.

iOS는 Apple Universal Link에 등록된 애플리케이션으로 메시지를 라우팅할 것입니다.

화면이 켜져 있는 동안, 배경 태그 판독은 근처의 NFC 태그를 스캔할 것이다.

호환 가능한 태그가 성공적으로 읽히면, 알림 센터의 팝업이 iPhone 화면에 나타납니다.

알림을 탭하면 Apple Universal Link 메커니즘을 사용하여 관련 애플리케이션에 NSUserActivity 객체가 전달됩니다.

기본적으로 Safari는 등록되지 않은 모든 응용 프로그램 링크를 처리하며 URL 페이로드만 처리합니다.

기본 iOS 동작을 트리거하는 다른 URL 체계도 있으며, 나중에 논의할 것입니다.

처리되지 않은 알림은 향후 참조를 위해 알림 센터에 저장됩니다.

사용자가 NFC 태그를 탭하면 다음과 같이 됩니까?

알림이 표시되고, 알림을 탭하면 등록된 애플리케이션이 시작됩니다.

애플리케이션이 실행되면, NFC 태그를 다시 탭하면 새로운 알림이 트리거됩니다.

태그가 잠긴 상태에서 읽히면, 사용자는 태그 데이터를 처리하기 전에 먼저 휴대폰의 잠금을 해제하라는 메시지가 표시됩니다.

배경 태그 읽기는 iPhone XS, iPhone XS Max 및 iPhone XR에서 지원됩니다.

백그라운드 태그 판독이 작동하려면 휴대폰을 부팅한 후 적어도 한 번은 먼저 잠금을 해제해야 합니다.

첫 번째 잠금 해제 후, 장치는 다음 조건을 제외하고 잠금 상태에 관계없이 디스플레이가 켜져 있을 때마다 백그라운드에서 NFC 태그를 스캔합니다: Core NFC 리더 세션이 진행 중이거나, 지갑 또는 Apple Pay가 사용 중이거나, 카메라가 사용 중이거나, 장치가 비행기 모드에 있습니다.

이제 NFC 태그의 내용을 받기 위해 애플리케이션에서 필요한 구현 단계를 살펴보겠습니다.

이것은 세 가지 주요 단계로 나뉜다.

유니버설 링크 요구 사항에 따라 애플리케이션에 관련 도메인을 등록해야 합니다.

그런 다음 UIApplicationDelegate 프로토콜, application(_:continue: restorationHandler:) 기능을 채택해야 합니다.

마지막으로, NSUserActivity 객체의 ndefMessagePayload 속성에서 NDEF 메시지를 추출해야 합니다.

앱에 도메인을 등록하려면, Xcode에서 프로젝트를 열고 관련 도메인 섹션에 서버 호스트 도메인을 입력하십시오.

다음은 UIKit 애플리케이션에서 NSUserActivity 객체를 받는 방법을 보여주는 코드 스니펫입니다.

먼저, 코어 NFC 프레임워크를 가져오세요.

UIApplicationDelegate 프로토콜 방법, 응용 프로그램 구현 (_:continue: restorationHandler:).

핸들러에서 활동 유형이 NSUserActivityTypeBrowsingWeb인지 확인하십시오.

ndefMessagePayload 속성에서 NFCNDEFMessage를 읽으세요.

여기에는 NFC 태그에서 읽은 전체 NDEF 메시지가 포함되어 있습니다.

이 메시지에는 NFC NDEF 페이로드 레코드 배열이 포함되어 있습니다.

각 NDEF 레코드에는 typeNameFormat, Type, Identifier 및 데이터 페이로드가 포함되어 있습니다.

NFC NDEF 페이로드 중 하나는 애플리케이션 실행을 트리거한 유니버설 링크가 있는 URL 레코드를 포함합니다.

다양한 레코드 유형 정의와 관련하여 NFC 포럼 사양을 참조하십시오.

수신된 NSUserActivity 객체가 백그라운드 태그 판독에서 비롯되지 않은 경우, 결과 NFCNDEFMessage는 typeNameFormat 속성이 NFCTypeNameFormatEmpty로 설정된 정확히 하나의 NFC NDEF 페이로드 객체를 포함합니다.

URL 레코드에 유니버설 링크가 포함되어 있지 않은 경우, iOS는 여전히 HomeKit, SMS, GPS 등과 같은 QR 코드 스캐너와 동일한 URI 체계를 처리할 수 있습니다.

다음은 지원되는 다양한 계획의 몇 가지 예입니다.

Developer.apple.com에서 Core NFC에 대한 더 많은 정보를 찾을 수 있습니다.