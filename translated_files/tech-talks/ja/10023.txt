10023

みなさん、こんにちは。今日はご参加いただきありがとうございます。

私の名前はプラナブで、ここアップルのメディア品質チームで働いています。

今日はApple Pro Display XDRについて話すのがとても楽しみです。

この講演では、この素晴らしいディスプレイを操作し、最も推奨される方法で使用する方法について、アプリ開発者とプロのユーザーをガイドします。

Pro Display XDRは、高級リファレンスモニターです。

それは32インチのLCDディスプレイで、2000万以上のピクセルを持ち、6Kの解像度で、これはAppleがこれまでに作った中で最大の網膜ディスプレイです。

それはP3の広色域を持ち、真の10ビットカラーをサポートしています。

ディスプレイは1600ニトと同じくらい明るくなり、1000ニトのフルスクリーン輝度を無期限に維持することさえできます。

これにより、すべてのHDRワークフローに理想的なディスプレイになります。

また、ディスプレイにリファレンスモードを組み込み、これらのモードはすべて工場でキャリブレーションされています。

あなたにとって、これは、色精度が高く、すべてのポストプロダクションニーズに対応する機能が満載のディスプレイで作業できることを意味します。

私たちは、プロのためにこのディスプレイ上のすべての要素を構築しました。

ビデオ編集、写真、カラーグレーディング、視覚効果、3Dアニメーション、ゲーム開発などのプロフェッショナルなワークフローをサポートするように設計されています。

現在、そこにあるプロアプリのいくつかは、すでにこのディスプレイで動作するようにカスタマイズされています。

そして、ここであなたはそれらのいくつかを見ることができます。

例として、Blackmagic DesignはResolveでEDRのサポートを有効にしました。

これにより、Resolveは拡張範囲とSDRコンテンツの両方を同時に表示できるようになりました。

また、入力フッテージ、タイムライン作業スペース、出力にユニークな色空間を割り当てる機能も追加しました。

また、Adobe Premiere ProとFoundry NukeはすでにEDRの予備サポートを実装していますが、これらのアプリの完全なEDRサポートはまもなく行われます。

このセッションでは、他のプロアプリ開発者が独自のアプリを作成し、カスタマイズし、このディスプレイの機能を最大限に活用できるようにしたいと考えています。

同時に、ワークフローが正しく設定されていることを確認するために、このディスプレイを使用するためのベストプラクティスをプロユーザーに提供したいと考えています。

その目的を念頭に置いて、今日取り上げる内容は次のとおりです。

まず、参照モードが何であるかを理解し、このディスプレイで利用可能な参照モードのさまざまな特性について学びます。

次に、このディスプレイ用のプロアプリを開発する際に重要なカラーマネジメントとEDRに関連する重要な概念のいくつかについて話します。

次に、プロユーザー向けに、私たちが出荷した最近の機能のいくつかと、これらの機能がどのようにワークフローをより有能で正確なものにするかについて説明します。

そして最後に、このディスプレイの画面前面の応答を測定し、参照モードのいずれかで作業する際にコンテンツが正しくレンダリングされていることを確認する方法を紹介します。

では、始めましょう。

さて、参照モードとは何ですか?

参照モードごとに、ディスプレイ自体の輝度、色、ガンマ応答を設定しているため、ある参照モードから別の参照モードに切り替えると、ディスプレイは特定のワークフローに適応するために独自の動作を変更します。

また、これらのモードはそれぞれ較正されているため、すべての参照モードで高い色精度が期待できます。

これを考えると、参照モードは単にICCディスプレイプロファイルを差し込むだけではありません。

実際、参照モードを切り替えると、ICCプロファイルが自動的に入力されるため、macOSが提供するカラー管理と組み合わせてディスプレイが機能するのに役立ちます。

また、他のカラーマネージドシステムと同様に、メディアサーフェスにカラー記述子でタグを付ける必要があります。

そして、私たちはすぐにこれについて詳細に議論します。

ディスプレイには、箱から出してすぐにいくつかの参照モードが組み込まれています。

そして、参照モードには2つのカテゴリがあります。

1つ目は、Appleが設計したモードであり、当社の内蔵Macディスプレイの特性を反映しています。

そのため、Appleが設計したモードの1つにいると、True Toneや自動輝度などの動的適応機能を有効または無効にできることに気付くでしょう。

これらの適応技術は、非参照の表示環境でも表示を容易にするため、素晴らしいです。

ただし、参照環境でコンテンツをオーサリングしているプロのユーザーは、これらの動的機能が厳密に無効になっている参照モードで作業したいと思うでしょう。

そのために、標準ベースのモードがあります。

これらは、一般的な業界仕様と一致し、参照表示環境で作業していることを前提とする特定のポストプロダクションワークフローをサポートするように設計されています。

これらのモードを使用する場合、表示条件は非常に重要です。

通常、ほとんどのワークフローでは、薄暗い表示環境で作業する必要があります。

最も人気のある参照モードのいくつかを詳しく見てみましょう。

これは、ITU BT.709およびBT.1886の推奨事項を使用して構築されたHDTVビデオリファレンスモードです。

現在、当社のディスプレイは最大1600ニトとP3の広色域を行うことができますが、SDRワークフローで作業する場合、そのすべては必要ありません。

したがって、このモードに切り替えると、意図的にディスプレイのピーク輝度を100ニトに制限し、カラーボリュームをRec.709色域に制限します。

また、すべての動的コントロールは無効になっており、薄暗い表示環境でこの参照モードを使用する必要があります。

次に、HDRビデオリファレンスモードをチェックしてみましょう。

ここでは、P3の広色域と1000ニトのピークHDR輝度が見られます。

そして、あなたは1000ニトのフルスクリーン輝度を無期限に持つことができます。

これは、パッチサイズや時間の経過とともに輝度が大幅に低下することを心配することなく、好きなだけHDRワークフローに取り組むことができることを意味します。

プロディスプレイXDRリファレンスモードでは、ディスプレイの機能を最大限に活用します。

ここでは、画面領域の最大39%に対して1600ニトのHDRピーク輝度があります。

また、SDRピーク輝度は、明るさスライダーを使用して最大500ニトまで設定できます。

また、すべての動的適応機能を有効にすることができ、HDRビデオコンテンツはトーンマッピングされます。

さて、多くの場合、SDRとHDRの両方のアセットを同じ画面に同時に表示したいと思うでしょう。

たとえば、SDRの電子メールを確認したり、HDRの可能性のあるビデオを再生したりできます。

これを可能にするために、SDRとHDRの両方の要素を1つにマージするユニークな方法を考え出しました。

そして、私たちはそれをどのように行うかについてすぐに議論します。

それでは、このディスプレイ用のアプリを開発する際に注意すべきいくつかの重要な概念について話します。

参照モードをもっと理解するには、メディアパイプラインのさまざまなピクセル処理段階を理解する必要があります。

SDR参照モードの1つにいるときに何が起こるかをお見せしましょう。

私たちのSDRビデオコンテンツは、コアメディアによってデコードされ、ファイル内のカラー記述子でタグ付けされています。

次に、UIとSDRの両方のビデオは、コンポジションのための共通の色表現にマッピングされます。

構成されたインターフェイスは、プロディスプレイに送信する前に、ディスプレイの転送機能と色空間にマッピングされます。

HDRビデオやプロディスプレイXDRモードなどのHDRリファレンスモードで作業している場合、MacとディスプレイはPQリンクを介して通信します。

繰り返しますが、SDRコンテンツとUIは、タグ付き色空間とガンマを使用して線形光にデコードされます。

HDRコンテンツは、PQまたはHLG転送機能を使用して線形光にデコードされます。

すべての合成はEDR空間で行われます。

EDRとは何かについて簡単に話し合いましょう。

EDRは拡張ダイナミックレンジの略で、拡張範囲を使用してSDRとHDRシーンを同時に表現することが私たちのアプローチです。

EDRはSDR参照の作業スペースであり、SDRコンテンツは論理的な0対1の範囲で変更されず、EDRは1.0を超える明るい値を可能にします。

通常、ヘッドルームと呼ばれるEDR 1.0を超える範囲は、通常、シーン内の鏡面ハイライトと発光面を表すために予約されています。

最後に、合成フレームはディスプレイの色空間とPQ転送機能にマッピングされ、ディスプレイに送信されます。

今、私たちは、異なる参照モードが異なる動作をし、macOSが提供するカラーマネジメントを利用するのを見てきました。

その結果、画像とビデオの両方のメディアコンテンツに正しくタグを付けることが非常に重要です。

これにより、メディアデータがカラー管理システムであるmacOSによって正しく解釈されることが保証されます。

画像の場合はカラープロファイルを割り当て、ビデオの場合は標準カラー記述子でタグ付けします。

ビデオファイルのカラー記述子を見てみましょう。 

QuickTime Playerのムービーインスペクタを使用して、ビデオファイルに関連付けられたカラータグを読み取ることができます。

カラープライマリタグは、線形RGBからXYZ空間へのマッピングを指定します。

転送関数タグは、非線形R'G'B'コードワードを線形RGB空間に変換する電気光学転送関数を指定します。

そして最後に、Y'CbCr行列は、Y'CbCrとR'G'B'空間の間のマッピングを指定します。

AVFoundationを使用してコンテンツにタグを付けている場合は、HDRメディアのエクスポートに関する今年のWWDCセッションを見ることをお勧めします。

プロディスプレイXDRのリファレンスモードについては、ビデオファイルをタグ付けするときに使用すべき推奨カラー記述子の表です。

これらのタグは、作業中の参照モードでコンテンツが正しく解釈されることを保証します。

これで、アプリがAVFoundationフレームワークを使用している場合、参照モードを正しく識別し、各モードに必要なカラーマネジメントを提供します。

まず、ソース内のY'CbCrコードワードはコアメディアによってデコードされ、ソース色空間で非線形R'G'B'コードワードに変換されます。

これは、プリセットの転送機能と色空間にマッピングされます。

その後、ディスプレイはプリセットの特性を使用して入力信号を線形化できます。

アプリのハードウェアがカスタムビデオパイプラインを使用している場合、やるべきことがいくつかあります。

まず、Y'CbCr行列に指定されたNCLCタグを使用して、Y'CbCrスペースのコードワードをR'G'B'に変換する必要があります。

その後、R'G'B'コードワードをニッチ値に線形化し、EDRにマッピングする必要があります。

このEDRへのマッピングは、EDR 1.0がソースの参照白にマッピングされるように行う必要があります。

参照白よりも明るいピクセルは、1.0より大きいEDR値にマッピングできます。

その後、ディスプレイパイプラインは、EDRをプリセットの色空間にマッピングし、それをディスプレイに供給します。

さて、ユーザーが作業している参照モードに基づいて、EDRへのマッピングを別の方法で管理したいと思うでしょう。

これは、アプリを利用するためにアプリの動作を調整するのに役立ちます。

ユーザーが作業している参照モードを正しく識別するには、EDRパラメータを使用できます。

3つのヘッドルームパラメータのそれぞれを理解しましょう。

潜在的なヘッドルームは、現在のディスプレイ構成で可能な最大ヘッドルームを示します。

そして、それは参照モードによって異なるかもしれません。

たとえば、HDRビデオリファレンスモードのピークHDR輝度は1000ニト、ピークSDR輝度は100ニトです。

これは、10.0の潜在的なヘッドルームがあることを意味します。

ピークSDRとHDR輝度が100ニトのHDTVビデオモードは、1.0の潜在的なヘッドルームを持っています。

ヘッドルームパラメータは、現在利用可能なヘッドルームの量を上げることができ、これは潜在的なヘッドルーム以下にすることができます。

参照モードで明るさが増加すると、ヘッドルームが低下する可能性があることに注意してください。

例として、Pro Display XDRプリセットのピークHDR輝度は1600ニトです。

輝度スライダーが200ニトのSDRピークに設定されている場合、ヘッドルームは8.0ですが、潜在的なヘッドルームはまだ16です。

最後に、参照ヘッドルームは、要求された輝度の正確な再現が期待できるヘッドルームの量です。

参照ヘッドルームは、ヘッドルーム値以下にすることができます。

たとえば、HDRビデオとHDTVビデオリファレンスモードでは、それぞれ最大1000ニトと100ニトの正確な再生を保証します。

したがって、参照ヘッドルームは、これらのモードのヘッドルームと同じです。

Appleが設計したモードでは、リファレンスヘッドルームはゼロです。

そして、コードでそれを行う方法は次のとおりです。

まず、Pro Display XDR画面を指すNSScreenオブジェクトを作成します。

次に、潜在的なHeadroom、headroom、およびreferenceHeadroomパラメータを照会できます。

ビデオパイプラインが設定されたので、アプリのカラーパフォーマンスの正確性を評価したいと思うでしょう。

その方法の1つは、分光放射計などの測定機器を使用して、ディスプレイの画面前面の応答を測定することです。

これは、関連するさまざまな段階をまとめたフローチャートです。

前に説明したように、入力信号をプリセットの色空間にマッピングするために、macOSでカラーマネジメントが実行されます。

その後、Pro Display XDRはR'G'B'コードワードを入力として取り込み、光スペクトルを生成します。

その後、分光放射計を使用して光出力を測定し、輝度と色度値を導き出すことができます。

このプロセスを支援するために、AVFoundation開発者のWebページで利用可能なビデオテストパターンを提供しました。

これらのテストパターンは、正しいNCLCとHDR 10ファイルの静的メタデータでタグ付けされたQuickTimeムービーファイルです。

これには、21ステップの輝度ランプ、100%振幅カラープライマリー、カラーセカンダリーが含まれます。

また、これらのテストパターンが設計された参照モードで表示されるときに期待される基準輝度と色度値も含まれています。

では、Pro Display XDRの展開について話し、プロユーザーがリリースした新機能のいくつかを利用して、ワークフローをより有能で正確なものにする方法を紹介します。

そのため、Pro Display XDRは工場で校正され、箱から出してすぐに使用できます。

また、最も人気のあるワークフロー用に設計された組み込みの参照モードのリストもあります。

これらとともに、さまざまなカスタマイズオプションもサポートしています。

カスタマイズされた参照モードについて話すことから始めましょう。

さて、ディスプレイには参照モードのリストが組み込まれていますが、独自のワークフローで、転送機能、ホワイトポイント、色域の異なる組み合わせが必要な場合はどうなりますか?

または、別の最大輝度ターゲットを使用する場合は?

そのために、macOS 10.15.4以降で利用可能なリファレンスモードをカスタマイズしました。

カスタム参照モードを使用すると、これらのパラメータをカスタマイズして、一意の参照モードを作成できるようになりました。

カスタム参照モードを作成する方法をお見せしましょう。

最大HDR輝度の600ニトのワークフローを作成する必要があると想像してみましょう。

また、UIを100ニトよりも明るくしたいとしましょう。

たぶん200ニト。

まず、システム環境設定からディスプレイを選択する必要があります。

ウィンドウタイトルのPro Display XDRで、プリセットリストから[プリセットのカスタマイズ]を選択します。

次に、カスタムプリセットを作成するベースプリセットを選択します。

次に、プラスアイコンをクリックします。

ここでは、プリセットに名前を付けて説明を編集できます。

利用可能なオプションから、色域、ホワイトポイント、およびSDR転送機能を選択できます。

システムガンマブーストを明示的に適用することもできます。

最後に、最大HDR輝度を600ニト、最大SDR輝度を200ニトに変更し、プリセットを保存します。

私たちは今、独自のカスタム参照モードを作成しました。

次の機能を見てみましょう。 では。

現在、多くの場合、測定機器は、あるユニットから別のユニットにわずかな違いがあります。

また、すべてのワークフローが社内の機器で動作するように設定されている場合は、Pro Display XDRを他のディスプレイと一致するように微調整することをお勧めします。

ハイエンドのキャリブレーション分光放射計にアクセスできる方のために、微調整キャリブレーション機能を使用してこれを行うことができます。

微調整キャリブレーションは、macOS 10.15.6以降で利用できます。

この機能を使用すると、ディスプレイの輝度とホワイトポイントを調整して、社内の分光放射計とよりよく一致させ、他のモニターと一致させることができます。

Pro Display XDRでこれをどのように使用できるか見てみましょう。

まず、システム環境設定に移動し、「ディスプレイ」を選択します。

プリセットリストのポップアップメニューでは、ファインチューンキャリブレーションオプションが利用可能です。

ここでは、測定値と目標輝度とホワイトポイント値を入力する必要があります。

次のセクションでは、これらを入手する方法について詳しく説明します。

今、私たちはコンテンツクリエイターとして、あなたのディスプレイが期待どおりに動作していることを確認したいことを知っています。

このセクションでは、コンテンツが正しくレンダリングされていることを客観的に評価する方法について説明します。

これは、Pro Display XDRを使用する際の画面前面評価の推奨プロセスを説明するフローチャートです。

まず、テストパターンを作成し、テストパターンが参照モニターに表示され、較正された分光放射計を使用して測定されたときに期待される参照値を計算する必要があります。

次に、測定器と環境をセットアップします。

正確な結果を得るには、測定中にハイエンドの較正分光放射計を使用することをお勧めします。

これは、私たちが使用することをお勧めするいくつかの分光放射計のリストです。

また、機器が正しく設定されていることを確認してください。

たとえば、Photo Research PR-740分光放射計を使用している場合は、機器の帯域幅を4ナノメートルに設定し、各測定の平均読み取り値を3つ以上に設定することをお勧めします。

迷光が測定を妨げると、低輝度の測定が影響を受ける可能性があります。

最良の結果を得るには、環境が完全に暗いことを確認してください。

また、熱放射を避けるために、通常は摂氏25度未満の温度が制御された部屋で作業することをお勧めします。

次のステップは、テストパターンを画面に表示し、測定することです。

測定値と基準値を取得したら、エラー分析を実行する必要があります。

非常に高いエラーは、プロセスのエラーを示している可能性があります。

これは、テストパターンが正しくタグ付けされていないか、参照モードの選択が正しくないか、機器と環境が適切に設定されていない可能性があります。

エラー分析では、知覚色差メトリックを計算して、測定値と参照値の違いがどれほど目に見えるかを知る必要があります。

この例では、いくつかの知覚色差メトリックを計算する色差計算機を使用しています。

これのサンプルコードを提供します。このサンプルコードを提供します。

計算機は、参照値と測定値を取り込み、デルタE ITP、デルタE 2000、デルタPQメトリックを計算します。

色空間、色域のリストから入力信号を定義できます。

関数と表現を転送します。

入力信号は分光放射計の測定値であるため、Yxy色空間を選択します。

次に、基準輝度と彩度の値を入力します。

この例では、94ニト、D65をターゲットに選択しました。

次に、ご覧のとおり、ターゲットからわずかに外れている測定された輝度と色度値を入力します。

最後に、エラーメトリックを計算します。

21ステップの輝度ランプ全体でこのプロセスを繰り返して、各測定ポイントの誤差メトリックを計算できます。

これは、ランプ全体のデルタE ITP値を示すチャートの例です。

そして、この場合の最大誤差は、約94ニトの目標輝度で発生することがわかります。

次に、エラーが知覚的に重要でない場合は、ワークフローを検証しました。

しかし、輝度とホワイトポイントの誤差が知覚的に重要である場合は、微調整キャリブレーション機能を使用してそれらを改善できます。

これで、最大エラーケースを使用してディスプレイを微調整します。

まず、測定されたホワイトポイントと輝度の値を入力します。

次に、ターゲットのホワイトポイントと輝度の値を入力します。

最後に、説明を追加して「OK」を押して、ディスプレイのキャリブレーションを微調整することができます。

私たちは今、ディスプレイのキャリブレーションを微調整しました。

最終的な検証のために、測定を行い、エラー分析を再度実行します。

これは、微調整キャリブレーション後に見られる可能性のあるデルタE ITPの改善を示す例です。

全体の輝度ランプは、社内の分光放射計とはるかに密接に一致します。

まもなく、ディスプレイのフィールド内再調整を実行するためのサポートを追加します。

この機能を使用すると、機器とのより良いアライメントのためにディスプレイを再調整することができます。

キャリブレーションプロセスは、ディスプレイのカラープライマリー、輝度、ガンマを調整し、ハイエンドの分光放射計と暗い環境が必要になります。

そして、これはインフィールドリキャリブレーションをフローに追加して更新されたプロセスフローチャートです。

この話から取り除いてほしい重要なことがいくつかあります。

Pro Display XDRの参照モードは、ICCディスプレイプロファイルを使用するよりもはるかに多く、ディスプレイ自体の輝度、色、ガンマ応答を設定する方法を提供します。

Macでカラーマネジメントを使用すると、各参照モードは複数のメディアフォーマットをサポートしています。

AVFoundationフレームワークを使用するか、独自のビデオパイプラインをカラー管理できます。

カスタマイズされた参照モードを使用すると、独自の参照モードを作成し、独自のワークフローに取り組むことができます。

Appleが提供するテストパターンと参照値を使用して、ワークフローを評価できます。

そして最後に、フィールド内の再調整と微調整機能を使用して、ディスプレイのカラープライエ、輝度、ホワイトポイントを調整して、社内の測定機器とのより良いアライメントを調整できます。

ありがとうございます。