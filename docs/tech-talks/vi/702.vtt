WEBVTT

00:00:01.000 --> 00:00:04.000
Xin chào, tôi là Lawrence từ nhóm NFC.

00:00:04.000 --> 00:00:07.000
Chào mừng đến với bản cập nhật Core NFC này.

00:00:07.000 --> 00:00:20.000
Chúng tôi đã có một tính năng mới cho Core NFC trong năm nay sẽ không chỉ nâng cao trải nghiệm NFC mà còn đơn giản hóa rất nhiều quá trình xử lý thẻ NFC trong các ứng dụng của bạn.

00:00:20.000 --> 00:00:28.000
Nếu bạn chưa quen với Core NFC, tôi khuyên bạn nên xem video "Giới thiệu về Core NFC" được phát hành vào năm ngoái.

00:00:28.000 --> 00:00:36.000
Với tính năng đọc thẻ nền mới, iPhone có thể tự động đọc các thẻ NFC và gửi chúng đến các ứng dụng thích hợp.

00:00:36.000 --> 00:00:43.000
Cơ chế có thể thực hiện khởi chạy ứng dụng cần thiết hoặc đưa ứng dụng về trạng thái tiền cảnh.

00:00:43.000 --> 00:00:52.000
Chúng tôi rất vui khi thấy điều này có thể làm cho trải nghiệm người dùng tốt hơn và giúp các ứng dụng xử lý thẻ NFC dễ dàng hơn như thế nào.

00:00:52.000 --> 00:01:04.000
Trong video này, tôi sẽ thảo luận về các yêu cầu dữ liệu thẻ NFC, trải nghiệm người dùng dự kiến, khi việc đọc thẻ nền được hỗ trợ và một số đoạn mã ví dụ để giúp bạn bắt đầu.

00:01:04.000 --> 00:01:11.000
Việc đọc thẻ nền sẽ hoạt động với bất kỳ thẻ được định dạng NDEF nào có thông báo NDEF bao gồm bản ghi URL.

00:01:11.000 --> 00:01:17.000
Chỉ bản ghi URL được phát hiện đầu tiên trong tin nhắn NDEF mới được xử lý.

00:01:17.000 --> 00:01:25.000
Bản ghi URL phải chứa URL Apple Universal Link hợp lệ để tin nhắn được chuyển đến một ứng dụng.

00:01:25.000 --> 00:01:31.000
iOS sẽ định tuyến tin nhắn đến ứng dụng đã đăng ký với Apple Universal Link.

00:01:31.000 --> 00:01:36.000
Trong khi màn hình đang bật, việc đọc thẻ nền sẽ quét các thẻ NFC gần đó.

00:01:36.000 --> 00:01:43.000
Khi một thẻ tương thích được đọc thành công, một cửa sổ bật lên từ Trung tâm Thông báo sẽ xuất hiện trên màn hình iPhone.

00:01:43.000 --> 00:01:53.000
Nhấn vào thông báo sẽ kích hoạt việc phân phối đối tượng NSUserActivity đến ứng dụng được liên kết bằng cách sử dụng cơ chế Apple Universal Link.

00:01:53.000 --> 00:02:01.000
Theo mặc định, Safari sẽ xử lý tất cả các liên kết ứng dụng chưa đăng ký và nó sẽ chỉ xử lý tải trọng URL.

00:02:01.000 --> 00:02:09.000
Ngoài ra còn có các sơ đồ URL khác kích hoạt hành vi iOS mặc định, mà tôi sẽ thảo luận sau.

00:02:09.000 --> 00:02:15.000
Mọi thông báo chưa được xử lý sẽ được lưu trong Trung tâm Thông báo để tham khảo trong tương lai.

00:02:15.000 --> 00:02:19.000
Đây là những gì xảy ra khi người dùng chạm vào thẻ NFC.

00:02:19.000 --> 00:02:24.000
Một thông báo sẽ được hiển thị và nhấn vào thông báo sẽ khởi chạy ứng dụng đã đăng ký.

00:02:24.000 --> 00:02:30.000
Khi ứng dụng đang chạy, nhấn vào thẻ NFC một lần nữa sẽ kích hoạt thông báo mới.

00:02:30.000 --> 00:02:50.000
Khi một thẻ được đọc ở trạng thái khóa, người dùng sẽ được nhắc mở khóa điện thoại trước khi dữ liệu thẻ có thể được xử lý.

00:02:50.000 --> 00:03:07.000
Đọc thẻ nền được hỗ trợ trên iPhone XS, iPhone XS Max và iPhone XR.

00:03:07.000 --> 00:03:13.000
Điện thoại trước tiên phải được mở khóa ít nhất một lần sau khi khởi động để việc đọc thẻ nền hoạt động.

00:03:13.000 --> 00:03:34.000
Sau lần mở khóa đầu tiên, thiết bị sẽ quét các thẻ NFC trong nền bất cứ khi nào màn hình bật bất kể trạng thái khóa, ngoại trừ các điều kiện sau: phiên đọc Core NFC đang diễn ra, Wallet hoặc Apple Pay đang được sử dụng, máy ảnh đang được sử dụng hoặc thiết bị đang ở Chế độ trên máy bay.

00:03:34.000 --> 00:03:41.000
Bây giờ hãy để chúng tôi xem qua các bước triển khai bắt buộc trong ứng dụng của bạn để nhận nội dung của thẻ NFC.

00:03:41.000 --> 00:03:44.000
Điều này được chia thành ba bước chính.

00:03:44.000 --> 00:03:51.000
Bạn sẽ cần đăng ký các miền liên quan cho ứng dụng của mình theo yêu cầu của Universal Link.

00:03:51.000 --> 00:04:00.000
Sau đó, bạn sẽ cần áp dụng giao thức UIApplicationDelegate, chức năng application(_:continue: restorationHandler:).

00:04:00.000 --> 00:04:10.000
Cuối cùng, bạn sẽ cần trích xuất tin nhắn NDEF từ thuộc tính ndefMessagePayload của đối tượng NSUserActivity.

00:04:10.000 --> 00:04:19.000
Để đăng ký tên miền của bạn trong ứng dụng của bạn, hãy mở dự án của bạn trong Xcode và nhập tên miền máy chủ máy chủ trong phần Tên miền liên kết.

00:04:19.000 --> 00:04:27.000
Đây là một đoạn mã minh họa cách nhận đối tượng NSUserActivity trong ứng dụng UIKit của bạn.

00:04:27.000 --> 00:04:30.000
Đầu tiên, nhập khung Core NFC.

00:04:30.000 --> 00:04:38.000
Triển khai phương thức giao thức UIApplicationDelegate, ứng dụng (_:tiếp tục: restorationHandler:).

00:04:38.000 --> 00:04:47.000
Xác thực loại hoạt động là NSUserActivityTypeBrowsingWeb trong trình xử lý.

00:04:47.000 --> 00:04:53.000
Đọc NFCNDEFMessage từ thuộc tính ndefMessagePayload.

00:04:53.000 --> 00:04:58.000
Cái này chứa toàn bộ tin nhắn NDEF được đọc từ thẻ NFC.

00:04:58.000 --> 00:05:03.000
Tin nhắn chứa một mảng các bản ghi tải trọng NFC NDEF.

00:05:03.000 --> 00:05:11.000
Mỗi bản ghi NDEF chứa typeNameFormat, Type, Identifier và tải trọng dữ liệu.

00:05:11.000 --> 00:05:20.000
Một trong những tải trọng NFC NDEF sẽ chứa bản ghi URL với Liên kết chung đã kích hoạt khởi chạy ứng dụng của bạn.

00:05:20.000 --> 00:05:26.000
Vui lòng tham khảo các thông số kỹ thuật của Diễn đàn NFC liên quan đến các định nghĩa loại bản ghi khác nhau.

00:05:26.000 --> 00:05:46.000
Nếu đối tượng NSUserActivity nhận được không bắt nguồn từ việc đọc thẻ nền, thì NFCNDEFMessage kết quả sẽ chứa chính xác một đối tượng tải trọng NFC NDEF với thuộc tính typeNameFormat được đặt thành NFCTypeNameFormatEmpty.

00:05:46.000 --> 00:05:59.000
Nếu bản ghi URL không chứa Liên kết chung, iOS vẫn có thể xử lý nhiều lược đồ URI giống như trình quét mã QR như HomeKit, SMS, GPS và các sơ đồ khác.

00:05:59.000 --> 00:06:04.000
Đây là một ví dụ về một số chương trình được hỗ trợ khác nhau.

00:06:04.000 --> 23:59:59.000
Bạn có thể tìm thêm thông tin về Core NFC trên developer.apple.com.

