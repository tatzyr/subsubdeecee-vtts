WEBVTT

00:00:00.000 --> 00:00:10.000
♪ ♪

00:00:10.000 --> 00:00:14.000
Kelly: Xin chào, tên tôi là Kelly, và tôi là một kỹ sư trong đội AirPlay.

00:00:14.000 --> 00:00:15.000
Chào mừng đến với buổi học.

00:00:15.000 --> 00:00:26.000
Hôm nay, chúng tôi sẽ đề cập đến một số tính năng của phiên bản AirPlay mới nhất và cung cấp cho bạn một số mẹo để đảm bảo bạn đang mang đến trải nghiệm AirPlay tuyệt vời trên ứng dụng của mình.

00:00:26.000 --> 00:00:28.000
Đây là chương trình nghị sự mà chúng tôi dành cho bạn hôm nay.

00:00:28.000 --> 00:00:32.000
Tôi sẽ bắt đầu với một cái nhìn tổng quan về AirPlay.

00:00:32.000 --> 00:00:37.000
Sau đó khám phá một số tính năng mà bộ đệm âm thanh nâng cao AirPlay cung cấp.

00:00:37.000 --> 00:00:43.000
Và cuối cùng, tôi sẽ đề cập đến cách tích hợp bộ đệm âm thanh nâng cao vào ứng dụng của bạn.

00:00:43.000 --> 00:00:52.000
AirPlay là cách dễ nhất để chia sẻ video, ảnh, nhạc và hơn thế nữa từ các thiết bị Apple đến loa và màn hình gần đó.

00:00:52.000 --> 00:00:59.000
Với rất nhiều thiết bị tương thích AirPlay trong nhà ngày nay, AirPlay phổ biến hơn bao giờ hết.

00:00:59.000 --> 00:01:11.000
Bạn có thể sử dụng AirPlay theo một trong những cách sau: Với AirPlay Audio, bạn có thể chia sẻ nhạc hoặc podcast yêu thích của mình bằng cách phát trực tuyến đến một hoặc nhiều loa tương thích HomePods và AirPlay đồng bộ hoàn hảo.

00:01:11.000 --> 00:01:24.000
Với AirPlay Video, bạn có thể phát trực tuyến các bộ phim và chương trình yêu thích của mình từ các thiết bị Apple sang Apple TV hoặc TV thông minh tương thích AirPlay với chất lượng cao, hỗ trợ HDR lên đến 4K.

00:01:24.000 --> 00:01:35.000
Và với tính năng phản chiếu, bạn có thể chia sẻ những gì có trên thiết bị Apple của mình - ảnh, video cá nhân, trò chơi, trang web hoặc bảng tính - với Apple TV hoặc TV thông minh tương thích AirPlay.

00:01:35.000 --> 00:01:40.000
Bạn bè và gia đình của bạn cũng có thể dễ dàng chia sẻ những gì có trên thiết bị Apple của họ.

00:01:40.000 --> 00:01:44.000
Đối với video hôm nay, tôi sẽ tập trung vào khía cạnh phát trực tuyến âm thanh của AirPlay.

00:01:44.000 --> 00:01:49.000
AirPlay mang đến trải nghiệm phát trực tuyến âm thanh liền mạch cho một hoặc nhiều thiết bị.

00:01:49.000 --> 00:02:03.000
Có một hệ sinh thái đầy đủ các thiết bị hỗ trợ âm thanh AirPlay ngày nay, từ các thiết bị Apple như HomePod, Mac và Apple TV, đến các sản phẩm âm thanh và video từ các thương hiệu hàng đầu thế giới, bao gồm hàng trăm triệu TV thông minh.

00:02:03.000 --> 00:02:08.000
AirPlay rất tiện lợi, và cá nhân tôi thích sử dụng nó hàng ngày của mình.

00:02:08.000 --> 00:02:13.000
Khi AirPlay tiếp tục phát triển, kỳ vọng từ các nhà phát triển và khách hàng cũng vậy.

00:02:13.000 --> 00:02:23.000
Để đưa AirPlay lên một tầm cao mới, có một giao thức mới và được cải tiến, bộ đệm âm thanh nâng cao AirPlay, để mang lại trải nghiệm rạp hát tại nhà và đa kênh thậm chí còn tốt hơn.

00:02:23.000 --> 00:02:29.000
Bộ đệm âm thanh nâng cao được xây dựng từ đầu với toàn bộ âm thanh gia đình.

00:02:29.000 --> 00:02:31.000
Nó rất mạnh mẽ.

00:02:31.000 --> 00:02:37.000
Âm thanh truyền nhanh hơn tốc độ phát lại thời gian thực để giảm thiểu sự gián đoạn phát lại.

00:02:37.000 --> 00:02:45.000
Nó đáp ứng nhanh, vì vậy ứng dụng của bạn ngay lập tức phản hồi khi chạm vào HomePod hoặc khi sử dụng iPhone của bạn làm điều khiển từ xa.

00:02:45.000 --> 00:02:54.000
Nó hỗ trợ các định dạng âm thanh đa kênh, như Dolby ATMOS từ Apple TV và mới trong năm nay, sử dụng thông minh phát lại Lossless cho iOS.

00:02:54.000 --> 00:03:00.000
Bộ đệm âm thanh nâng cao cung cấp hỗ trợ tốt nhất cho HLS Interstitials để hỗ trợ quảng cáo.

00:03:00.000 --> 00:03:07.000
Bạn có thể tìm hiểu thêm về quảng cáo xen kẽ HLS từ video của đồng nghiệp Amit của tôi, "Khám phá AirPlay với quảng cáo xen kẽ."

00:03:07.000 --> 00:03:13.000
Như bạn có thể thấy, chúng tôi đã xây dựng một nền tảng tuyệt vời với bộ đệm âm thanh nâng cao cho tương lai.

00:03:13.000 --> 00:03:17.000
Tích hợp điều này sẽ tạo ra trải nghiệm AirPlay tuyệt vời với ứng dụng của bạn.

00:03:17.000 --> 00:03:21.000
Hãy xem bạn có thể hưởng lợi như thế nào từ bộ đệm âm thanh nâng cao.

00:03:21.000 --> 00:03:27.000
Tôi đang phát trực tuyến âm thanh từ điện thoại của mình đến HomePod.

00:03:27.000 --> 00:03:30.000
Hãy tưởng tượng tôi đang đổ rác, và bây giờ tôi đã ra khỏi phạm vi Wi-Fi của mình.

00:03:30.000 --> 00:03:32.000
♪ ♪

00:03:32.000 --> 00:03:35.000
Lưu ý HomePod tiếp tục phát.

00:03:35.000 --> 00:03:41.000
Khi tôi cố gắng kết nối lại với mạng, âm nhạc của tôi không bỏ qua một nhịp nào và điện thoại của tôi kết nối lại liền mạch với HomePod.

00:03:41.000 --> 00:03:43.000
♪ ♪

00:03:43.000 --> 00:03:46.000
Tôi có thể điều khiển phát lại từ điện thoại của mình một lần nữa.

00:03:46.000 --> 00:03:53.000
Đây là loại hiệu suất mà mọi người mong đợi khi sử dụng AirPlay để phát nhạc trên loa tương thích AirPlay như HomePod.

00:03:53.000 --> 00:03:59.000
Bây giờ với tất cả những điều tuyệt vời mà bộ đệm âm thanh nâng cao cung cấp, hãy kết hợp nó vào ứng dụng của bạn.

00:03:59.000 --> 00:04:04.000
Hãy xem lại cách thêm hỗ trợ AirPlay vào ứng dụng của bạn.

00:04:04.000 --> 00:04:11.000
Điều quan trọng là phải cấu hình phiên âm thanh đúng cách cho hành vi trộn và gián đoạn chính xác cho ứng dụng của bạn.

00:04:11.000 --> 00:04:16.000
Nếu phát phương tiện là trung tâm của ứng dụng của bạn, hãy đặt danh mục phiên âm thanh của bạn thành phát lại.

00:04:16.000 --> 00:04:22.000
Điều này sẽ đảm bảo phương tiện của ứng dụng của bạn sẽ tiếp tục phát khi ứng dụng ở chế độ nền.

00:04:22.000 --> 00:04:32.000
Nói chung, bạn có thể đặt chế độ thành mặc định, nhưng nó được khuyến nghị cho âm thanh nói, như podcast hoặc sách nói, để đặt chế độ thành Âm thanh nói.

00:04:32.000 --> 00:04:36.000
Cuối cùng, đặt chính sách định tuyến của phiên âm thanh thành longFormAudio.

00:04:36.000 --> 00:04:43.000
Âm thanh dạng dài là bất cứ thứ gì khác ngoài âm thanh hệ thống, chẳng hạn như âm nhạc hoặc podcast.

00:04:43.000 --> 00:04:47.000
Mới trong năm nay, chúng tôi đang làm cho AirPlay liền mạch hơn bao giờ hết.

00:04:47.000 --> 00:04:52.000
iPhone và iPad của bạn hiện sử dụng trí thông minh trên thiết bị để tìm hiểu các tùy chọn AirPlay của bạn.

00:04:52.000 --> 00:05:04.000
Vì vậy, bởi vì bạn thường nghe nhạc khi nấu bữa tối, HomePod gần đó trong nhà bếp sẽ tự động hiển thị, giúp mọi người dễ dàng phát nội dung ứng dụng của bạn ở nơi họ muốn.

00:05:04.000 --> 00:05:08.000
Nếu bạn cung cấp nội dung âm thanh dạng dài, thì bạn muốn hỗ trợ điều này.

00:05:08.000 --> 00:05:13.000
Và thật đơn giản để thêm hỗ trợ cho đề xuất AirPlay thông minh trong ứng dụng của bạn.

00:05:13.000 --> 00:05:26.000
Ngoài cấu hình AVAudioSession mà chúng ta đã thảo luận, bước mới duy nhất là vào Info Plist của ứng dụng của bạn, khóa AVInitialRouteSharingPolicy và đặt nó thành LongFormAudio.

00:05:26.000 --> 00:05:32.000
Trong Xcode, khóa này được gọi là "Chính sách tối ưu hóa AirPlay" trong trình đơn thả xuống.

00:05:32.000 --> 00:05:34.000
Và thế là xong.

00:05:34.000 --> 00:05:42.000
iOS sẽ xử lý phần còn lại và sử dụng học tập trên thiết bị để cung cấp cho mọi người một cách thông minh loa gần đó mà họ sử dụng khi mở ứng dụng của bạn.

00:05:42.000 --> 00:05:49.000
Tiếp theo, thêm AVRoutePickerView vào hệ thống phân cấp chế độ xem của bạn để bao gồm bộ chọn AirPlay trong ứng dụng của bạn.

00:05:49.000 --> 00:05:55.000
Bộ chọn cung cấp cho mọi người danh sách các thiết bị AirPlay tiềm năng mà họ có thể sử dụng với ứng dụng của bạn.

00:05:55.000 --> 00:06:08.000
Cuối cùng, sử dụng MPNowPlayingInfoCenter để thông báo cho hệ thống về mục phát hiện tại và MPRemoteCommandCenter để nhận các lệnh từ xa, như phát, tạm dừng hoặc bỏ qua.

00:06:08.000 --> 00:06:11.000
Điều đó bao gồm ứng dụng của bạn được thiết lập cho AirPlay.

00:06:11.000 --> 00:06:25.000
Bây giờ, để hỗ trợ bộ đệm âm thanh nâng cao, bạn sẽ cần áp dụng một trong hai bộ API này, AVPlayer và AVQueuePlayer hoặc AVSampleBufferAudioRenderer và AVSampleBufferRenderSynchronizer.

00:06:25.000 --> 00:06:31.000
Cả hai API sẽ hoạt động để phát lại không phải AirPlay, bao gồm cục bộ hoặc Bluetooth.

00:06:31.000 --> 00:06:38.000
Tuy nhiên, một số nhà phát triển có thể muốn các API khác nhau để phát lại AirPlay và không phải AirPlay.

00:06:38.000 --> 00:06:48.000
Trong trường hợp đó, ứng dụng của bạn có thể đăng ký routeChangeNotification và hành động phù hợp tùy thuộc vào tuyến đường hiện tại.

00:06:48.000 --> 00:06:55.000
AVPlayer và AVQueuePlayer cung cấp cách đơn giản nhất để hỗ trợ bộ đệm âm thanh nâng cao cho ứng dụng của bạn.

00:06:55.000 --> 00:07:01.000
Đối với đa số các nhà phát triển ứng dụng, chúng tôi khuyên bạn nên áp dụng AVQueuePlayer.

00:07:01.000 --> 00:07:10.000
AVQueuePlayer sẽ xử lý hầu hết những gì phát lại cần, chẳng hạn như quản lý các mục, kiểm soát phát lại và tìm kiếm thông qua phương tiện.

00:07:10.000 --> 00:07:14.000
Hầu hết các ứng dụng đa phương tiện của Apple cũng sử dụng AVQueuePlayer.

00:07:14.000 --> 00:07:18.000
Để bắt đầu, hãy tạo một trình phát hàng đợi.

00:07:18.000 --> 00:07:24.000
Xác định URL trỏ đến nội dung cục bộ hoặc đám mây mà bạn muốn phát.

00:07:24.000 --> 00:07:33.000
Sau đó tạo một phiên bản AVAsset với URL và tạo một phiên bản AVPlayerItem với tài sản đó.

00:07:33.000 --> 00:07:38.000
Cuối cùng, đưa AVPlayerItem cho người chơi và bắt đầu phát lại.

00:07:38.000 --> 00:07:41.000
Thật đơn giản.

00:07:41.000 --> 00:07:45.000
Bạn có thể đang nghĩ, "Nó chỉ xếp hàng một vật phẩm chơi vào người chơi.

00:07:45.000 --> 00:07:47.000
Phần AirPlay ở đâu?"

00:07:47.000 --> 00:07:48.000
Và điều đó đúng.

00:07:48.000 --> 00:07:55.000
Bằng cách sử dụng AVPlayer và AVQueuePlayer, bạn sẽ tự động nhận được bộ đệm âm thanh nâng cao khi nó được chuyển đến AirPlay.

00:07:55.000 --> 00:08:00.000
Để biết thêm các chức năng của AVPlayer, vui lòng tham khảo các liên kết trong phần mô tả.

00:08:00.000 --> 00:08:15.000
Nếu bạn có một ứng dụng duy nhất cần thực hiện tiền xử lý trên dữ liệu phương tiện hoặc có mô hình DRM mà AVPlayer không hỗ trợ, thì bạn có thể sử dụng AVSampleBufferAudioRenderer và AVSampleBufferRenderSynchronizer.

00:08:15.000 --> 00:08:21.000
Bạn sẽ sử dụng các API để đồng bộ hóa nhiều bộ đệm mẫu được xếp hàng đợi với một dòng thời gian duy nhất.

00:08:21.000 --> 00:08:26.000
Ở đây tôi sẽ xem xét những điều cơ bản về cách xếp hàng dữ liệu âm thanh với nó.

00:08:26.000 --> 00:08:31.000
Đầu tiên, bạn cần tạo một hàng đợi nối tiếp để thực hiện tất cả các thao tác phát lại.

00:08:31.000 --> 00:08:35.000
Tạo trình kết xuất âm thanh và trình đồng bộ hóa kết xuất.

00:08:35.000 --> 00:08:40.000
Bộ đồng bộ hóa được sử dụng để thiết lập dòng thời gian truyền thông.

00:08:40.000 --> 00:08:44.000
Sau đó, thêm trình kết xuất âm thanh vào trình đồng bộ hóa kết xuất.

00:08:44.000 --> 00:08:49.000
Điều này sẽ yêu cầu trình kết xuất âm thanh theo dòng thời gian phương tiện.

00:08:49.000 --> 00:08:55.000
Để xếp hàng dữ liệu âm thanh, hãy cài đặt một cuộc gọi lại sẽ cho bạn biết bạn cần thêm dữ liệu.

00:08:55.000 --> 00:09:00.000
Bắt đầu xếp hàng dữ liệu âm thanh trong cuộc gọi lại đó.

00:09:00.000 --> 00:09:05.000
Và khi không còn dữ liệu âm thanh nữa, hãy yêu cầu trình kết xuất ngừng yêu cầu dữ liệu.

00:09:05.000 --> 00:09:07.000
Đây chỉ là những điều cơ bản của giao diện.

00:09:07.000 --> 00:09:18.000
Để biết thêm chi tiết, vui lòng tham khảo tài liệu được liên kết trong phần mô tả, nơi chúng tôi mô tả chuyên sâu về cách sử dụng API này, cùng với một dự án mẫu để xây dựng trình phát tùy chỉnh.

00:09:18.000 --> 00:09:24.000
Điều đó bao gồm hai API mà bạn có thể sử dụng để tận dụng bộ đệm âm thanh nâng cao cho các thiết bị tương thích AirPlay.

00:09:24.000 --> 00:09:26.000
Và đó không phải là tất cả.

00:09:26.000 --> 00:09:32.000
Các nhà sản xuất ô tô hiện có thể hỗ trợ bộ đệm nâng cao trong việc triển khai CarPlay của họ.

00:09:32.000 --> 00:09:34.000
Tại sao điều này lại quan trọng?

00:09:34.000 --> 00:09:37.000
Ngày càng có nhiều phương tiện hỗ trợ CarPlay không dây.

00:09:37.000 --> 00:09:43.000
Phát lại mạnh mẽ và điều khiển đáp ứng là rất quan trọng để có trải nghiệm âm thanh tốt nhất trên đường.

00:09:43.000 --> 00:09:53.000
Tin tốt là, bằng cách thêm bộ đệm âm thanh nâng cao vào ứng dụng của bạn với một trong hai API mà chúng ta đã nói trước đây, nó cũng sẽ hoạt động cho CarPlay.

00:09:53.000 --> 00:09:59.000
Những người sử dụng ứng dụng của bạn sẽ có trải nghiệm phát trực tuyến âm thanh tốt nhất ở bất cứ nơi nào hành trình của họ đưa họ đến.

00:09:59.000 --> 00:10:17.000
Tóm lại, bạn sẽ cần định cấu hình phiên âm thanh để hỗ trợ AirPlay, thêm bộ chọn AirPlay vào ứng dụng của mình, tích hợp Trình phát đa phương tiện vào ứng dụng của bạn và áp dụng AVQueuePlayer hoặc API kết xuất và đồng bộ hóa tùy chỉnh để tăng cường bộ đệm âm thanh.

00:10:17.000 --> 00:10:18.000
Đây mới chỉ là sự khởi đầu.

00:10:18.000 --> 00:10:23.000
Chúng tôi liên tục cải tiến và làm việc để mang lại nhiều tính năng hơn cho công nghệ này.

00:10:23.000 --> 00:10:25.000
Hy vọng bạn thích buổi học. Cảm ơn bạn.

00:10:25.000 --> 23:59:59.000
♪ ♪

