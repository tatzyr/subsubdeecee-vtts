WEBVTT

00:00:00.000 --> 00:00:10.000
♪ ♪

00:00:10.000 --> 00:00:16.000
Rasmus: Xin chào, tôi là Rasmus. Tôi là một kỹ sư trong nhóm Thuật toán Máy ảnh làm việc với Video Tính toán.

00:00:16.000 --> 00:00:18.000
Tôi đã hào hứng với chế độ Điện ảnh.

00:00:18.000 --> 00:00:29.000
Và bây giờ tôi thậm chí còn hào hứng hơn khi chỉ ra cách bạn có thể tích hợp sự kỳ diệu của chế độ Điện ảnh trong ứng dụng của riêng bạn bằng cách sử dụng API Điện ảnh mới.

00:00:29.000 --> 00:00:41.000
Trong bài thuyết trình này, tôi sẽ hướng dẫn các bước cần thiết bằng cách sử dụng API mới để xây dựng một ứng dụng mẫu phát lại và chỉnh sửa, nhận ra khả năng tuyệt vời của chế độ Điện ảnh.

00:00:41.000 --> 00:00:51.000
Nhưng trước khi tôi bắt đầu nói về tích hợp, trước tiên hãy để tôi chỉ cho bạn chế độ Điện ảnh là gì, cách bạn có thể chụp nó và bạn có thể làm gì với nó sau khi chụp.

00:00:51.000 --> 00:00:57.000
Chúng tôi đã giới thiệu chế độ Điện ảnh trong iPhone 13, và nó thực sự là một đoàn làm phim nhỏ ngay trong túi của bạn.

00:00:57.000 --> 00:01:16.000
Nó mang đến cho bạn một chiếc máy ảnh với độ sâu trường ảnh nông tuyệt đẹp và độ rơi lấy nét tự nhiên, một đạo diễn, người chỉ đạo sự chú ý và tường thuật bằng cách thay đổi tiêu điểm và một bộ kéo lấy nét, người dự đoán các khung hình chính trước thời hạn và tạo ra sự chuyển tiếp mượt mà giữa các điểm lấy nét.

00:01:16.000 --> 00:01:17.000
Vậy làm thế nào để bạn chụp chế độ Điện ảnh?

00:01:17.000 --> 00:01:27.000
Nó được chụp ngay trong ứng dụng Camera trên bất kỳ thiết bị nào trong dòng sản phẩm iPhone 13 &amp; 14 và nó cung cấp cho bạn bản xem trước kết xuất khi bạn ghi lại.

00:01:27.000 --> 00:01:36.000
Điều này làm cho nó trở nên siêu dễ tiếp cận, cho dù bạn là một nhà làm phim độc lập đầy tham vọng hay chỉ muốn thêm một điểm nhấn kỳ diệu vào các video chuyến đi cắm trại của bạn.

00:01:36.000 --> 00:01:42.000
Và trong khi tôi mơ ước trở thành một nhà làm phim, tôi thích chụp chế độ Điện ảnh của chính gia đình mình.

00:01:42.000 --> 00:01:44.000
Nhưng điều kỳ diệu không dừng lại ở đây.

00:01:44.000 --> 00:01:47.000
Chế độ Điện ảnh có nhiều thứ hơn là bắt mắt.

00:01:47.000 --> 00:01:52.000
Nó cho phép bạn thực hiện một số chỉnh sửa không phá hủy khá tuyệt vời sau khi chụp.

00:01:52.000 --> 00:01:56.000
Bạn có thể thay đổi khẩu độ, và do đó lượng hiệu quả.

00:01:56.000 --> 00:02:01.000
Và bạn có thể chuyển hướng tiêu điểm và tường thuật bằng cách sử dụng các phát hiện thay thế.

00:02:01.000 --> 00:02:10.000
Điều này cho thấy chỉnh sửa sau chụp trong Ảnh, nhưng chỉnh sửa cũng có thể được thực hiện trong các ứng dụng như iMovie, Final Cut Pro và Motion.

00:02:10.000 --> 00:02:20.000
Và bây giờ với sự ra đời của Cinematic API, bạn có thể sử dụng video chế độ Điện ảnh để phát lại và chỉnh sửa trong ứng dụng tuyệt vời của riêng bạn.

00:02:20.000 --> 00:02:29.000
Cinematic API có sẵn rộng rãi trên macOS Sonoma mới, iOS 17, iPadOS 17 và tvOS 17.

00:02:29.000 --> 00:02:31.000
Vì vậy, điều này thực sự thú vị.

00:02:31.000 --> 00:02:37.000
Đầu tiên tôi sẽ bắt đầu với một số nguyên tắc cơ bản về tài sản chế độ Điện ảnh đặc biệt và luồng dữ liệu.

00:02:37.000 --> 00:02:46.000
Sau đó, tôi sẽ thực hiện các bước cụ thể để tải và phát nội dung chế độ Điện ảnh với các điều chỉnh phát lại đơn giản, như thay đổi khẩu độ.

00:02:46.000 --> 00:02:56.000
Và sau đó làm thế nào để thực hiện các chỉnh sửa không phá hủy thúc đẩy tiêu điểm ở chế độ Điện ảnh và cách lưu và tải các thay đổi chỉnh sửa này.

00:02:56.000 --> 00:03:04.000
Tôi sẽ xem xét một số cuộc gọi API Điện ảnh mới và cũng cung cấp một ứng dụng mã mẫu có thể được sử dụng làm tài liệu tham khảo chi tiết.

00:03:04.000 --> 00:03:09.000
Nhưng như đã hứa, hãy để tôi bắt đầu bằng cách giải thích một số nguyên tắc cơ bản về chế độ Điện ảnh.

00:03:09.000 --> 00:03:15.000
Chế độ điện ảnh thực sự bao gồm hai tệp và một luồng dữ liệu từ tệp này sang tệp khác.

00:03:15.000 --> 00:03:17.000
Đầu tiên là tài sản được kết xuất.

00:03:17.000 --> 00:03:26.000
Đây là một tệp nướng với hiệu ứng chế độ Điện ảnh được áp dụng và nó có thể được xuất, chia sẻ và phát như một bộ phim QuickTime thông thường.

00:03:26.000 --> 00:03:33.000
Và sau đó là nội dung chế độ Điện ảnh đặc biệt, có tất cả thông tin cần thiết để tạo nội dung được hiển thị.

00:03:33.000 --> 00:03:40.000
Nó cho phép bạn thực hiện các chỉnh sửa sau chụp không phá hủy, chẳng hạn như thay đổi khẩu độ và lấy nét lại theo câu chuyện của bạn.

00:03:40.000 --> 00:03:48.000
Hãy bắt đầu bằng cách xem xét nội dung được kết xuất và chia nhỏ một cảnh quay với một chút Cinematography 101.

00:03:48.000 --> 00:03:59.000
Cú đánh mở đầu: chúng tôi bước vào những gì rõ ràng là một trò chơi bóng ném đường phố quan trọng, và bằng cách tập trung vào chủ đề chính, chúng tôi thực sự cảm thấy căng thẳng khi anh ấy sẵn sàng thực hiện một vở kịch lớn.

00:03:59.000 --> 00:04:02.000
Anh ấy kiểm tra cầu thủ đồng đội của mình. Anh ấy cũng đã sẵn sàng.

00:04:02.000 --> 00:04:06.000
Tập trung vào anh ấy nhấn mạnh anh ấy đã sẵn sàng như thế nào.

00:04:06.000 --> 00:04:09.000
Chúng tôi tập trung trở lại chủ đề chính của mình.

00:04:09.000 --> 00:04:14.000
Đây là nó; bạn có thể cắt qua sự căng thẳng bằng một con dao.

00:04:14.000 --> 00:04:19.000
Anh ấy thực hiện vở kịch và hoàn toàn làm hỏng nó, thiết lập một số cứu trợ truyện tranh.

00:04:19.000 --> 00:04:28.000
Bây giờ hãy thay đổi câu chuyện về người chơi trong đội bằng cách tập trung vào anh ta sớm trong cú đánh, và thay vì qua lại, chúng tôi giữ anh ta tập trung.

00:04:28.000 --> 00:04:29.000
Tôi sẽ là tiếng nói trong suy nghĩ của anh ấy.

00:04:29.000 --> 00:04:33.000
Anh yêu em, anh bạn, nhưng em luôn mất mãi mãi.

00:04:33.000 --> 00:04:38.000
"Vâng, tôi đã sẵn sàng, nhưng tôi có kỳ vọng thấp.

00:04:38.000 --> 00:04:47.000
"Thật lãng phí thời gian. Bravo." Vì vậy, điều này được quay trên iPhone 13, giới thiệu các công cụ quay phim để kể chuyện được cung cấp bởi chế độ Điện ảnh.

00:04:47.000 --> 00:04:51.000
Và để tạo ra tài sản được kết xuất này, có tài sản chế độ Điện ảnh đặc biệt.

00:04:51.000 --> 00:04:58.000
Để hỗ trợ các chỉnh sửa sau khi chụp không phá hủy, một nội dung chế độ Điện ảnh thực sự có nhiều bản nhạc.

00:04:58.000 --> 00:05:03.000
Đầu tiên là đoạn video, đó là bộ phim QuickTime gốc được quay.

00:05:03.000 --> 00:05:14.000
Nó có thể là HDR/SDR, 1080p ở tốc độ 30 khung hình mỗi giây và trên iPhone 14, thậm chí 4K ở tốc độ 24, 25 và 30 khung hình mỗi giây.

00:05:14.000 --> 00:05:21.000
Bản nhạc này có thể được phát như một video thông thường, nhưng nó thiếu tính thẩm mỹ và cách kể chuyện so với nội dung được kết xuất.

00:05:21.000 --> 00:05:28.000
Không có hồi hộp và không có sự nhẹ nhõm hài hước, và chúng tôi chỉ đang xem một số người chơi một trò chơi ở con hẻm phía sau.

00:05:28.000 --> 00:05:35.000
Bản nhạc thứ hai chứa sự chênh lệch, đó là sự dịch chuyển điểm ảnh nhìn thấy từ hai máy ảnh nhìn vào cùng một cảnh.

00:05:35.000 --> 00:05:38.000
Các đối tượng gần bị dịch chuyển nhiều hơn các đối tượng ở xa hơn.

00:05:38.000 --> 00:05:45.000
Bạn có thể tự kiểm tra điều này bằng cách nhắm một mắt và sau đó là mắt kia, và xem các vật thể dịch chuyển như thế nào ở các khoảng cách khác nhau.

00:05:45.000 --> 00:05:50.000
Chênh lệch được sử dụng để lấy nét và hiển thị độ sâu trường ảnh nông.

00:05:50.000 --> 00:05:55.000
Bản đồ chênh lệch ở độ phân giải thấp hơn bản nhạc video.

00:05:55.000 --> 00:06:13.000
Bản nhạc, được hiển thị dưới dạng màu sắc, chứa sự chênh lệch tương đối và không tuyệt đối, có nghĩa là nó chỉ có thể được sử dụng so với các mẫu khác trong cùng một bản đồ, chẳng hạn như kết xuất liên quan đến chênh lệch tiêu điểm hoặc chuyển đổi giữa hai chênh lệch tiêu điểm.

00:06:13.000 --> 00:06:22.000
Để có thông tin chi tiết về sự chênh lệch tương đối và cách chơi chữ chiều sâu tuyệt vời, tôi thực sự khuyên bạn nên sử dụng WWDC17, "Nắm bắt chiều sâu trong chụp ảnh iPhone".

00:06:22.000 --> 00:06:27.000
Bản nhạc thứ ba chứa siêu dữ liệu quan trọng để kết xuất và chỉnh sửa.

00:06:27.000 --> 00:06:29.000
Bản nhạc bao gồm hai thứ.

00:06:29.000 --> 00:06:36.000
Đầu tiên, các thuộc tính kết xuất, giữ chênh lệch tiêu điểm và khẩu độ dưới dạng số f.

00:06:36.000 --> 00:06:38.000
Những thứ này thúc đẩy kết xuất.

00:06:38.000 --> 00:06:46.000
Tiêu điểm, được hiển thị dưới dạng lớp phủ, được quyết định bởi công cụ Điện ảnh, trong khi khẩu độ được người dùng chọn.

00:06:46.000 --> 00:06:52.000
Và sau đó là kịch bản Điện ảnh, chứa tất cả các phát hiện cảnh tự động.

00:06:52.000 --> 00:07:02.000
Cảnh này cho thấy khuôn mặt, đầu và thân, được nhóm lại bằng một ID liên kết chúng lại với nhau theo thời gian khi có thể.

00:07:02.000 --> 00:07:08.000
Kịch bản cũng giữ các quyết định tập trung, quyết định phát hiện nào để giữ trọng tâm.

00:07:08.000 --> 00:07:16.000
Các quyết định trọng tâm có thể được thay đổi sau khi chụp để theo dõi các phát hiện khác và do đó thay đổi tường thuật và kết xuất.

00:07:16.000 --> 00:07:21.000
Đây là luồng dữ liệu từ nội dung chế độ Điện ảnh sang nội dung được hiển thị.

00:07:21.000 --> 00:07:30.000
Như vừa được đề cập, nội dung chế độ Điện ảnh chứa tất cả thông tin cần thiết để kết xuất và thay đổi tiêu điểm và khẩu độ sau chụp.

00:07:30.000 --> 00:07:37.000
Sau đây là chỉnh sửa tùy chọn, trong đó các thay đổi không phá hủy và luôn có thể được hoàn nguyên về bản gốc.

00:07:37.000 --> 00:07:49.000
Nếu không chỉnh sửa xong, công cụ Điện ảnh sẽ tự động điều khiển chênh lệch tiêu điểm và khẩu độ do người dùng đặt tại thời điểm chụp vẫn không thay đổi.

00:07:49.000 --> 00:07:58.000
Với sự chênh lệch lấy nét và khẩu độ, kết xuất áp dụng độ sâu trường ảnh nông với độ rơi lấy nét chính xác bằng cách sử dụng bản đồ chênh lệch.

00:07:58.000 --> 00:08:05.000
Và cuối cùng, chúng tôi nhận được nội dung được hiển thị với hiệu ứng được áp dụng, đây là một bộ phim QuickTime thông thường, có thể chia sẻ.

00:08:05.000 --> 00:08:10.000
Với sự hiểu biết tốt hơn về chế độ Điện ảnh, đã đến lúc bắt đầu xây dựng ứng dụng phát lại.

00:08:10.000 --> 00:08:16.000
Nhưng trước tiên chúng ta cần nắm giữ một tài sản chế độ Điện ảnh, vì vậy hãy xem mã để có được nó.

00:08:16.000 --> 00:08:21.000
Khá dễ dàng để chọn một nội dung chế độ Điện ảnh từ thư viện Ảnh.

00:08:21.000 --> 00:08:25.000
Chỉ cần sử dụng bộ chọn Ảnh và bộ lọc cho các video Điện ảnh.

00:08:25.000 --> 00:08:29.000
Bộ chọn sẽ nhận được mã định danh cục bộ cho tệp đã chọn.

00:08:29.000 --> 00:08:43.000
Như một lưu ý phụ không liên quan đến mã, nếu bạn chưa có nội dung chế độ Điện ảnh, nó có thể được AirDropped giữa các thiết bị người dùng khác nhau với tùy chọn Tất cả Dữ liệu Ảnh để bao gồm cả nội dung được hiển thị và nội dung chế độ Điện ảnh.

00:08:43.000 --> 00:08:45.000
Hãy quay lại với mã hóa.

00:08:45.000 --> 00:08:55.000
Sử dụng mã định danh tài sản từ lựa chọn, bây giờ tôi có thể tìm nạp nội dung ảnh với thông tin về nội dung chế độ Điện ảnh trước khi tôi yêu cầu.

00:08:55.000 --> 00:09:09.000
Tôi cần đảm bảo đặt các tùy chọn yêu cầu để có được phiên bản gốc và cho phép truy cập mạng trong trường hợp nội dung nằm trên iCloud, và cuối cùng yêu cầu nội dung chế độ Điện ảnh dưới dạng AVAsset.

00:09:09.000 --> 00:09:10.000
Và bây giờ đến phần thú vị.

00:09:10.000 --> 00:09:12.000
Chúng tôi đã nhận được tài sản chế độ Điện ảnh.

00:09:12.000 --> 00:09:14.000
Hãy tích hợp phát lại.

00:09:14.000 --> 00:09:24.000
Một nội dung được hiển thị có thể được phát lại bằng cách sử dụng AVPlayer và AVPlayerItem như một bộ phim thông thường, và bộ phim cũng có thể theo dõi bên trong nội dung chế độ Điện ảnh.

00:09:24.000 --> 00:09:38.000
Nhưng để nhận ra tiềm năng của nội dung chế độ Điện ảnh, chúng ta cần thêm một bộ tổng hợp video tùy chỉnh, có thể xử lý nhiều bản nhạc, thay đổi người dùng và cuối cùng, gọi trình kết xuất Điện ảnh để soạn đầu ra.

00:09:38.000 --> 00:09:49.000
Bộ tổng hợp tùy chỉnh này cũng có thể được sử dụng cho hình thu nhỏ và xuất ngoại tuyến, nhưng hãy tập trung vào việc sử dụng nó để phát lại và chỉnh sửa nội dung chế độ Điện ảnh.

00:09:49.000 --> 00:10:05.000
Tôi sẽ chỉ đi vào chi tiết cụ thể cho API Điện ảnh, vì vậy để biết thêm thông tin chi tiết về các lớp tổng hợp video tùy chỉnh và HDR, tôi khuyên bạn nên WWDC20, "Chỉnh sửa và phát lại video HDR với AVFoundation."

00:10:05.000 --> 00:10:08.000
Hãy bắt đầu sử dụng Cinematic API.

00:10:08.000 --> 00:10:20.000
Cinematic API sử dụng tiền tố CN, vì vậy bạn có thể phát hiện ra ba lệnh gọi API cần thiết để thiết lập phiên kết xuất sẽ hiển thị độ sâu trường ảnh nông.

00:10:20.000 --> 00:10:24.000
Cuộc gọi đầu tiên nhận được các thuộc tính kết xuất từ tài sản Điện ảnh.

00:10:24.000 --> 00:10:28.000
Phiên thứ hai thiết lập một phiên kết xuất với các thuộc tính này.

00:10:28.000 --> 00:10:34.000
Phiên kết xuất sử dụng GPU, vì vậy tôi cần cung cấp một hàng đợi lệnh kim loại.

00:10:34.000 --> 00:10:38.000
Và cuộc gọi cuối cùng đặt chất lượng kết xuất để xuất.

00:10:38.000 --> 00:10:44.000
Chất lượng có thể được đặt thành các liệt kê khác nhau như xem trước và xuất tùy thuộc vào hiệu suất và các hạn chế về chất lượng của bạn.

00:10:44.000 --> 00:10:53.000
Trong những đoạn mã này và sau đây, tôi đã loại bỏ các kiểm tra lỗi thực hành tốt, như bảo vệ để lỗi khác, chỉ để tập trung vào mã cốt lõi.

00:10:53.000 --> 00:11:01.000
Bộ tổng hợp tùy chỉnh cần một bố cục, bao gồm thông tin nội dung Điện ảnh cần thiết để hiển thị đầu ra.

00:11:01.000 --> 00:11:10.000
Trong một trường hợp điển hình, bạn sẽ cần nhiều bước để thêm nhiều bản nhạc, nhưng may mắn thay, chúng tôi cung cấp một cách dễ dàng để làm điều này chỉ trong một bước.

00:11:10.000 --> 00:11:16.000
Bạn có thể thêm trực tiếp tất cả các bản nhạc, từ thông tin nội dung vào bố cục.

00:11:16.000 --> 00:11:23.000
Thông tin bố cục Điện ảnh cũng giống như thông tin nội dung Điện ảnh, nhưng chỉ ra các bản nhạc sáng tác.

00:11:23.000 --> 00:11:27.000
Sau đó tôi nhận được kịch bản Điện ảnh từ tài sản Điện ảnh.

00:11:27.000 --> 00:11:32.000
Kịch bản Điện ảnh chứa tất cả các phát hiện và quyết định tập trung.

00:11:32.000 --> 00:11:35.000
Và tôi sẽ đi vào chi tiết hơn về điều này sau.

00:11:35.000 --> 00:11:45.000
Đối với bộ tổng hợp tùy chỉnh, tôi đã thiết lập hướng dẫn với phiên kết xuất, bố cục với các bản nhạc nội dung, tập lệnh Điện ảnh và khẩu độ dưới dạng số f.

00:11:45.000 --> 00:11:51.000
Hướng dẫn tùy chỉnh này mô tả cách soạn nội dung Điện ảnh được kết xuất.

00:11:51.000 --> 00:12:06.000
Để phát video, tôi sẽ cần một bố cục video, mà tôi sẽ thêm ID bản nhạc từ bố cục Điện ảnh, thêm một bộ tổng hợp tùy chỉnh mẫu, đó là nơi trình kết xuất được gọi để soạn hiệu ứng và thêm hướng dẫn sáng tác.

00:12:06.000 --> 00:12:10.000
Chúng ta hãy xem xét kỹ hơn những gì diễn ra trong bộ tổng hợp tùy chỉnh.

00:12:10.000 --> 00:12:17.000
Có một vài điều quan trọng cụ thể đối với API Điện ảnh bên trong chức năng startRequest trong trình tổng hợp tùy chỉnh.

00:12:17.000 --> 00:12:34.000
Sử dụng ID bản nhạc từ bố cục Điện ảnh, tôi nhận được bộ đệm nguồn cho khung hình hiện tại từ bản nhạc video gốc, bản nhạc chênh lệch, bản nhạc siêu dữ liệu và cuối cùng tôi tạo bộ đệm cho đầu ra được hiển thị.

00:12:34.000 --> 00:12:38.000
Những bộ đệm này cho phép chúng tôi thực hiện các chỉnh sửa và kết xuất mới.

00:12:38.000 --> 00:12:44.000
Từ bộ đệm siêu dữ liệu, tôi có thể lấy các thuộc tính khung kết xuất, điều khiển kết xuất.

00:12:44.000 --> 00:12:52.000
Siêu dữ liệu là một cấu trúc mờ đục, vì vậy tôi sẽ sử dụng CNRenderingSession và lấy các thuộc tính khung trực tiếp.

00:12:52.000 --> 00:13:04.000
Với các thuộc tính khung hình, bây giờ tôi có thể thực hiện các thay đổi phát lại tùy chọn, trong trường hợp này bằng cách thay đổi số f khẩu độ theo hướng dẫn, giữ các thay đổi khẩu độ từ phần tử giao diện người dùng.

00:13:04.000 --> 00:13:11.000
Sự chênh lệch tiêu điểm có thể được thay đổi theo cách tương tự, nhưng tôi sẽ quay lại thực hiện các thay đổi theo hướng cảnh bằng cách sử dụng các phát hiện sau.

00:13:11.000 --> 00:13:15.000
Tại thời điểm này, chúng tôi thực sự, thực sự gần đạt được khả năng phát lại.

00:13:15.000 --> 00:13:23.000
Tôi chỉ cần lấy một bộ đệm lệnh trên hàng đợi lệnh kết xuất, sao cho đầu ra đã soạn có thể được hiển thị trên GPU.

00:13:23.000 --> 00:13:30.000
Mã hóa kết xuất bằng cách sử dụng các thuộc tính khung được cập nhật và bộ đệm hình ảnh và chênh lệch.

00:13:30.000 --> 00:13:36.000
Thêm trình xử lý hoàn thành cho bộ đệm đầu ra, bộ đệm này sẽ được chuyển đến bố cục video.

00:13:36.000 --> 00:13:38.000
Và cuối cùng cam kết bộ đệm lệnh.

00:13:38.000 --> 00:13:42.000
Bây giờ hãy thử phát lại trong ứng dụng mẫu.

00:13:42.000 --> 00:13:47.000
Bây giờ tôi có thể chọn một nội dung chế độ Điện ảnh từ thư viện Ảnh.

00:13:47.000 --> 00:13:53.000
Và khi tôi phát lại tài sản, hiệu ứng được áp dụng trong thời gian thực.

00:13:53.000 --> 00:14:04.000
Tôi có thể chà qua lại và thay đổi khẩu độ, điều này làm thay đổi lượng hiệu quả.

00:14:04.000 --> 00:14:09.000
Dừng lại sẽ giảm thiểu hiệu quả.

00:14:09.000 --> 00:14:11.000
Mở ra làm tăng nó.

00:14:11.000 --> 00:14:15.000
Có lẽ điều này là quá nhiều.

00:14:15.000 --> 00:14:17.000
Tôi nghĩ cái này có vẻ ổn.

00:14:17.000 --> 00:14:22.000
Ứng dụng đã khá tuyệt, nhưng nó sẽ trở nên tuyệt vời hơn trong phần chỉnh sửa sắp tới.

00:14:22.000 --> 00:14:27.000
Và để nhắc nhở bạn, như một tài liệu tham khảo, mã cho từng phần có sẵn trong ứng dụng mẫu.

00:14:27.000 --> 00:14:38.000
Bây giờ tôi sẽ chuyển sang mở rộng ứng dụng phát lại và trình tổng hợp video tùy chỉnh để thực hiện các chỉnh sửa nâng cao và không phá hủy hơn bằng cách thay đổi tập lệnh Điện ảnh và do đó tập trung.

00:14:38.000 --> 00:14:53.000
Nhưng hãy xem lại môi trường chỉnh sửa ứng dụng Ảnh cho chế độ Điện ảnh và xem xét cụ thể tiêu điểm, được tự động điều khiển trong quá trình chụp bằng cách phát hiện các đối tượng và quyết định lấy nét ở đâu và ở đâu.

00:14:53.000 --> 00:15:00.000
Những phát hiện và quyết định này đều nằm trong kịch bản Điện ảnh và kịch bản có thể được thay đổi thành câu chuyện của bạn.

00:15:00.000 --> 00:15:09.000
Phát hiện tiêu điểm được hiển thị dưới dạng hình vuông màu vàng và bên dưới dòng thời gian, chúng tôi có các khung hình chính và thay đổi quyết định lấy nét.

00:15:09.000 --> 00:15:15.000
Để hiểu rõ hơn về cách thức hoạt động của nó, hãy chia nhỏ cấu trúc kịch bản Điện ảnh bằng một ví dụ đơn giản.

00:15:15.000 --> 00:15:20.000
Hãy bắt đầu với chỉ hai khung kịch bản Điện ảnh trong một chuỗi ngắn.

00:15:20.000 --> 00:15:26.000
Mỗi người giữ tất cả các phát hiện trong một thời điểm nhất định và trong trường hợp này chỉ có hai phát hiện.

00:15:26.000 --> 00:15:34.000
Các phát hiện được theo dõi theo thời gian với ID nhóm, nhóm khuôn mặt, đầu và thân với nhau.

00:15:34.000 --> 00:15:43.000
Ngoài ra, mèo, chó và bóng được phát hiện và theo dõi, nhưng ở đây chúng ta chỉ có khuôn mặt của Diễn viên 1 và Diễn viên 2.

00:15:43.000 --> 00:15:52.000
Một quyết định cơ bản tự động tập trung vào Diễn viên 1 trong khung hình đầu tiên và tiêu điểm sẽ theo dõi theo dõi này cho đến khi có quyết định mới.

00:15:52.000 --> 00:16:01.000
Ngay cả sau khi Diễn viên 3 bước vào hiện trường và giới thiệu một khuôn mặt mới và bản nhạc phát hiện, trọng tâm vẫn tập trung vào Diễn viên 1.

00:16:01.000 --> 00:16:09.000
Trong khung 5, một sự kiện khung hình chính tự động thay đổi quyết định và trọng tâm thành Diễn viên 2.

00:16:09.000 --> 00:16:16.000
Và chỉ sau bốn khung hình, Diễn viên 3 thực hiện một lối thoát chán nản mà không bao giờ nhận được sự chú ý tập trung mà cô ấy xứng đáng.

00:16:16.000 --> 00:16:21.000
Trọng tâm vẫn tập trung vào Diễn viên 2 trong phần còn lại của chuỗi.

00:16:21.000 --> 00:16:32.000
Những quyết định cơ bản tự động này được quyết định dựa trên một loạt các thông số như ai đối mặt với máy ảnh, ai nhìn đi chỗ khác, ai ở gần hơn và điều gì thú vị.

00:16:32.000 --> 00:16:36.000
Và trong khi chúng tôi cố gắng hết sức để tạo ra một câu chuyện hay, bạn có thể có một câu chuyện khác.

00:16:36.000 --> 00:16:39.000
May mắn thay, các quyết định có thể được thay đổi, và thực sự theo hai cách.

00:16:39.000 --> 00:16:44.000
Đầu tiên là thêm một quyết định yếu kém của người dùng.

00:16:44.000 --> 00:16:48.000
Điều này khiến Diễn viên 3 trở nên tập trung khi cô ấy bước vào hiện trường.

00:16:48.000 --> 00:17:01.000
Tuy nhiên, một quyết định yếu chỉ theo dõi cho đến khi cơ sở hoặc quyết định người dùng tiếp theo, xảy ra trong khung 5, trong đó quyết định cơ sở thay đổi tiêu điểm thành Diễn viên 2 cho các khung còn lại.

00:17:01.000 --> 00:17:09.000
Vì vậy, nếu chúng tôi muốn tập trung vào Diễn viên 3, chúng tôi có thể thêm một quyết định yếu khác vào khung 5 hoặc chúng tôi có thể sử dụng thứ gì đó mạnh hơn.

00:17:09.000 --> 00:17:13.000
Vâng, bạn có thể đã đoán được nó, một quyết định mạnh mẽ của người dùng.

00:17:13.000 --> 00:17:22.000
Một quyết định mạnh mẽ sẽ tiếp tục tập trung vào một chủ đề cho đến khi người dùng tiếp theo quyết định tập trung vào nơi khác hoặc kết thúc quá trình phát hiện.

00:17:22.000 --> 00:17:28.000
Thêm một quyết định mạnh mẽ đưa Diễn viên 3 vào trọng tâm và ghi đè lên quyết định cơ bản sau đây.

00:17:28.000 --> 00:17:38.000
Sau khi bản nhạc phát hiện của Diễn viên 3 kết thúc, trọng tâm quay trở lại quyết định cơ bản, đó là tập trung vào Diễn viên 2.

00:17:38.000 --> 00:17:49.000
Hệ thống phân cấp quyết định hoạt động như sau: quyết định của người dùng trên các quyết định cơ bản, quyết định của người dùng áp dụng khi có thể, các quyết định cơ bản lấp đầy khoảng trống.

00:17:49.000 --> 00:17:54.000
Vì vậy, như được thực hiện trong ví dụ này, người dùng chỉ có thể thay đổi các phần của tập lệnh.

00:17:54.000 --> 00:18:04.000
Và trong khi cả hai quyết định đều trở lại quyết định cơ bản khi bản nhạc phát hiện kết thúc, một quyết định mạnh mẽ giữ cho đường tập trung của nó càng lâu càng tốt.

00:18:04.000 --> 00:18:09.000
Trước khi di chuyển để thay đổi tập lệnh, hãy lấy một khung tập lệnh và vẽ các hộp phát hiện.

00:18:09.000 --> 00:18:20.000
Đầu tiên tôi cần lấy thời gian khung hình từ yêu cầu sáng tác video, và sau đó lấy khung kịch bản Điện ảnh cho thời điểm hiện tại đó.

00:18:20.000 --> 00:18:24.000
Khung tập lệnh này chứa tất cả các phát hiện, bao gồm cả phát hiện tiêu điểm.

00:18:24.000 --> 00:18:28.000
Bây giờ thật dễ dàng để vẽ các hộp phát hiện.

00:18:28.000 --> 00:18:39.000
Bằng cách lặp lại tất cả các phát hiện trong một tập lệnh, tôi có thể lấy từng hình chữ nhật phát hiện và vẽ nó thành một kết cấu được đính kèm với renderEncoder bằng lệnh vẽ.

00:18:39.000 --> 00:18:42.000
Trong ví dụ này, các phát hiện được vẽ bằng màu trắng.

00:18:42.000 --> 00:18:48.000
Và để nhấn mạnh những gì hiện đang là focusDetection, hãy vẽ nó bằng một màu khác.

00:18:48.000 --> 00:19:01.000
Tôi nhận được phát hiện lấy nét trực tiếp từ khung kịch bản Điện ảnh, lấy hình chữ nhật tương ứng của nó và để làm cho nó nổi bật, tôi vẽ hình chữ nhật lấy nét bằng màu vàng.

00:19:01.000 --> 00:19:04.000
Hãy thử ứng dụng phát lại với lớp phủ phát hiện được thêm vào.

00:19:04.000 --> 00:19:10.000
Bây giờ tôi có thể bật lớp phủ phát hiện mới để vẽ các phát hiện.

00:19:10.000 --> 00:19:17.000
Cảnh này cho thấy khuôn mặt, đầu và thân màu trắng và phát hiện tiêu điểm màu vàng.

00:19:17.000 --> 00:19:24.000
Bạn có thể tùy chỉnh lớp phủ để chỉ hiển thị một tập hợp con phát hiện cụ thể nếu điều đó có ý nghĩa đối với ứng dụng của bạn.

00:19:24.000 --> 00:19:34.000
Khi tôi bắt đầu phát lại, hãy chú ý cách tiêu điểm và kết xuất tuân theo các phát hiện tiêu điểm màu vàng thông qua phim trong khi các phát hiện thay thế chỉ hiển thị bằng màu trắng.

00:19:34.000 --> 00:19:40.000
Hãy để tôi chỉ cho bạn cách sử dụng những phát hiện thay thế này để thay đổi tiêu điểm.

00:19:40.000 --> 00:19:47.000
Một khi chúng ta biết cách vẽ các hộp phát hiện, việc thay đổi tập lệnh bằng điểm nhấn giao diện người dùng thực sự rất giống nhau.

00:19:47.000 --> 00:19:59.000
Một lần nữa tôi sẽ lặp lại tất cả các phát hiện và nếu điểm nhấn nằm bên trong một phát hiện, tôi sẽ nhận được ID phát hiện tương ứng và tạo ra một quyết định mới.

00:19:59.000 --> 00:20:02.000
Sức mạnh quyết định có thể được đặt trong giao diện người dùng.

00:20:02.000 --> 00:20:11.000
Trong ứng dụng mẫu, yếu được đặt bằng một lần nhấn và mạnh bằng một lần nhấn đúp, nhưng giao diện người dùng thực sự tùy thuộc vào bạn.

00:20:11.000 --> 00:20:18.000
Sau đó, cuối cùng tôi thêm quyết định người dùng mới này vào kịch bản Điện ảnh và kịch bản đã thay đổi.

00:20:18.000 --> 00:20:21.000
Vì vậy, hãy để tôi nói về cách tập lệnh cập nhật thúc đẩy sự tập trung.

00:20:21.000 --> 00:20:29.000
Hãy coi đây là độ dài clip bình thường và xem xét ba quyết định và các bản phát hiện tiêu điểm tương ứng của chúng.

00:20:29.000 --> 00:20:34.000
Hãy sắp xếp các bản nhạc lấy nét theo thời gian và khoảng cách trong một biểu đồ 2D.

00:20:34.000 --> 00:20:42.000
Bởi vì công cụ Điện ảnh biết toàn bộ tập lệnh được cập nhật, nó có thể thực hiện chuyển đổi lấy nét trơn tru trước thời hạn.

00:20:42.000 --> 00:20:50.000
Nó trông giống như thế này, nơi một giá lấy nét bắt đầu trước thời hạn để lấy nét ở đầu mỗi khung hình chính.

00:20:50.000 --> 00:21:00.000
Nó khá kỳ diệu, và nó hoạt động giống như một công cụ kéo lấy nét, người có thể hướng sự chú ý và lấy nét trước thời hạn bằng cách biết các điểm đánh dấu đã đặt.

00:21:00.000 --> 00:21:07.000
Sự chênh lệch tiêu điểm có giá đỡ có thể được truy cập trực tiếp từ một khung hình trong tập lệnh Điện ảnh được cập nhật.

00:21:07.000 --> 00:21:16.000
Tôi đã chỉ ra cách trích xuất khung tập lệnh và việc thay đổi các thuộc tính khung để lấy nét tương tự như thay đổi khẩu độ.

00:21:16.000 --> 00:21:23.000
Khi tôi có một khung tập lệnh từ tập lệnh được cập nhật, tôi có thể cập nhật trực tiếp các thuộc tính khung cho sự chênh lệch tiêu điểm.

00:21:23.000 --> 00:21:29.000
Điều này sẽ chuyển trọng tâm với sự chuyển đổi mượt mà theo tập lệnh được cập nhật sang trình kết xuất.

00:21:29.000 --> 00:21:34.000
Hãy thử nhấn để thay đổi tập lệnh và tập trung vào ứng dụng mẫu.

00:21:34.000 --> 00:21:41.000
Chuyển từ chế độ phát lại sang chỉnh sửa, bây giờ tôi có thể cập nhật kịch bản Điện ảnh.

00:21:41.000 --> 00:21:53.000
Tôi có thể thay đổi các quyết định tập trung bằng cách nhấn một lần để có được quyết định yếu, được hiển thị dưới dạng hộp đứt nét màu vàng hoặc bằng cách nhấn đúp để có được quyết định mạnh mẽ và hộp màu vàng đặc.

00:21:53.000 --> 00:22:00.000
Bạn có thể thấy tiêu điểm và kết xuất thay đổi như thế nào theo đầu vào người dùng của tôi khi tôi tab trên các trình phát khác nhau.

00:22:00.000 --> 00:22:02.000
Tôi nghĩ điều này thật tuyệt.

00:22:02.000 --> 00:22:05.000
Chà, chà.

00:22:05.000 --> 00:22:08.000
Nhấn, chạm, chạm.

00:22:08.000 --> 00:22:10.000
Thay đổi khẩu độ.

00:22:10.000 --> 00:22:15.000
Chà, chạm, chạm, nhấn đúp.

00:22:15.000 --> 00:22:19.000
Và bây giờ tôi đã hoàn thành chỉnh sửa, làm thế nào tôi có thể lưu những thay đổi chỉnh sửa này?

00:22:19.000 --> 00:22:27.000
Các thay đổi tập lệnh có thể được lưu trong một tệp dữ liệu riêng biệt và lưu các thay đổi riêng biệt có nghĩa là bản gốc vẫn không thay đổi.

00:22:27.000 --> 00:22:30.000
Và những thay đổi luôn có thể được hoàn nguyên về bản gốc.

00:22:30.000 --> 00:22:41.000
Vì vậy, tôi nhận được các thay đổi tập lệnh, nhận các thay đổi dưới dạng biểu diễn nhị phân nhỏ gọn và ghi các thay đổi vào tệp dữ liệu.

00:22:41.000 --> 00:22:45.000
API Điện ảnh xử lý biểu diễn dữ liệu.

00:22:45.000 --> 00:22:50.000
Và bạn sẽ cần lưu trữ dữ liệu này trong ứng dụng của mình để nó có thể được tải lại theo nhu cầu của bạn.

00:22:50.000 --> 00:22:56.000
Việc tải các thay đổi tập lệnh được thực hiện theo ba bước đơn giản không kém.

00:22:56.000 --> 00:23:04.000
Tôi lấy dữ liệu nhị phân từ tệp dữ liệu, giải nén các thay đổi tập lệnh và tải lại các thay đổi vào tập lệnh Điện ảnh.

00:23:04.000 --> 00:23:09.000
Các thay đổi cũng có thể được tải đồng thời với tập lệnh gốc.

00:23:09.000 --> 00:23:14.000
Vì vậy, đó là cách chúng ta có thể chỉnh sửa và kết xuất và lưu và tải các thay đổi kịch bản Điện ảnh.

00:23:14.000 --> 00:23:21.000
Như đã đề cập trước đó, bộ tổng hợp video tùy chỉnh có thể được sử dụng để xuất các video được kết xuất.

00:23:21.000 --> 00:23:25.000
Và những thứ này có thể được hiển thị ngay vào thư viện Ảnh.

00:23:25.000 --> 00:23:29.000
Điều này được đề cập chi tiết trong mã mẫu.

00:23:29.000 --> 00:23:38.000
API cũng bao gồm một trình theo dõi, CNObjectTracker, có thể được sử dụng cho các đối tượng mà không cần phát hiện tự động.

00:23:38.000 --> 00:23:45.000
Mã mẫu bao gồm cách trình theo dõi có thể được tham gia bằng cách chạm vào một đối tượng mà không cần phát hiện.

00:23:45.000 --> 00:23:50.000
Và trình theo dõi sẽ cung cấp một bản nhạc phát hiện và có thể được thêm vào tập lệnh.

00:23:50.000 --> 00:23:53.000
Và bây giờ đến một số khả năng nâng cao hơn.

00:23:53.000 --> 00:24:01.000
Bạn cũng có thể thêm theo dõi tùy chỉnh bằng cách cung cấp trình theo dõi của riêng bạn và thêm theo dõi phát hiện tùy chỉnh của riêng bạn vào tập lệnh.

00:24:01.000 --> 00:24:10.000
Và bạn có thể thực hiện các thay đổi tùy chỉnh đối với các thuộc tính kết xuất trên mỗi khung hình, cho phép chuyển đổi tùy chỉnh và thay đổi khẩu độ.

00:24:10.000 --> 00:24:15.000
Cá nhân tôi rất hào hứng với những gì tất cả các bạn có thể làm với chế độ Điện ảnh và API mới.

00:24:15.000 --> 00:24:22.000
Và cho dù đó là một ứng dụng đơn giản hay một trình soạn thảo phức tạp, tôi chắc chắn rằng bạn có thể đưa ra những ý tưởng mà chúng tôi thậm chí còn chưa nghĩ đến.

00:24:22.000 --> 00:24:39.000
Đây là phần giới thiệu về API Điện ảnh mới, cho phép bạn tích hợp các nội dung video chế độ Điện ảnh để phát lại với các điều chỉnh phát lại, thay đổi tập lệnh Điện ảnh và tập trung để thực hiện các chỉnh sửa không phá hủy và kết xuất mới, đồng thời lưu và tải các thay đổi tập lệnh này.

00:24:39.000 --> 00:24:42.000
Vui lòng kiểm tra cái này và hơn thế nữa trong ứng dụng mẫu đi kèm.

00:24:42.000 --> 00:24:46.000
Cảm ơn bạn đã tập trung và viết mã vui vẻ.

00:24:46.000 --> 23:59:59.000
♪ ♪

