WEBVTT

00:00:00.000 --> 00:00:12.000
Chào mừng đến với Meet StoreKit cho SwiftUI.

00:00:12.000 --> 00:00:15.000
Tôi là Greg, một kỹ sư trong nhóm StoreKit.

00:00:15.000 --> 00:00:19.000
Hãy nói về việc bán hàng mua hàng trong ứng dụng.

00:00:19.000 --> 00:00:27.000
Mua hàng trong ứng dụng là tất cả về việc trình bày các dịch vụ sản phẩm của bạn và cung cấp một cách để khách hàng hoàn tất việc mua hàng.

00:00:27.000 --> 00:00:34.000
Việc bán hàng bắt đầu bằng việc lấy dữ liệu về sản phẩm bạn đang bán và nhận được trạng thái của khách hàng.

00:00:34.000 --> 00:00:38.000
Ví dụ, khách hàng đã sở hữu sản phẩm không tiêu hao của tôi chưa?

00:00:38.000 --> 00:00:41.000
Họ đã đăng ký đăng ký của tôi chưa?

00:00:41.000 --> 00:00:48.000
Bạn kết hợp dữ liệu này để xây dựng giao diện tiếp thị sản phẩm cho khách hàng và cung cấp các tương tác để mua sản phẩm.

00:00:48.000 --> 00:00:54.000
Hình chữ nhật nhỏ màu đỏ này đại diện cho tất cả công việc khó khăn để xây dựng giao diện của bạn.

00:00:54.000 --> 00:01:00.000
Thực sự có nhiều khía cạnh để xây dựng giao diện của bạn, đòi hỏi các kỹ năng từ nhiều lĩnh vực khác nhau.

00:01:00.000 --> 00:01:03.000
Sau đó, khách hàng của bạn chọn mua sản phẩm của bạn.

00:01:03.000 --> 00:01:10.000
Ứng dụng của bạn cần phản hồi bằng cách sử dụng API mua hàng và sau đó cập nhật giao diện của nó do kết quả của việc mua hàng.

00:01:10.000 --> 00:01:16.000
Nếu bạn đã từng thêm giao dịch mua trong ứng dụng vào một ứng dụng, bạn biết rằng việc bán hàng đúng cách là rất quan trọng.

00:01:16.000 --> 00:01:22.000
Sẽ thật tuyệt nếu chúng ta có thể trừu tượng hóa tất cả các bước này thành một cái nhìn đơn giản nhưng mạnh mẽ?

00:01:22.000 --> 00:01:30.000
Chế độ xem này có thể xử lý tất cả các chức năng phổ biến và lấy các tham số cho phép bạn định cấu hình các bit tạo ra ứng dụng của bạn, ứng dụng của bạn.

00:01:30.000 --> 00:01:37.000
Chà, tôi rất vui mừng được giới thiệu một bộ API mới mạnh mẽ từ StoreKit để xây dựng giao diện người dùng bán hàng.

00:01:37.000 --> 00:01:44.000
Trong Xcode 15, StoreKit hiện cung cấp một bộ sưu tập các chế độ xem SwiftUI, giúp bạn xây dựng giao diện người dùng mua hàng trong ứng dụng khai báo.

00:01:44.000 --> 00:01:52.000
Bạn chỉ cần khai báo những gì bạn muốn trải nghiệm bán hàng, và hệ thống đưa các tuyên bố của bạn vào hành động đằng sau hậu trường.

00:01:52.000 --> 00:02:01.000
StoreView, ProductView và SubscriptionStoreView là những chế độ xem mới giúp bạn bắt đầu và chạy bán hàng nhanh hơn bao giờ hết.

00:02:01.000 --> 00:02:08.000
Những chế độ xem này trừu tượng hóa luồng dữ liệu từ App Store và hiển thị giao diện người dùng do hệ thống cung cấp để đại diện cho các giao dịch mua trong ứng dụng của bạn.

00:02:08.000 --> 00:02:16.000
Bạn thậm chí có thể sử dụng SwiftUI API mà bạn đã quen thuộc để tùy chỉnh cách các chế độ xem này tích hợp với ứng dụng của bạn.

00:02:16.000 --> 00:02:29.000
Cũng giống như SwiftUI, những chế độ xem mới này được hỗ trợ trên tất cả các nền tảng, vì vậy việc mua hàng trong ứng dụng sẽ dễ dàng hơn bao giờ hết trên iPhone, iPad, Mac, Apple Watch và Apple TV.

00:02:29.000 --> 00:02:36.000
Một nhóm bạn lông vũ đã tiếp cận tôi và hỏi liệu tôi có thể giúp họ thêm các giao dịch mua trong ứng dụng vào trò chơi mới của họ có tên là Backyard Birds không.

00:02:36.000 --> 00:02:41.000
Với những quan điểm mới này từ StoreKit, tất nhiên tôi đã nói, "Không vấn đề gì cả."

00:02:41.000 --> 00:02:45.000
Tham gia cùng tôi khi chúng tôi mang đến trải nghiệm mua hàng trong ứng dụng tuyệt vời ở Backyard Birds.

00:02:45.000 --> 00:02:49.000
Vui lòng tải xuống dự án mẫu để giải quyết vấn đề này với tôi.

00:02:49.000 --> 00:02:54.000
Chúng tôi sẽ sử dụng Xcode Previews để nhanh chóng lặp lại các chế độ xem SwiftUI của chúng tôi.

00:02:54.000 --> 00:02:59.000
Bởi vì chúng ta có quá nhiều thứ để giải quyết, tôi đã thiết lập một tệp cấu hình StoreKit.

00:02:59.000 --> 00:03:05.000
Điều này chứa siêu dữ liệu về các giao dịch mua trong ứng dụng của chúng tôi, cần thiết để sử dụng Bản xem trước Xcode với StoreKit.

00:03:05.000 --> 00:03:15.000
Chúng tôi có một số phiên tuyệt vời để giúp bạn bắt đầu trong ứng dụng của riêng mình, chẳng hạn như, "Có gì mới trong Kiểm tra StoreKit" và "Giới thiệu Kiểm tra StoreKit trong Xcode."

00:03:15.000 --> 00:03:17.000
Hãy vào ngay Xcode.

00:03:17.000 --> 00:03:21.000
Ở Backyard Birds, chúng tôi muốn bán thức ăn cho chim cao cấp như viên dinh dưỡng này.

00:03:21.000 --> 00:03:26.000
Sau khi mua thức ăn, chúng ta có thể để nó ở sân sau của mình để thu hút nhiều du khách chim đói hơn.

00:03:26.000 --> 00:03:33.000
Hãy nhảy vào mã để xem cách chúng ta có thể tận dụng StoreKit để bán những sản phẩm này.

00:03:33.000 --> 00:03:39.000
Để bắt đầu, chúng tôi sẽ tạo một khung cảnh được gọi là BirdFoodShop để bán thức ăn cho chim của chúng tôi.

00:03:39.000 --> 00:03:42.000
Tôi đã tạo một tệp để thực hiện chế độ xem này.

00:03:42.000 --> 00:03:50.000
Để sử dụng StoreKit để xây dựng chế độ xem của chúng tôi, chúng tôi cần nhập cả StoreKit và SwiftUI ở đầu tệp.

00:03:50.000 --> 00:03:59.000
Tiếp theo, tôi sẽ khai báo một truy vấn ở đây để có được mô hình dữ liệu thức ăn cho chim của chúng tôi, điều này sẽ giúp chúng tôi xây dựng cửa hàng của mình.

00:03:59.000 --> 00:04:05.000
Tôi đang thêm StoreView vào ứng dụng vì đó là cách nhanh nhất để thiết lập và chạy chế độ xem bán hàng.

00:04:05.000 --> 00:04:18.000
Chúng tôi cần cung cấp cho nó một bộ sưu tập các số nhận dạng sản phẩm từ tệp cấu hình StoreKit của chúng tôi, mà chúng tôi có thể nhận được từ mô hình birdFood.

00:04:18.000 --> 00:04:22.000
Sau tuyên bố này, bây giờ chúng tôi có quan điểm bán hàng đang hoạt động.

00:04:22.000 --> 00:04:28.000
StoreKit tải tất cả các số nhận dạng sản phẩm từ App Store và trình bày chúng trong giao diện người dùng để chúng tôi xem.

00:04:28.000 --> 00:04:37.000
Tên hiển thị, mô tả và giá cả đều đến trực tiếp từ App Store, sử dụng những gì bạn đã thiết lập trong App Store Connect hoặc tệp cấu hình StoreKit của bạn.

00:04:37.000 --> 00:04:49.000
StoreKit thậm chí còn xử lý các cân nhắc tinh tế hơn, nhưng quan trọng hơn, như lưu trữ dữ liệu cho đến khi hết hạn hoặc hệ thống chịu áp lực bộ nhớ và kiểm tra xem việc mua hàng trong ứng dụng có bị vô hiệu hóa trong Thời gian sử dụng hay không.

00:04:49.000 --> 00:04:54.000
Trước đó, các nhà thiết kế chim đã gửi các biểu tượng trang trí cho mỗi sản phẩm thức ăn cho chim.

00:04:54.000 --> 00:05:04.000
Chúng tôi có thể thêm các biểu tượng này vào Chế độ xem cửa hàng chỉ bằng cách thêm trình tạo chế độ xem cuối và chuyển sang chế độ xem SwiftUI đại diện cho các biểu tượng của chúng tôi.

00:05:04.000 --> 00:05:10.000
Trình tạo chế độ xem lấy giá trị Sản phẩm làm tham số mà chúng ta có thể sử dụng để xác định biểu tượng để sử dụng.

00:05:10.000 --> 00:05:20.000
Tôi đã tạo một chế độ xem trợ giúp lấy ID sản phẩm và tra cứu biểu tượng bên phải từ danh mục tài sản của chúng tôi.

00:05:20.000 --> 00:05:26.000
Khi tôi đặt cái này ở đây, bạn có thể xem các bản cập nhật xem trước để hiển thị các biểu tượng cho từng sản phẩm của chúng tôi.

00:05:26.000 --> 00:05:35.000
Chế độ xem cửa hàng giúp chúng tôi bắt đầu và chạy dễ dàng bằng cách biến các số nhận dạng và biểu tượng sản phẩm của chúng tôi thành một cửa hàng có chức năng và được thiết kế tốt.

00:05:35.000 --> 00:05:43.000
Một tính năng mạnh mẽ của Chế độ xem cửa hàng là, các sản phẩm của chúng tôi tự động điều chỉnh theo các nền tảng khác nhau, vì vậy chúng tôi đã có một cửa hàng trông tuyệt vời trên iPad, Mac và Apple Watch.

00:05:43.000 --> 00:05:57.000
Hãy thay đổi mục tiêu của chúng tôi trong Xcode thành Apple Watch để xem trước cửa hàng của chúng tôi.

00:05:57.000 --> 00:05:58.000
Trông thật tuyệt!

00:05:58.000 --> 00:06:03.000
Tôi nghĩ chúng tôi cũng đã sẵn sàng để bán một số thức ăn cho chim trên Apple Watch.

00:06:03.000 --> 00:06:07.000
Người ta thường muốn sắp xếp các sản phẩm của mình theo cách duy nhất cho sản phẩm của bạn.

00:06:07.000 --> 00:06:13.000
Đội ngũ thiết kế chim của chúng tôi đã làm việc chăm chỉ để tạo ra một bố cục để giới thiệu thức ăn cho chim.

00:06:13.000 --> 00:06:20.000
Thành phần này thể hiện giá trị tốt nhất một cách nổi bật và sắp xếp các sản phẩm khác vào các kệ.

00:06:20.000 --> 00:06:28.000
Điều này khác với bố cục kiểu danh sách mà chúng ta có thể đạt được với StoreView, nhưng StoreKit cũng đã đề cập đến chúng ta ở đây.

00:06:28.000 --> 00:06:31.000
Để bố cục chi tiết hơn, chúng ta có thể sử dụng ProductView mới.

00:06:31.000 --> 00:06:38.000
Trên thực tế, StoreView mà chúng tôi vừa xem xét sử dụng cùng một ProductView để tạo các hàng của nó.

00:06:38.000 --> 00:06:46.000
Hãy bắt đầu bằng cách khai báo một thùng chứa cho cửa hàng mới của chúng tôi.

00:06:46.000 --> 00:06:53.000
Tôi muốn giới thiệu hộp viên dinh dưỡng này nổi bật hơn các sản phẩm khác, bởi vì đó là giá trị tốt nhất của chúng tôi.

00:06:53.000 --> 00:07:04.000
Để làm điều này, tôi sẽ khai báo ProductView bằng cách cung cấp ID cho hộp viên dinh dưỡng.

00:07:04.000 --> 00:07:09.000
Cũng giống như với StoreView, chúng ta có thể thêm biểu tượng trang trí bằng cách thêm phần đóng cuối.

00:07:09.000 --> 00:07:16.000
Tôi sẽ sử dụng lại chế độ xem trợ giúp của chúng tôi từ trước.

00:07:16.000 --> 00:07:20.000
Tiếp theo, hãy thêm một phần bên dưới cho các mặt hàng thực phẩm khác.

00:07:20.000 --> 00:07:26.000
Tôi sẽ bắt đầu bằng cách đặt một nền tảng đằng sau giá trị tốt nhất...

00:07:26.000 --> 00:07:37.000
Sau đó, một tiêu đề cùng với một chế độ xem trợ giúp khác mà tôi đã thực hiện để bày thức ăn cho chim của chúng tôi trên kệ.

00:07:37.000 --> 00:07:50.000
Bên trong chế độ xem trợ giúp kệ này, chúng tôi có thể khai báo Chế độ xem sản phẩm cho từng sản phẩm thức ăn cho chim, cùng với biểu tượng trang trí của chúng tôi.

00:07:50.000 --> 00:07:52.000
Có một điều cuối cùng chúng ta cần gắn kết toàn bộ cửa hàng này lại với nhau.

00:07:52.000 --> 00:08:00.000
Chúng tôi thực sự muốn trưng bày hộp viên dinh dưỡng này một cách nổi bật cho khách hàng, nhưng các nhà thiết kế chim nghĩ rằng những gì chúng tôi có bây giờ có thể trông đẹp hơn.

00:08:00.000 --> 00:08:06.000
Để xoa dịu những chú chim, chúng ta có thể sử dụng API productViewStyle mới để thiết lập phong cách cho sản phẩm anh hùng của chúng ta.

00:08:06.000 --> 00:08:16.000
Tôi sẽ chọn phong cách lớn để thực sự làm cho nó nổi bật.

00:08:16.000 --> 00:08:24.000
Chỉ trong vài phút, chúng tôi đã xây dựng một cửa hàng chuyên biệt chỉ dành cho thức ăn cho chim của chúng tôi bằng cách sử dụng ProductView mới trong StoreKit.

00:08:24.000 --> 00:08:31.000
Phong cách ProductView lớn giúp chúng tôi hiển thị giá trị tốt nhất của mình một cách nổi bật chỉ bằng cách thêm một công cụ sửa đổi chế độ xem.

00:08:31.000 --> 00:08:35.000
Có ba kiểu tiêu chuẩn để lựa chọn phù hợp với nhu cầu của bạn.

00:08:35.000 --> 00:08:49.000
Nhỏ gọn giúp trưng bày nhiều sản phẩm hơn trong một không gian nhỏ hơn, kệ thức ăn cho chim của chúng tôi tự động sử dụng kiểu Thông thường và tất nhiên, phong cách Lớn rất phù hợp cho các bài thuyết trình nổi bật.

00:08:49.000 --> 00:08:58.000
Vì StoreView bao gồm các phiên bản ProductView, bạn có thể sử dụng cùng một công cụ sửa đổi productViewStyle để thay đổi kiểu của StoreView.

00:08:58.000 --> 00:09:03.000
Bạn thậm chí có thể tạo các kiểu tùy chỉnh và sử dụng chúng với ProductView và StoreView.

00:09:03.000 --> 00:09:07.000
Hãy ở lại, và tôi sẽ chỉ cho bạn cách sau trong phiên.

00:09:07.000 --> 00:09:13.000
Chúng tôi đã xây dựng một cách tuyệt vời để cung cấp dịch vụ mua thức ăn cho chim tiêu hao trong ứng dụng bằng ProductView.

00:09:13.000 --> 00:09:22.000
Những người kinh doanh nghĩ rằng chúng tôi chưa đi đủ xa và họ đã giao nhiệm vụ cho tôi cung cấp một đăng ký có tên Backyard Birds Pass cho những người đam mê ngắm chim nhất.

00:09:22.000 --> 00:09:31.000
Mặc dù chúng tôi có thể xây dựng giao diện người dùng đăng ký bằng ProductView hoặc StoreView, nhưng SubscriptionStoreView mới được xây dựng dành riêng cho các đăng ký.

00:09:31.000 --> 00:09:34.000
Hãy quay lại Xcode và cùng nhau xây dựng cái này.

00:09:34.000 --> 00:09:44.000
Để bắt đầu, trong cấu hình StoreKit của chúng tôi, tôi đã tạo nhóm đăng ký "Backyard Birds Pass" này cung cấp ba cấp độ dịch vụ.

00:09:44.000 --> 00:09:48.000
Lưu ý ID nhóm này. Chúng ta sẽ cần cái này trong giây lát.

00:09:48.000 --> 00:09:56.000
Trước đó, tôi đã tạo một tệp mới cho cửa hàng thẻ của chúng tôi, vì vậy hãy đi sâu vào SubscriptionStoreView.

00:09:56.000 --> 00:10:04.000
Cách nhanh nhất để bắt đầu và chạy với SubscriptionStoreView là cung cấp ID nhóm từ tệp cấu hình StoreKit hoặc App Store Connect của chúng tôi.

00:10:04.000 --> 00:10:21.000
Tôi đã thêm ID nhóm vào môi trường của chúng tôi, vì vậy chúng tôi chỉ có thể khai báo một thuộc tính môi trường để truy cập nó, và sau đó khai báo SubscriptionStoreView bằng cách cung cấp ID nhóm.

00:10:21.000 --> 00:10:30.000
Cũng giống như StoreView và ProductView, SubscriptionStoreView quản lý luồng dữ liệu cho chúng tôi và đưa ra một chế độ xem với các tùy chọn gói khác nhau.

00:10:30.000 --> 00:10:37.000
Nó cũng kiểm tra trạng thái người đăng ký hiện tại và liệu khách hàng có đủ điều kiện nhận ưu đãi giới thiệu hay không.

00:10:37.000 --> 00:10:44.000
Mặc dù giao diện tự động này rất tuyệt, nhưng có một số API mới mạnh mẽ mà chúng tôi có thể sử dụng để làm cho nó phù hợp với giao diện của Backyard Birds.

00:10:44.000 --> 00:10:50.000
Ví dụ, chúng ta có thể thay thế nội dung tiếp thị trong tiêu đề bằng bất kỳ chế độ xem SwiftUI nào.

00:10:50.000 --> 00:10:57.000
Tôi đã xây dựng chế độ xem nội dung tiếp thị trước đó, vì vậy tôi sẽ thả cái này vào đây.

00:10:57.000 --> 00:11:03.000
Chúng tôi cũng có thể thêm nền vùng chứa vào Cửa hàng đăng ký để làm cho mọi thứ trở nên thú vị hơn về mặt thị giác.

00:11:03.000 --> 00:11:10.000
Chúng ta có thể sử dụng SwiftUI containerBackground API mới.

00:11:10.000 --> 00:11:20.000
Chú ý cách tôi chọn đặt cái này ở chiều cao đầy đủ của Cửa hàng đăng ký và sau đó khai báo chế độ xem mà tôi đã tạo trước đó với độ dốc bầu trời và một số đám mây.

00:11:20.000 --> 00:11:26.000
Để kết hợp mọi thứ lại với nhau, chúng ta có thể sử dụng một số API khác để tạo kiểu cho Cửa hàng đăng ký.

00:11:26.000 --> 00:11:35.000
Theo mặc định, Cửa hàng đăng ký thêm một lớp vật liệu giữa các điều khiển đăng ký và nền có chiều cao đầy đủ.

00:11:35.000 --> 00:11:45.000
Chúng ta có thể sử dụng công cụ sửa đổi kiểu nền để làm cho nền đằng sau các điều khiển đăng ký rõ ràng.

00:11:45.000 --> 00:11:55.000
Bây giờ, tôi sẽ sử dụng subscriptionStoreButtonLabel để chọn bố cục nhiều dòng cho nút đăng ký của chúng tôi.

00:11:55.000 --> 00:12:01.000
Lưu ý cách nút đăng ký hiện chứa cả giá và "Dử miễn phí".

00:12:01.000 --> 00:12:12.000
Tiếp theo, tôi sẽ thêm subscriptionStorePickerItemBackground để khai báo hiệu ứng vật chất cho các tùy chọn đăng ký của chúng tôi.

00:12:12.000 --> 00:12:20.000
Ở đây, chúng ta có thể thấy độ dốc bầu trời tỏa sáng thông qua các tùy chọn gói đăng ký.

00:12:20.000 --> 00:12:32.000
Cuối cùng, vì đăng ký của chúng tôi có mã ưu đãi, tôi sẽ sử dụng công cụ sửa đổi storeButton mới để khai báo nút Đổi mã là hiển thị.

00:12:32.000 --> 00:12:40.000
Chỉ với một công cụ sửa đổi chế độ xem này, chúng tôi có một nút để khách hàng mở bảng đổi mã ưu đãi.

00:12:40.000 --> 00:12:45.000
Bây giờ, chế độ xem đăng ký của chúng tôi phù hợp với cảm giác của phần còn lại của Backyard Birds.

00:12:45.000 --> 00:12:54.000
Mặc dù những lượt xem mới này làm giảm đáng kể nỗ lực cần thiết để thêm giao dịch mua trong ứng dụng vào ứng dụng, nhưng có một vài phần quan trọng mà chúng tôi đang thiếu.

00:12:54.000 --> 00:12:59.000
Đầu tiên, chúng ta phải thêm logic để thực sự mở khóa nội dung sau khi mua hàng được thực hiện.

00:12:59.000 --> 00:13:07.000
Thứ hai, chúng ta cần kiểm tra xem ai đó đã đăng ký chưa và sau đó ẩn bất kỳ điều khiển nào trình bày SubscriptionStoreView.

00:13:07.000 --> 00:13:20.000
Chế độ xem StoreKit xử lý những khách hàng đã đăng ký tự động, nhưng trong nhiều trường hợp, trải nghiệm tốt nhất là chọn không trình bày bất kỳ giao diện người dùng bán hàng nào cho khách hàng hiện tại.

00:13:20.000 --> 00:13:28.000
StoreKit có một số API hoàn toàn mới để giúp việc triển khai những khả năng quan trọng này dễ dàng và thú vị như bán nội dung của bạn.

00:13:28.000 --> 00:13:35.000
Trước khi bạn bắt đầu với các API này, bạn sẽ muốn triển khai logic kinh doanh của mình hoặc ít nhất là có một số giàn giáo tại chỗ.

00:13:35.000 --> 00:13:47.000
Đảm bảo bạn đang xử lý các giao dịch cập nhật, hợp tác với máy chủ của mình, theo dõi các quyền lợi tiêu hao và tạo mô hình dữ liệu phù hợp với mã giao diện người dùng của bạn, trong số những thứ khác.

00:13:47.000 --> 00:13:56.000
Tôi khuyên bạn nên kiểm tra "Gặp gỡ StoreKit 2" và "Có gì mới trong API máy chủ App Store" để tìm hiểu thêm về việc triển khai logic kinh doanh của bạn.

00:13:56.000 --> 00:14:01.000
Tôi đã tiếp tục và triển khai logic kinh doanh chim của chúng tôi thành một diễn viên tên là BirdBrain.

00:14:01.000 --> 00:14:04.000
Bạn sẽ thấy tôi tham khảo điều này sớm thôi.

00:14:04.000 --> 00:14:10.000
Hãy bắt đầu với việc cho những người quan sát chim quyền truy cập vào thức ăn cho chim tiêu hao mà họ mua.

00:14:10.000 --> 00:14:13.000
Xử lý các giao dịch mua đến từ bất kỳ chế độ xem StoreKit nào đều đơn giản.

00:14:13.000 --> 00:14:21.000
Bạn chỉ cần sửa đổi chế độ xem với onInAppPurchaseCompletion và cung cấp chức năng gọi bất cứ khi nào giao dịch mua hoàn tất.

00:14:21.000 --> 00:14:27.000
Bạn có thể sửa đổi bất kỳ chế độ xem nào bằng phương pháp này và nó sẽ được gọi bất cứ khi nào chế độ xem StoreKit hậu duệ kết thúc giao dịch mua.

00:14:27.000 --> 00:14:39.000
Hãy thêm công cụ sửa đổi này vào BirdFoodShop của chúng tôi.

00:14:39.000 --> 00:14:46.000
Công cụ sửa đổi cung cấp cho chúng tôi sản phẩm đã được mua và kết quả mua hàng, cho dù nó có thành công hay không.

00:14:46.000 --> 00:14:55.000
Hãy thực hiện điều này để gửi bất kỳ kết quả thành công nào đến diễn viên BirdBrain để xử lý.

00:14:55.000 --> 00:15:01.000
Bằng cách thêm công cụ sửa đổi này, chúng tôi hiện đang mở khóa thức ăn cho chim tiêu hao mà mọi người mua.

00:15:01.000 --> 00:15:05.000
Hãy thử cái này trong trình giả lập.

00:15:05.000 --> 00:15:10.000
Tôi sẽ chọn một sân sau và khai thác nguồn cung cấp.

00:15:10.000 --> 00:15:19.000
Sau đó, tôi sẽ mua một số viên dinh dưỡng.

00:15:19.000 --> 00:15:26.000
Sau khi tờ giấy bị loại bỏ, bạn sẽ nhận thấy chúng tôi hiện có năm viên dinh dưỡng trong kho vật tư của mình.

00:15:26.000 --> 00:15:34.000
Bây giờ, chúng ta có thể đặt một viên dinh dưỡng và ngồi lại khi viên của chúng ta mang tất cả những con chim đói đến sân.

00:15:34.000 --> 00:15:43.000
Ngoài onInAppPurchaseCompletion, có một vài công cụ sửa đổi chế độ xem liên quan khác mà bạn có thể sử dụng để xử lý các sự kiện từ chế độ xem StoreKit.

00:15:43.000 --> 00:15:50.000
Bạn có thể sử dụng onInAppPurchaseStart để xử lý khi ai đó kích hoạt nút mua hàng, nhưng trước khi giao dịch mua bắt đầu.

00:15:50.000 --> 00:15:56.000
Điều này rất hữu ích nếu bạn muốn cập nhật một số thành phần giao diện người dùng trong khi giao dịch mua đang chạy, như điều khiển làm mờ.

00:15:56.000 --> 00:16:02.000
Chức năng bạn cung cấp ở đây nhận được sản phẩm sẽ được mua dưới dạng tham số.

00:16:02.000 --> 00:16:13.000
Khi sử dụng các công cụ sửa đổi này, điều quan trọng là phải biết rằng chúng sẽ xử lý các sự kiện từ bất kỳ phiên bản ProductView, StoreView hoặc SubscriptionStoreView hậu duệ nào.

00:16:13.000 --> 00:16:17.000
Nếu bạn thêm nhiều công cụ sửa đổi, tất cả các hành động của bạn sẽ chạy cho mỗi sự kiện.

00:16:17.000 --> 00:16:21.000
Hãy nhớ rằng, sử dụng các công cụ sửa đổi này là hoàn toàn tùy chọn.

00:16:21.000 --> 00:16:33.000
Theo mặc định, các giao dịch thành công từ chế độ xem StoreKit sẽ phát ra từ chuỗi Transaction.updates, nhưng bạn có tùy chọn thêm onInAppPurchaseCompletion để xử lý kết quả trực tiếp.

00:16:33.000 --> 00:16:38.000
Bạn có thể chuyển số không cho bất kỳ công cụ sửa đổi nào trong số này để trở lại hành vi mặc định.

00:16:38.000 --> 00:16:43.000
Bây giờ, hãy nói về việc xử lý đăng ký Backyard Birds Pass.

00:16:43.000 --> 00:16:50.000
Ngoài các API chế độ xem mới, StoreKit có các công cụ sửa đổi chế độ xem mới để khai báo các phụ thuộc dữ liệu trong SwiftUI.

00:16:50.000 --> 00:16:56.000
Đầu tiên, tôi sẽ đề cập đến đăng ký StatusTask, mà chúng ta có thể sử dụng để giúp việc mở khóa thẻ của mình trở nên dễ dàng.

00:16:56.000 --> 00:17:02.000
Trong bất kỳ chế độ xem nào phụ thuộc vào đăng ký của chúng tôi, chúng tôi có thể thêm công cụ sửa đổi subscriptionStatusTask.

00:17:02.000 --> 00:17:14.000
Hãy bắt đầu với Backyard Grid, bởi vì đây là nơi chúng tôi hiển thị nút để mở bảng ưu đãi đăng ký.

00:17:14.000 --> 00:17:20.000
Công cụ sửa đổi subscriptionStatusTask lấy ID nhóm của đăng ký mà chúng tôi phụ thuộc vào.

00:17:20.000 --> 00:17:25.000
Đây là cùng một ID nhóm mà chúng tôi đã sử dụng trước đó khi chúng tôi khai báo SubscriptionStoreView.

00:17:25.000 --> 00:17:36.000
Bây giờ, bất cứ khi nào Backyard Grid xuất hiện, một tác vụ nền sẽ tải trạng thái đăng ký và sau đó gọi chức năng mà chúng tôi cung cấp sau khi nhiệm vụ hoàn thành.

00:17:36.000 --> 00:17:55.000
Cách tốt nhất để sử dụng API này là chỉ cần chuyển các trạng thái cho logic kinh doanh của chúng tôi, trong trường hợp của chúng tôi, tác nhân BirdBrain, và sau đó yêu cầu tác nhân xử lý dữ liệu và trả về một loại mô hình dễ làm việc hơn trong mã giao diện người dùng của chúng tôi.

00:17:55.000 --> 00:18:07.000
Tôi đã tạo danh sách trạng thái Pass này, vì vậy tôi sẽ chỉ tạo một thuộc tính của tiểu bang để gán cái này cho.

00:18:07.000 --> 00:18:18.000
Sau đó, chúng tôi có thể chọn chỉ hiển thị thẻ ưu đãi đăng ký nếu ai đó hiện không đăng ký.

00:18:18.000 --> 00:18:23.000
Với những bổ sung nhanh chóng này, bây giờ chúng tôi sẽ chỉ hiển thị thẻ ưu đãi cho những người quan sát chim chưa đăng ký.

00:18:23.000 --> 00:18:31.000
StoreKit sẽ gọi chức năng của chúng tôi khi trạng thái thay đổi, vì vậy chế độ xem của chúng tôi sẽ luôn phản ánh thông tin cập nhật nhất.

00:18:31.000 --> 00:18:44.000
Chúng tôi có thể sử dụng cùng một mẫu này trong toàn bộ ứng dụng để mở khóa nội dung Backyard Birds Pass và chúng tôi có thể sử dụng công cụ sửa đổi onInAppPurchaseCompletion để tự động loại bỏ bảng Pass Shop sau khi đăng ký thành công.

00:18:44.000 --> 00:18:55.000
Tôi đã hoàn thành phần này sớm hơn, vì vậy hãy chạy ứng dụng trong trình mô phỏng iPhone và kiểm tra toàn bộ điều này.

00:18:55.000 --> 00:19:02.000
Tôi sẽ chỉ nhấn Kiểm tra nó và nhấn Dùng thử miễn phí.

00:19:02.000 --> 00:19:09.000
Bảng thanh toán xuất hiện và tôi có thể nhấn Đăng ký, sau đó bỏ qua cảnh báo.

00:19:09.000 --> 00:19:15.000
Xem cách bảng ưu đãi tự động loại bỏ và thẻ ưu đãi cũng bị ẩn.

00:19:15.000 --> 00:19:25.000
Đó là bởi vì nhiệm vụ trạng thái đăng ký gọi lại chức năng của chúng tôi mỗi khi trạng thái thay đổi, vì vậy chúng tôi có thể chắc chắn rằng giao diện người dùng của ứng dụng của chúng tôi luôn được cập nhật.

00:19:25.000 --> 00:19:35.000
Mặc dù chúng tôi đang nói về chủ đề này, nếu ứng dụng của bạn cung cấp các đăng ký không phải hàng tiêu dùng hoặc không gia hạn, có một API mới để giúp việc kiểm tra các quyền lợi dễ dàng như subscriptionStatusTask.

00:19:35.000 --> 00:19:51.000
Bạn có thể sử dụng công cụ sửa đổi currentEntitlementTask để khai báo chế độ xem phụ thuộc vào quyền lợi hiện tại cho ID sản phẩm và hệ thống sẽ tải không đồng bộ quyền lợi hiện tại và gọi hàm của bạn với quyền lợi hiện tại bất cứ khi nào nó thay đổi.

00:19:51.000 --> 00:19:59.000
Các chức năng bạn cung cấp cho cả subscriptionStatusTask và currentEntitlementTask lấy trạng thái nhiệm vụ quyền lợi làm tham số.

00:19:59.000 --> 00:20:09.000
Bằng cách đó, bạn có thể chọn xử lý chi tiết trường hợp khi quyền lợi vẫn đang tải, nếu nó không tải được và khi quyền lợi được tải thành công.

00:20:09.000 --> 00:20:15.000
Tôi đã đề cập đến cách các chế độ xem StoreKit mới này giúp hợp lý hóa việc tích hợp mua hàng trong ứng dụng trong Backyard Birds.

00:20:15.000 --> 00:20:25.000
Bây giờ, tôi muốn đi sâu hơn một chút và chỉ ra cách bạn có thể đưa những quan điểm này tiến thêm một bước với tất cả các API StoreKit mới cho SwiftUI.

00:20:25.000 --> 00:20:30.000
Đầu tiên, chúng ta sẽ xem xét nhiều tùy chọn hơn để thiết lập các biểu tượng cho ProductView và StoreView.

00:20:30.000 --> 00:20:34.000
Sau đó, tôi sẽ đi vào chi tiết về kiểu dáng của Chế độ xem sản phẩm.

00:20:34.000 --> 00:20:41.000
Sau đó, tôi sẽ đề cập đến cách thêm các nút có chức năng chung vào StoreView và SubscriptionStoreView.

00:20:41.000 --> 00:20:49.000
Cuối cùng, tôi sẽ đi sâu vào các API mới khác nhau mà bạn có thể sử dụng để làm cho Chế độ xem cửa hàng đăng ký phù hợp với giao diện thương hiệu của bạn.

00:20:49.000 --> 00:20:51.000
Hãy đi vào các biểu tượng trang trí.

00:20:51.000 --> 00:21:00.000
Khi bạn cung cấp một biểu tượng, tất cả các kiểu Chế độ xem sản phẩm tiêu chuẩn đều hiển thị biểu tượng giữ chỗ trong khi sản phẩm đang tải, giống như những gì bạn có thể thấy ở bên trái.

00:21:00.000 --> 00:21:05.000
Đôi khi biểu tượng tự động không khớp chính xác với những gì bạn mong đợi biểu tượng thực tế.

00:21:05.000 --> 00:21:13.000
Ví dụ, trên iPhone, trình giữ chỗ tự động là một hình vuông, nhưng chúng tôi sử dụng các biểu tượng hình tròn cho các sản phẩm Thức ăn cho chim.

00:21:13.000 --> 00:21:21.000
Bạn có thể dễ dàng cải thiện giao diện này bằng cách thêm đóng cửa thứ hai vào ProductView của mình bằng biểu tượng bạn muốn sử dụng cho trình giữ chỗ của mình.

00:21:21.000 --> 00:21:25.000
Trong trường hợp này, tôi vừa cung cấp một vòng tròn cho trình giữ chỗ.

00:21:25.000 --> 00:21:33.000
Nếu bạn đặt hình ảnh quảng cáo App Store trong App Store Connect, bạn có thể yêu cầu ProductView sử dụng cùng một hình ảnh đó thay vì chế độ xem SwiftUI.

00:21:33.000 --> 00:21:38.000
Chỉ cần đặt tham số prefersPromotionalIcon thành true.

00:21:38.000 --> 00:21:45.000
Bạn vẫn có thể cung cấp chế độ xem SwiftUI như một dự phòng, nhưng chế độ xem này sẽ bị bỏ qua miễn là sản phẩm có biểu tượng quảng cáo.

00:21:45.000 --> 00:21:56.000
Kiểm tra "Có gì mới trong StoreKit 2 và Kiểm tra StoreKit trong Xcode" và "Có gì mới trong App Store Connect" để tìm hiểu cách thiết lập biểu tượng quảng cáo.

00:21:56.000 --> 00:22:06.000
Ngay cả khi bạn không muốn sử dụng biểu tượng quảng cáo từ App Store, bạn vẫn có thể sử dụng cách xử lý biểu tượng mua hàng trong ứng dụng thú vị cho các biểu tượng của mình được khai báo trong SwiftUI.

00:22:06.000 --> 00:22:12.000
Chỉ cần thêm công cụ sửa đổi này vào chế độ xem bạn cung cấp cho biểu tượng để thêm đường viền này vào chế độ xem của bạn.

00:22:12.000 --> 00:22:15.000
Đó là tất cả về các biểu tượng trong Chế độ xem sản phẩm.

00:22:15.000 --> 00:22:22.000
Hãy nhớ rằng, có API tương ứng để thực hiện tất cả những điều tương tự với các biểu tượng Chế độ xem cửa hàng.

00:22:22.000 --> 00:22:26.000
Bây giờ, hãy nói về việc tạo kiểu cho Chế độ xem sản phẩm.

00:22:26.000 --> 00:22:33.000
Trước đó trong phiên, tôi đã đề cập rằng bạn có thể tạo các kiểu Chế độ xem sản phẩm tùy chỉnh và cuối cùng đã đến lúc tôi chỉ cho bạn cách thực hiện.

00:22:33.000 --> 00:22:40.000
Giao diện, hành vi bố cục và tương tác của Chế độ xem sản phẩm hoàn toàn được xác định bởi phong cách mà nó sử dụng.

00:22:40.000 --> 00:22:48.000
Vì vậy, nếu bạn không thể tìm thấy một phong cách tiêu chuẩn phù hợp với những gì bạn đang làm, bạn luôn có thể tạo phong cách Chế độ xem sản phẩm tùy chỉnh của riêng mình.

00:22:48.000 --> 00:22:55.000
Trường hợp đầu tiên chúng ta sẽ xem xét liên quan đến việc tạo các kiểu tùy chỉnh bao gồm các kiểu tiêu chuẩn để bạn không bắt đầu lại từ đầu.

00:22:55.000 --> 00:23:03.000
Ví dụ, điều gì sẽ xảy ra nếu bạn muốn Chế độ xem sản phẩm hiển thị trình quay tiến trình thay vì giao diện trình giữ chỗ tiêu chuẩn trong khi tải?

00:23:03.000 --> 00:23:10.000
Bước đầu tiên để tạo một kiểu tùy chỉnh là tạo một kiểu phù hợp với giao thức ProductViewStyle.

00:23:10.000 --> 00:23:15.000
Yêu cầu duy nhất để triển khai giao thức là phương thức makeBody này.

00:23:15.000 --> 00:23:23.000
Giá trị cấu hình được chuyển đến phương thức makeBody của bạn có tất cả các thuộc tính bạn cần để khai báo Chế độ xem sản phẩm tuyệt vời.

00:23:23.000 --> 00:23:29.000
Ví dụ, nó có một bảng liệt kê trạng thái bao gồm các trạng thái tải sản phẩm khác nhau.

00:23:29.000 --> 00:23:34.000
Để tùy chỉnh giao diện tải, chúng ta chỉ cần khai báo ProgressView cho trạng thái tải.

00:23:34.000 --> 00:23:44.000
Sau đó, chúng ta có thể dự phòng hành vi ProductView tiêu chuẩn cho bất kỳ trạng thái nào khác bằng cách chuyển cấu hình sang phiên bản ProductView.

00:23:44.000 --> 00:23:52.000
Bạn áp dụng các kiểu tùy chỉnh giống như cách bạn thực hiện các kiểu tiêu chuẩn, bằng cách chuyển nó đến công cụ sửa đổi productViewStyle.

00:23:52.000 --> 00:23:58.000
Tất nhiên, bạn không cần phải sáng tác phong cách tùy chỉnh của mình với phong cách tiêu chuẩn.

00:23:58.000 --> 00:24:03.000
Bạn luôn có thể xác định phong cách của mình bằng cách sử dụng các chế độ xem khác trong phương thức makeBody.

00:24:03.000 --> 00:24:09.000
Khi trạng thái nhiệm vụ thành công, bạn có thể truy cập giá trị Sản phẩm mà chế độ xem đang đại diện.

00:24:09.000 --> 00:24:14.000
Đây là cùng một giá trị Sản phẩm mà bạn đã quen làm việc nếu ứng dụng của bạn sử dụng StoreKit 2.

00:24:14.000 --> 00:24:19.000
Bạn có thể sử dụng tất cả các thuộc tính của Sản phẩm để tạo chế độ xem của mình.

00:24:19.000 --> 00:24:24.000
Cấu hình cũng cho phép bạn truy cập biểu tượng trang trí.

00:24:24.000 --> 00:24:32.000
Khi bạn thêm nút mua hàng, hãy đảm bảo sử dụng phương thức mua hàng trên giá trị cấu hình, không phải giá trị sản phẩm.

00:24:32.000 --> 00:24:47.000
Sử dụng phương thức trên cấu hình sẽ thêm các tùy chọn mua mặc định để đảm bảo bảng xác nhận thanh toán hiển thị gần với Chế độ xem sản phẩm của bạn và cũng kích hoạt các công cụ sửa đổi phản ứng như onInAppPurchaseCompletion.

00:24:47.000 --> 00:24:57.000
Hãy nhớ rằng: khi phong cách tùy chỉnh của bạn được xây dựng từ đầu, giao diện và hành vi của Chế độ xem sản phẩm sử dụng phong cách này sẽ khớp với chế độ xem bạn đã soạn để xây dựng phong cách.

00:24:57.000 --> 00:25:10.000
Tạo các kiểu tùy chỉnh là một cách tuyệt vời để tận dụng tất cả cơ sở hạ tầng cho Chế độ xem sản phẩm, chẳng hạn như luồng dữ liệu App Store, đồng thời tự do khai báo bất kỳ giao diện và hành vi nào bạn muốn.

00:25:10.000 --> 00:25:15.000
Trong khi tải, giao diện người dùng mà chúng tôi đã xây dựng cho Bird Food Shop hiển thị các hình dạng giữ chỗ cho mỗi sản phẩm.

00:25:15.000 --> 00:25:19.000
Nhưng điều gì sẽ xảy ra nếu chúng ta muốn có một diện mạo như con quay tải này ở bên phải?

00:25:19.000 --> 00:25:22.000
Giải pháp cho vấn đề này là nâng cao trạng thái.

00:25:22.000 --> 00:25:25.000
Hãy để tôi giải thích ý tôi ở đây.

00:25:25.000 --> 00:25:30.000
Sơ đồ này thể hiện hệ thống phân cấp của BirdFoodShop mà chúng tôi đã xây dựng trước đó.

00:25:30.000 --> 00:25:34.000
BirdFoodShop có một số hậu duệ của ProductView.

00:25:34.000 --> 00:25:42.000
Khi bạn khởi tạo ProductView bằng ID sản phẩm, mỗi chế độ xem bên trong sẽ giữ trạng thái của sản phẩm vì thao tác tải không đồng bộ.

00:25:42.000 --> 00:25:51.000
Nếu bạn muốn tạo hiệu ứng trong đó BirdFoodShop mẹ hiển thị hình thức khác trong khi các sản phẩm đang tải, bạn sẽ cần nâng trạng thái của mình lên BirdFoodShop mẹ.

00:25:51.000 --> 00:26:04.000
Khi BirdFoodShop mẹ đang quản lý trạng thái của sản phẩm, bạn có thể tự do thay đổi giao diện trong khi dữ liệu đang tải và sau đó tạo các phiên bản ProductView bằng cách sử dụng các giá trị sản phẩm được tải sẵn thay vì ID của chúng.

00:26:04.000 --> 00:26:14.000
Cho đến nay, chúng tôi chỉ đề cập đến việc tạo Lượt xem Sản phẩm theo ID sản phẩm, nhưng điều quan trọng cần biết là bạn có thể chuyển giá trị Sản phẩm mà bạn đã tải lên Chế độ xem Sản phẩm.

00:26:14.000 --> 00:26:19.000
Điều này khiến Chế độ xem sản phẩm bỏ qua quá trình tải và chỉ cần bố trí chế độ xem bán hàng trực tiếp.

00:26:19.000 --> 00:26:27.000
Bạn có thể đang nghĩ: tất cả đều tuyệt vời, nhưng để làm được điều đó, bây giờ tôi phải viết yêu cầu sản phẩm của riêng mình và logic bộ nhớ đệm.

00:26:27.000 --> 00:26:38.000
Chà, bạn sẽ rất vui khi biết chúng tôi đang hiển thị bên trong chế độ xem StoreKit dưới dạng công cụ sửa đổi chế độ xem, vì vậy bạn có thể khai báo bất kỳ chế độ xem nào là phụ thuộc vào siêu dữ liệu cho ID sản phẩm.

00:26:38.000 --> 00:26:43.000
StoreKit sẽ xử lý việc tải các sản phẩm cho bạn, lưu trữ chúng và cập nhật chúng.

00:26:43.000 --> 00:26:48.000
Để làm điều này, bạn chỉ cần sử dụng công cụ sửa đổi storeProductsTask mới.

00:26:48.000 --> 00:26:56.000
Tương tự như subscriptionStatusTask mà chúng tôi đã đề cập trước đó, bạn chuyển một bộ sưu tập ID sản phẩm để xem phụ thuộc vào.

00:26:56.000 --> 00:27:00.000
Sau đó, bạn nhận được một giá trị trạng thái mà bạn có thể sử dụng để xử lý các trạng thái của nhiệm vụ không đồng bộ.

00:27:00.000 --> 00:27:07.000
Tất cả điều này sẽ cảm thấy khá quen thuộc sau khi chúng tôi vừa xem xét việc triển khai ProductViewStyle tùy chỉnh.

00:27:07.000 --> 00:27:12.000
Từ đây, chúng tôi có thể hiển thị chế độ xem tải của mình khi tải....

00:27:12.000 --> 00:27:21.000
Sử dụng ContentUnavailableView mới nếu các sản phẩm không có sẵn... Hoặc chỉ hiển thị trực tiếp BirdFoodShop của chúng tôi với các giá trị Sản phẩm được tải sẵn.

00:27:21.000 --> 00:27:23.000
Thật dễ dàng.

00:27:23.000 --> 00:27:30.000
Nói về sự dễ dàng, có một số hành động phổ biến hữu ích để đưa vào giao diện người dùng bán hàng trong ứng dụng.

00:27:30.000 --> 00:27:37.000
StoreView và SubscriptionStoreView giúp việc thêm các nút phụ trợ cho các hành động phổ biến này thực sự dễ dàng.

00:27:37.000 --> 00:27:44.000
Khi tôi nói về các nút phụ trợ, ý tôi là các nút thực hiện các hành động hỗ trợ mục đích chính của chế độ xem.

00:27:44.000 --> 00:27:53.000
Ví dụ, nút Hủy và nút Đổi Mã này đều phụ trợ để đăng ký thẻ.

00:27:53.000 --> 00:28:00.000
Chúng tôi đã xem xét việc thêm nút Đổi Mã bằng cách sử dụng công cụ sửa đổi storeButton khi chúng tôi lần đầu tiên xây dựng trang tính này.

00:28:00.000 --> 00:28:03.000
Chúng ta hãy xem xét kỹ hơn công cụ sửa đổi chế độ xem này.

00:28:03.000 --> 00:28:07.000
Có một vài giá trị bạn có thể truyền cho mỗi trong hai tham số ở đây.

00:28:07.000 --> 00:28:11.000
Tham số đầu tiên cho phép bạn chọn khả năng hiển thị.

00:28:11.000 --> 00:28:18.000
Tự động là mặc định cho tất cả các nút, điều này khiến StoreKit chọn xem có hiển thị nút hay không tùy thuộc vào ngữ cảnh.

00:28:18.000 --> 00:28:23.000
Bạn cũng có thể chọn làm cho một nút hiển thị hoặc ẩn rõ ràng.

00:28:23.000 --> 00:28:29.000
Tham số tiếp theo cho phép bạn chọn loại nút mà bạn muốn định cấu hình khả năng hiển thị.

00:28:29.000 --> 00:28:34.000
Nút hủy hiển thị nút phù hợp với nền tảng để loại bỏ chế độ xem.

00:28:34.000 --> 00:28:38.000
Nút này hoạt động cho cả StoreView và SubscriptionStoreView.

00:28:38.000 --> 00:28:44.000
Hành vi tự động cho nút hủy là hiển thị bất cứ khi nào chế độ xem được hiển thị.

00:28:44.000 --> 00:28:52.000
Ở bên phải, Chế độ xem Cửa hàng Đăng ký được trình bày dưới dạng một trang tính để nó tự động hiển thị nút hủy ở trên cùng bên phải.

00:28:52.000 --> 00:28:58.000
Ở bên trái, chế độ xem không được trình bày dưới dạng trang tính, vì vậy không có nút hủy.

00:28:58.000 --> 00:29:04.000
Tất nhiên, bạn có thể chọn ghi đè hành vi này và ẩn nút hủy khi được trình bày.

00:29:04.000 --> 00:29:11.000
Hãy nhớ rằng, bạn chỉ muốn làm điều này khi bạn thay thế nút hủy bằng nút hủy của riêng bạn.

00:29:11.000 --> 00:29:19.000
Thực hành tốt là luôn đi kèm với giao diện người dùng bán hàng của bạn với một nút rõ ràng để loại bỏ bài thuyết trình.

00:29:19.000 --> 00:29:26.000
Cũng giống như nút hủy, cả Chế độ xem cửa hàng và Chế độ xem cửa hàng đăng ký đều có thể hiển thị nút Khôi phục mua hàng.

00:29:26.000 --> 00:29:35.000
Theo mặc định, nút Khôi phục Mua hàng luôn bị ẩn, nhưng bạn có thể chọn hiển thị nó trong giao diện người dùng bán hàng của mình bằng công cụ sửa đổi storeButton.

00:29:35.000 --> 00:29:40.000
Ba loại nút tiếp theo chỉ dành cho SubscriptionStoreView.

00:29:40.000 --> 00:29:43.000
Chúng ta đã nói về nút redeemCode.

00:29:43.000 --> 00:29:45.000
Loại nút tiếp theo là nút đăng nhập.

00:29:45.000 --> 00:29:56.000
Nếu dịch vụ đăng ký của bạn cho phép mọi người đăng ký bên ngoài App Store, bạn nên hiển thị nút đăng nhập trong trường hợp người đăng ký hiện tại cần truy cập đăng ký của họ.

00:29:56.000 --> 00:30:05.000
Một điều quan trọng cần biết đối với nút đăng nhập là, bạn phải khai báo hành động đăng nhập bằng cách sử dụng công cụ sửa đổi subscriptionStoreSignInAction mới.

00:30:05.000 --> 00:30:11.000
Nếu bạn đặt đăng nhập hoạt động, nút đăng nhập sẽ tự động hiển thị.

00:30:11.000 --> 00:30:20.000
Nút đăng nhập chỉ đơn giản gọi chức năng bạn khai báo với subscriptionStoreSignInAction, vì vậy bạn có thể sử dụng điều này như một tín hiệu để chạy luồng đăng nhập của mình.

00:30:20.000 --> 00:30:23.000
Loại nút cuối cùng để xem xét là các chính sách.

00:30:23.000 --> 00:30:33.000
Bạn có thể muốn hiển thị các liên kết đến các điều khoản dịch vụ và chính sách bảo mật cùng với ưu đãi đăng ký của mình và SubscriptionStoreView giúp điều này thực sự dễ dàng.

00:30:33.000 --> 00:30:36.000
Thông thường các nút chính sách được ẩn theo mặc định.

00:30:36.000 --> 00:30:43.000
Nếu bạn hiển thị chúng bằng công cụ sửa đổi storeButton, chúng sẽ hiển thị phía trên các điều khiển đăng ký trên iOS và Mac.

00:30:43.000 --> 00:30:50.000
Vì các nút này hiển thị phía trên nền vùng chứa của bạn, kiểu mặc định có thể không dễ đọc so với nền của bạn.

00:30:50.000 --> 00:31:00.000
Sử dụng subscriptionStorePolicyForegroundStyle để đặt kiểu hình dạng để sử dụng cho các nút chính sách dễ đọc trên nền của bạn.

00:31:00.000 --> 00:31:11.000
Định cấu hình các nút phụ trợ với công cụ sửa đổi storeButton giúp thêm chức năng mạnh mẽ vào giao diện người dùng bán hàng của bạn chỉ với một vài khai báo đơn giản.

00:31:11.000 --> 00:31:18.000
Trước đó trong phiên, chúng tôi đã định cấu hình phong cách của Chế độ xem Cửa hàng Đăng ký để phù hợp với giao diện của Backyard Birds.

00:31:18.000 --> 00:31:21.000
Bây giờ, tôi muốn xem xét các API kiểu này kỹ hơn.

00:31:21.000 --> 00:31:25.000
Đầu tiên, hãy xem xét việc chọn một kiểu điều khiển.

00:31:25.000 --> 00:31:33.000
Tự động, SubscriptionStoreView chọn kiểu điều khiển dựa trên loại đăng ký bạn đang bán.

00:31:33.000 --> 00:31:40.000
Bạn có thể sử dụng công cụ sửa đổi subscriptionStoreControlStyle mới để chọn kiểu điều khiển để sử dụng cho các gói đăng ký của mình.

00:31:40.000 --> 00:31:46.000
Ví dụ, bạn có thể chọn một nút cho mỗi gói thay vì bộ chọn tự động.

00:31:46.000 --> 00:31:50.000
Hãy nói về các kiểu điều khiển khác nhau.

00:31:50.000 --> 00:31:56.000
Nếu bạn không chỉ định kiểu, Chế độ xem Cửa hàng Đăng ký sẽ tự động chọn một điều khiển.

00:31:56.000 --> 00:32:01.000
Trên iPhone, đây là điều khiển chọn cho các đăng ký với nhiều tùy chọn gói.

00:32:01.000 --> 00:32:05.000
Bạn cũng có thể chọn rõ ràng điều khiển bộ chọn.

00:32:05.000 --> 00:32:15.000
Trên iOS và Mac, có một điều khiển chọn nổi bật, hiển thị các tùy chọn gói đăng ký nổi bật hơn với bóng và vòng chọn.

00:32:15.000 --> 00:32:22.000
Cuối cùng, bạn có thể chọn hiển thị một nút cho mỗi gói đăng ký thay vì điều khiển bộ chọn.

00:32:22.000 --> 00:32:28.000
Về chủ đề các nút đăng ký, có một API mới mà bạn có thể sử dụng để tùy chỉnh nhãn nút.

00:32:28.000 --> 00:32:38.000
Theo mặc định, SubscriptionStoreView hiển thị nút đăng ký có chứa cụm từ hành động và thông tin giá dưới dạng chú thích phía trên nút.

00:32:38.000 --> 00:32:50.000
Bạn có thể thêm công cụ sửa đổi subscriptionStoreButtonLabel để thay đổi nhãn nút thành nhiều dòng, điều này khiến văn bản giá được chứa trong nhãn nút, thay vì dưới dạng chú thích riêng biệt.

00:32:50.000 --> 00:32:56.000
Ngoài việc tùy chỉnh bố cục của nhãn nút, bạn cũng có thể tùy chỉnh nội dung.

00:32:56.000 --> 00:33:03.000
Ví dụ, bạn có thể chọn hiển thị tên hiển thị của đăng ký đã chọn thay vì cụm từ hành động.

00:33:03.000 --> 00:33:12.000
Bạn thậm chí có thể soạn một giá trị nhãn nút với cả bố cục và nội dung bằng cách xâu chuỗi các thành phần lại với nhau, như thế này.

00:33:12.000 --> 00:33:21.000
Vì các nút điều khiển bao gồm các nút đăng ký giống như các nút chọn, bạn cũng có thể sử dụng cùng một công cụ sửa đổi để tùy chỉnh các nút này.

00:33:21.000 --> 00:33:25.000
Ví dụ, bạn có thể chọn chỉ hiển thị giá trên nhãn.

00:33:25.000 --> 00:33:30.000
Điều này rất hữu ích khi các gói của bạn đều là cùng một dịch vụ, nhưng với các mức giá khác nhau.

00:33:30.000 --> 00:33:38.000
Các gói đăng ký khác nhau sử dụng tên hiển thị và mô tả bạn đã thiết lập trong App Store Connect để xây dựng các điều khiển.

00:33:38.000 --> 00:33:44.000
Để làm cho các điều khiển này thú vị hơn, bạn có thể chọn thêm chế độ xem trang trí cho từng kế hoạch khác nhau.

00:33:44.000 --> 00:33:51.000
Để thêm chế độ xem trang trí, chỉ cần thêm công cụ sửa đổi subscriptionStoreControlIcon vào Cửa hàng Đăng ký.

00:33:51.000 --> 00:33:54.000
Công cụ sửa đổi có trình tạo chế độ xem.

00:33:54.000 --> 00:34:00.000
Nó cung cấp cho trình tạo chế độ xem cả giá trị Sản phẩm và giá trị Thông tin đăng ký.

00:34:00.000 --> 00:34:06.000
Sử dụng các thông số này, bạn có thể cung cấp một chế độ xem khác nhau cho mỗi kế hoạch.

00:34:06.000 --> 00:34:11.000
Những biểu tượng này cũng hoạt động khi bạn sử dụng kiểu điều khiển nút cho các gói đăng ký của mình.

00:34:11.000 --> 00:34:16.000
Bây giờ, chúng ta hãy xem xét kỹ hơn một chút về việc thêm nội dung nền vào Chế độ xem Cửa hàng Đăng ký.

00:34:16.000 --> 00:34:26.000
Để tóm tắt lại từ trước đó, bạn có thể thêm nền vùng chứa vào Cửa hàng đăng ký bằng cách sửa đổi nội dung tiếp thị của mình bằng công cụ sửa đổi containerBackground.

00:34:26.000 --> 00:34:34.000
Trong trường hợp này, chúng tôi đang cung cấp một gradient màu nhấn của chúng tôi cho nền và chọn đặt nó trong Cửa hàng Đăng ký.

00:34:34.000 --> 00:34:41.000
Bạn có thể tìm hiểu thêm về containerBackground API mới trong phiên "Có gì mới trong SwiftUI."

00:34:41.000 --> 00:34:45.000
Có một vài vị trí nền khác nhau mà bạn có thể sử dụng cho Cửa hàng Đăng ký.

00:34:45.000 --> 00:34:51.000
Nếu bạn sử dụng vị trí Cửa hàng Đăng ký, nó sẽ chọn vị trí tự động dựa trên ngữ cảnh.

00:34:51.000 --> 00:34:58.000
Trên iOS và Mac, bạn có thể chỉ định rõ ràng rằng bạn muốn nền của mình được đặt trong Tiêu đề của Cửa hàng Đăng ký.

00:34:58.000 --> 00:35:02.000
Vị trí này đứng sau nội dung tiếp thị của bạn.

00:35:02.000 --> 00:35:09.000
Ngoài ra còn có vị trí Chiều cao đầy đủ, đặt nền phía sau chiều cao đầy đủ của Chế độ xem Cửa hàng Đăng ký.

00:35:09.000 --> 00:35:18.000
Trước đó trong phiên họp, chúng tôi đã thảo luận về cách sử dụng API như nhiệm vụ trạng thái đăng ký để tránh trình bày tờ Get Backyard Birds Pass của chúng tôi.

00:35:18.000 --> 00:35:29.000
Tuy nhiên, có một trường hợp khi chúng tôi có thể muốn hiển thị Chế độ xem Cửa hàng Đăng ký cho những người đăng ký hiện tại và đó là lúc chúng tôi muốn khuyến khích người đăng ký nâng cấp lên gói cao cấp.

00:35:29.000 --> 00:35:41.000
Khi chúng tôi phát hiện ra một thuê bao hiện đang đăng ký gói có mức dịch vụ thấp hơn phí bảo hiểm, chúng tôi có thể trình bày bảng nâng cấp bằng cách chuyển nâng cấp làm tham số visibleRelationships.

00:35:41.000 --> 00:35:48.000
Đây có thể là bất kỳ sự kết hợp nào của các mối quan hệ đăng ký mà chúng tôi muốn và nó chỉ có hiệu lực khi ai đó hiện đang đăng ký.

00:35:48.000 --> 00:35:58.000
Sau đó, để làm cho ưu đãi hiệu quả hơn, chúng tôi có thể cung cấp một cái nhìn khác cho nội dung tiếp thị để giải thích lợi ích của gói cao cấp.

00:35:58.000 --> 00:36:07.000
Bạn có thể sử dụng subscriptionStatusTask để theo dõi mức độ dịch vụ của người đăng ký và sau đó sử dụng thông tin này để biết ưu đãi nào sẽ trình bày cho khách hàng.

00:36:07.000 --> 00:36:10.000
Đó là tất cả những gì tôi phải đề cập hôm nay.

00:36:10.000 --> 00:36:16.000
Khi bạn bắt đầu thêm giao dịch mua trong ứng dụng vào ứng dụng của mình, hãy khai báo StoreView để bắt đầu và chạy nhanh chóng.

00:36:16.000 --> 00:36:20.000
Nếu bạn muốn một bố cục tùy chỉnh hơn, hãy thử ProductView.

00:36:20.000 --> 00:36:26.000
Đối với đăng ký của bạn, bạn có thể khai báo SubscriptionStoreView để xây dựng các ưu đãi hấp dẫn.

00:36:26.000 --> 00:36:34.000
Và khi bạn đã sẵn sàng đưa mọi thứ lên một tầm cao mới, hãy thử các công cụ sửa đổi chế độ xem mới và các API khác để thực sự biến điều này thành của riêng bạn.

00:36:34.000 --> 00:36:46.000
Nếu bạn không thể có đủ StoreKit và SwiftUI, hãy xem các phiên; "Có gì mới trong StoreKit 2 và Kiểm tra StoreKit trong Xcode" và "Có gì mới trong SwiftUI" tiếp theo.

00:36:46.000 --> 00:36:50.000
Cảm ơn vì đã tham gia cùng tôi hôm nay để tìm hiểu về các API StoreKit mới cho SwiftUI.

00:36:50.000 --> 00:36:52.000
Mã hóa vui vẻ!

00:36:52.000 --> 23:59:59.000
.

