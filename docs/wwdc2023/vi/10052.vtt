WEBVTT

00:00:00.000 --> 00:00:10.000
♪ ♪

00:00:10.000 --> 00:00:12.000
Adam: Xin chào, tôi là Adam.

00:00:12.000 --> 00:00:18.000
Trong video này, tôi sẽ đề cập đến cách ứng dụng của bạn có thể giúp mọi người quản lý thời gian của họ với Lịch và EventKit.

00:00:18.000 --> 00:00:26.000
Đầu tiên, tôi sẽ xem xét một số cách mà các ứng dụng có thể tích hợp với Lịch và đưa ra cái nhìn tổng quan về các khuôn khổ liên quan.

00:00:26.000 --> 00:00:41.000
Sau đó, tôi sẽ xem qua một số ví dụ cụ thể về cách sử dụng các khuôn khổ này để triển khai các tính năng phổ biến, như thêm sự kiện, tìm nạp các sự kiện với toàn quyền truy cập và triển khai tiện ích mở rộng hội nghị ảo.

00:00:41.000 --> 00:00:48.000
Mọi người dựa vào lịch của họ để theo dõi thời gian và kế hoạch cho tương lai của họ, nhưng Lịch không chỉ là một ứng dụng.

00:00:48.000 --> 00:00:58.000
Có những vai trò khác nhau mà các ứng dụng có thể lấp đầy khi tích hợp với Lịch và khi kết hợp với nhau, những vai trò khác nhau này cung cấp trải nghiệm Lịch phong phú hơn.

00:00:58.000 --> 00:01:04.000
Một số ứng dụng hỗ trợ đặt chỗ, mua vé hoặc sắp xếp các cuộc gặp gỡ.

00:01:04.000 --> 00:01:07.000
Họ tham gia bằng cách thêm các sự kiện.

00:01:07.000 --> 00:01:15.000
Một số ứng dụng tham gia bằng cách hiển thị các sự kiện, có thể cho tiện ích lịch tùy chỉnh hoặc kế hoạch.

00:01:15.000 --> 00:01:18.000
Các ứng dụng khác đóng góp theo cả hai hướng.

00:01:18.000 --> 00:01:24.000
Họ giúp mọi người quản lý lịch trình của họ bằng cách xem và chỉnh sửa các sự kiện.

00:01:24.000 --> 00:01:29.000
Các ứng dụng hỗ trợ cuộc gọi thoại hoặc video cũng có thể tham gia.

00:01:29.000 --> 00:01:39.000
Tiện ích mở rộng hội nghị ảo không chỉ cải thiện trải nghiệm trong ứng dụng Lịch mà còn cung cấp lối tắt quay lại ứng dụng của bạn.

00:01:39.000 --> 00:01:44.000
Tất cả những thứ này khớp với nhau để cung cấp trải nghiệm gắn kết để quản lý thời gian.

00:01:44.000 --> 00:01:51.000
Sau đó, tôi sẽ xem qua một số ví dụ cụ thể để bắt đầu trong từng lĩnh vực này.

00:01:51.000 --> 00:01:56.000
Có hai khuôn khổ mà bạn có thể sử dụng để tích hợp với Lịch.

00:01:56.000 --> 00:02:00.000
Khung EventKit được sử dụng để làm việc trực tiếp với dữ liệu lịch.

00:02:00.000 --> 00:02:09.000
EventKitUI là một khung iOS và Mac Catalyst cung cấp bộ điều khiển chế độ xem để hiển thị giao diện người dùng lịch trong ứng dụng của bạn.

00:02:09.000 --> 00:02:13.000
Chúng ta hãy xem xét kỹ hơn từng...

00:02:13.000 --> 00:02:17.000
Bắt đầu với một số loại cơ bản trong EventKit.

00:02:17.000 --> 00:02:22.000
EKEventStore là đầu mối liên hệ chính cho dữ liệu lịch của bạn.

00:02:22.000 --> 00:02:27.000
Bạn sử dụng một cửa hàng sự kiện để yêu cầu quyền truy cập và để tìm nạp hoặc lưu.

00:02:27.000 --> 00:02:31.000
Bạn chỉ nên có một trong những thứ này cho đơn đăng ký của mình.

00:02:31.000 --> 00:02:40.000
Lớp EKEvent đại diện cho một sự kiện cụ thể và nó có các thuộc tính như tiêu đề, ngày bắt đầu, ngày kết thúc và địa điểm.

00:02:40.000 --> 00:02:46.000
Mỗi sự kiện thuộc về một lịch, được đại diện bởi lớp EKCalendar.

00:02:46.000 --> 00:02:52.000
Lịch có tiêu đề và màu sắc, có thể hữu ích cho việc tô màu các sự kiện.

00:02:52.000 --> 00:02:58.000
Cuối cùng, mỗi tài khoản lịch được đại diện bởi một EKSource, là một tập hợp các lịch.

00:02:58.000 --> 00:03:04.000
Các nguồn rất hữu ích cho việc nhóm lịch trong giao diện người dùng của bạn.

00:03:04.000 --> 00:03:08.000
EventKit là một khuôn khổ nền tảng để tương tác với dữ liệu lịch.

00:03:08.000 --> 00:03:15.000
EventKitUI được xây dựng dựa trên EventKit để cung cấp một số chế độ xem tích hợp hữu ích.

00:03:15.000 --> 00:03:19.000
Có ba bộ điều khiển chế độ xem được cung cấp bởi EventKitUI.

00:03:19.000 --> 00:03:24.000
EKEventEditViewController hiển thị một trình chỉnh sửa sự kiện.

00:03:24.000 --> 00:03:30.000
Sử dụng cái này để thêm một sự kiện mới hoặc thay đổi một sự kiện hiện có.

00:03:30.000 --> 00:03:34.000
EKEventViewController hiển thị chi tiết sự kiện.

00:03:34.000 --> 00:03:39.000
Sử dụng cái này để hiển thị thông tin trong ứng dụng của bạn về một sự kiện hiện có.

00:03:39.000 --> 00:03:46.000
Và EKCalendarChooser hiển thị danh sách lịch và hỗ trợ lựa chọn đơn hoặc nhiều lựa chọn.

00:03:46.000 --> 00:03:55.000
Sử dụng điều này để cho phép mọi người chọn lịch để thêm sự kiện hoặc chọn lịch nào sẽ hiển thị trong ứng dụng của bạn.

00:03:55.000 --> 00:04:02.000
Lịch là riêng tư, vì vậy hệ thống ngăn các ứng dụng đọc hoặc ghi các sự kiện Lịch mà không được phép.

00:04:02.000 --> 00:04:12.000
Có ba cấp độ truy cập mà một ứng dụng có thể có cho Lịch: Không có quyền truy cập, quyền truy cập chỉ ghi hoặc quyền truy cập đầy đủ.

00:04:12.000 --> 00:04:19.000
Các ứng dụng không có quyền truy cập lịch có thể thêm các sự kiện bằng cách sử dụng EventKitUI hoặc Siri Event Suggestions.

00:04:19.000 --> 00:04:25.000
Các ứng dụng có quyền truy cập chỉ ghi có thể thêm các sự kiện trực tiếp bằng EventKit.

00:04:25.000 --> 00:04:36.000
Và các ứng dụng có toàn quyền truy cập có thể tìm nạp hoặc sửa đổi các sự kiện hiện có, truy cập lịch hiện có và tạo lịch mới.

00:04:36.000 --> 00:04:42.000
Một trong những cách phổ biến nhất để tích hợp với Lịch là thêm các sự kiện mới.

00:04:42.000 --> 00:04:46.000
Các sự kiện có thể được thêm vào lịch theo một vài cách khác nhau.

00:04:46.000 --> 00:04:51.000
Sử dụng EventKitUI hoặc Siri Event Suggestions để thêm một sự kiện tại một thời điểm.

00:04:51.000 --> 00:04:56.000
Hoặc, để lưu trực tiếp các sự kiện, hãy sử dụng EventKit.

00:04:56.000 --> 00:05:02.000
Cách đơn giản nhất để thêm một sự kiện vào lịch là để EventKitUI thực hiện hầu hết công việc.

00:05:02.000 --> 00:05:08.000
Trình bày một EKEventEditViewController để hiển thị một biên tập viên với các chi tiết sự kiện được điền đầy đủ.

00:05:08.000 --> 00:05:15.000
Điều này cho mọi người cơ hội chọn lịch hoặc thực hiện các thay đổi khác trước khi quyết định có lưu sự kiện hay không.

00:05:15.000 --> 00:05:25.000
Trong iOS 17, giao diện người dùng này chạy trong một quy trình riêng biệt, có nghĩa là bạn không cần yêu cầu quyền truy cập Lịch.

00:05:25.000 --> 00:05:29.000
Thêm một sự kiện với EventKitUI là một quá trình gồm bốn bước.

00:05:29.000 --> 00:05:32.000
Đầu tiên, tạo một cửa hàng sự kiện.

00:05:32.000 --> 00:05:36.000
Tiếp theo, tạo một sự kiện và điền thông tin chi tiết.

00:05:36.000 --> 00:05:41.000
Sau đó tạo một bộ điều khiển chế độ xem được cấu hình để chỉnh sửa sự kiện.

00:05:41.000 --> 00:05:45.000
Và cuối cùng, trình bày bộ điều khiển chế độ xem.

00:05:45.000 --> 00:05:48.000
Hãy xem qua điều này chi tiết hơn với một số mã.

00:05:48.000 --> 00:05:52.000
Bắt đầu bằng cách tạo một eventStore.

00:05:52.000 --> 00:05:56.000
Tiếp theo, tạo một sự kiện và điền thông tin chi tiết.

00:05:56.000 --> 00:06:00.000
Các chi tiết bạn đặt ở đây sẽ được sử dụng trong giao diện người dùng của trình chỉnh sửa.

00:06:00.000 --> 00:06:12.000
Khi trình chỉnh sửa được trình bày, mọi người sẽ có cơ hội thực hiện các thay đổi, nhưng lý tưởng nhất, họ chỉ cần nhấn vào nút thêm để xác nhận, vì vậy việc điền đúng chi tiết giúp họ tiết kiệm thời gian.

00:06:12.000 --> 00:06:15.000
Mọi sự kiện đều cần một tiêu đề.

00:06:15.000 --> 00:06:22.000
Tiêu đề được sử dụng ở nhiều nơi bao gồm các tiện ích và thông báo, vì vậy hãy giữ nó đơn giản.

00:06:22.000 --> 00:06:26.000
Các thuộc tính quan trọng nhất là ngày bắt đầu và ngày kết thúc.

00:06:26.000 --> 00:06:30.000
Sử dụng các thành phần ngày để tạo ngày bắt đầu.

00:06:30.000 --> 00:06:36.000
Khi bạn đã có ngày bắt đầu, hãy tính ngày kết thúc bằng cách thêm thời lượng.

00:06:36.000 --> 00:06:44.000
Sử dụng các loại Lịch và Thành phần Ngày của Foundation để tính toán ngày, nếu không, bạn sẽ đạt được kết quả đáng ngạc nhiên xung quanh Giờ tiết kiệm ánh sáng ban ngày.

00:06:44.000 --> 00:06:49.000
Ở đây mẫu thêm hai giờ vào ngày bắt đầu của chúng tôi.

00:06:49.000 --> 00:06:54.000
Nếu sự kiện diễn ra trong một múi giờ cụ thể, thì hãy đảm bảo đặt nó.

00:06:54.000 --> 00:06:59.000
Múi giờ mặc định sẽ là múi giờ hệ thống hiện tại.

00:06:59.000 --> 00:07:03.000
Đặt một địa điểm để cho mọi người biết sự kiện diễn ra ở đâu.

00:07:03.000 --> 00:07:12.000
Bao gồm địa chỉ đầy đủ hoặc sử dụng tay cầm MapKit sẽ kích hoạt các tính năng như đề xuất Bản đồ và Cảnh báo Thời gian để lại.

00:07:12.000 --> 00:07:17.000
Cuối cùng, thêm một số ghi chú để cung cấp thêm một số chi tiết.

00:07:17.000 --> 00:07:23.000
Khi bạn đã thiết lập các thuộc tính sự kiện, bước tiếp theo là tạo EKEventEditViewController.

00:07:23.000 --> 00:07:27.000
Chỉ định các thuộc tính của cửa hàng sự kiện và sự kiện.

00:07:27.000 --> 00:07:31.000
Trong trình chỉnh sửa, mọi người có thể thêm sự kiện hoặc hủy.

00:07:31.000 --> 00:07:40.000
Nếu bạn muốn biết liệu họ có thêm sự kiện hay không, thì hãy sử dụng thuộc tính đại diện và triển khai giao thức EKEventEditViewDelegate.

00:07:40.000 --> 00:07:43.000
Cuối cùng, trình bày biên tập viên.

00:07:43.000 --> 00:07:47.000
Tại thời điểm này, sự kiện vẫn chưa có trong lịch.

00:07:47.000 --> 00:07:56.000
Nhấn vào nút Thêm sẽ lưu nó, trong khi nhấn vào hủy sẽ loại bỏ trình chỉnh sửa mà không lưu bất cứ thứ gì.

00:07:56.000 --> 00:08:07.000
Để có ví dụ đầy đủ hơn về việc thêm các sự kiện với EventKitUI, hãy xem mục tiêu "DropInLessons" trong mã mẫu "Truy cập Lịch bằng EventKit và EventKitUI".

00:08:07.000 --> 00:08:14.000
Một cách khác để thêm các sự kiện vào lịch là sử dụng Đề xuất Sự kiện Siri để đặt chỗ trong ứng dụng của bạn.

00:08:14.000 --> 00:08:18.000
API Đề xuất Sự kiện Siri là một phần của Khung Ý định.

00:08:18.000 --> 00:08:24.000
Nó không yêu cầu nhắc nhở truy cập Lịch và nó không hiển thị bất kỳ giao diện người dùng nào trong ứng dụng của bạn.

00:08:24.000 --> 00:08:29.000
Thay vào đó, những sự kiện này sẽ xuất hiện trong hộp thư đến Lịch như một lời mời.

00:08:29.000 --> 00:08:34.000
Sau đó chúng có thể được thêm vào lịch hoặc bỏ qua.

00:08:34.000 --> 00:08:47.000
Đề xuất sự kiện Siri hỗ trợ đặt chỗ cho nhà hàng hoặc khách sạn, đặt chỗ du lịch như chuyến bay hoặc xe hơi cho thuê và các sự kiện có vé như buổi hòa nhạc hoặc sự kiện thể thao.

00:08:47.000 --> 00:08:53.000
Nếu đặt chỗ sau đó bị hủy hoặc sửa đổi, các sự kiện có thể được cập nhật.

00:08:53.000 --> 00:08:58.000
Sử dụng Siri Event Suggestions API là một quá trình gồm bốn bước.

00:08:58.000 --> 00:09:02.000
Đầu tiên, tạo một INReservation.

00:09:02.000 --> 00:09:07.000
Sau đó, gói đặt chỗ trong một ý định và phản hồi.

00:09:07.000 --> 00:09:10.000
Tiếp theo, tạo một INInteraction.

00:09:10.000 --> 00:09:14.000
Cuối cùng, quyên góp sự tương tác cho hệ thống.

00:09:14.000 --> 00:09:17.000
Hãy đi sâu vào một số mã mẫu.

00:09:17.000 --> 00:09:23.000
Đặt chỗ yêu cầu một tài liệu tham khảo duy nhất mà hệ thống sẽ sử dụng để xác định nó.

00:09:23.000 --> 00:09:32.000
Tạo tham chiếu đó bằng cách tạo một phiên bản của INSpeakableString với một mã định danh từ vựng duy nhất và một cụm từ được nói.

00:09:32.000 --> 00:09:37.000
Cụm từ này có thể được sử dụng để chỉ đặt chỗ này khi nói chuyện với Siri.

00:09:37.000 --> 00:09:45.000
Sử dụng INDateComponentsRange để đặt thời gian bắt đầu và kết thúc đặt chỗ.

00:09:45.000 --> 00:09:51.000
Cung cấp cho sự kiện một địa điểm bằng cách sử dụng loại CLPlacemark.

00:09:51.000 --> 00:09:57.000
Sau đó, kết hợp tất cả lại với nhau bằng cách tạo một thể hiện của một trong các lớp con của INReservation.

00:09:57.000 --> 00:10:03.000
Để đặt chỗ nhà hàng, hãy sử dụng INRestaurantReservation.

00:10:03.000 --> 00:10:10.000
Trình khởi tạo này có thêm một vài đối số tùy chọn không được hiển thị và mỗi lớp con có các tùy chọn cụ thể riêng.

00:10:10.000 --> 00:10:15.000
Kiểm tra tài liệu để tìm hiểu thêm.

00:10:15.000 --> 00:10:22.000
Bước tiếp theo là tạo một INGetReservationDetailsIntent với tham chiếu đặt chỗ.

00:10:22.000 --> 00:10:31.000
Sau đó tạo một INGetReservationDetailsIntentResponse với đối tượng đặt trước.

00:10:31.000 --> 00:10:37.000
Tiếp theo, tạo một INInteraction với ý định và phản hồi.

00:10:37.000 --> 00:10:43.000
Cuối cùng, gọi phương thức quyên góp của tương tác.

00:10:43.000 --> 00:10:49.000
Ví dụ này chỉ làm trầy xước bề mặt của những gì có thể được thực hiện với Đề xuất Sự kiện Siri.

00:10:49.000 --> 00:10:59.000
Để biết thêm thông tin về việc tạo Đề xuất Sự kiện Siri, hãy xem video "Tối rộng phạm vi tiếp cận của bạn với Đề xuất Sự kiện Siri" từ WWDC20.

00:10:59.000 --> 00:11:04.000
Đề xuất sự kiện EventKitUI hoặc Siri cung cấp trải nghiệm tốt nhất để thêm các sự kiện.

00:11:04.000 --> 00:11:17.000
Chỉ sử dụng quyền truy cập chỉ ghi nếu ứng dụng của bạn cần hiển thị giao diện người dùng chỉnh sửa tùy chỉnh, thêm nhiều sự kiện cùng một lúc hoặc thêm sự kiện vào lịch mà không cần người dùng tương tác.

00:11:17.000 --> 00:11:29.000
Để yêu cầu quyền truy cập chỉ ghi, hãy bao gồm khóa NSCalendarsWriteOnlyAccess UsageDescription trong Info.plist của bạn để giải thích lý do tại sao ứng dụng của bạn cần truy cập.

00:11:29.000 --> 00:11:32.000
Chuỗi này sẽ được hiển thị trong lời nhắc yêu cầu.

00:11:32.000 --> 00:11:39.000
Đây là lời nhắc cho ứng dụng mẫu của chúng tôi: "Lưu các bài học lặp lại vào lịch mà bạn chọn."

00:11:39.000 --> 00:11:43.000
Truy cập chỉ ghi cũng có một số hạn chế.

00:11:43.000 --> 00:11:47.000
Đối với một người, mọi người có thể chọn không cho phép truy cập.

00:11:47.000 --> 00:11:57.000
Nếu quyền truy cập được cấp, thì ứng dụng vẫn không thể đọc bất kỳ sự kiện hiện có nào từ lịch, bao gồm các sự kiện được thêm vào bởi cùng một ứng dụng.

00:11:57.000 --> 00:12:02.000
Ứng dụng cũng không thể đọc danh sách lịch hoặc tạo lịch mới.

00:12:02.000 --> 00:12:06.000
Quyền truy cập chỉ ghi là mới trong iOS 17 và macOS Sonoma.

00:12:06.000 --> 00:12:16.000
Để tìm hiểu thêm về cách điều này ảnh hưởng đến các ứng dụng hiện có, hãy xem video "Có gì mới trong Quyền riêng tư".

00:12:16.000 --> 00:12:22.000
Thêm một sự kiện mới với quyền truy cập chỉ ghi sẽ trông tương tự như thêm một sự kiện mới bằng EventKitUI.

00:12:22.000 --> 00:12:25.000
Nó bắt đầu giống nhau: Tạo một cửa hàng sự kiện.

00:12:25.000 --> 00:12:29.000
Sau đó yêu cầu quyền truy cập chỉ ghi.

00:12:29.000 --> 00:12:34.000
Nếu quyền truy cập được cấp, hãy tạo một sự kiện mới và điền thông tin chi tiết.

00:12:34.000 --> 00:12:37.000
Cuối cùng, hãy lưu sự kiện.

00:12:37.000 --> 00:12:40.000
Hãy kiểm tra điều đó chi tiết hơn.

00:12:40.000 --> 00:12:43.000
Bắt đầu bằng cách tạo một cửa hàng sự kiện.

00:12:43.000 --> 00:12:50.000
Sau đó, yêu cầu quyền truy cập chỉ ghi bằng cách gọi phương thức requestWriteOnlyAccessToEvents.

00:12:50.000 --> 00:12:54.000
Giá trị trả về cho biết liệu quyền truy cập có được cấp hay không.

00:12:54.000 --> 00:12:59.000
Mọi người có thể chọn từ chối quyền truy cập, vì vậy hãy đảm bảo xử lý điều đó một cách duyên dáng.

00:12:59.000 --> 00:13:11.000
Yêu cầu truy cập rất có thể sẽ được chấp thuận khi mọi người hiểu tại sao ứng dụng của bạn cần quyền truy cập, vì vậy bạn nên yêu cầu quyền truy cập khi ai đó lần đầu tiên tương tác với một tính năng yêu cầu nó.

00:13:11.000 --> 00:13:15.000
Tiếp theo, tạo một sự kiện và điền thông tin chi tiết.

00:13:15.000 --> 00:13:18.000
Có một sự khác biệt quan trọng khác ở đây.

00:13:18.000 --> 00:13:27.000
Khi sử dụng EventKitUI, các chi tiết bạn điền sẽ hiển thị trong trình chỉnh sửa và mọi thứ không được điền đều có giá trị mặc định.

00:13:27.000 --> 00:13:32.000
Khi lưu một sự kiện trực tiếp bằng EventKit, sẽ không có gì được điền cho bạn.

00:13:32.000 --> 00:13:35.000
Những gì bạn đặt là những gì sẽ được lưu lại.

00:13:35.000 --> 00:13:41.000
Có một số thuộc tính phải được điền vào, nếu không việc lưu sẽ thất bại.

00:13:41.000 --> 00:13:44.000
Một tài sản bắt buộc là lịch.

00:13:44.000 --> 00:13:52.000
Sử dụng thuộc tính defaultCalendarForNewEvents của cửa hàng sự kiện để sử dụng lịch được định cấu hình làm mặc định trong cài đặt.

00:13:52.000 --> 00:13:58.000
Các thuộc tính bắt buộc khác là tiêu đề, ngày bắt đầu và ngày kết thúc.

00:13:58.000 --> 00:14:05.000
Mọi thứ khác là tùy chọn, nhưng tốt nhất là điền càng nhiều càng tốt.

00:14:05.000 --> 00:14:12.000
Khi các chi tiết được điền vào, hãy lưu sự kiện bằng phương pháp lưu của cửa hàng sự kiện.

00:14:12.000 --> 00:14:23.000
Để xem ví dụ đầy đủ về việc thêm các sự kiện với EventKit, hãy xem mục tiêu "Lặp lại bài học" trong dự án mẫu "Truy cập Lịch bằng EventKit và EventKitUI".

00:14:23.000 --> 00:14:31.000
Các ứng dụng muốn thêm sự kiện vào lịch nên sử dụng EventKitUI, Đề xuất sự kiện Siri hoặc quyền truy cập chỉ ghi.

00:14:31.000 --> 00:14:38.000
Đối với rất ít ứng dụng cần đọc dữ liệu lịch, có toàn quyền truy cập.

00:14:38.000 --> 00:14:48.000
Chỉ yêu cầu quyền truy cập đầy đủ nếu ứng dụng của bạn có tính năng cốt lõi yêu cầu hiển thị, cập nhật hoặc xóa các sự kiện hiện có.

00:14:48.000 --> 00:14:57.000
Để yêu cầu quyền truy cập đầy đủ, hãy bao gồm khóa NSCalendars FullAccessUsageDescription trong Info.plist của bạn.

00:14:57.000 --> 00:15:00.000
Chuỗi này sẽ được hiển thị trong lời nhắc yêu cầu.

00:15:00.000 --> 00:15:07.000
Lịch chứa thông tin nhạy cảm và lời nhắc truy cập đầy đủ mô tả lượng dữ liệu được bao gồm.

00:15:07.000 --> 00:15:12.000
Mọi người cần rất nhiều sự tin tưởng để cho phép một ứng dụng đọc lịch của họ.

00:15:12.000 --> 00:15:17.000
Nếu mọi người chưa tin tưởng ứng dụng của bạn, thì yêu cầu có thể bị từ chối.

00:15:17.000 --> 00:15:28.000
Chỉ yêu cầu quyền truy cập đầy đủ nếu nó cần thiết cho trải nghiệm cốt lõi của ứng dụng của bạn và chỉ yêu cầu tại thời điểm rõ ràng lý do tại sao cần truy cập.

00:15:28.000 --> 00:15:34.000
Nếu ứng dụng của bạn cần quyền truy cập đầy đủ cho một tính năng cốt lõi, thì có lẽ nó sẽ cần tìm nạp các sự kiện.

00:15:34.000 --> 00:15:38.000
Để làm điều này, trước tiên hãy tạo một cửa hàng sự kiện.

00:15:38.000 --> 00:15:41.000
Tiếp theo, yêu cầu quyền truy cập đầy đủ.

00:15:41.000 --> 00:15:44.000
Sau đó, tạo một vị ngữ.

00:15:44.000 --> 00:15:48.000
Và cuối cùng, lấy các sự kiện từ cửa hàng sự kiện.

00:15:48.000 --> 00:15:50.000
Hãy kiểm tra mã cho điều đó.

00:15:50.000 --> 00:15:55.000
Cũng như các ví dụ khác của chúng tôi, hãy bắt đầu bằng cách tạo một cửa hàng sự kiện.

00:15:55.000 --> 00:15:59.000
Các ứng dụng chỉ nên có một cửa hàng sự kiện, vì vậy hãy đảm bảo sử dụng lại cái này.

00:15:59.000 --> 00:16:05.000
Tiếp theo, yêu cầu quyền truy cập đầy đủ bằng cách gọi phương thức requestFullAccessToEvents.

00:16:05.000 --> 00:16:10.000
Điều này sẽ hiển thị lời nhắc và trả về xem quyền truy cập có được cho phép hay không.

00:16:10.000 --> 00:16:15.000
Lời nhắc truy cập đầy đủ sẽ bị từ chối thường xuyên hơn, vì vậy hãy đảm bảo xử lý điều đó.

00:16:15.000 --> 00:16:22.000
Khi bạn có toàn quyền truy cập, hãy tạo một vị ngữ bằng cách gọi phương thức predicateForEvents của cửa hàng sự kiện.

00:16:22.000 --> 00:16:28.000
Vị ngữ mô tả sự kiện nào bạn muốn tìm nạp với phạm vi ngày và danh sách lịch tùy chọn.

00:16:28.000 --> 00:16:32.000
Mã này sử dụng một phạm vi cho tháng hiện tại.

00:16:32.000 --> 00:16:36.000
Sử dụng phạm vi ngắn nhất có thể để có hiệu suất tốt nhất.

00:16:36.000 --> 00:16:42.000
Nếu đối số lịch bị bỏ lại bằng không, kết quả sẽ bao gồm các sự kiện từ tất cả các lịch.

00:16:42.000 --> 00:16:51.000
Cuối cùng, tìm nạp các sự kiện bằng cách chuyển vị ngữ cho phương thức events(matching:) của cửa hàng sự kiện, phương thức này trả về một mảng các sự kiện phù hợp.

00:16:51.000 --> 00:16:57.000
Các sự kiện trong mảng này không nhất thiết phải được sắp xếp theo thứ tự, vì vậy hãy sắp xếp kết quả nếu cần.

00:16:57.000 --> 00:17:10.000
Nếu bạn muốn tìm hiểu ví dụ đầy đủ về việc tìm nạp các sự kiện, hãy xem mục tiêu "Sự kiện hàng tháng" trong dự án mẫu "Truy cập Lịch bằng EventKit và EventKitUI".

00:17:10.000 --> 00:17:17.000
Để hỗ trợ các bản phát hành sớm hơn iOS 17 và macOS Sonoma, hãy thực hiện kiểm tra tính khả dụng trong thời gian chạy.

00:17:17.000 --> 00:17:24.000
Gọi các phương thức requestAccess mới trên iOS 17 và macOS Sonoma và hơn thế nữa.

00:17:24.000 --> 00:17:30.000
Trên các hệ điều hành trước đó, hãy gọi phương thức requestAccess kế thừa.

00:17:30.000 --> 00:17:36.000
Các chuỗi sử dụng bổ sung được yêu cầu trước iOS 17 hoặc macOS Sonoma.

00:17:36.000 --> 00:17:42.000
Bao gồm khóa NSCalendarsUsageDescription để yêu cầu quyền truy cập lịch.

00:17:42.000 --> 00:17:54.000
Các ứng dụng sử dụng EventKitUI cũng cần bao gồm khóa NSContactsUsageDescription vì EventKitUI sẽ yêu cầu quyền truy cập danh bạ cho ứng dụng.

00:17:54.000 --> 00:18:01.000
Nếu một ứng dụng thiếu các chuỗi này khi yêu cầu quyền truy cập, thì nó sẽ gặp sự cố.

00:18:01.000 --> 00:18:10.000
Cho đến nay, chúng tôi đã đề cập đến một số cách để thêm sự kiện và cách tìm nạp sự kiện, nhưng làm việc với các sự kiện không phải là cách duy nhất để tích hợp với Lịch.

00:18:10.000 --> 00:18:19.000
Nếu ứng dụng của bạn hỗ trợ cuộc gọi thoại hoặc video, hãy sử dụng tiện ích mở rộng hội nghị ảo để cho phép mọi người thêm cuộc gọi của bạn trực tiếp vào sự kiện của họ.

00:18:19.000 --> 00:18:23.000
Có hai cách mà các tiện ích mở rộng này được sử dụng.

00:18:23.000 --> 00:18:30.000
Khi thêm một địa điểm vào một sự kiện, các tùy chọn hội nghị ảo tùy chỉnh sẽ xuất hiện trong bộ chọn vị trí.

00:18:30.000 --> 00:18:36.000
Ví dụ này có các tùy chọn được cung cấp bởi các tiện ích mở rộng hội nghị ảo FaceTime và Skype.

00:18:36.000 --> 00:18:41.000
Nhấn vào một trong những thứ này sẽ thêm hội nghị ảo đó vào sự kiện.

00:18:41.000 --> 00:18:48.000
Một sự kiện có hội nghị ảo sẽ hiển thị tùy chọn tham gia tùy chỉnh trong chi tiết sự kiện.

00:18:48.000 --> 00:18:53.000
Tạo một phần mở rộng hội nghị ảo chỉ mất vài bước.

00:18:53.000 --> 00:18:58.000
Đầu tiên, tạo một mục tiêu Mở rộng Hội nghị Ảo mới trong Xcode.

00:18:58.000 --> 00:19:03.000
Sau đó, có hai phương pháp trong giao thức mở rộng để thực hiện.

00:19:03.000 --> 00:19:16.000
Triển khai fetchAvailableRoomTypes để cung cấp các loại phòng có sẵn của bạn, và sau đó triển khai fetchVirtualConference để cung cấp một đối tượng hội nghị ảo cho một loại phòng đã chọn.

00:19:16.000 --> 00:19:18.000
Hãy xem qua một ví dụ.

00:19:18.000 --> 00:19:23.000
Đầu tiên, tạo một mục tiêu mở rộng Hội nghị Ảo trong Xcode.

00:19:23.000 --> 00:19:29.000
Mục tiêu mới sẽ có một lớp con bị bỏ rơi của EKVirtualConferenceProvider.

00:19:29.000 --> 00:19:34.000
Phương pháp đầu tiên để ghi đè là fetchAvailableRoomTypes.

00:19:34.000 --> 00:19:39.000
Các loại phòng được hiển thị trong bộ chọn vị trí.

00:19:39.000 --> 00:19:42.000
Chọn một tiêu đề cho mỗi loại phòng.

00:19:42.000 --> 00:19:47.000
Điều này sẽ được hiển thị trong giao diện người dùng bên cạnh biểu tượng ứng dụng của bạn.

00:19:47.000 --> 00:19:51.000
Cũng chọn một mã định danh duy nhất cho mỗi loại phòng.

00:19:51.000 --> 00:19:58.000
Mã định danh được sử dụng để cho tiện ích mở rộng của bạn biết loại phòng nào đã được chọn.

00:19:58.000 --> 00:20:05.000
Tạo một phiên bản của EKVirtualConferenceRoomTypeDescriptor bằng cách sử dụng tiêu đề và mã định danh.

00:20:05.000 --> 00:20:11.000
Nếu ứng dụng của bạn hỗ trợ nhiều loại phòng, thì hãy tạo một ví dụ cho mỗi loại.

00:20:11.000 --> 00:20:16.000
Cuối cùng, trả lại một loạt các loại phòng của bạn.

00:20:16.000 --> 00:20:20.000
Phương pháp tiếp theo để thực hiện là fetchVirtualConference.

00:20:20.000 --> 00:20:24.000
Điều này được gọi khi một trong các loại phòng được chọn.

00:20:24.000 --> 00:20:29.000
Đối số định danh cho bạn biết phòng nào đã được chọn.

00:20:29.000 --> 00:20:37.000
Các hội nghị ảo có một hoặc nhiều bộ mô tả URL, cho Lịch biết cách tham gia.

00:20:37.000 --> 00:20:45.000
Tạo một EKVirtualConferenceURLDescriptor với URL để mở và một tiêu đề tùy chọn.

00:20:45.000 --> 00:20:51.000
Sử dụng Liên kết chung cho URL của bạn để cho phép ứng dụng của bạn được mở trực tiếp.

00:20:51.000 --> 00:20:55.000
Tiêu đề giúp phân biệt giữa nhiều tùy chọn tham gia.

00:20:55.000 --> 00:21:01.000
Ở đây nó không cần thiết bởi vì chỉ có một cách để tham gia.

00:21:01.000 --> 00:21:05.000
Cung cấp bất kỳ thông tin bổ sung nào trong một chuỗi chi tiết.

00:21:05.000 --> 00:21:12.000
Văn bản này sẽ được bao gồm trong phần hội nghị ảo đặc biệt của giao diện người dùng chi tiết sự kiện.

00:21:12.000 --> 00:21:19.000
Cuối cùng, kết hợp tất cả những điều này lại với nhau để tạo và trả lại một EKVirtualConferenceDescriptor.

00:21:19.000 --> 00:21:23.000
Tiêu đề ở đây giúp phân biệt giữa nhiều loại phòng.

00:21:23.000 --> 00:21:30.000
Ví dụ này chỉ có một loại phòng, vì vậy tiêu đề còn lại là số không.

00:21:30.000 --> 00:21:38.000
Chỉ với hai phương pháp này, ứng dụng của bạn sẽ xuất hiện trong bộ chọn vị trí của ứng dụng Lịch như một tùy chọn cho các hội nghị ảo.

00:21:38.000 --> 00:21:45.000
Bây giờ chúng tôi đã đề cập đến một vài cách khác nhau để tích hợp với Lịch, hãy nghĩ về cách ứng dụng của bạn có thể đóng góp.

00:21:45.000 --> 00:21:51.000
Sử dụng EventKitUI hoặc Siri Event Suggestions để thêm các sự kiện mà không cần yêu cầu quyền truy cập.

00:21:51.000 --> 00:21:58.000
Nếu bạn cần yêu cầu quyền truy cập, hãy yêu cầu quyền truy cập tối thiểu cần thiết và chỉ khi cần thiết.

00:21:58.000 --> 00:22:04.000
Và nếu bạn có ứng dụng cuộc gọi thoại hoặc video, thì hãy triển khai tiện ích mở rộng hội nghị ảo.

00:22:04.000 --> 00:22:07.000
Tôi nóng lòng muốn xem ứng dụng của bạn tích hợp với Lịch như thế nào.

00:22:07.000 --> 00:22:09.000
Cảm ơn vì đã xem.

00:22:09.000 --> 23:59:59.000
♪ ♪

