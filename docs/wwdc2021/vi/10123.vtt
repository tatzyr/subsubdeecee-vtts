WEBVTT

00:00:02.000 --> 00:00:11.000
Chào mừng đến với WWDC.

00:00:11.000 --> 00:00:18.000
Tôi là Christopher Skogen, một kỹ sư trong nhóm Screen Time, và tôi ở đây để nói chuyện với bạn về Screen Time API mới.

00:00:18.000 --> 00:00:23.000
Đã ba năm kể từ khi Apple giới thiệu Screen Time cho iOS.

00:00:23.000 --> 00:00:31.000
Và đó là một bước tiến lớn để cải thiện mối quan hệ của khách hàng và gia đình với các thiết bị của họ.

00:00:31.000 --> 00:00:38.000
Trong ba năm qua, Screen Time đã mang đến một số khả năng mới tuyệt vời cho iPhone, iPad và Mac.

00:00:38.000 --> 00:00:58.000
Screen Time giúp bạn theo dõi tần suất bạn và gia đình bạn sử dụng các ứng dụng và trang web, quản lý thời gian bằng cách đặt giới hạn, chia sẻ việc sử dụng với các thành viên trong gia đình để cung cấp cái nhìn về cách thiết bị của bạn đang được sử dụng và cuối cùng, bạn cũng có thể quản lý con bạn giao tiếp với ai và hơn thế nữa.

00:00:58.000 --> 00:01:05.000
Chúng tôi cũng đã nghe từ nhiều bạn rằng bạn muốn tận dụng một số khả năng này trong các ứng dụng kiểm soát của phụ huynh.

00:01:05.000 --> 00:01:08.000
Vì vậy, chúng tôi đã tạo ra API Thời gian sử dụng thiết bị.

00:01:08.000 --> 00:01:16.000
Nó mang lại chức năng Screen Time cốt lõi cho các ứng dụng của bạn để bạn có thể tạo ra những trải nghiệm mới năng động cho khách hàng của mình.

00:01:16.000 --> 00:01:22.000
Trước hết, API sẽ có sẵn trên iOS và iPadOS 15.

00:01:22.000 --> 00:01:31.000
Đó là mã Swift và SwiftUI 100% để dễ dàng tích hợp vào các ứng dụng Swift hiện đại của bạn.

00:01:31.000 --> 00:01:36.000
Screen Time API được thiết kế và xây dựng với ba nguyên tắc hướng dẫn.

00:01:36.000 --> 00:01:45.000
Đầu tiên, cung cấp một khuôn khổ hiện đại, trên thiết bị để truy cập API trực tiếp vào các hạn chế hiện có.

00:01:45.000 --> 00:01:50.000
Nguyên tắc hướng dẫn thứ hai của chúng tôi là bảo vệ quyền riêng tư của người dùng.

00:01:50.000 --> 00:02:02.000
Vì Screen Time xử lý một số thông tin cá nhân rất nhạy cảm như các ứng dụng bạn đã sử dụng hoặc các trang web bạn đã truy cập, Screen Time luôn thực hiện một cách tiếp cận rất lấy quyền riêng tư làm trung tâm.

00:02:02.000 --> 00:02:12.000
Ví dụ, không có cách nào để bất kỳ ai ngoài gia đình bạn hoặc thậm chí Apple biết bạn đã truy cập trang web nào hoặc bạn sử dụng ứng dụng nào.

00:02:12.000 --> 00:02:21.000
Đối với API mới, chúng tôi tiếp tục cách tiếp cận quyền riêng tư này và dữ liệu sử dụng của khách hàng của bạn sẽ vô hình bên ngoài thiết bị của họ.

00:02:21.000 --> 00:02:33.000
Và cuối cùng, nguyên tắc chỉ đạo thứ ba của chúng tôi là đảm bảo rằng bạn, những nhà phát triển, có thể tạo ra những trải nghiệm kiểm soát năng động mới tuyệt vời của phụ huynh.

00:02:33.000 --> 00:02:39.000
Không phải ngẫu nhiên mà ba nguyên tắc chỉ đạo của chúng tôi đã khiến chúng tôi tạo ra ba khuôn khổ mới.

00:02:39.000 --> 00:02:44.000
Ba khuôn khổ, được kết hợp với nhau, bao gồm API Thời gian sử dụng thiết bị.

00:02:44.000 --> 00:02:47.000
Đầu Tiên, Cài Đặt Được Quản Lý.

00:02:47.000 --> 00:02:54.000
Cài đặt được quản lý cung cấp cho ứng dụng của bạn quyền truy cập trực tiếp vào các hạn chế tương tự có sẵn trong Thời gian sử dụng màn hình.

00:02:54.000 --> 00:02:56.000
Thứ hai, Kiểm soát Gia đình.

00:02:56.000 --> 00:03:01.000
Family Controls thúc đẩy chính sách bảo mật của chúng tôi.

00:03:01.000 --> 00:03:04.000
Và cuối cùng, Hoạt động của Thiết bị.

00:03:04.000 --> 00:03:12.000
Hoạt động thiết bị cho phép bạn vượt ra ngoài Thời gian sử dụng màn hình bằng cách cung cấp cho ứng dụng của bạn những khả năng mới tuyệt vời để chạy mã mà không cần khởi chạy ứng dụng của bạn.

00:03:12.000 --> 00:03:16.000
Chúng ta hãy xem xét kỹ hơn cả ba khuôn khổ.

00:03:16.000 --> 00:03:19.000
Hãy bắt đầu với Cài đặt được quản lý.

00:03:19.000 --> 00:03:30.000
Ứng dụng của bạn cần một cách tốt hơn để hạn chế những gì trẻ có thể làm với thiết bị của chúng và đảm bảo rằng những hạn chế đó vẫn được giữ nguyên cho đến khi cha mẹ hoặc người giám hộ nói khác.

00:03:30.000 --> 00:03:49.000
Với Cài đặt được quản lý, ứng dụng của bạn có thể đặt một số hạn chế, như khóa tài khoản tại chỗ hoặc ngăn chặn thay đổi mật khẩu, lọc lưu lượng truy cập web hoặc che chắn các ứng dụng, giống như Screen Time, nhưng được tùy chỉnh với thương hiệu và chức năng của ứng dụng của bạn.

00:03:49.000 --> 00:03:52.000
Tiếp theo là Kiểm soát Gia đình.

00:03:52.000 --> 00:04:01.000
Bằng cách tận dụng Chia sẻ trong gia đình, Kiểm soát gia đình ngăn chặn quyền truy cập vào API Thời gian sử dụng màn hình mà không cần sự chấp thuận của người giám hộ.

00:04:01.000 --> 00:04:08.000
Một khi ứng dụng của bạn đã được người giám hộ chấp thuận, nó không thể bị xóa khỏi thiết bị mà không có sự chấp thuận của người giám hộ.

00:04:08.000 --> 00:04:14.000
Ngoài ra, Family Controls cung cấp các mã thông báo mờ đục đại diện cho các ứng dụng và trang web.

00:04:14.000 --> 00:04:27.000
Các mã thông báo này được sử dụng trong suốt API Thời gian sử dụng để theo dõi hoặc hạn chế việc sử dụng và đảm bảo rằng không ai ngoài một nhóm Chia sẻ trong gia đình sẽ biết những ứng dụng và trang web nào đang được sử dụng.

00:04:27.000 --> 00:04:30.000
Và cuối cùng, Hoạt động của Thiết bị.

00:04:30.000 --> 00:04:39.000
Khung này cho phép bạn vượt ra ngoài Thời gian sử dụng màn hình bằng cách cung cấp cho ứng dụng của bạn những cách mới để theo dõi việc sử dụng web và ứng dụng và thực thi mã của bạn khi cần thiết.

00:04:39.000 --> 00:04:46.000
Bởi vì ứng dụng của bạn là một ứng dụng kiểm soát của phụ huynh, rất khó có khả năng một đứa trẻ sẽ có lý do để chạy ứng dụng của bạn trên thiết bị của chúng.

00:04:46.000 --> 00:04:50.000
Vậy làm thế nào để bạn thực thi mã của mình để đặt các hạn chế?

00:04:50.000 --> 00:04:55.000
Câu trả lời là lịch trình và sự kiện Hoạt động của Thiết bị.

00:04:55.000 --> 00:05:05.000
Lịch trình Hoạt động của Thiết bị là cửa sổ thời gian gọi tiện ích mở rộng trong ứng dụng của bạn khi bắt đầu và kết thúc cửa sổ thời gian.

00:05:05.000 --> 00:05:15.000
Sự kiện là màn hình sử dụng gọi tiện ích mở rộng của bạn khi người dùng trên thiết bị đạt đến ngưỡng sử dụng trong lịch Hoạt động của Thiết bị.

00:05:15.000 --> 00:05:21.000
Ứng dụng của bạn chỉ đơn giản là khai báo loại sử dụng mà nó quan tâm và khi nào nó quan tâm.

00:05:21.000 --> 00:05:26.000
Kết hợp cả ba khuôn khổ lại với nhau trông như thế này.

00:05:26.000 --> 00:05:34.000
Sau khi ứng dụng của bạn được cài đặt trên cả thiết bị của người giám hộ và trẻ em, người giám hộ sẽ mở ứng dụng trên thiết bị của trẻ.

00:05:34.000 --> 00:05:37.000
Ứng dụng của bạn ủy quyền với Family Controls.

00:05:37.000 --> 00:05:44.000
Sau đó, ứng dụng của bạn trên thiết bị của người giám hộ sẽ chọn cài đặt, hạn chế và quy tắc.

00:05:44.000 --> 00:05:48.000
Ứng dụng của bạn gửi thông tin đó đến thiết bị của trẻ.

00:05:48.000 --> 00:05:54.000
Và sau đó trên thiết bị của trẻ, ứng dụng của bạn tạo Lịch trình và Sự kiện với Hoạt động của Thiết bị.

00:05:54.000 --> 00:06:01.000
Tiện ích mở rộng Hoạt động Thiết bị trong ứng dụng của bạn được gọi khi lịch trình xảy ra hoặc các sự kiện xảy ra.

00:06:01.000 --> 00:06:05.000
Từ tiện ích mở rộng, đặt các hạn chế với Cài đặt được quản lý.

00:06:05.000 --> 00:06:09.000
Đây là thời điểm tốt để giới thiệu Nolan.

00:06:09.000 --> 00:06:17.000
Nolan đang làm việc trên một ứng dụng demo mới tuyệt vời, Bài tập về nhà, và anh ấy sẽ hướng dẫn bạn cách Bài tập về nhà sử dụng API Thời gian sử dụng màn hình.

00:06:17.000 --> 00:06:20.000
Xin chào, tôi là Nolan, một kỹ sư trong nhóm Screen Time.

00:06:20.000 --> 00:06:23.000
Tôi muốn giới thiệu với bạn ứng dụng demo của tôi, Bài tập về nhà.

00:06:23.000 --> 00:06:32.000
Bài tập về nhà khuyến khích những thói quen tốt bằng cách hạn chế quyền truy cập của trẻ vào một số ứng dụng nhất định cho đến khi chúng tích lũy mức sử dụng trong các ứng dụng khác mà người giám hộ muốn chúng sử dụng.

00:06:32.000 --> 00:06:37.000
Để làm cho Bài tập về nhà hoạt động, tôi sẽ sử dụng cả ba khuôn khổ trong API Thời gian sử dụng.

00:06:37.000 --> 00:06:41.000
Đầu tiên, tôi sẽ hướng dẫn bạn yêu cầu ủy quyền cho Kiểm soát Gia đình.

00:06:41.000 --> 00:06:46.000
Tiếp theo, tôi sẽ che chắn các ứng dụng không khuyến khích do người giám hộ lựa chọn theo lịch trình định kỳ.

00:06:46.000 --> 00:06:52.000
Sau đó, tôi sẽ chỉ cho bạn cách loại bỏ những tấm chắn đó sau khi tích lũy đủ mức sử dụng ứng dụng được khuyến khích.

00:06:52.000 --> 00:06:58.000
Cuối cùng, tôi sẽ tùy chỉnh các tấm chắn được sử dụng bởi Homework để phù hợp với thương hiệu và chức năng của ứng dụng.

00:06:58.000 --> 00:07:03.000
Tôi sẽ bắt đầu với việc thiết lập dự án và ủy quyền Kiểm soát Gia đình.

00:07:03.000 --> 00:07:14.000
Để thiết lập dự án Xcode của tôi để bao gồm khả năng Kiểm soát Gia đình, tôi sẽ vào trình chỉnh sửa Dự án, chọn mục tiêu ứng dụng và bên dưới Ký và Khả năng, nhấp vào nút dấu cộng.

00:07:14.000 --> 00:07:19.000
Tôi sẽ tìm kiếm Family Controls để tìm ra khả năng và thêm nó vào dự án của mình.

00:07:19.000 --> 00:07:22.000
Bây giờ khả năng đã được thêm vào, tôi đã sẵn sàng viết mã.

00:07:22.000 --> 00:07:28.000
Điều đầu tiên Bài tập về nhà cần làm là yêu cầu ủy quyền cho Kiểm soát Gia đình.

00:07:28.000 --> 00:07:34.000
Tôi sẽ sử dụng trung tâm ủy quyền được chia sẻ trong khuôn khổ Family Controls để thực hiện yêu cầu này khi ứng dụng của tôi khởi chạy.

00:07:34.000 --> 00:07:37.000
Yêu cầu có thể dẫn đến thành công hoặc thất bại.

00:07:37.000 --> 00:07:43.000
Việc gọi chức năng này sẽ yêu cầu người giám hộ trong gia đình phê duyệt Kiểm soát Gia đình cho Bài tập về nhà.

00:07:43.000 --> 00:07:50.000
Vì ứng dụng của tôi chưa bao giờ chạy trên iPhone này trước đây, requestAuthorization sẽ yêu cầu sự chấp thuận của người giám hộ với một cảnh báo.

00:07:50.000 --> 00:07:57.000
Nhấn vào Cho phép sau đó sẽ nhắc người giám hộ xác thực bằng ID Apple và mật khẩu của họ để tiếp tục.

00:07:57.000 --> 00:08:06.000
Khi người giám hộ đã xác thực thành công, yêu cầu gọiAuthorization sẽ không nhắc lại cảnh báo mà thay vào đó âm thầm trả lại thành công.

00:08:06.000 --> 00:08:14.000
Để ngăn chặn việc lạm dụng, requestAuthorization sẽ trả về lỗi nếu iCloud đã đăng nhập không phải là con sử dụng Chia sẻ trong gia đình.

00:08:14.000 --> 00:08:18.000
Thật dễ dàng để chuẩn bị ứng dụng của bạn để sử dụng API Thời gian sử dụng.

00:08:18.000 --> 00:08:20.000
Cảm ơn, Nolan.

00:08:20.000 --> 00:08:25.000
Chúng tôi vừa thấy ứng dụng demo của mình, Bài tập về nhà, ủy quyền với Kiểm soát gia đình.

00:08:25.000 --> 00:08:30.000
Ủy quyền với Family Controls cũng cấp các sức mạnh ma thuật khác cho ứng dụng của bạn.

00:08:30.000 --> 00:08:37.000
Ví dụ, một khi thiết bị được ủy quyền, người dùng không thể đăng xuất khỏi iCloud nữa.

00:08:37.000 --> 00:08:49.000
Ngoài ra, các bộ lọc nội dung web trên thiết bị được xây dựng với khung Tiện ích mở rộng mạng có thể được đưa vào ứng dụng của bạn và sẽ được cài đặt tự động và không thể xóa được.

00:08:49.000 --> 00:08:54.000
Điều này cung cấp cho ứng dụng của bạn khả năng lọc lưu lượng truy cập web trên thiết bị.

00:08:54.000 --> 00:09:04.000
Một trong những thách thức khi viết ứng dụng kiểm soát của phụ huynh là để mã của bạn chạy trên thiết bị của trẻ khi trẻ có thể sẽ không bao giờ chạy ứng dụng của bạn.

00:09:04.000 --> 00:09:11.000
Đối với API Thời gian sử dụng màn hình, chúng tôi đã tạo ra một cách mới để thực hiện thực thi mã nền với Hoạt động thiết bị.

00:09:11.000 --> 00:09:18.000
Tiện ích mở rộng Hoạt động Thiết bị sẽ là cách chính của bạn để tương tác với phần còn lại của API Thời gian Sử dụng.

00:09:18.000 --> 00:09:29.000
Hãy quay lại Nolan để xem Bài tập về nhà có thể chạy mã như thế nào trên lịch trình lặp lại để hạn chế thiết bị của trẻ bằng cách đặt tấm chắn Thời gian sử dụng trên một số ứng dụng.

00:09:29.000 --> 00:09:31.000
Nolan.

00:09:31.000 --> 00:09:32.000
Cảm ơn, Chris.

00:09:32.000 --> 00:09:38.000
Tiếp theo với Bài tập về nhà là che chắn các ứng dụng mà người giám hộ đã chọn để ngăn cản trong một lịch trình định kỳ.

00:09:38.000 --> 00:09:50.000
Vì tôi không thể tin tưởng vào ứng dụng của mình đang chạy trên thiết bị của trẻ, tôi sẽ sử dụng Lịch hoạt động của thiết bị để đặt giới hạn lá chắn ứng dụng mỗi ngày, ngay cả khi Bài tập về nhà chưa chạy kể từ khi được người giám hộ thiết lập.

00:09:50.000 --> 00:09:55.000
Khi Lịch trình Hoạt động Thiết bị của tôi kích hoạt, Hoạt động Thiết bị sẽ gọi đến một điểm mở rộng mới.

00:09:55.000 --> 00:10:01.000
Bài tập về nhà sẽ bao gồm một phần mở rộng cho điểm mở rộng này, nơi tôi sẽ đặt giới hạn để che chắn các ứng dụng.

00:10:01.000 --> 00:10:08.000
Việc triển khai một tiện ích mở rộng cho điểm mở rộng này yêu cầu bạn phân lớp DeviceActivityMonitor làm lớp nguyên tắc.

00:10:08.000 --> 00:10:14.000
Ở đây, tôi đã ghi đè hai phương thức trong lớp nguyên tắc của tiện ích mở rộng của mình: intervalDidStart và intervalDidEnd.

00:10:14.000 --> 00:10:19.000
Những chức năng này sẽ được gọi lần đầu tiên thiết bị được sử dụng sau khi bắt đầu và kết thúc lịch trình của tôi.

00:10:19.000 --> 00:10:26.000
Tôi sẽ để trống việc triển khai các chức năng này cho đến khi tôi định cấu hình lịch Trình Hoạt động Thiết bị của mình từ ứng dụng chính của Bài tập về nhà.

00:10:26.000 --> 00:10:35.000
Bây giờ tiện ích mở rộng màn hình Hoạt động Thiết bị của tôi được thiết lập từ ứng dụng chính, tôi cần tạo tên Hoạt động Thiết bị và lịch Hoạt động Thiết bị.

00:10:35.000 --> 00:10:39.000
Tên Hoạt động Thiết bị là cách tôi có thể tham chiếu hoạt động từ bên trong tiện ích mở rộng của mình.

00:10:39.000 --> 00:10:45.000
Và lịch trình Hoạt động Thiết bị đại diện cho giới hạn thời gian mà tiện ích mở rộng của tôi sẽ theo dõi hoạt động.

00:10:45.000 --> 00:10:51.000
Ở đây tôi đã đặt tên hoạt động của mình thành "hàng ngày" và tôi đã đặt lịch trình của mình để bắt đầu và kết thúc lúc nửa đêm.

00:10:51.000 --> 00:10:53.000
Tôi cũng sẽ thiết lập lịch trình này để lặp lại.

00:10:53.000 --> 00:11:00.000
Cuối cùng, tôi có thể tạo một trung tâm Hoạt động Thiết bị và gọi startMonitoring với tên hoạt động và lịch trình mà tôi vừa xác định.

00:11:00.000 --> 00:11:09.000
Với một vài dòng mã này, tiện ích mở rộng màn hình Hoạt động Thiết bị của tôi sẽ được gọi với tên hoạt động bất cứ khi nào lịch trình bắt đầu và kết thúc.

00:11:09.000 --> 00:11:13.000
Một thành phần khác để che chắn các ứng dụng là tìm ra những gì người giám hộ muốn ngăn cản.

00:11:13.000 --> 00:11:19.000
Khung Kiểm soát Gia đình có một yếu tố SwiftUI chỉ dành cho công việc: Bộ chọn hoạt động gia đình.

00:11:19.000 --> 00:11:28.000
Từ giao diện người dùng của ứng dụng chính, tôi có thể hiển thị bộ chọn hoạt động gia đình và cho phép người giám hộ chọn từ danh sách các ứng dụng, trang web và danh mục được gia đình sử dụng.

00:11:28.000 --> 00:11:37.000
Khi người giám hộ đã thực hiện lựa chọn của họ, Bài tập về nhà có thể sử dụng các mã thông báo mờ đục do bộ chọn trả về để đặt các hạn chế đối với các ứng dụng, trang web và danh mục mà mỗi mã thông báo đại diện.

00:11:37.000 --> 00:11:45.000
Ở đây, tôi đã thêm công cụ sửa đổi chế độ xem familyActivityPicker vào một Nút trong ứng dụng và tôi đã liên kết tham số lựa chọn của bộ chọn với một thuộc tính trong mô hình của ứng dụng.

00:11:45.000 --> 00:11:51.000
Điều này sẽ cập nhật mô hình của tôi bất cứ khi nào lựa chọn của người giám hộ được cập nhật trong giao diện người dùng.

00:11:51.000 --> 00:11:59.000
Bây giờ tôi đã lưu trữ lựa chọn ứng dụng không khuyến khích của người giám hộ trong mô hình ứng dụng của mình, tôi sẽ chuyển trở lại tiện ích mở rộng Giám sát Hoạt động Thiết bị.

00:11:59.000 --> 00:12:06.000
Đầu tiên, tôi sẽ nhập mô-đun Cài đặt được quản lý để có quyền truy cập vào hạn chế lá chắn ứng dụng.

00:12:06.000 --> 00:12:14.000
Sau đó, trong intervalDidStart, tôi có thể kéo lựa chọn ra khỏi mô hình của ứng dụng và định cấu hình hạn chế lá chắn ứng dụng cho phù hợp.

00:12:14.000 --> 00:12:20.000
Và trong intervalDidEnd, tôi có thể loại bỏ hạn chế bằng cách đặt nó thành số không.

00:12:20.000 --> 00:12:26.000
Với những sửa đổi đơn giản này, Bài tập về nhà sẽ bảo vệ người giám hộ đã chọn các ứng dụng không khuyến khích mỗi ngày từ nửa đêm đến nửa đêm.

00:12:26.000 --> 00:12:28.000
Quay lại với bạn, Chris.

00:12:28.000 --> 00:12:30.000
Cảm ơn, Nolan.

00:12:30.000 --> 00:12:34.000
Che chắn không phải là hạn chế duy nhất có sẵn trong Cài đặt được quản lý.

00:12:34.000 --> 00:12:41.000
Chúng tôi cũng có thể chọn đặt bất kỳ số lượng hạn chế nào ở đầu hoặc cuối Lịch hoạt động của thiết bị.

00:12:41.000 --> 00:12:53.000
Ví dụ, ứng dụng của bạn có thể chọn ngăn chặn việc tạo hoặc xóa tài khoản, chặn hoàn toàn các ứng dụng và trang web hoặc từ chối nội dung phương tiện theo độ tuổi.

00:12:53.000 --> 00:13:03.000
Nói về các hạn chế phương tiện truyền thông, Cài đặt được quản lý cũng cung cấp một API cho phép bất kỳ ứng dụng nào đọc các hạn chế đối với nội dung Phim và TV.

00:13:03.000 --> 00:13:07.000
Không cần ủy quyền Kiểm soát Gia đình.

00:13:07.000 --> 00:13:15.000
Các chức năng này lý tưởng cho bất kỳ ứng dụng đa phương tiện nào để kiểm tra xem một thiết bị có nên giới hạn nội dung được trình bày cho người dùng hay không.

00:13:15.000 --> 00:13:25.000
Trong ứng dụng demo Bài tập về nhà, các hạn chế được đặt vào nửa đêm mỗi ngày, nhưng nếu bạn muốn thay đổi các hạn chế dựa trên việc sử dụng ứng dụng hoặc web thì sao?

00:13:25.000 --> 00:13:32.000
Hoạt động thiết bị có một tính năng khác cho phép ứng dụng của bạn thực hiện điều đó: Các sự kiện Hoạt động thiết bị.

00:13:32.000 --> 00:13:41.000
Các sự kiện này được cấu hình với cùng một mã thông báo mà bạn đã thấy từ trình chọn hoạt động gia đình và cho phép bạn thực thi mã khi đạt đến giới hạn sử dụng.

00:13:41.000 --> 00:13:47.000
Những sự kiện này được đăng ký cùng với lịch trình mà Nolan đã cho chúng ta thấy trong phân đoạn cuối cùng.

00:13:47.000 --> 00:13:51.000
Bây giờ chúng ta hãy đi kiểm tra với Nolan và xem những sự kiện này hoạt động như thế nào.

00:13:51.000 --> 00:14:02.000
Tôi muốn loại bỏ hạn chế lá chắn ứng dụng không chỉ khi lịch trình Bài tập về nhà kết thúc mà còn khi đứa trẻ tích lũy đủ mức sử dụng cho một bộ ứng dụng được khuyến khích do người giám hộ chọn.

00:14:02.000 --> 00:14:13.000
Để làm điều đó, tôi sẽ cần theo dõi việc sử dụng các ứng dụng được khuyến khích này bằng cách định cấu hình Hoạt động Thiết bị để gọi thêm vào tiện ích mở rộng màn hình Hoạt động Thiết bị của tôi khi đạt ngưỡng sử dụng.

00:14:13.000 --> 00:14:17.000
Ở đây, tôi sẽ xác định tên sự kiện Hoạt động Thiết bị để được "khuyến khích".

00:14:17.000 --> 00:14:21.000
Tên này là cách tôi có thể tham khảo sự kiện từ bên trong phần mở rộng của mình.

00:14:21.000 --> 00:14:28.000
Và sau đó tôi sẽ xác định sự kiện được khuyến khích của mình để bao gồm tập hợp các ứng dụng được khuyến khích do người giám hộ chọn và ngưỡng sử dụng mong muốn.

00:14:28.000 --> 00:14:35.000
Cuối cùng, tôi sẽ cập nhật cuộc gọi để bắt đầu Giám sát để bao gồm sự kiện tôi vừa xác định.

00:14:35.000 --> 00:14:46.000
Bây giờ tôi đang theo dõi các sự kiện Hoạt động Thiết bị từ ứng dụng chính, tiện ích mở rộng giám sát Hoạt động Thiết bị của tôi sẽ được gọi bất cứ khi nào bất kỳ sự kiện nào trong số đó đáp ứng ngưỡng sử dụng của chúng.

00:14:46.000 --> 00:14:57.000
Chức năng eventDidReachThreshold sẽ được gọi với Tên Sự kiện Hoạt động Thiết bị và Tên Hoạt động Thiết bị để xác định sự kiện nào được kích hoạt cho hoạt động đã lên lịch nào.

00:14:57.000 --> 00:15:03.000
Trong Bài tập về nhà, tôi muốn đặt giới hạn lá chắn ứng dụng thành số không khi phần mở rộng được thông báo cho sự kiện này.

00:15:03.000 --> 00:15:08.000
Đặt giới hạn này thành nil sẽ xóa lá chắn khỏi bất kỳ ứng dụng nào được che chắn trước đó.

00:15:08.000 --> 00:15:09.000
Quay lại với Chris.

00:15:09.000 --> 00:15:15.000
Trong phần trước, các ứng dụng không khuyến khích được che chắn bằng lá chắn Thời gian sử dụng mặc định.

00:15:15.000 --> 00:15:20.000
Nhưng bạn có thể sẽ muốn có được thương hiệu và phong cách của riêng mình trong những tấm khiên này.

00:15:20.000 --> 00:15:24.000
Bạn cũng có thể sẽ muốn có trình xử lý hành động của riêng mình cho các nút của lá chắn.

00:15:24.000 --> 00:15:27.000
Chúng tôi có các công cụ cho cả hai.

00:15:27.000 --> 00:15:33.000
Lá chắn tùy chỉnh cho phép bạn tạo ra trải nghiệm thương hiệu độc đáo.

00:15:33.000 --> 00:15:40.000
Để tùy chỉnh các tấm chắn, bạn sẽ cần triển khai hai điểm mở rộng mới được xác định trong Cài đặt được quản lý.

00:15:40.000 --> 00:15:51.000
Một điểm mở rộng cho phép bạn tùy chỉnh giao diện của tấm chắn bằng cách thay đổi chất liệu nền, tiêu đề, biểu tượng và giao diện của các nút.

00:15:51.000 --> 00:15:56.000
Và một điểm mở rộng khác cho phép bạn tạo trình xử lý nút tùy chỉnh.

00:15:56.000 --> 00:16:02.000
Hãy quay lại Nolan và xem bạn sẽ tùy chỉnh lá chắn của mình như thế nào.

00:16:02.000 --> 00:16:10.000
Để định cấu hình giao diện của các lá chắn tùy chỉnh cho Bài tập về nhà, tôi cần bắt đầu bằng cách phân loại ShieldConfigurationProvider làm lớp chính của tiện ích mở rộng.

00:16:10.000 --> 00:16:14.000
Cấu hình là chức năng duy nhất bạn cần ghi đè ở đây.

00:16:14.000 --> 00:16:21.000
Hàm này được chuyển một tham chiếu đến ứng dụng hiện đang được che chắn và dự kiến sẽ trả về cấu trúc ShieldConfiguration.

00:16:21.000 --> 00:16:34.000
Cấu trúc ShieldConfiguration cho phép bạn xác định hiệu ứng nền, màu nền, biểu tượng, tiêu đề, phụ đề, nhãn nút chính, màu nền nút chính và nhãn nút phụ.

00:16:34.000 --> 00:16:37.000
Chà, đó là rất nhiều tùy chỉnh.

00:16:37.000 --> 00:16:47.000
Khi cấu trúc này được cấu hình và trả về bởi tiện ích mở rộng nhà cung cấp cấu hình lá chắn của tôi, hệ điều hành sẽ tự động hiển thị các tùy chỉnh này trên bất kỳ ứng dụng nào được bảo vệ bởi Bài tập về nhà.

00:16:47.000 --> 00:16:57.000
Bây giờ chúng tôi đã tạo kiểu cho các tấm chắn, tôi có thể sử dụng điểm mở rộng thứ hai trong Cài đặt được quản lý để định cấu hình trình xử lý hành động cho các nút chính và phụ.

00:16:57.000 --> 00:17:05.000
Trong phần mở rộng mới này, tôi sẽ phân lớp ShieldActionHandler làm lớp nguyên tắc và ghi đè hàm xử lý.

00:17:05.000 --> 00:17:14.000
Chức năng tay cầm được cho biết liệu hành động nút chính hay hành động nút phụ đã được nhấn và ứng dụng nào hiện đang được che chắn.

00:17:14.000 --> 00:17:19.000
Bạn được yêu cầu gọi trình xử lý hoàn thành của hàm với phản hồi hành động sshield.

00:17:19.000 --> 00:17:25.000
Phản hồi có thể là đóng ứng dụng được che chắn hoặc trì hoãn hành động và vẽ lại cấu hình lá chắn.

00:17:25.000 --> 00:17:34.000
Khả năng trì hoãn hành động trong lá chắn rất mạnh mẽ vì nó cho lá chắn cơ hội cập nhật diện mạo của nó trong khi chờ tín hiệu về cách tiến hành.

00:17:34.000 --> 00:17:41.000
Ví dụ, nó có thể được sử dụng để chỉ ra rằng lá chắn đang chờ hành động của người giám hộ khi đứa trẻ nhấn Yêu cầu quyền truy cập tại đây.

00:17:41.000 --> 00:17:46.000
Với việc bổ sung các lá chắn tùy chỉnh này, ứng dụng demo của tôi, Bài tập về nhà, đã hoàn tất.

00:17:46.000 --> 00:17:56.000
Người giám hộ có thể chọn các ứng dụng để che chắn, chẳng hạn như trò chơi hoặc giải trí, và loại bỏ lá chắn khi đứa trẻ đã hoàn thành đủ thời gian tích cực trên màn hình, như đọc sách, học tập hoặc sáng tạo.

00:17:56.000 --> 00:17:59.000
Cảm ơn vì đã cùng tôi xây dựng ứng dụng demo mới tuyệt vời này.

00:17:59.000 --> 00:18:00.000
Bây giờ quay lại với Chris.

00:18:00.000 --> 00:18:14.000
Hôm nay chúng tôi đã học được cách ba mục tiêu của chúng tôi - để cung cấp các hạn chế, bảo vệ quyền riêng tư và cho phép trải nghiệm động mới - được phân phối với ba khuôn khổ tạo nên API Thời gian sử dụng màn hình.

00:18:14.000 --> 00:18:20.000
Cài đặt được quản lý cho phép ứng dụng của bạn thực thi các cài đặt và hạn chế.

00:18:20.000 --> 00:18:29.000
Hoạt động thiết bị cho phép ứng dụng của bạn chạy mã theo lịch trình hoặc trên các sự kiện sử dụng ngay cả khi ứng dụng của bạn không được sử dụng.

00:18:29.000 --> 00:18:44.000
Và cuối cùng, Family Controls, cấp quyền truy cập vào Cài đặt được quản lý và Hoạt động thiết bị và bảo vệ quyền riêng tư của người dùng của bạn, đảm bảo rằng chỉ những người giám hộ mới biết đứa trẻ đang làm gì.

00:18:44.000 --> 00:18:51.000
Giống như tất cả các khuôn khổ, API Thời gian sử dụng màn hình sẽ tiếp tục phát triển dựa trên phản hồi từ bạn.

00:18:51.000 --> 00:18:58.000
Vì vậy, hãy thử những thứ này và cho chúng tôi biết cách chúng hỗ trợ hoặc không hỗ trợ các trường hợp sử dụng duy nhất của bạn.

00:18:58.000 --> 00:19:00.000
Cảm ơn vì đã tham gia cùng chúng tôi hôm nay.

00:19:00.000 --> 00:19:03.000
Tận hưởng WWDC 2021.

00:19:03.000 --> 23:59:59.000
[Âm nhạc].

