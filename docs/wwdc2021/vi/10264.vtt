WEBVTT

00:00:09.000 --> 00:00:12.000
Xin chào, tôi là Nicki Brower.

00:00:12.000 --> 00:00:14.000
Tôi là một kỹ sư trong nhóm Bút chì và Giấy.

00:00:14.000 --> 00:00:19.000
Và hôm nay, tôi sẽ chỉ cho bạn cách áp dụng Quick Note.

00:00:19.000 --> 00:00:33.000
Quick Note là một trải nghiệm ghi chú hoàn toàn mới, trên toàn hệ thống nhằm mục đích không chỉ hợp lý hóa khả năng ghi chú trên iOS và macOS mà còn kết nối nội dung từ nhiều ứng dụng và web ở một vị trí.

00:00:33.000 --> 00:00:44.000
Tính năng này cho phép mọi người dễ dàng hiển thị Ghi chú ở bất cứ đâu và phần tốt nhất là, nó sử dụng API đã tồn tại: NSUserActivity.

00:00:44.000 --> 00:00:49.000
Nếu điều đó nghe có vẻ quen thuộc, đó là vì nó được sử dụng cho các tính năng khác, như Handoff.

00:00:49.000 --> 00:00:52.000
Hôm nay, tôi sẽ cho bạn xem Ghi chú nhanh trực tiếp và đang hoạt động.

00:00:52.000 --> 00:00:58.000
Tôi sẽ nói về cách nó hoạt động trên hệ thống và cách áp dụng NSUserActivity.

00:00:58.000 --> 00:01:04.000
Cuối cùng, tôi sẽ xem xét một số phương pháp hay nhất để bạn có thể tạo ra trải nghiệm tốt nhất.

00:01:04.000 --> 00:01:11.000
Để cho bạn thấy tính năng Ghi chú nhanh mới, tôi sẽ thực hiện kế hoạch hành động của mình để lấy lại vóc dáng bằng Apple Fitness+.

00:01:11.000 --> 00:01:15.000
Tôi chưa đăng ký, và tôi không muốn thiếu một kế hoạch hành động.

00:01:15.000 --> 00:01:34.000
Thay vì phải chuyển sang ứng dụng Ghi chú, bây giờ tôi có thể sử dụng bút chì của mình để vuốt lên từ góc dưới cùng bên phải của màn hình để tạo Ghi chú nhanh hoàn toàn mới để nhớ rằng khi tôi sẵn sàng bắt đầu, trang web Apple có tất cả thông tin tôi cần biết.

00:01:34.000 --> 00:01:45.000
Ngoài ra còn có một menu thêm liên kết mới ở đầu Ghi chú nhanh, nơi tôi sẽ thêm liên kết đến trang web để dễ dàng điều hướng trở lại nội dung này.

00:01:45.000 --> 00:01:51.000
Tương tự như hình ảnh trong hình ảnh, cửa sổ Ghi chú nhanh có thể tự do di chuyển đến bất kỳ góc nào của thiết bị.

00:01:51.000 --> 00:01:59.000
Tôi cũng có thể chụm để chia tỷ lệ cửa sổ từ kích thước mặc định, đến kích thước nhỏ nhất, lên đến kích thước lớn nhất.

00:01:59.000 --> 00:02:03.000
Nếu tôi hoàn thành ghi chú của mình, tôi có thể nhấn nút Xong ở góc trên cùng bên trái.

00:02:03.000 --> 00:02:10.000
Nhưng tôi vẫn còn một số thứ tôi cần thêm vào, vì vậy tôi sẽ vuốt giao diện người dùng sang phải để giấu nó ở bên cạnh màn hình.

00:02:10.000 --> 00:02:14.000
Tất nhiên, ngoài các trang web, nó cũng hoạt động với các ứng dụng.

00:02:14.000 --> 00:02:18.000
Sử dụng Bản đồ, tôi đã có thể tìm thấy một địa điểm tuyệt vời để thực hành các bài tập HIIT của mình.

00:02:18.000 --> 00:02:23.000
Tôi sẽ lấy ra ghi chú mà tôi đã giấu đi và thêm vị trí này vào ghi chú của mình.

00:02:23.000 --> 00:02:31.000
Để có thêm không gian để vẽ, hãy nhấn vào biểu tượng Ghi chú từ thanh công cụ Ghi chú nhanh để truy cập ghi chú trong ứng dụng Ghi chú.

00:02:31.000 --> 00:02:36.000
Ở đây, tôi sẽ tận dụng khả năng vẽ qua các hình ảnh và liên kết.

00:02:36.000 --> 00:02:40.000
Các liên kết tôi đã thêm vào đây không chỉ là bất kỳ liên kết cũ nào.

00:02:40.000 --> 00:02:48.000
Chắc chắn, nhấn vào chúng sẽ đưa tôi đến Safari hoặc Bản đồ, nhưng bây giờ tôi có thể quay lại ghi chú của mình từ các ứng dụng này với Đề xuất Ghi chú Nhanh.

00:02:48.000 --> 00:02:56.000
Khi tôi truy cập trang web về Apple Fitness+, giao diện người dùng Gợi ý Ghi chú Nhanh sẽ hiển thị ở góc dưới cùng bên phải.

00:02:56.000 --> 00:03:05.000
Nhấn vào điều này sẽ đưa tôi trở lại ngay nơi tôi đã ở và tôi sẽ thêm một lưu ý rằng mục tiêu của tôi là thực hiện bài tập HIIT 4 đến 5 lần một tuần.

00:03:05.000 --> 00:03:11.000
Tôi đã tạo một ghi chú ở đây trên iPad, nhưng nó cũng hoạt động đa nền tảng với Mac.

00:03:11.000 --> 00:03:18.000
Khi tôi truy cập liên kết về Apple Fitness+, giao diện người dùng gợi ý ghi chú nhanh cũng sẽ xuất hiện ở đây trên máy Mac của tôi.

00:03:18.000 --> 00:03:22.000
Khi tôi nhấp vào nó, tôi sẽ được chuyển đến ghi chú trong ứng dụng Ghi chú.

00:03:22.000 --> 00:03:26.000
Bây giờ bạn đã gặp Quick Note, hãy nói về cách nó hoạt động.

00:03:26.000 --> 00:03:32.000
Một đối tượng NSUserActivity cung cấp một cách để nắm bắt trạng thái của một ứng dụng và đưa nó vào sử dụng sau này.

00:03:32.000 --> 00:03:44.000
Các đối tượng hoạt động của người dùng được tạo ra về những gì đang xảy ra, chẳng hạn như xem trang web hoặc xem nội dung ứng dụng và mỗi ứng dụng sẽ đăng ký hoạt động hiện tại của mình với hệ thống.

00:03:44.000 --> 00:03:49.000
Hệ thống sau đó nhận các hoạt động này và gửi chúng đến các tính năng như Handoff.

00:03:49.000 --> 00:03:53.000
Ghi chú nhanh liên kết cõng trên hệ thống này.

00:03:53.000 --> 00:04:00.000
Ngoài việc chuyển sang Handoff, Spotlight và Reminders, các hoạt động đã đăng ký cũng được gửi đến Quick Note.

00:04:00.000 --> 00:04:06.000
Đây là cách liên kết hiển thị trong menu thêm liên kết và điều gì kích hoạt Đề xuất Ghi chú Nhanh.

00:04:06.000 --> 00:04:15.000
NSUserActivity đã có ba thuộc tính đóng vai trò là số nhận dạng bền để liên kết nội dung ứng dụng với Quick Note.

00:04:15.000 --> 00:04:26.000
Để trở thành một phần của hệ sinh thái này, bạn phải đặt một hoặc nhiều thuộc tính sau: targetContentIdentifier, persistentIdentifier và webpageURL.

00:04:26.000 --> 00:04:32.000
Bạn chọn cái nào phụ thuộc vào những tính năng khác mà bạn muốn hỗ trợ.

00:04:32.000 --> 00:04:36.000
targetContentIdentifier cũng được sử dụng trong quá trình khôi phục trạng thái.

00:04:36.000 --> 00:04:42.000
Thuộc tính này tạo ra trải nghiệm đa nhiệm tuyệt vời cho các ứng dụng chạy trên iPad.

00:04:42.000 --> 00:04:52.000
persistentIdentifier cũng được sử dụng để xác định nội dung ứng dụng trong chỉ mục Spotlight của hệ thống và webpageURL cũng được sử dụng cho dự phòng web trong Handoff.

00:04:52.000 --> 00:04:58.000
Để các liên kết Ghi chú Nhanh hoạt động, có một vài thuộc tính mà số nhận dạng cần phải có.

00:04:58.000 --> 00:05:10.000
Chúng phải là duy nhất cho phần nội dung đó, mang tính toàn cầu để chúng hoạt động trên tất cả các thiết bị và đủ ổn định để hoạt động cho nội dung đó theo thời gian.

00:05:10.000 --> 00:05:17.000
Có một mã định danh duy nhất, toàn cầu và ổn định cho một hoạt động cho phép Đề xuất Ghi chú Nhanh.

00:05:17.000 --> 00:05:31.000
Khi tôi quay lại trang web về Apple Fitness+, lý do giao diện người dùng Gợi ý Ghi chú Nhanh xuất hiện là vì mã định danh trong liên kết, được tạo một giờ trước hoặc sáu tháng trước, vẫn khớp với mã định danh trên trang web.

00:05:31.000 --> 00:05:50.000
Có ba bước chính để áp dụng NSUserActivity: khai báo các hoạt động được hỗ trợ trong Info.plist của ứng dụng của bạn, tạo và đăng ký các hoạt động của người dùng mô tả những gì trên màn hình tại các thời điểm khác nhau và xử lý các yêu cầu đến để tiếp tục hoạt động.

00:05:50.000 --> 00:05:55.000
Điều này có thể đến từ một liên kết trong Quick Note hoặc từ một thiết bị khác.

00:05:55.000 --> 00:06:04.000
Khai báo các loại hoạt động mà ứng dụng của bạn hỗ trợ theo khóa NSUserActivityTypes trong tệp Info.plist của nó.

00:06:04.000 --> 00:06:11.000
Hệ thống sử dụng thông tin trong khóa đó để xác định xem ứng dụng của bạn có khả năng xử lý một đối tượng hoạt động người dùng nhất định hay không.

00:06:11.000 --> 00:06:19.000
Để tạo một đối tượng NSUserActivity, hãy sử dụng một trong các chuỗi loại hoạt động đã đăng ký plist của bạn và đặt tiêu đề.

00:06:19.000 --> 00:06:23.000
Đặt một hoặc nhiều trong ba số nhận dạng được đề cập trước đó.

00:06:23.000 --> 00:06:26.000
Bất kỳ một trong những số nhận dạng này đều có thể được sử dụng cho Ghi chú nhanh.

00:06:26.000 --> 00:06:33.000
Đối với ví dụ này, giả sử ứng dụng của bạn là một ứng dụng iPad cũng quan tâm đến việc hỗ trợ khôi phục trạng thái.

00:06:33.000 --> 00:06:35.000
Đặt targetContentIdentifier.

00:06:35.000 --> 00:06:42.000
Đặt thuộc tính userInfo với bất kỳ thông tin trạng thái cụ thể nào của ứng dụng cần thiết để tiếp tục hoạt động.

00:06:42.000 --> 00:06:46.000
Sau đó, gắn nó vào một người phản hồi.

00:06:46.000 --> 00:06:54.000
Thay vì phải đăng ký hoạt động bằng cách quản lý thủ công hoạt động ứng dụng hiện tại, hãy để hệ thống xử lý nó cho bạn.

00:06:54.000 --> 00:07:02.000
Bằng cách thiết lập hoạt động trên trình phản hồi, đối tượng được quản lý bởi UIKit và AppKit.

00:07:02.000 --> 00:07:09.000
Bởi vì NSUserActivity là đa nền tảng, mã này hoạt động trên cả iOS và macOS.

00:07:09.000 --> 00:07:15.000
Bước cuối cùng là xử lý việc nhận các hoạt động đến và khôi phục trạng thái của nó trong ứng dụng của bạn.

00:07:15.000 --> 00:07:25.000
Khi một liên kết được nhấn, Quick Note sẽ khởi chạy ứng dụng của bạn và gọi phương thức cảnh (willContinueUserActivityWithType) của UIWindowSceneDelegate.

00:07:25.000 --> 00:07:31.000
Đây là nơi bạn có thể đưa ra một số phản hồi rằng ứng dụng của bạn đang nhận được hoạt động.

00:07:31.000 --> 00:07:37.000
Ghi chú nhanh sau đó cung cấp hoạt động cho ứng dụng của bạn trong cảnh (tiếp tục userActivity:).

00:07:37.000 --> 00:07:45.000
Đây là nơi bạn thiết lập bất kỳ bộ điều khiển chế độ xem, chế độ xem nào và sử dụng từ điển userInfo để khôi phục và tiếp tục hoạt động.

00:07:45.000 --> 00:07:56.000
Trong trường hợp Handoff, nếu các thiết bị không thể kết nối, hệ thống sẽ gọi cảnh (didFailToContinueUserActivityWithType) nơi bạn có thể hiển thị thông báo lỗi.

00:07:56.000 --> 00:08:04.000
Phương pháp này sẽ không được gọi cho Quick Note, nhưng rất tốt để thực hiện để áp dụng NSUserActivity toàn diện.

00:08:04.000 --> 00:08:20.000
Đối với các ứng dụng macOS, hãy triển khai ứng dụng tương đương (willContinueUserActivityWithType), ứng dụng (tiếp tục userActivity) và ứng dụng (didFailToContinueUserActivityWithType) trong đại diện ứng dụng.

00:08:20.000 --> 00:08:32.000
Để biết thêm thông tin về việc áp dụng NSUserActivity, hãy xem video WWDC 2014, "Adopting Handoff trên iOS 8 và OS X."

00:08:32.000 --> 00:08:38.000
NSUserActivity là một cổng vì nó là nền tảng cho nhiều tính năng khác.

00:08:38.000 --> 00:08:42.000
Bằng cách áp dụng nó cho Quick Note, đây là mọi thứ khác mà bạn có thể nhận được.

00:08:42.000 --> 00:08:47.000
Chuyển giao được bật theo mặc định, trong khi những người khác đang chọn tham gia.

00:08:47.000 --> 00:08:59.000
Ứng dụng của bạn có thể còn mạnh hơn vì mọi người có thể tạo lời nhắc về tài liệu trong ứng dụng của bạn hoặc có bài đăng trên blog từ ứng dụng của bạn hiển thị trong ánh đèn sân khấu hoặc cải thiện khả năng xử lý đa cửa sổ.

00:08:59.000 --> 00:09:06.000
Kiểm tra tài liệu mới nhất và các video WWDC liên quan để biết thêm thông tin.

00:09:06.000 --> 00:09:13.000
Cuối cùng, nhưng chắc chắn không kém phần quan trọng, chúng ta hãy xem qua một số phương pháp hay nhất để áp dụng NSUserActivity cho Quick Note.

00:09:13.000 --> 00:09:22.000
Tôi sẽ xem xét bốn hành vi và đối với mỗi hành vi này, tôi sẽ nói về lý do và cách triển khai chúng trong ứng dụng của bạn.

00:09:22.000 --> 00:09:27.000
Thuộc tính tiêu đề là một chuỗi có thể đọc được của con người cho hoạt động.

00:09:27.000 --> 00:09:30.000
Đây là chuỗi hiển thị trong menu thêm liên kết.

00:09:30.000 --> 00:09:36.000
Điều đó nói rằng, tiêu đề nên cung cấp một đại diện tốt, mô tả về nội dung.

00:09:36.000 --> 00:09:42.000
Nói chung, tốt hơn là sử dụng tiêu đề của tài liệu hoặc mục trực tiếp.

00:09:42.000 --> 00:09:48.000
Có một vài mẹo để giúp các số nhận dạng là duy nhất, toàn cầu và ổn định.

00:09:48.000 --> 00:09:51.000
Tránh sử dụng dữ liệu dành riêng cho thiết bị.

00:09:51.000 --> 00:09:59.000
Nếu mã định danh cho bức ảnh này là đường dẫn tệp cục bộ của nó, liên kết chỉ được đảm bảo hoạt động trên thiết bị mà nó được tạo.

00:09:59.000 --> 00:10:06.000
Tránh bất kỳ thông tin thoáng qua nào, như ID phiên hoặc các thuộc tính xem cụ thể.

00:10:06.000 --> 00:10:16.000
Tiêu đề của bức ảnh có thể hoàn toàn độc đáo, nhưng nếu nó có thể được sửa đổi, không có gì đảm bảo nó sẽ tồn tại khi cố gắng điều hướng trở lại nội dung này.

00:10:16.000 --> 00:10:27.000
Suy nghĩ lâu dài, như sử dụng UUID đã lưu của ứng dụng cho ảnh, sẽ cho phép ứng dụng của bạn khôi phục các liên kết Ghi chú Nhanh, ngay cả khi nội dung đã được di chuyển xung quanh.

00:10:27.000 --> 00:10:38.000
Mặc dù URL có thể là số nhận dạng duy nhất cho nội dung ứng dụng, nhưng chúng thường chứa thông tin trạng thái tạm thời, vi phạm các nguyên tắc nhận dạng được đề cập trước đó.

00:10:38.000 --> 00:10:45.000
Quick Note thích targetContentIdentifier hoặc persistentIdentifier hơn webpageURL.

00:10:45.000 --> 00:10:51.000
webpageURL hoàn toàn ổn để sử dụng, miễn là nó tuân theo các hướng dẫn.

00:10:51.000 --> 00:11:02.000
Nếu ứng dụng của bạn sử dụng NSUserActivity cho cả khôi phục trạng thái và Spotlight, hãy sử dụng cùng một giá trị cho targetContentIdentifier và persistentIdentifier.

00:11:02.000 --> 00:11:09.000
Nếu bạn có một trang web khen ngợi ứng dụng của mình, hãy thêm URL làm mã định danh dự phòng thứ hai.

00:11:09.000 --> 00:11:15.000
Bằng cách này, nếu ứng dụng chưa được cài đặt, việc mở một liên kết sẽ chuyển hướng đến trang web của bạn.

00:11:15.000 --> 00:11:21.000
Một thực hành quan trọng khác là đảm bảo NSUserActivity hiện tại của ứng dụng được cập nhật.

00:11:21.000 --> 00:11:25.000
Điều này có nghĩa là theo kịp những gì đang xảy ra.

00:11:25.000 --> 00:11:35.000
Phương pháp hay nhất là giữ cho các thuộc tính tiêu đề và định danh chính xác khi phát hiện bất kỳ thay đổi hoạt động nào, chẳng hạn như chọn xem một bức ảnh khác.

00:11:35.000 --> 00:11:39.000
Không nên sử dụng lại các phiên bản hoạt động.

00:11:39.000 --> 00:11:44.000
Khi có nội dung mới, như bức ảnh mới, hãy tạo một hoạt động mới.

00:11:44.000 --> 00:11:54.000
Hãy để UIKit và AppKit xử lý hoạt động ứng dụng hiện tại bằng cách đính kèm các hoạt động vào các trình phản hồi như viewControllers hoặc chế độ xem, như tôi đã hiển thị trong mã ví dụ.

00:11:54.000 --> 00:12:05.000
Nếu đính kèm vào trình phản hồi không hoạt động cho ứng dụng của bạn, hoạt động ứng dụng hiện tại có thể được quản lý thủ công bằng cách gọi becomeCurrent() và resignCurrent() vào những thời điểm thích hợp.

00:12:05.000 --> 00:12:18.000
Ví dụ: khi xem xong ảnh, ứng dụng sẽ gọi resignCurrent() trên hoạt động hiện tại và khi một ảnh mới được chọn, ứng dụng sẽ gọi becomeCurrent() trên hoạt động mới.

00:12:18.000 --> 00:12:24.000
Để có hiệu suất tốt hơn, hãy tận dụng thuộc tính "needsSave" của hoạt động.

00:12:24.000 --> 00:12:29.000
Một hoạt động có thể cần các thuộc tính xem cụ thể để khôi phục đúng hoạt động trong ứng dụng.

00:12:29.000 --> 00:12:34.000
Ví dụ, vị trí và thu phóng khi xem bản đồ.

00:12:34.000 --> 00:12:41.000
Các thuộc tính này có thể được chuyển cùng với hoạt động, nhưng có chi phí khi cập nhật sau mỗi cử chỉ.

00:12:41.000 --> 00:12:46.000
Thay vì cập nhật hoạt động, hãy đặt needsSave thành true.

00:12:46.000 --> 00:13:00.000
Khi hệ thống cần gửi hoạt động đến liên kết Ghi chú nhanh hoặc Chuyển giao, cuộc gọi lại đại diện userActivityWillSave được gọi, để ứng dụng có thể cập nhật tất cả các thuộc tính theo yêu cầu.

00:13:00.000 --> 00:13:08.000
Cuộc gọi lại này là nơi từ điển userInfo có thể được cập nhật để bao gồm bất kỳ thuộc tính nào giúp khôi phục hoạt động.

00:13:08.000 --> 00:13:11.000
Có một vài vấn đề tương thích cần chuẩn bị.

00:13:11.000 --> 00:13:14.000
Điều gì sẽ xảy ra nếu ứng dụng đã được cập nhật?

00:13:14.000 --> 00:13:17.000
Ghi chú điều này với hai liên kết từ một ứng dụng.

00:13:17.000 --> 00:13:23.000
Các liên kết có thể là từ phiên bản cũ hơn hoặc mới hơn của ứng dụng so với trên thiết bị.

00:13:23.000 --> 00:13:27.000
Hoàn toàn ổn, nhưng các liên kết vẫn cần phải hoạt động.

00:13:27.000 --> 00:13:39.000
Để chuẩn bị cho việc xử lý khả năng tương thích, hãy hỗ trợ xử lý các hoạt động nhận từ các phiên bản trước của ứng dụng của bạn và thất bại một cách duyên dáng khi nhận các hoạt động từ các phiên bản mới hơn.

00:13:39.000 --> 00:13:50.000
Điều này có thể được hỗ trợ từ việc lập phiên bản các hoạt động của bạn hoặc sử dụng từ điển các khóa và chịu được các khóa bị thiếu hoặc có một số khóa mà bạn không hiểu.

00:13:50.000 --> 00:13:54.000
Điều gì sẽ xảy ra nếu nội dung không còn tồn tại nữa?

00:13:54.000 --> 00:13:58.000
Nội dung mà hoạt động được liên kết có thể đã bị xóa hoặc di chuyển.

00:13:58.000 --> 00:14:05.000
Khi điều hướng trở lại ứng dụng, hãy hiển thị thông báo lỗi nếu bị xóa hoặc chuyển hướng nếu nội dung được di chuyển.

00:14:05.000 --> 00:14:10.000
Áp dụng Quick Note kết nối ứng dụng của bạn vào hệ thống ghi chú mới này.

00:14:10.000 --> 00:14:18.000
Một hệ thống được thiết kế để cải thiện kết nối giữa con người, nội dung và ứng dụng của bạn.

00:14:18.000 --> 00:14:20.000
Đảm bảo rằng bạn đã áp dụng NSUserActivity.

00:14:20.000 --> 00:14:26.000
Bây giờ là một cơ hội tuyệt vời để xem lại và đánh bóng bất kỳ mã hiện có nào.

00:14:26.000 --> 00:14:30.000
Có các số nhận dạng duy nhất, toàn cầu và ổn định.

00:14:30.000 --> 00:14:36.000
Và thiết lập các hoạt động của bạn trên những người phản hồi để cho phép hệ thống quản lý NSUserActivity hiện tại của ứng dụng.

00:14:36.000 --> 00:14:39.000
Cảm ơn bạn đã xem, và tôi mong được thấy ứng dụng của bạn trong Quick Note và hơn thế nữa.

00:14:39.000 --> 23:59:59.000
[Nhạc gõ].

