WEBVTT

00:00:02.000 --> 00:00:11.000
Xin chào, tôi là Harrison từ đội Game Center.

00:00:11.000 --> 00:00:15.000
Cảm ơn vì đã tham gia cùng tôi để tìm hiểu về cách sử dụng bảng xếp hạng định kỳ trong các trò chơi của bạn.

00:00:15.000 --> 00:00:20.000
Trung tâm trò chơi cung cấp một danh tính thuận tiện mà người chơi có thể sử dụng để truy cập dữ liệu của họ trên nhiều trò chơi của họ.

00:00:20.000 --> 00:00:28.000
Là một nhà phát triển, Game Center cho phép bạn dễ dàng thêm các tính năng như thành tích, nhiều người chơi và bảng xếp hạng, đó là những gì tôi ở đây để nói về ngày hôm nay.

00:00:28.000 --> 00:00:32.000
Vì đây là một mã cùng, bạn sẽ cần thực hiện một số thiết lập ban đầu để tham gia.

00:00:32.000 --> 00:00:39.000
Sau đó, tôi sẽ tóm tắt nhanh các loại bảng xếp hạng của Trung tâm trò chơi và xem qua trò chơi mẫu được cung cấp.

00:00:39.000 --> 00:00:46.000
Cuối cùng, tôi sẽ thêm một bảng xếp hạng định kỳ trong App Store Connect và chỉ ra một vài cách khác nhau để sử dụng nó trong trò chơi mẫu.

00:00:46.000 --> 00:00:49.000
Hãy bắt đầu với một số thiết lập.

00:00:49.000 --> 00:00:54.000
Chúng tôi đã cung cấp một dự án tương thích với Xcode 13 trong cổng thông tin dành cho nhà phát triển để giúp bạn bắt đầu.

00:00:54.000 --> 00:00:58.000
Tôi khuyến khích bạn tạm dừng video và tải xuống ngay bây giờ.

00:00:58.000 --> 00:01:04.000
Sau khi nó được tải xuống, hãy tiếp tục và tôi sẽ hướng dẫn bạn một số thiết lập ban đầu.

00:01:04.000 --> 00:01:07.000
Trong thư mục bạn đã tải xuống, bạn sẽ tìm thấy một dự án Xcode có tên là The Coast.

00:01:07.000 --> 00:01:10.000
Hãy tiếp tục và mở nó ngay bây giờ.

00:01:10.000 --> 00:01:15.000
Vì bạn sẽ sửa đổi ứng dụng này để sử dụng các tính năng của Trung tâm trò chơi, nó cần được đăng ký với nhóm của bạn.

00:01:15.000 --> 00:01:19.000
Làm theo, tạm dừng khi cần thiết.

00:01:19.000 --> 00:01:24.000
Đầu tiên, chọn tệp dự án TheCoast từ trình điều hướng dự án.

00:01:24.000 --> 00:01:29.000
Sau đó, chọn TheCoast từ danh sách Mục tiêu.

00:01:29.000 --> 00:01:33.000
Trong ngăn Ký &amp; Khả năng, chọn nhóm của bạn từ menu Nhóm.

00:01:33.000 --> 00:01:40.000
Nếu ID Apple hoặc nhóm của bạn không có trong menu, trước tiên hãy chọn Thêm Tài khoản và nhập thông tin ID Apple của bạn.

00:01:40.000 --> 00:01:43.000
Tiếp theo, đặt ID gói thành một mã định danh duy nhất.

00:01:43.000 --> 00:01:46.000
Bạn phải thay đổi ID gói để tiếp tục.

00:01:46.000 --> 00:01:50.000
Nếu được nhắc, hãy nhấp vào Đăng ký Thiết bị để tạo hồ sơ cung cấp.

00:01:50.000 --> 00:01:56.000
Khi bạn đã đăng ký thành công, sẽ không có bất kỳ cảnh báo nào được liệt kê dưới trạng thái.

00:01:56.000 --> 00:02:01.000
Bây giờ ID gói bạn đã chọn đã được đăng ký, bạn có thể thêm bản ghi ứng dụng vào App Store Connect.

00:02:01.000 --> 00:02:07.000
Ở góc trên cùng bên phải của App Store Connect, chọn nhóm bạn đã sử dụng khi đăng ký ID gói của mình.

00:02:07.000 --> 00:02:11.000
Sau đó, điều hướng đến phần Ứng dụng của tôi.

00:02:11.000 --> 00:02:17.000
Nhấp vào nút dấu cộng ở góc trên cùng bên trái và chọn Ứng dụng mới.

00:02:17.000 --> 00:02:22.000
Bạn sẽ làm việc trên một ứng dụng chỉ dành cho iOS, vì vậy hãy chọn iOS làm nền tảng.

00:02:22.000 --> 00:02:26.000
Chọn một tên thích hợp, ngôn ngữ chính và SKU.

00:02:26.000 --> 00:02:30.000
Đối với ID gói, hãy đảm bảo bạn chọn ID gói mà bạn đã đăng ký trong Xcode.

00:02:30.000 --> 00:02:36.000
Sau khi tất cả các trường bắt buộc được điền, hãy chọn Tạo để thêm bản ghi ứng dụng của bạn.

00:02:36.000 --> 00:02:38.000
Bạn sẽ quay lại App Store Connect muộn hơn một chút.

00:02:38.000 --> 00:02:43.000
Nhưng bây giờ, tôi sẽ đưa ra một bản tóm tắt nhanh về bảng xếp hạng.

00:02:43.000 --> 00:02:48.000
Tất cả các bảng xếp hạng của chúng tôi cho phép người chơi thấy họ xếp hạng tốt như thế nào so với bạn bè và người chơi trên khắp thế giới.

00:02:48.000 --> 00:02:54.000
Các loại bảng xếp hạng của chúng tôi chủ yếu khác nhau tùy theo thời gian hoạt động của bảng xếp hạng.

00:02:54.000 --> 00:02:57.000
Bảng xếp hạng cổ điển luôn hoạt động, không có kết thúc.

00:02:57.000 --> 00:03:02.000
Họ duy trì thứ hạng mọi thời đại, cũng như xếp hạng hàng tuần và hàng ngày.

00:03:02.000 --> 00:03:10.000
Chúng đặc biệt hữu ích cho điểm tích lũy, như tổng số điểm kinh nghiệm kiếm được hoặc số tiền xu hiện tại.

00:03:10.000 --> 00:03:18.000
Mặt khác, bảng xếp hạng định kỳ là bảng xếp hạng tồn tại trong thời gian ngắn lặp lại theo lịch trình do nhà phát triển xác định, cứ sau 5 phút hoặc 30 ngày một lần.

00:03:18.000 --> 00:03:28.000
Bạn có thể truy xuất lần xuất hiện bảng xếp hạng hiện đang hoạt động và bạn cũng có thể truy xuất lần xuất hiện đã hoàn thành gần đây nhất mà người chơi đã gửi đến, trong tối đa 30 ngày sau thời gian kết thúc.

00:03:28.000 --> 00:03:36.000
Bảng xếp hạng định kỳ rất hữu ích cho các sự kiện định kỳ, theo thời gian, như thử thách 1 giờ vào mỗi trưa Chủ nhật hoặc bảng xếp hạng mới mỗi tuần.

00:03:36.000 --> 00:03:41.000
Tôi sẽ nêu bật một trường hợp sử dụng cụ thể cho các bảng xếp hạng định kỳ trong phiên.

00:03:41.000 --> 00:03:44.000
Nhưng trước tiên, hãy quay lại dự án bạn đã mở trong Xcode.

00:03:44.000 --> 00:03:50.000
Xây dựng và chạy nó trên một thiết bị iOS hoặc một trình giả lập.

00:03:50.000 --> 00:03:53.000
Đây là màn hình tiêu đề của The Coast.

00:03:53.000 --> 00:03:56.000
Hiện tại, màn hình này chỉ có một nút để bắt đầu trò chơi.

00:03:56.000 --> 00:03:58.000
Hãy tiếp tục và nhấn vào "PLAY".

00:03:58.000 --> 00:04:04.000
Lối chơi khá đơn giản: khi bạn nhìn thấy một con tàu, hãy nhấn vào nó để có điểm.

00:04:04.000 --> 00:04:06.000
Mỗi phiên kéo dài 60 giây.

00:04:06.000 --> 00:04:11.000
Cuối cùng, bạn sẽ có tùy chọn thử lại hoặc quay lại màn hình tiêu đề.

00:04:11.000 --> 00:04:16.000
Nếu bạn chọn nút menu ở góc trên cùng bên phải, bạn có thể hoàn thành sớm.

00:04:16.000 --> 00:04:21.000
Vậy, điều này được thực hiện như thế nào?

00:04:21.000 --> 00:04:24.000
Tôi sẽ làm nổi bật một vài lớp học chính để bắt đầu.

00:04:24.000 --> 00:04:28.000
TitleScreenViewController chịu trách nhiệm về màn hình tiêu đề.

00:04:28.000 --> 00:04:31.000
Trong một thời gian, nó sẽ được sử dụng để xác thực với Game Center.

00:04:31.000 --> 00:04:38.000
Hiện tại, nó chủ yếu chịu trách nhiệm trình bày GameViewController khi nhấn nút PLAY.

00:04:38.000 --> 00:04:41.000
GameViewController khá đơn giản.

00:04:41.000 --> 00:04:49.000
Nó hiển thị một cảnh SpriteKit, được gọi là GameScene, khi chế độ xem được tải và có một phương thức đại diện được gọi là endGame để quay lại màn hình tiêu đề.

00:04:49.000 --> 00:04:54.000
Hãy xem GameScene, nơi quản lý tất cả logic trò chơi.

00:04:54.000 --> 00:04:58.000
Khi nó được trình bày, nó thiết lập một vài nút SpriteKit.

00:04:58.000 --> 00:05:02.000
Một là một nút được tạo ra với hình nền.

00:05:02.000 --> 00:05:07.000
Điều này được chia tỷ lệ dựa trên kích thước màn hình thiết bị của bạn và tất cả các nút khác được thêm vào nó khi còn nhỏ.

00:05:07.000 --> 00:05:15.000
Một cái khác là scoreLabel, một SKLabelNode được đặt ở phía trên bên trái của màn hình hiển thị điểm số hiện tại.

00:05:15.000 --> 00:05:23.000
Cuối cùng là CountdownNode, cho người chơi biết họ còn bao nhiêu thời gian và thông báo cho GameScene khi hết thời gian.

00:05:23.000 --> 00:05:31.000
Với những nút đó được thêm vào, phương thức setupBoatNodeWithActions() được gọi.

00:05:31.000 --> 00:05:39.000
Điều này bắt đầu một chuỗi các hành động SpriteKit để mờ dần và mờ dần các sprites thuyền trong suốt phiên.

00:05:39.000 --> 00:05:46.000
Phương pháp touchesEnded được ghi đè để loại bỏ các sprites thuyền đó khi chạm và tăng điểm.

00:05:46.000 --> 00:05:57.000
Khi kết thúc đếm ngược, trong phương pháp timeIsUp, tất cả các nút sẽ bị xóa khỏi nền và một menu với điểm số cuối cùng được hiển thị.

00:05:57.000 --> 00:06:05.000
Có rất nhiều cách để các bảng xếp hạng định kỳ có thể được tận dụng để cải thiện trải nghiệm của The Coast cho người chơi, nhưng hôm nay, tôi sẽ tập trung vào ba cách.

00:06:05.000 --> 00:06:14.000
Đầu tiên, tôi sẽ chỉ cho bạn cách thiết lập một cuộc thi hàng ngày bằng cách tạo bảng xếp hạng định kỳ 24 giờ và chỉ cho bạn cách liên kết với giao diện người dùng bảng xếp hạng mặc định của Game Center.

00:06:14.000 --> 00:06:21.000
Đây có lẽ là cách dễ nhất để thêm bảng xếp hạng định kỳ và đó là một cách tuyệt vời để người chơi tìm hiểu cách họ so sánh với những người khác.

00:06:21.000 --> 00:06:27.000
Nhịp điệu hàng ngày đảm bảo rằng mọi người sẽ có cơ hội mới để giành được vị trí hàng đầu.

00:06:27.000 --> 00:06:31.000
Tiếp theo, chúng tôi sẽ hiển thị bảng xếp hạng trực tiếp trong quá trình chơi trò chơi.

00:06:31.000 --> 00:06:38.000
Điều này làm tăng thêm sự phấn khích cho trò chơi, khi người chơi có thể thấy trong thời gian thực họ đang làm tốt như thế nào và họ gần vị trí hàng đầu như thế nào.

00:06:38.000 --> 00:06:45.000
Cuối cùng, chúng tôi sẽ sử dụng các cấp bậc từ các lần xuất hiện tại và trước đó để cho thấy người chơi đang thay đổi như thế nào theo thời gian.

00:06:45.000 --> 00:06:49.000
Đây là một cách thực sự đơn giản để mang đến cho người chơi cảm giác tiến bộ trong trò chơi.

00:06:49.000 --> 00:06:51.000
Hãy bắt đầu nào.

00:06:51.000 --> 00:06:55.000
Tôi đã đề cập trước đó rằng tôi sẽ sử dụng bảng xếp hạng định kỳ hàng ngày.

00:06:55.000 --> 00:06:59.000
Trước khi bạn có thể sử dụng bảng xếp hạng trong trò chơi của mình, bạn cần định cấu hình nó trong App Store Connect.

00:06:59.000 --> 00:07:04.000
Kéo nó lên trong Safari ngay bây giờ và mở ứng dụng của bạn.

00:07:04.000 --> 00:07:07.000
Điều hướng đến tab Tính năng và đảm bảo rằng Trung tâm trò chơi được chọn.

00:07:07.000 --> 00:07:14.000
Sau đó, nhấp vào nút dấu cộng bên cạnh bảng xếp hạng và chọn tùy chọn bảng xếp hạng định kỳ.

00:07:14.000 --> 00:07:18.000
Cả bảng xếp hạng cổ điển và định kỳ đều có sáu trường này để định cấu hình.

00:07:18.000 --> 00:07:21.000
Tên tham chiếu bảng xếp hạng được sử dụng nội bộ trong App Store Connect.

00:07:21.000 --> 00:07:24.000
Chọn một cái gì đó mô tả, như "DailyHighScore."

00:07:24.000 --> 00:07:28.000
ID bảng xếp hạng được sử dụng để tham chiếu bảng xếp hạng của bạn trong ứng dụng.

00:07:28.000 --> 00:07:34.000
Để đơn giản, tôi sẽ chỉ sử dụng cùng một giá trị mô tả mà tôi đã sử dụng cho tên tham chiếu.

00:07:34.000 --> 00:07:38.000
Loại định dạng điểm xác định cách định dạng điểm số trong giao diện người dùng Trung tâm trò chơi.

00:07:38.000 --> 00:07:44.000
Điểm số của Coast chỉ là số nguyên, nhưng các trò chơi khác có thể sử dụng thời gian hoặc tiền bạc.

00:07:44.000 --> 00:07:53.000
Nếu một người chơi gửi nhiều điểm cho cùng một lần xuất hiện bảng xếp hạng, loại gửi điểm sẽ xác định điểm nào được xếp hạng: điểm tốt nhất hoặc gần đây nhất.

00:07:53.000 --> 00:07:59.000
Sử dụng tốt nhất cho The Coast, vì bạn muốn ghi lại điểm số cao nhất của người chơi trong ngày.

00:07:59.000 --> 00:08:03.000
Thứ tự sắp xếp xác định cách xếp hạng điểm của người chơi so với nhau.

00:08:03.000 --> 00:08:07.000
Đối với The Coast, điểm số cao sẽ tốt hơn, vì vậy hãy chọn Cao đến Thấp.

00:08:07.000 --> 00:08:10.000
Bạn có thể tùy ý xác định một phạm vi cho điểm số hợp lệ.

00:08:10.000 --> 00:08:14.000
Bất kỳ điểm nào ngoài phạm vi đó sẽ bị từ chối.

00:08:14.000 --> 00:08:17.000
Điều này hữu ích như một sự giảm thiểu gian lận.

00:08:17.000 --> 00:08:24.000
Tôi sẽ đặt mức tối thiểu là 0 và tối đa là 200, vì tôi không mong đợi người chơi ghi bàn một cách hợp lý ngoài phạm vi đó.

00:08:24.000 --> 00:08:28.000
Bảng xếp hạng định kỳ có các trường bắt buộc bổ sung này.

00:08:28.000 --> 00:08:33.000
Ngày và Giờ bắt đầu là ngày và giờ xuất hiện đầu tiên của bảng xếp hạng, theo UTC.

00:08:33.000 --> 00:08:42.000
Bạn không thể chọn bắt đầu trong quá khứ, vì vậy hãy chọn ngày và giờ trong tương lai gần, chẳng hạn như trong một phút, để bạn có thể bắt đầu sử dụng bảng xếp hạng ngay lập tức.

00:08:42.000 --> 00:08:46.000
Thời lượng là khoảng thời gian mà điểm số có thể được đăng cho bảng xếp hạng.

00:08:46.000 --> 00:08:51.000
Tất nhiên, đây là một ngày cho bảng xếp hạng hàng ngày.

00:08:51.000 --> 00:08:56.000
Khởi động lại Mỗi chỉ định tần suất tạo ra các lần xuất hiện mới của bảng xếp hạng.

00:08:56.000 --> 00:09:02.000
Tần suất được yêu cầu phải lớn hơn hoặc bằng thời lượng, để các lần xuất hiện sẽ không trùng lặp.

00:09:02.000 --> 00:09:09.000
Bờ biển không cần bất kỳ khoảng cách nào giữa các lần xuất hiện, vì vậy hãy đặt khoảng cách này bằng với thời lượng.

00:09:09.000 --> 00:09:13.000
Đây là một sơ đồ cho thấy cách các trường này tương tác để tạo ra sự xuất hiện.

00:09:13.000 --> 00:09:19.000
Vào ngày bắt đầu bạn chọn, giả sử ngày 11 tháng 6 lúc 9:00 sáng, một sự xuất hiện được tạo ra.

00:09:19.000 --> 00:09:24.000
Bạn có thể gửi đến sự xuất hiện này trong một ngày vì thời lượng được định cấu hình.

00:09:24.000 --> 00:09:32.000
Ngay sau khi sự cố đó hết hạn, ngày 12 tháng 6 lúc 9:00 sáng, một sự cố mới được tạo ra, bởi vì khởi động lại được định cấu hình để phù hợp với thời lượng.

00:09:32.000 --> 00:09:36.000
Quá trình này tiếp tục vô thời hạn.

00:09:36.000 --> 00:09:40.000
Điều cuối cùng cần cấu hình là thông tin bản địa hóa.

00:09:40.000 --> 00:09:44.000
Bảng xếp hạng cần điều này để hiển thị đúng cách trong giao diện người dùng Game Center.

00:09:44.000 --> 00:09:46.000
Ít nhất một ngôn ngữ phải được cấu hình.

00:09:46.000 --> 00:09:50.000
Tôi sẽ cấu hình cho tiếng Anh.

00:09:50.000 --> 00:09:54.000
Chọn một tên hiển thị thích hợp, như "Daily High Score" cho bảng xếp hạng hàng ngày.

00:09:54.000 --> 00:09:57.000
Bạn cũng cần chọn một định dạng điểm.

00:09:57.000 --> 00:10:01.000
Đối với một loại số nguyên, bạn có thể sử dụng dấu chấm hoặc dấu phẩy làm dấu phân cách hàng nghìn.

00:10:01.000 --> 00:10:04.000
Chọn một cái có ý nghĩa với ngôn ngữ của bạn.

00:10:04.000 --> 00:10:09.000
Hậu tố định dạng điểm số là một cách để chỉ định đơn vị điểm số của bạn, như điểm hoặc lượt truy cập.

00:10:09.000 --> 00:10:12.000
Tôi sẽ để trống cái này cho The Coast.

00:10:12.000 --> 00:10:19.000
Hình ảnh bảng xếp hạng là tùy chọn, nhưng nó được khuyến nghị vì nó mang lại giao diện tùy chỉnh cho trò chơi của bạn trong giao diện người dùng Trung tâm trò chơi.

00:10:19.000 --> 00:10:24.000
Có một hình ảnh được cung cấp trong thư mục Tài sản của dự án để bạn sử dụng ở đây, được đặt tên là leaderboardImage.

00:10:24.000 --> 00:10:26.000
Tải cái đó lên.

00:10:26.000 --> 00:10:31.000
Khi bạn đã lưu bảng xếp hạng, bạn có thể xác thực với Game Center và sử dụng nó trong trò chơi của mình.

00:10:31.000 --> 00:10:35.000
Vì vậy, hãy bắt đầu bằng cách bật xác thực Trung tâm trò chơi.

00:10:35.000 --> 00:10:42.000
Trong TitleScreenViewController, có một phương thức được gọi là authenticateLocalPlayer(), với phần thân được nhận xét.

00:10:42.000 --> 00:10:44.000
Hãy tiếp tục và bỏ bình luận về nó.

00:10:44.000 --> 00:10:52.000
Mã này đặt trình xử lý xác thực trên trình phát cục bộ, điều này sẽ kích hoạt luồng đăng nhập Trung tâm trò chơi khi bắt đầu.

00:10:52.000 --> 00:10:56.000
Nếu bạn cần thêm thông tin, hãy theo liên kết được cung cấp đến tài liệu.

00:10:56.000 --> 00:10:58.000
Bây giờ, chúng ta có thể nộp điểm.

00:10:58.000 --> 00:11:04.000
Trước đó, tôi đã chỉ cho bạn phương pháp trong GameScene cập nhật điểm số khi chạm kết thúc, được gọi là touchesEnded.

00:11:04.000 --> 00:11:11.000
Điều hướng đến đó.

00:11:11.000 --> 00:11:13.000
Có hai phương thức submitScore.

00:11:13.000 --> 00:11:16.000
Một là một phương thức lớp, và một là một phương thức thể hiện.

00:11:16.000 --> 00:11:22.000
Khi bạn gửi đến phương thức lớp học, việc gửi sẽ đi đến bất kỳ sự xuất hiện nào hiện đang hoạt động.

00:11:22.000 --> 00:11:25.000
Nó sẽ chỉ thất bại nếu không có sự xuất hiện tích cực.

00:11:25.000 --> 00:11:34.000
Để sử dụng phương thức phiên bản, trước tiên bạn tải một GKLeaderboard đại diện cho sự xuất hiện tại.

00:11:34.000 --> 00:11:49.000
Sau đó, khi bạn gửi điểm trong trình xử lý hoàn thành, nó sẽ chỉ thành công nếu sự xuất hiện đó vẫn đang hoạt động.

00:11:49.000 --> 00:11:54.000
Hãy xem xét một trò chơi cung cấp một thử thách độc đáo mỗi giờ, sử dụng bảng xếp hạng định kỳ hàng giờ.

00:11:54.000 --> 00:12:03.000
Bạn sẽ không muốn bất kỳ điểm số nào từ một thử thách rò rỉ vào sự xuất hiện của thử thách tiếp theo, chẳng hạn như do sự chậm trễ mạng giữa thiết bị của người chơi và máy chủ.

00:12:03.000 --> 00:12:06.000
Phương pháp điểm gửi ví dụ đảm bảo điều đó sẽ không xảy ra.

00:12:06.000 --> 00:12:13.000
Bảng xếp hạng hàng ngày của Coast không bị ràng buộc với một phiên trò chơi cụ thể, vì vậy không quan trọng sự xuất hiện nào nhận được điểm số.

00:12:13.000 --> 00:12:34.000
Hãy chỉ sử dụng phương pháp lớp học.

00:12:34.000 --> 00:12:38.000
Bây giờ, điểm số sẽ được gửi đến sự xuất hiện của bảng xếp hạng hiện đang hoạt động.

00:12:38.000 --> 00:12:41.000
Lưu ý rằng tôi đang đặt ngữ cảnh thành 0.

00:12:41.000 --> 00:12:46.000
Ngữ cảnh có thể được sử dụng để mã hóa một số thông tin cụ thể của trò chơi và lưu trữ nó với điểm số.

00:12:46.000 --> 00:12:50.000
Đối với The Coast, điểm số không cần bất kỳ bối cảnh bổ sung nào.

00:12:50.000 --> 00:12:57.000
Bây giờ bạn đang gửi lên bảng xếp hạng hàng ngày, hãy thêm một nút để hiển thị bảng xếp hạng trong giao diện người dùng Trung tâm trò chơi từ màn hình tiêu đề.

00:12:57.000 --> 00:13:04.000
Đầu tiên, đi đến TitleScreenViewController.

00:13:04.000 --> 00:13:12.000
Bạn sẽ cần tạo một phương pháp IBAction mới.

00:13:12.000 --> 00:13:19.000
Gọi nó là showLeaderboardVC.

00:13:19.000 --> 00:13:29.000
Khởi tạo một GKGameCenterViewController.

00:13:29.000 --> 00:13:45.000
Vượt qua ID bảng xếp hạng, một playerScope-- Tôi đang sử dụng global-- và timeScope.

00:13:45.000 --> 00:13:53.000
Đối với bảng xếp hạng định kỳ, timeScope phải là allTime.

00:13:53.000 --> 00:14:01.000
Đặt gameCenterDelegate thành "self".

00:14:01.000 --> 00:14:11.000
Sau đó, trình bày nó.

00:14:11.000 --> 00:14:23.000
Bạn cũng cần tạo một UIButton.

00:14:23.000 --> 00:14:30.000
Tôi chỉ đang gọi bảng xếp hạng của tôi là Nút.

00:14:30.000 --> 00:14:36.000
Sau đó, kết nối mọi thứ trong bảng phân cảnh chính.

00:14:36.000 --> 00:14:41.000
Chúng tôi đã cung cấp một bảng xếp hạng glyph để bạn sử dụng trong thư mục tài sản.

00:14:41.000 --> 00:14:43.000
Thêm một nút với hình ảnh đó, và xóa văn bản.

00:14:43.000 --> 00:14:52.000
Tôi sẽ đặt một ràng buộc tỷ lệ khung hình để đảm bảo glyph không bị kéo dài ra ngoài.

00:14:52.000 --> 00:14:57.000
Sau đó, đặt nó bên cạnh nút PLAY.

00:14:57.000 --> 00:15:06.000
Đặt sự kiện Touch Up Inside theo phương pháp mới của bạn.

00:15:06.000 --> 00:15:13.000
Và đặt Cửa hàng Tham chiếu Mới thành nút mới của bạn.

00:15:13.000 --> 00:15:28.000
Bây giờ, hãy xây dựng và chạy ứng dụng để dùng thử bảng xếp hạng mới của bạn.

00:15:28.000 --> 00:15:30.000
Bạn có thể được nhắc đăng nhập vào Trung tâm trò chơi.

00:15:30.000 --> 00:15:36.000
Làm điều đó ngay bây giờ, vì một tài khoản được xác thực là bắt buộc để bảng xếp hạng hoạt động.

00:15:36.000 --> 00:15:42.000
Nhấn vào bảng xếp hạng glyph sẽ đưa bạn trực tiếp đến bảng xếp hạng trong Game Center UI.

00:15:42.000 --> 00:15:45.000
Nếu bạn chưa chơi, bảng xếp hạng sẽ trống.

00:15:45.000 --> 00:16:08.000
Chơi một thời gian ngắn và kiểm tra lại bảng xếp hạng để xem điểm số mới của bạn.

00:16:08.000 --> 00:16:19.000
Bây giờ bạn đã có bảng xếp hạng và đang gửi điểm, hãy thêm điểm trực tiếp trong quá trình chơi trò chơi.

00:16:19.000 --> 00:16:27.000
Hãy nhìn vào lớp LeaderboardNode.

00:16:27.000 --> 00:16:34.000
Đây là một nút SpriteKit lấy danh sách các mục nhập bảng xếp hạng bao gồm tên và điểm số, sau đó hiển thị chúng theo thứ hạng.

00:16:34.000 --> 00:16:39.000
Nó có thể được khởi tạo với các mục nhập và cập nhật khi các mục nhập cần thay đổi.

00:16:39.000 --> 00:16:58.000
Thêm một bảng xếp hạng tùy chọnNode với tư cách là thành viên của GameScene.

00:16:58.000 --> 00:17:02.000
Chúng tôi khởi tạo vị trí bảng xếp hạng trong setupInitialGameplay.

00:17:02.000 --> 00:17:18.000
Khởi tạo nút ngay bên dưới đó.

00:17:18.000 --> 00:17:34.000
Tôi đang cấu hình nó với năm hàng và để trống các mục nhập ban đầu.

00:17:34.000 --> 00:17:46.000
Thêm nó vào nền Nút để hiển thị nó trong cảnh của bạn.

00:17:46.000 --> 00:17:50.000
Bây giờ, chúng ta cần tải các mục nhập và cập nhật bảng xếp hạng.

00:17:50.000 --> 00:18:02.000
Tôi sẽ tạo một chức năng updateLeaderboardNode cho việc này.

00:18:02.000 --> 00:18:13.000
Đầu tiên, tải bảng xếp hạng DailyHighScore.

00:18:13.000 --> 00:18:21.000
Trong trình xử lý hoàn thành, sử dụng bảng xếp hạng để tải năm mục hàng đầu từ bảng xếp hạng toàn cầu.

00:18:21.000 --> 00:18:38.000
Vì đây là bảng xếp hạng định kỳ, timeScope sẽ luôn là allTime.

00:18:38.000 --> 00:19:01.000
Khi những thứ này đã được tải, bạn sẽ cần chuyển đổi các mục GameKit thành cấu trúc LeaderboardEntry mà LeaderboardNode sử dụng nếu các mục nhập không bằng không.

00:19:01.000 --> 00:19:38.000
Sau đó, gọi phương thức updateEntries của LeaderboardNode.

00:19:38.000 --> 00:19:42.000
Bước cuối cùng là cập nhật LeaderboardNode trong suốt quá trình chơi.

00:19:42.000 --> 00:19:47.000
Trong trò chơi này, điểm số của người chơi thường xuyên thay đổi và bạn nên giữ Bảng xếp hạng Đồng bộ.

00:19:47.000 --> 00:20:03.000
Để làm điều đó, hãy gọi updateLeaderboardNode() trong trình xử lý hoàn thành cho submitScore.

00:20:03.000 --> 00:20:19.000
Để hiển thị bảng xếp hạng đúng cách trước khi người chơi ghi bàn, hãy gọi ngay sau khi nút đã được tạo.

00:20:19.000 --> 00:20:33.000
Bây giờ, tôi sẽ xây dựng và chạy lại.

00:20:33.000 --> 00:20:35.000
Tôi có một vài người bạn đang chơi trò chơi cùng với tôi.

00:20:35.000 --> 00:20:57.000
Bạn có thể thấy bảng xếp hạng liên tục cập nhật khi điểm số của chúng tôi tăng lên.

00:20:57.000 --> 00:21:05.000
Thay đổi cuối cùng tôi đang thực hiện là cho thấy thứ hạng hàng ngày hiện tại của người chơi khác với thứ hạng hàng ngày trước đó của họ như thế nào.

00:21:05.000 --> 00:21:13.000
Tôi sẽ đưa cái này vào GameMenuNode khi hết thời gian.

00:21:13.000 --> 00:21:21.000
Tôi có thể sử dụng một loạt các trình xử lý hoàn thành lồng nhau để thực hiện điều này, nhưng sử dụng các phương pháp không đồng bộ mới của GameKit sẽ làm cho mã này dễ đọc hơn.

00:21:21.000 --> 00:21:22.000
Tạo một phương pháp không đồng bộ mới.

00:21:22.000 --> 00:21:36.000
Hãy gọi nó là addRankToGameMenu().

00:21:36.000 --> 00:21:39.000
Vì các phương pháp không đồng bộ của GameKit có thể ném, bạn sẽ muốn phát hiện bất kỳ lỗi nào.

00:21:39.000 --> 00:21:45.000
Tôi sẽ đăng nhập chúng.

00:21:45.000 --> 00:21:53.000
Tải bảng xếp hạng hàng ngày và xác nhận rằng nó đã được trả lại thành công.

00:21:53.000 --> 00:21:56.000
Với ví dụ bảng xếp hạng đó, hãy làm hai việc.

00:21:56.000 --> 00:22:01.000
Đầu tiên, tải không đồng bộ các mục nhập với async let.

00:22:01.000 --> 00:22:08.000
Tôi để trống tham số for, vì tôi chỉ quan tâm đến điểm số của người chơi địa phương.

00:22:08.000 --> 00:22:20.000
Thứ hai, tải không đồng bộ lần xuất hiện trước đó của bảng xếp hạng và sử dụng nó để tải các mục nhập.

00:22:20.000 --> 00:22:24.000
Tôi sẽ cần viết một phương pháp trên gameMenuNode để hiển thị thông tin này.

00:22:24.000 --> 00:22:36.000
Hãy gọi nó là addRankNode.

00:22:36.000 --> 00:22:55.000
Vượt qua các cấp bậc hiện tại và trước đó.

00:22:55.000 --> 00:23:04.000
Bạn sẽ cần sử dụng try await để đợi họ sẵn sàng.

00:23:04.000 --> 00:23:23.000
Hãy tiếp tục và gọi phương thức không đồng bộ mới trong một khối tách khỏi timeIsUp.

00:23:23.000 --> 00:23:41.000
Sau đó, đi đến GameMenuNode để triển khai addRankNode.

00:23:41.000 --> 00:24:01.000
addRankNode sẽ tạo ra một số văn bản đơn giản bằng cách sử dụng sự khác biệt giữa thứ hạng trước đó và hiện tại.

00:24:01.000 --> 00:24:05.000
Nếu cả hai cấp bậc đều bằng không, bạn có thể quay trở lại.

00:24:05.000 --> 00:24:08.000
Hiển thị văn bản của bạn trong một nút nhãn.

00:24:08.000 --> 00:24:28.000
Tôi đang sử dụng một chức năng trợ giúp để tạo ra điều đó.

00:24:28.000 --> 00:24:36.000
Định vị nó một cách thích hợp.

00:24:36.000 --> 00:24:52.000
Tôi sẽ thêm nó ở giữa theo chiều ngang và hơi thấp hơn trung tâm theo chiều dọc.

00:24:52.000 --> 00:25:02.000
Sau đó, thêm nó vào nền.

00:25:02.000 --> 00:25:12.000
Bây giờ, hãy xem kết quả.

00:25:12.000 --> 00:25:15.000
Tôi đã chơi ngày hôm qua, vì vậy tôi có sẵn thứ hạng trước đó.

00:25:15.000 --> 00:25:21.000
Như bạn có thể thấy, thứ hạng của tôi hôm nay giảm một chút, một lý do chính đáng để tiếp tục chơi.

00:25:21.000 --> 00:25:37.000
Trong phiên này, tôi đã chỉ cho bạn cách thiết lập bảng xếp hạng định kỳ trong App Store Connect, và sau đó là cách sử dụng nó trong trò chơi của bạn, bằng cách gửi điểm số, liên kết đến giao diện người dùng bảng xếp hạng của Game Center và sử dụng API bảng xếp hạng để hiển thị trực tiếp toàn cầu và thứ hạng từ lần xuất hiện trước đó.

00:25:37.000 --> 00:25:44.000
Để biết thêm thông tin về bảng xếp hạng định kỳ, hãy xem "Nhấn vào Trung tâm trò chơi: Bảng xếp hạng, thành tích và nhiều người chơi" từ WWDC năm ngoái.

00:25:44.000 --> 00:25:48.000
Và hãy chắc chắn kiểm tra "Có gì mới trong Trung tâm trò chơi" tại WWDC năm nay.

00:25:48.000 --> 23:59:59.000
[Nhạc gõ].

