WEBVTT

00:00:00.000 --> 00:00:05.000
♪ Nhạc bass đang phát ♪

00:00:05.000 --> 00:00:09.000
♪

00:00:09.000 --> 00:00:10.000
Alex Telek: Xin chào, tôi là Alex.

00:00:10.000 --> 00:00:12.000
Tôi là một kỹ sư trong đội Shazam.

00:00:12.000 --> 00:00:14.000
Cảm ơn vì đã tham gia phiên này.

00:00:14.000 --> 00:00:22.000
Hôm nay, tôi sẽ chỉ cho bạn cách tạo trải nghiệm âm thanh tùy chỉnh cho ứng dụng của bạn với ShazamKit bằng cách sử dụng nhận dạng danh mục tùy chỉnh.

00:00:22.000 --> 00:00:31.000
Trong phiên này, tôi sẽ sử dụng một số khái niệm ShazamKit hiện có, chẳng hạn như danh mục, chữ ký và các mục phương tiện.

00:00:31.000 --> 00:00:37.000
Nếu bạn chưa quen thuộc với những thứ đó, hãy đảm bảo xem bài nói chuyện "Khám phá ShazamKit".

00:00:37.000 --> 00:00:41.000
Hãy xem những gì chúng ta sẽ đề cập hôm nay.

00:00:41.000 --> 00:00:46.000
Chúng ta sẽ nói về cách xây dựng danh mục với âm thanh và siêu dữ liệu tùy chỉnh.

00:00:46.000 --> 00:00:55.000
Chúng tôi sẽ tìm hiểu cách bạn có thể kết hợp âm thanh với danh mục tùy chỉnh của riêng mình khi sử dụng micrô và khung AVFAudio để ghi lại âm thanh.

00:00:55.000 --> 00:01:01.000
Sau đó, chúng tôi sẽ tùy chỉnh ứng dụng của mình để đồng bộ hóa nội dung với âm thanh tùy chỉnh.

00:01:01.000 --> 00:01:08.000
Cuối cùng, chúng tôi sẽ đề cập đến một số phương pháp hay nhất mà bạn có thể sử dụng khi làm việc với các danh mục tùy chỉnh.

00:01:08.000 --> 00:01:10.000
Đây là một mã-cùng.

00:01:10.000 --> 00:01:16.000
Có một dự án có sẵn trên cổng thông tin dành cho nhà phát triển mà chúng tôi sẽ sử dụng trong suốt phiên này.

00:01:16.000 --> 00:01:20.000
Tôi khuyên bạn nên tải xuống dự án trước khi chúng ta bắt đầu.

00:01:20.000 --> 00:01:26.000
Khi việc học ngày càng trở nên kỹ thuật số hơn, chúng ta cần đưa ra những cách để giữ cho trẻ em tham gia.

00:01:26.000 --> 00:01:35.000
Điều gì sẽ xảy ra nếu bạn có thể phát video trên Apple TV của mình và có một ứng dụng đồng hành hiển thị các câu hỏi chính xác vào đúng thời điểm?

00:01:35.000 --> 00:01:45.000
Hôm nay, tôi sẽ chỉ cho bạn cách xây dựng một ứng dụng từ xa đồng bộ hóa và phản ứng với video giáo dục bằng cách sử dụng nhận dạng danh mục tùy chỉnh.

00:01:45.000 --> 00:01:50.000
Đầu tiên, chính xác các danh mục tùy chỉnh là gì và làm thế nào để chúng ta xây dựng một danh mục?

00:01:50.000 --> 00:01:56.000
Danh mục tùy chỉnh là một tập hợp các chữ ký mà bạn tạo ra từ bất kỳ âm thanh nào.

00:01:56.000 --> 00:02:01.000
Bạn cũng có thể thêm siêu dữ liệu liên quan cho mỗi chữ ký.

00:02:01.000 --> 00:02:06.000
Để thêm chữ ký vào danh mục tùy chỉnh của bạn, bạn có thể sử dụng đối tượng SignatureGenerator.

00:02:06.000 --> 00:02:10.000
Nó sẽ chuyển đổi bộ đệm âm thanh thành chữ ký.

00:02:10.000 --> 00:02:22.000
Đầu tiên, tạo một trình tạo chữ ký, sau đó sử dụng chức năng installTap trên inputNode của audioEngine, thêm bộ đệm và audioTime vào trình tạo.

00:02:22.000 --> 00:02:27.000
Tham số bộ đệm là bộ đệm của âm thanh được thu từ đầu ra của inputNode.

00:02:27.000 --> 00:02:32.000
audioTime là thời gian mà bộ đệm được ghi lại.

00:02:32.000 --> 00:02:40.000
Khi bạn chỉ định Định dạng âm thanh, hãy đảm bảo rằng định dạng là PCM ở một trong các tỷ lệ mẫu được hỗ trợ.

00:02:40.000 --> 00:02:46.000
Gọi chức năng chữ ký trên trình tạo sẽ chuyển đổi bộ đệm âm thanh thành chữ ký.

00:02:46.000 --> 00:02:51.000
Chúng tôi gọi đây là chữ ký tham chiếu, sau đó chúng tôi có thể thêm vào danh mục tùy chỉnh.

00:02:51.000 --> 00:02:56.000
Bạn cũng có thể thêm chữ ký vào danh mục bằng cách sử dụng tệp shazamsignature.

00:02:56.000 --> 00:03:00.000
Đây là một tệp không rõ ràng có thể được chia sẻ trên các thiết bị.

00:03:00.000 --> 00:03:07.000
Để giúp việc áp dụng các danh mục tùy chỉnh với ShazamKit dễ dàng hơn, trong phiên này, chúng tôi đã bao gồm tệp này để bạn sử dụng.

00:03:07.000 --> 00:03:12.000
Trước khi chúng ta bắt đầu, hãy mở dự án đã tải xuống và xem chúng ta có gì trong đó.

00:03:12.000 --> 00:03:18.000
Chúng ta hãy xem xét kỹ đối tượng Câu hỏi.

00:03:18.000 --> 00:03:22.000
Một câu hỏi đại diện cho một nội dung tùy chỉnh trong ứng dụng.

00:03:22.000 --> 00:03:26.000
Đầu tiên, có một tiêu đề và một phần bù.

00:03:26.000 --> 00:03:29.000
Tiêu đề là một chuỗi mô tả một phần trong video.

00:03:29.000 --> 00:03:33.000
Bù đắp là thời gian khi phần này xuất hiện.

00:03:33.000 --> 00:03:38.000
Ví dụ, sau 45 giây, giáo viên bắt đầu nói về một phương trình toán học.

00:03:38.000 --> 00:03:45.000
Bạn sẽ tạo một Câu hỏi với tiêu đề đó và 45 làm phần bù.

00:03:45.000 --> 00:03:50.000
Phương trình đại diện cho một thời điểm giảng dạy, hiển thị các phương trình toán học.

00:03:50.000 --> 00:03:53.000
Bạn có thể sử dụng cái này như các khối xây dựng gia tăng.

00:03:53.000 --> 00:04:00.000
Ví dụ, bạn có thể muốn hiển thị phía bên trái và bên phải của một phương trình ở các độ lệch khác nhau.

00:04:00.000 --> 00:04:11.000
Cuối cùng, answerRange và requireAnswer được sử dụng để chỉ ra khi nào một giao diện người dùng tương tác sẽ hiển thị, vì vậy trẻ em có thể thực hành trả lời các câu hỏi.

00:04:11.000 --> 00:04:16.000
Hãy cùng xem điều này sẽ như thế nào đối với video giáo dục của chúng tôi.

00:04:16.000 --> 00:04:19.000
Câu hỏi đầu tiên bắt đầu từ 14 giây.

00:04:19.000 --> 00:04:27.000
Tôi có một quả táo đỏ ở 21 giây và thêm ba quả táo xanh ở 25 giây.

00:04:27.000 --> 00:04:33.000
Cuối cùng, sau 31 giây, học sinh sẽ có cơ hội trả lời câu hỏi.

00:04:33.000 --> 00:04:44.000
Lưu ý, các video thường được định dạng theo giờ, phút và giây, vì vậy để tạo độ lệch như tôi đã làm ở đây, trước tiên bạn nên chuyển đổi thời gian thành giây.

00:04:44.000 --> 00:04:52.000
Ví dụ, bạn có thể nhờ Siri giúp đỡ, như, "Ba phút 14 giây trong vài giây là gì?"

00:04:52.000 --> 00:04:57.000
Bây giờ, hãy đi sâu vào mã và xem cách chúng ta có thể bắt đầu với các danh mục tùy chỉnh!

00:04:57.000 --> 00:05:06.000
Đầu tiên, tôi sẽ xây dựng một danh mục bằng cách thêm chữ ký với một số siêu dữ liệu được liên kết với nó.

00:05:06.000 --> 00:05:13.000
Ở đây, tôi có CatalogProvider với chức năng tạo danh mục.

00:05:13.000 --> 00:05:24.000
Chữ ký tham khảo mà bạn sẽ thêm vào danh mục được gọi là FoodMath.shazamsignature.

00:05:24.000 --> 00:05:29.000
Hãy tải tệp đó vào và tạo một đối tượng chữ ký từ nó.

00:05:29.000 --> 00:05:39.000
Khi bạn có điều đó, bạn xác định siêu dữ liệu bằng cách sử dụng các mục phương tiện.

00:05:39.000 --> 00:05:46.000
Tôi sẽ đặt một số khóa thuộc tính mục phương tiện được xác định trước, chẳng hạn như tiêu đề và phụ đề.

00:05:46.000 --> 00:05:49.000
Điều này sẽ mô tả video giáo dục.

00:05:49.000 --> 00:05:58.000
Tôi cũng đã tạo một tiện ích mở rộng trên SHMediaItemProperty với hai khóa tùy chỉnh: giáo viên và tập.

00:05:58.000 --> 00:06:04.000
Đặt số tập và tên của giáo viên sẽ tùy chỉnh thêm nội dung của danh mục.

00:06:04.000 --> 00:06:15.000
Tất cả những gì bạn phải làm bây giờ là tạo một đối tượng customCatalog.

00:06:15.000 --> 00:06:21.000
Sau đó gọi addReferenceSignature trên đó và chuyển chữ ký và đối tượng mediaItem.

00:06:21.000 --> 00:06:27.000
Điều này sẽ liên kết siêu dữ liệu bạn vừa tạo với chữ ký tham chiếu bạn đã tải từ đĩa.

00:06:27.000 --> 00:06:29.000
Hoàn hảo!

00:06:29.000 --> 00:06:36.000
Bây giờ tôi đã có nó, tôi có thể bắt đầu kết hợp âm thanh với danh mục và xem kết quả đang hoạt động.

00:06:36.000 --> 00:06:40.000
Vậy hãy mở Matcher.

00:06:40.000 --> 00:06:47.000
Chúng tôi sẽ khớp âm thanh đầu vào từ micrô với nội dung của danh mục tùy chỉnh mà chúng tôi vừa tạo.

00:06:47.000 --> 00:06:54.000
Để ghi lại âm thanh từ micrô, bạn có thể sử dụng AVAudioEngine từ AVFAudio.

00:06:54.000 --> 00:07:03.000
Trong dự án này, tôi đã thêm mô tả về việc sử dụng micrô trong tệp Info.plist.

00:07:03.000 --> 00:07:12.000
Cũng trong Matcher, tôi đã bao gồm mã để yêu cầu quyền micrô và thiết lập phiên âm thanh.

00:07:12.000 --> 00:07:23.000
Đầu tiên, để nhận thông tin cập nhật về các trận đấu, bạn tạo một đối tượng phiên và đặt đại diện.

00:07:23.000 --> 00:07:30.000
Chức năng đối sánh lấy danh mục tùy chỉnh mà chúng tôi đã tạo trước đó, vì vậy bạn có thể chuyển nó cho phiên.

00:07:30.000 --> 00:07:41.000
Bây giờ, bạn đã sẵn sàng để kết hợp âm thanh bằng cách sử dụng chức năng installTap trên inputNode của audioEngine.

00:07:41.000 --> 00:07:51.000
Hàm trả về một audioBuffer - đó là âm thanh được chuyển đổi từ micrô - và audioTime - là thời gian bộ đệm được ghi lại.

00:07:51.000 --> 00:07:59.000
Sau đó, bạn gọi matchStreamingBuffer trong phiên và chuyển bộ đệm âm thanh và thời gian âm thanh.

00:07:59.000 --> 00:08:09.000
Chúng tôi khuyên bạn nên bao gồm thời gian khi có sẵn vì điều này sẽ được xác thực bởi phiên để đảm bảo rằng âm thanh được cung cấp tiếp giáp nhau.

00:08:09.000 --> 00:08:24.000
Vì bạn đã đặt đại diện phiên ở đầu, để xử lý các cập nhật, bạn có thể triển khai phiên: didFind match: chức năng từ đại diện phiên.

00:08:24.000 --> 00:08:32.000
Đối với điều này, tôi đã tạo ra một đối tượng gọi là MatchResult.

00:08:32.000 --> 00:08:43.000
Nó chứa một MatchedMediaItem, được trả về bởi phiên: didFind match: hàm, đây là siêu dữ liệu được liên kết với chữ ký tham chiếu trong danh mục.

00:08:43.000 --> 00:08:49.000
Nó sẽ bao gồm các chi tiết mà chúng tôi đã tạo trước đó, như số tập và tên của giáo viên.

00:08:49.000 --> 00:08:56.000
Nó chỉ có thể được tạo ra từ một trận đấu, và nó chứa thêm thông tin liên quan đến điều đó.

00:08:56.000 --> 00:09:03.000
Cũng trong MatchResult, chúng tôi có đối tượng Câu hỏi mà tôi đã chỉ cho bạn trước đó.

00:09:03.000 --> 00:09:07.000
Điều này đại diện cho một phần trong video với một phương trình toán học.

00:09:07.000 --> 00:09:11.000
Chúng tôi sẽ sử dụng cái này để tìm nội dung liên quan cho một trận đấu.

00:09:11.000 --> 00:09:26.000
Vì vậy, bên trong đại diện, chúng tôi đặt MatchResult để lấy đối tượng MatchedMediaItem đầu tiên và bây giờ chúng tôi sẽ không đặt gì cho Câu hỏi.

00:09:26.000 --> 00:09:30.000
Bây giờ hãy xây dựng và chạy và xem trận đấu đang hoạt động.

00:09:30.000 --> 00:09:36.000
Đây là ứng dụng FoodMath của chúng tôi, nó có một danh sách các tập có sẵn cho học sinh.

00:09:36.000 --> 00:09:41.000
Tôi có thể phát video và cùng với đồng nghiệp Neil của tôi, chúng ta có thể học cách giải một số bài toán.

00:09:41.000 --> 00:09:44.000
Neil, bạn có gì cho chúng tôi hôm nay?

00:09:44.000 --> 00:09:52.000
Neil: Vì vậy, định dạng là tôi sẽ hỏi bạn một câu hỏi, bạn sẽ có một chút thời gian để suy nghĩ về nó, và sau đó chúng ta sẽ xem liệu bạn có hiểu đúng không!

00:09:52.000 --> 00:10:02.000
Bạn cũng có thể chơi cùng nếu bạn có ứng dụng của chúng tôi. &lt; Khi tôi bắt đầu video, ứng dụng nhận ra rằng chúng tôi đang nghe tập ba, "Count on Me."

00:10:02.000 --> 00:10:04.000
Điều này thật tuyệt!

00:10:04.000 --> 00:10:12.000
Tiếp theo, tôi muốn tìm ra những phần nào cần hiển thị cho một độ lệch cụ thể trong âm thanh, sử dụng đối tượng Câu hỏi của chúng tôi.

00:10:12.000 --> 00:10:23.000
Chúng tôi sử dụng MatchedMediaItem để biết chúng tôi đang xem video nào, nhưng nó cũng chứa thông tin bổ sung về trận đấu, chẳng hạn như CurrentMatchOffset được dự đoán.

00:10:23.000 --> 00:10:30.000
Đây là vị trí tự động cập nhật trong chữ ký tham chiếu được biểu thị dưới dạng khoảng thời gian tính bằng giây.

00:10:30.000 --> 00:10:37.000
Bạn có thể sử dụng điều này để tìm ra vị trí của bạn trong video và tìm đối tượng Câu hỏi có liên quan.

00:10:37.000 --> 00:10:53.000
Quay trở lại mã, trong cuộc gọi lại đại diện, thay vì đặt nil, tôi muốn tìm Câu hỏi cuối cùng xuất hiện ngay sau CurrentMatchOffset dự đoán.

00:10:53.000 --> 00:10:57.000
Tôi có thể sử dụng độ lệch của câu hỏi để so sánh các giá trị.

00:10:57.000 --> 00:11:06.000
phiên:didFindMatch có thể được gọi nhiều lần với cùng một trận đấu.

00:11:06.000 --> 00:11:13.000
Vì vậy, hãy triển khai một bộ lọc sẽ chỉ cập nhật kết quả khi bạn nhận được một đối tượng Câu hỏi mới.

00:11:13.000 --> 00:11:21.000
Một khi bạn có điều đó, bạn có thể cập nhật kết quả với giá trị.

00:11:21.000 --> 00:11:28.000
Bây giờ hãy xem nó trông như thế nào; xây dựng và chạy.

00:11:28.000 --> 00:11:31.000
Lần này, tôi muốn tìm hiểu về sự bổ sung.

00:11:31.000 --> 00:11:40.000
Tôi sẽ phát lại video và xem liệu nội dung của câu hỏi có hiển thị đồng bộ với video hay không.

00:11:40.000 --> 00:11:43.000
Neil: Câu hỏi một. Hãy bắt đầu nào.

00:11:43.000 --> 00:11:54.000
Hôm nay tôi đã đến các cửa hàng và tôi tưởng tượng ra một vài quả táo, vì vậy tôi đã mua một quả táo đỏ; và tôi đã mua một, hai, ba quả táo xanh.

00:11:54.000 --> 00:11:57.000
Tôi đã mua tổng cộng bao nhiêu quả táo?

00:11:57.000 --> 00:12:04.000
Bộ đếm thời gian của bạn bắt đầu... ngay bây giờ. &lt; Alex: Bây giờ là thời gian đặt câu hỏi. Một cộng ba là gì?

00:12:04.000 --> 00:12:07.000
Nó có thể là năm không?

00:12:07.000 --> 00:12:10.000
Ồ. Không, tôi đã hiểu sai cái đó. Hãy thử lại lần nữa.

00:12:10.000 --> 00:12:19.000
Tôi sẽ tua lại video, và lần này tôi sẽ chú ý nhiều hơn!

00:12:19.000 --> 00:12:22.000
Neil: Câu hỏi một. Hãy bắt đầu nào.

00:12:22.000 --> 00:12:34.000
Hôm nay tôi đã đến các cửa hàng và tôi tưởng tượng ra một vài quả táo, vì vậy tôi đã mua một quả táo đỏ; và tôi đã mua một, hai, ba quả táo xanh.

00:12:34.000 --> 00:12:36.000
Tôi đã mua tổng cộng bao nhiêu quả táo?

00:12:36.000 --> 00:12:46.000
Bộ đếm thời gian của bạn bắt đầu... ngay bây giờ. &lt; Alex: Bây giờ tôi nghe lại nó, tôi biết rằng câu trả lời là bốn.

00:12:46.000 --> 00:12:49.000
Điều gì sẽ xảy ra nếu bạn thấy câu hỏi này quá dễ dàng?

00:12:49.000 --> 00:13:00.000
Hãy để tôi bỏ qua và xem Neil có điều gì phức tạp hơn một chút để dạy chúng ta không.

00:13:00.000 --> 00:13:04.000
Neil: Câu hỏi bốn. Câu hỏi cuối cùng.

00:13:04.000 --> 00:13:08.000
Vì vậy hôm nay, tôi cảm thấy khá đói.

00:13:08.000 --> 00:13:12.000
Vì vậy, tôi đã quyết định sẽ mua 14 quả táo.

00:13:12.000 --> 00:13:25.000
Một... hai... ba... bốn -- &lt; Alex: Đó là rất nhiều táo. Hãy để tôi tiếp tục thêm một chút nữa.

00:13:25.000 --> 00:13:27.000
Bỏ qua phía trước 20 giây.

00:13:27.000 --> 00:13:32.000
Neil: Vì vậy tôi quyết định mua thêm 28 quả táo nữa.

00:13:32.000 --> 00:13:42.000
Một... hai... ba...

00:13:42.000 --> 00:13:49.000
Bốn... năm... sáu...

00:13:49.000 --> 00:13:55.000
26... 27...

00:13:55.000 --> 00:13:57.000
28 quả táo.

00:13:57.000 --> 00:13:59.000
Tôi đã mua tổng cộng bao nhiêu quả táo?

00:13:59.000 --> 00:14:04.000
Bộ đếm thời gian của bạn bắt đầu ngay bây giờ. &lt; Alex: Bây giờ, đó là một câu hỏi tuyệt vời.

00:14:04.000 --> 00:14:05.000
Bạn đã theo dõi chưa?

00:14:05.000 --> 00:14:10.000
Tôi sẽ đi với con số yêu thích của tôi!

00:14:10.000 --> 00:14:11.000
Đúng rồi!

00:14:11.000 --> 00:14:15.000
Câu trả lời cho câu hỏi cuối cùng là 42!

00:14:15.000 --> 00:14:21.000
Thật đơn giản: bất kể học sinh ở đâu trong video, ứng dụng từ xa của bạn sẽ cập nhật và cập nhật nội dung.

00:14:21.000 --> 00:14:27.000
Hãy đề cập đến một số phương pháp hay nhất khi sử dụng danh mục tùy chỉnh.

00:14:27.000 --> 00:14:34.000
Danh mục tùy chỉnh có thể được chia sẻ liền mạch giữa các thiết bị bằng cách sử dụng phần mở rộng tệp shazamcatalog.

00:14:34.000 --> 00:14:41.000
Bạn có thể tải và lưu vào đĩa bằng cách sử dụng fileURL cũng như gửi chúng qua mạng.

00:14:41.000 --> 00:14:50.000
Khi sử dụng dịch vụ web từ xa, bạn có thể muốn tải xuống danh mục trước và sau đó sử dụng chức năng thêm trên đối tượng danh mục tùy chỉnh.

00:14:50.000 --> 00:14:56.000
Đảm bảo cung cấp danh mục địa phương khi không có sẵn danh mục nào trên mạng.

00:14:56.000 --> 00:15:01.000
Danh mục có thể lưu trữ các khóa tùy chỉnh để trả lại dữ liệu cụ thể cho trường hợp sử dụng của bạn.

00:15:01.000 --> 00:15:08.000
Đảm bảo rằng dữ liệu bạn thêm vào danh mục của mình là một trong những giá trị danh sách tài sản hợp lệ.

00:15:08.000 --> 00:15:23.000
Khi sử dụng matchStreamingBuffer, ShazamKit sẽ khớp với luồng âm thanh và cân bằng hiệu suất cũng như cường độ tìm kiếm, thực hiện tất cả công việc tạo và tự động cập nhật chữ ký cho bạn.

00:15:23.000 --> 00:15:36.000
Vì vậy, bây giờ bạn đã xây dựng một ứng dụng đầy đủ được đồng bộ hóa với video giáo dục, cập nhật nội dung đến nơi học sinh hiện chỉ sử dụng chữ ký và danh mục tùy chỉnh.

00:15:36.000 --> 00:15:43.000
Đây chỉ là một trong nhiều ví dụ có thể xảy ra và chúng tôi thực sự vui mừng khi thấy những gì bạn sẽ xây dựng bằng ShazamKit.

00:15:43.000 --> 00:15:46.000
Cảm ơn bạn và chúc bạn có một WWDC tuyệt vời.

00:15:46.000 --> 23:59:59.000
♪

