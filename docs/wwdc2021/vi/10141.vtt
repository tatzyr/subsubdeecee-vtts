WEBVTT

00:00:00.000 --> 00:00:05.000
♪ Nhạc bass đang phát ♪

00:00:05.000 --> 00:00:10.000
♪

00:00:10.000 --> 00:00:13.000
Naiwei Zheng: Xin chào. Chào mừng đến với WWDC.

00:00:13.000 --> 00:00:15.000
Tên tôi là Zheng Naiwei.

00:00:15.000 --> 00:00:18.000
Tôi đến từ Nhóm Phát trực tuyến HLS của Apple.

00:00:18.000 --> 00:00:27.000
Hôm nay tôi sẽ nói về một tính năng mới trong HLS được gọi là Chỉ đạo nội dung và cách nó có thể cải thiện tính khả dụng phát trực tuyến toàn cầu.

00:00:27.000 --> 00:00:32.000
Kết nối mạng ngày nay ở quy mô toàn cầu.

00:00:32.000 --> 00:00:36.000
Các nhà cung cấp phương tiện truyền thông trực tuyến cung cấp nội dung của họ trên toàn thế giới.

00:00:36.000 --> 00:00:44.000
Tuy nhiên, việc cung cấp nội dung ở quy mô toàn cầu đi kèm với rất nhiều thách thức mà ngành công nghiệp phải giải quyết.

00:00:44.000 --> 00:00:52.000
Chúng tôi, Nhóm phát trực tuyến HLS tại Apple, cũng nhận ra những vấn đề đầy thách thức này và liên tục làm việc để cung cấp các giải pháp.

00:00:52.000 --> 00:00:57.000
Hôm nay, chúng tôi sẽ tập trung vào vấn đề sẵn có.

00:00:57.000 --> 00:01:02.000
Cụ thể, giảm thiểu tắc nghẽn mạng và phục hồi lỗi.

00:01:02.000 --> 00:01:07.000
Để giúp chúng tôi hiểu những vấn đề này, chúng ta hãy xem một ví dụ.

00:01:07.000 --> 00:01:17.000
Giả sử một nhà cung cấp dịch vụ phát trực tuyến phổ biến ở châu Á triển khai cơ sở hạ tầng CDN của mình ở ba quốc gia sau: Trung Quốc, Nhật Bản và Singapore.

00:01:17.000 --> 00:01:22.000
Trong biểu đồ này, chúng tôi đang hiển thị trạng thái mà mọi thứ đang hoạt động trong tình trạng hoàn hảo.

00:01:22.000 --> 00:01:35.000
Chúng tôi có người dùng ở Trung Quốc phát trực tuyến từ CDN Trung Quốc và người dùng từ Nhật Bản phát trực tuyến từ CDN Nhật Bản và cả hai mạng CDN đều đang hoạt động ở mức có khả năng.

00:01:35.000 --> 00:01:38.000
Bây giờ, hãy giới thiệu một số thay đổi.

00:01:38.000 --> 00:01:49.000
Giả sử một lúc sau, người dùng ở Trung Quốc phát trực tuyến từ CDN của Trung Quốc đã tăng lên rất nhiều, đến mức mạng CDN đang trở nên quá tải.

00:01:49.000 --> 00:01:56.000
Với các công nghệ HLS mà chúng tôi có, thật khó để giải quyết đầy đủ vấn đề tắc nghẽn mạng này.

00:01:56.000 --> 00:02:09.000
Mặc dù chúng tôi có thể chỉ định người dùng mới cho các CDN khác nhau, tuy nhiên, rất khó để hướng dẫn các khách hàng hiện tại sử dụng một CDN khác và lưu lượng hiện tại sẽ liên tục làm quá tải CDN hiện tại.

00:02:09.000 --> 00:02:17.000
Với tính năng Chỉ đạo Nội dung HLS mới của chúng tôi, các nhà cung cấp nội dung có thể giải quyết vấn đề này bằng cách lưu trữ máy chủ chỉ đạo của riêng họ.

00:02:17.000 --> 00:02:24.000
Nó thiết lập một kênh phụ với tất cả các khách hàng HLS mới nhất để cập nhật cho họ chính sách CDN mới nhất.

00:02:24.000 --> 00:02:33.000
Ví dụ, nó có thể gửi bản cập nhật chính sách cho 30 phần trăm khách hàng hiện tại ở Trung Quốc để chuyển sang CDN Nhật Bản.

00:02:33.000 --> 00:02:41.000
Và các khách hàng nhận được bản cập nhật chính sách sẽ tôn trọng sự thay đổi và chuyển hướng lưu lượng mạng của họ đến CDN Nhật Bản.

00:02:41.000 --> 00:02:46.000
Giờ đây, tình trạng tắc nghẽn mạng trong CDN của Trung Quốc đã được giảm thiểu.

00:02:46.000 --> 00:02:51.000
Nhưng tắc nghẽn mạng chỉ là một trong nhiều vấn đề về tính khả dụng.

00:02:51.000 --> 00:02:54.000
Điều gì xảy ra khi mất mạng?

00:02:54.000 --> 00:02:56.000
Hãy lấy một ví dụ khác.

00:02:56.000 --> 00:03:04.000
Giả sử đường dẫn mạng từ người dùng ở Nhật Bản đến CDN Nhật Bản đã trải qua sự cố ngừng hoạt động trong khu vực.

00:03:04.000 --> 00:03:16.000
Với các công nghệ HLS mà chúng tôi có, các nhà cung cấp nội dung có thể liệt kê các luồng biến thể dự phòng của chúng tôi trong danh sách phát chính, vì vậy khách hàng có thể thử xem qua danh sách cho đến khi nó đạt đến CDN hoạt động.

00:03:16.000 --> 00:03:27.000
Nhưng cách tiếp cận này là sơ bộ theo nghĩa là nhà cung cấp nội dung không thể thay đổi thứ tự hoặc mức ưu tiên của các CDN được liệt kê trong danh sách phát chính trong thời gian thực.

00:03:27.000 --> 00:03:35.000
Tuy nhiên, với sự trợ giúp của máy chủ chỉ đạo, khách hàng sẽ được cập nhật các ưu tiên CDN mới nhất vào thời gian gần như thực.

00:03:35.000 --> 00:03:41.000
Hãy tua lại một chút để xem nó có thể tạo điều kiện cho khách hàng khôi phục lỗi hiệu quả hơn như thế nào.

00:03:41.000 --> 00:03:49.000
Trước khi mạng ngừng hoạt động, các khách hàng ở Nhật Bản định kỳ lấy các bản cập nhật danh sách ưu tiên CDN từ máy chủ chỉ đạo.

00:03:49.000 --> 00:04:03.000
Giả sử trong bản cập nhật mới nhất, khách hàng ở Nhật Bản đã nhận được danh sách ưu tiên CDN sau đây, nơi CDN Nhật Bản được ưa thích nhất, sau Singapore và sau đó là Trung Quốc.

00:04:03.000 --> 00:04:09.000
Hiện tại, người dùng ở Nhật Bản đang phát trực tuyến từ CDN Nhật Bản.

00:04:09.000 --> 00:04:16.000
Bây giờ khi sự cố mất mạng xảy ra, CDN Nhật Bản sẽ bị đánh dấu là bị phạt từ danh sách ưu tiên.

00:04:16.000 --> 00:04:26.000
Khách hàng sẽ chuyển sang CDN tiếp theo trong danh sách ưu tiên, trong trường hợp này là CDN ở Singapore và chuyển hướng lưu lượng mạng của họ.

00:04:26.000 --> 00:04:32.000
Giờ đây, người dùng ở Nhật Bản sẽ có thể tiếp tục xem các chương trình của họ mà không bị gián đoạn.

00:04:32.000 --> 00:04:39.000
Những gì ví dụ của chúng tôi cho bạn thấy chỉ là một cái nhìn tổng quan cấp cao về tính năng HLS mới của chúng tôi, Chỉ đạo nội dung.

00:04:39.000 --> 00:04:45.000
Bây giờ hãy đi sâu hơn để chỉ cho bạn cách tích hợp tính năng tuyệt vời này vào các luồng của bạn.

00:04:45.000 --> 00:04:52.000
Nó chỉ là một danh sách đơn giản các URL CDN khác nhau sao chép tất cả các biến thể có sẵn.

00:04:52.000 --> 00:04:59.000
Như đã giải thích trước đây, một danh sách phát như thế này có thứ tự liên tục và cuối cùng của các ưu tiên CDN.

00:04:59.000 --> 00:05:03.000
Các nhà cung cấp nội dung không thể thay đổi nó sau này trong quá trình phát lại.

00:05:03.000 --> 00:05:10.000
Bây giờ hãy xem cách thêm hỗ trợ Chỉ đạo Nội dung vào danh sách phát này.

00:05:10.000 --> 00:05:14.000
Bạn có thể ngạc nhiên khi sự thay đổi được giới thiệu ít như thế nào.

00:05:14.000 --> 00:05:18.000
Trên thực tế, những thay đổi tương thích ngược với các khách hàng HLS hiện tại.

00:05:18.000 --> 00:05:21.000
Hãy xem qua các bổ sung.

00:05:21.000 --> 00:05:34.000
Đáng chú ý nhất, bây giờ chúng tôi nhóm các luồng biến thể thành các con đường khác nhau bằng các thuộc tính PATHWAY-ID trên mỗi luồng biến thể, trong đó mỗi con đường thường tương ứng với một CDN.

00:05:34.000 --> 00:05:46.000
Trong ví dụ này, chúng tôi nhóm các luồng biến thể thành con đường CN, JP và SG, đại diện cho các CDN ở Trung Quốc, Nhật Bản và Singapore, tương ứng.

00:05:46.000 --> 00:05:54.000
Tuy nhiên, một con đường có thể chứa các luồng biến thể từ các CDN khác nhau để cho phép trường hợp sử dụng nâng cao hơn.

00:05:54.000 --> 00:06:01.000
Khi khách hàng chọn một con đường, chỉ những luồng biến thể từ con đường đó mới đủ điều kiện để lựa chọn biến thể.

00:06:01.000 --> 00:06:10.000
Thuộc tính PATHWAY-ID trên thẻ CONTENT-STEERING mới chỉ định đường dẫn ban đầu để sử dụng khi khởi động phát lại.

00:06:10.000 --> 00:06:18.000
Vì vậy, trong trường hợp này, khách hàng sẽ chỉ chọn từ các luồng biến thể thuộc đường dẫn CN ở lần phát lại ban đầu.

00:06:18.000 --> 00:06:23.000
Thuộc tính SERVER-URI chỉ định máy chủ Chỉ đạo Nội dung ở đâu.

00:06:23.000 --> 00:06:28.000
Khách hàng sẽ yêu cầu cập nhật Chỉ đạo Nội dung từ URI này.

00:06:28.000 --> 00:06:31.000
Nhưng nếu danh sách phát của bạn chứa các nhóm phương tiện thì sao?

00:06:31.000 --> 00:06:32.000
Không vấn đề gì.

00:06:32.000 --> 00:06:36.000
Nó vẫn rất đơn giản để kích hoạt Chỉ đạo Nội dung.

00:06:36.000 --> 00:06:45.000
Tất cả những gì bạn phải làm là sao chép các nhóm phương tiện cho mỗi con đường và gán chúng bằng các GROUP-ID duy nhất.

00:06:45.000 --> 00:06:56.000
Ví dụ, nhóm âm thanh trong danh sách phát này đang được sao chép cho mỗi con đường, với GROUP-ID được đặt thành âm thanh CN cho con đường CN và vân vân.

00:06:56.000 --> 00:07:05.000
Khi một máy khách HLS tải một danh sách phát chính với thẻ Chỉ đạo Nội dung, nó sẽ kích hoạt một quy trình khởi động hơi khác một chút.

00:07:05.000 --> 00:07:14.000
Đầu tiên, khi nó thực hiện lựa chọn luồng biến thể ban đầu, nó sẽ chỉ sử dụng các luồng biến thể từ con đường ban đầu.

00:07:14.000 --> 00:07:22.000
Sau đó, nó sẽ tải và bắt đầu phát luồng biến thể đã chọn và các phân đoạn phương tiện của nó như bình thường.

00:07:22.000 --> 00:07:30.000
Nhưng song song với thói quen phát lại thông thường, khách hàng sẽ bắt đầu thực hiện các yêu cầu Bản kê khai chỉ đạo định kỳ trong nền.

00:07:30.000 --> 00:07:36.000
Chúng ta hãy xem yêu cầu Bản kê khai chỉ đạo trông như thế nào.

00:07:36.000 --> 00:07:45.000
Nó chỉ là một yêu cầu HTTP GET đơn giản được gửi đến URI đã được giải quyết này từ thuộc tính SERVER-URI dựa trên URL danh sách phát chính.

00:07:45.000 --> 00:07:49.000
Máy chủ chỉ đạo sẽ phản hồi bằng Bản kê khai chỉ đạo.

00:07:49.000 --> 00:07:53.000
Hãy phân tích định dạng của nó với một ví dụ.

00:07:53.000 --> 00:07:56.000
Bản kê khai chỉ đạo là một tài liệu JSON.

00:07:56.000 --> 00:08:02.000
Máy chủ chỉ đạo có thể tạo ra các Bản kê khai chỉ đạo tùy chỉnh cho từng khách hàng.

00:08:02.000 --> 00:08:08.000
Điều này mang lại cho máy chủ điều khiển tiềm năng lớn trong việc định hình lưu lượng mạng được quản lý của nó.

00:08:08.000 --> 00:08:14.000
Thuộc tính quan trọng nhất trong Bản kê khai chỉ đạo này là trường PATHWAY-PRIORITY.

00:08:14.000 --> 00:08:21.000
Đó là danh sách các ID lộ trình được sắp xếp theo các ưu tiên của họ, với ID đầu tiên là ưu tiên nhất.

00:08:21.000 --> 00:08:30.000
Ở đây trong ví dụ này, chúng tôi ưu tiên con đường CN được ưu tiên nhất, tiếp theo là JP và sau đó là SG.

00:08:30.000 --> 00:08:42.000
Khi nhận được Bản kê khai chỉ đạo từ máy chủ chỉ đạo, khách hàng sẽ thực hiện đánh giá Chỉ đạo nội dung để xác định xem có nên chuyển sang một con đường khác hay không.

00:08:42.000 --> 00:08:47.000
Đầu tiên, khách hàng sẽ loại trừ các luồng biến thể không đủ điều kiện để lựa chọn.

00:08:47.000 --> 00:08:52.000
Điều này bao gồm các luồng biến thể bị phạt do lỗi mạng.

00:08:52.000 --> 00:09:00.000
Ngoài ra, các luồng biến thể với codec không được hỗ trợ, giống như lựa chọn biến thể thông thường sẽ làm.

00:09:00.000 --> 00:09:11.000
Nó sẽ chọn một con đường có ít nhất một luồng biến thể đủ điều kiện và có mức độ ưu tiên con đường cao nhất trong số tất cả các con đường đủ điều kiện.

00:09:11.000 --> 00:09:20.000
Nếu con đường được chọn khác với con đường hiện đang sử dụng, khách hàng sẽ ngay lập tức chuyển sang con đường mới.

00:09:20.000 --> 00:09:31.000
Nếu không có con đường phù hợp nào được chọn hoặc đã sử dụng con đường đã chọn, khách hàng sẽ không làm gì cả và tiếp tục chơi bằng con đường hiện tại.

00:09:31.000 --> 00:09:39.000
Cuối cùng, khách hàng sẽ lên lịch cho yêu cầu Bản kê khai chỉ đạo tiếp theo để lấy các bản cập nhật mới nhất từ máy chủ chỉ đạo.

00:09:39.000 --> 00:09:42.000
Vậy lịch trình này hoạt động như thế nào?

00:09:42.000 --> 00:09:45.000
Hãy xem lại Bản kê khai chỉ đạo.

00:09:45.000 --> 00:09:56.000
Lưu ý rằng có một trường TTL chỉ định số giây mà khách hàng nên đợi cho đến khi gửi yêu cầu Bản kê khai chỉ đạo tiếp theo.

00:09:56.000 --> 00:10:12.000
Trong ví dụ này, sau khi khách hàng thực hiện đánh giá Chỉ đạo Nội dung bằng cách sử dụng danh sách ưu tiên con đường của Bản kê khai Chỉ đạo này, nó sẽ lên lịch cho yêu cầu Bản kê khai Chỉ đạo tiếp theo trong 300 giây, tức là năm phút.

00:10:12.000 --> 00:10:24.000
Cũng cần lưu ý rằng máy chủ chỉ đạo có thể thay đổi giá trị TTL này trong mỗi phản hồi Bản kê khai chỉ đạo, ảnh hưởng đến thời gian khách hàng nên lên lịch cho yêu cầu tiếp theo.

00:10:24.000 --> 00:10:33.000
Nó cũng hữu ích cho việc điều khiển máy chủ để đưa một số ngẫu nhiên vào giá trị TTL của mỗi khách hàng để phân phối tải máy chủ.

00:10:33.000 --> 00:10:41.000
Ngoài ra, trường RELOAD-URI tùy chọn cho khách hàng biết nơi yêu cầu Bản kê khai chỉ đạo tiếp theo.

00:10:41.000 --> 00:10:50.000
Máy chủ chỉ đạo có thể tận dụng trường này để đưa dữ liệu phiên hoặc trạng thái dành riêng cho khách hàng vào URL để được lặp lại trong yêu cầu tiếp theo.

00:10:50.000 --> 00:10:55.000
Bây giờ bạn đã thấy các chi tiết kỹ thuật chính của Chỉ đạo Nội dung.

00:10:55.000 --> 00:11:02.000
Hãy quay lại một trong những ví dụ ban đầu của chúng tôi để xem nó hoạt động như thế nào dưới mui xe.

00:11:02.000 --> 00:11:18.000
Giả sử trong trường hợp này, tất cả người dùng ở Trung Quốc đã nhận được Bản kê khai chỉ đạo với lộ trình CN được ưu tiên nhất và CDN tương ứng của Trung Quốc đang bị quá tải vì số lượng người dùng ngày càng tăng.

00:11:18.000 --> 00:11:30.000
Vì vậy, máy chủ chỉ đạo đã hoạt động và gửi một Bản kê khai chỉ đạo khác cho 30 phần trăm người dùng ở Trung Quốc, với con đường ưa thích nhất được đổi thành JP.

00:11:30.000 --> 00:11:47.000
Sau khi thực hiện đánh giá Chỉ đạo Nội dung, 30 phần trăm khách hàng ở Trung Quốc sẽ chuyển sang lộ trình JP, chuyển hướng lưu lượng mạng của họ đến CDN ở Nhật Bản, giải quyết tình trạng tắc nghẽn mạng ở CDN Trung Quốc.

00:11:47.000 --> 00:11:56.000
Để kết thúc, chúng tôi đã giới thiệu tính năng HLS mới của Chỉ đạo nội dung, giải thích cách thức hoạt động và cách tích hợp nó vào các luồng của bạn.

00:11:56.000 --> 00:12:03.000
Với tính năng tuyệt vời này, bạn sẽ có thể tinh chỉnh tính khả dụng phát trực tuyến toàn cầu của mình.

00:12:03.000 --> 00:12:10.000
Để biết thêm chi tiết kỹ thuật, hãy theo liên kết bên dưới video này cho "Thông số kỹ thuật chỉ đạo nội dung HLR".

00:12:10.000 --> 00:12:20.000
Tôi cũng muốn nói với bạn rằng danh sách phát và xác thực Bản kê khai chỉ đạo cũng được hỗ trợ trong Công cụ phát trực tiếp HTTP mới nhất của chúng tôi.

00:12:20.000 --> 00:12:28.000
Tôi cũng muốn ghi nhận phản hồi và sự giúp đỡ mà chúng tôi nhận được từ các thành viên trong ngành trong diễn đàn HLS Interest IETF.

00:12:28.000 --> 00:12:33.000
Các phản hồi và đề xuất trong tương lai cũng được hoan nghênh.

00:12:33.000 --> 00:12:41.000
Và với tất cả những điều này, Chỉ đạo nội dung HLS sẽ có sẵn cho các nhà phát triển và người dùng trong các bản dựng WWDC Seed năm nay.

00:12:41.000 --> 00:12:54.000
Vì vậy, nếu bạn muốn phân phối phát trực tuyến toàn cầu tốt hơn với nhiều tính khả dụng hơn, hãy hành động ngay bây giờ để tích hợp Chỉ đạo nội dung HLS vào các luồng của bạn và mang đến cho khách hàng của bạn trải nghiệm phát trực tuyến tốt hơn.

00:12:54.000 --> 00:12:55.000
Cảm ơn bạn rất nhiều.

00:12:55.000 --> 23:59:59.000
♪

