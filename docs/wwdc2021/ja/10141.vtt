WEBVTT

00:00:00.000 --> 00:00:05.000
♪ベース音楽の演奏♪

00:00:05.000 --> 00:00:10.000
♪

00:00:10.000 --> 00:00:13.000
Naiwei Zheng:こんにちは。WWDCへようこそ。

00:00:13.000 --> 00:00:15.000
私の名前は鄭内偉です。

00:00:15.000 --> 00:00:18.000
私はアップルのHLSストリーミングチーム出身です。

00:00:18.000 --> 00:00:27.000
今日は、コンテンツステアリングと呼ばれるHLSの新機能と、それがどのようにグローバルストリーミングの可用性を向上させるかについて話します。

00:00:27.000 --> 00:00:32.000
今日のネットワーク接続は世界規模です。

00:00:32.000 --> 00:00:36.000
ストリーミングメディアプロバイダーは、世界中にコンテンツを配信しています。

00:00:36.000 --> 00:00:44.000
しかし、世界規模でコンテンツを配信するには、業界が解決しなければならない膨大な量の課題が伴います。

00:00:44.000 --> 00:00:52.000
私たち、アップルのHLSストリーミングチームも、これらの困難な問題を認識し、解決策を提供するために常に取り組んでいます。

00:00:52.000 --> 00:00:57.000
今日は、可用性の問題に焦点を当てます。

00:00:57.000 --> 00:01:02.000
具体的には、ネットワーク輻輳の軽減とエラー回復。

00:01:02.000 --> 00:01:07.000
これらの問題を理解するために、例を見てみましょう。 例を見てみましょう。

00:01:07.000 --> 00:01:17.000
アジアで人気のあるストリーミングプロバイダーが、中国、日本、シンガポールの3カ国にCDNインフラストラクチャを展開していると仮定しましょう。

00:01:17.000 --> 00:01:22.000
このグラフでは、すべてが完璧な状態で機能している状態を示しています。

00:01:22.000 --> 00:01:35.000
中国のCDNからストリーミングする中国のユーザーがおり、日本のCDNからストリーミングしている日本のユーザーがおり、両方のCDNネットワークは有能なレベルで機能しています。

00:01:35.000 --> 00:01:38.000
さて、いくつかの変化を紹介しましょう。

00:01:38.000 --> 00:01:49.000
しばらくして、中国のCDNからストリーミングする中国のユーザーが大幅に増加し、CDNネットワークが過負荷になっているとしましょう。

00:01:49.000 --> 00:01:56.000
私たちが持っていたHLS技術では、このネットワークの混雑の問題に完全に対処することは困難です。

00:01:56.000 --> 00:02:09.000
新規ユーザーを別のCDNに割り当てることができますが、既存のクライアントに別のCDNを使用するように指示することは難しく、既存のトラフィックは現在のCDNを継続的にオーバーロードします。

00:02:09.000 --> 00:02:17.000
新しいHLSコンテンツステアリング機能により、コンテンツプロバイダーは独自のステアリングサーバーをホストすることでこの問題を解決できます。

00:02:17.000 --> 00:02:24.000
最新のCDNポリシーで更新するために、すべての最新のHLSクライアントとのサイドチャネルを確立します。

00:02:24.000 --> 00:02:33.000
たとえば、中国の既存のクライアントの30%にポリシーの更新を送信して、日本のCDNに切り替えることができます。

00:02:33.000 --> 00:02:41.000
そして、ポリシーの更新を受け取るクライアントは、変更を尊重し、ネットワークトラフィックを日本のCDNにリダイレクトします。

00:02:41.000 --> 00:02:46.000
現在、中国のCDNのネットワーク輻輳が緩和されました。

00:02:46.000 --> 00:02:51.000
しかし、ネットワークの混雑は多くの可用性の問題の1つにすぎません。

00:02:51.000 --> 00:02:54.000
ネットワークが停止するとどうなりますか?

00:02:54.000 --> 00:02:56.000
別の例を挙げてみましょう。

00:02:56.000 --> 00:03:04.000
日本のユーザーから日本のCDNへのネットワークパスが地域的な停止を経験したとします。

00:03:04.000 --> 00:03:16.000
私たちが持っていたHLS技術では、コンテンツプロバイダーはマスタープレイリストにフォールバックバリアントストリームをリストできるため、クライアントは動作中のCDNに到達するまでリストを歩き回ることができます。

00:03:16.000 --> 00:03:27.000
しかし、このアプローチは、コンテンツプロバイダーがマスタープレイリストにリストされているCDNの順序や優先順位をリアルタイムで変更できないという意味で予備的なものです。

00:03:27.000 --> 00:03:35.000
ただし、ステアリングサーバーの助けを借りて、クライアントは最新のCDNの優先順位をほぼリアルタイムで更新します。

00:03:35.000 --> 00:03:41.000
少し巻き戻して、より効率的なエラー回復でクライアントをどのように促進できるかを見てみましょう。

00:03:41.000 --> 00:03:49.000
ネットワークが停止する前に、日本のクライアントはステアリングサーバーからCDN優先リストの更新を定期的に引き出します。

00:03:49.000 --> 00:04:03.000
最新のアップデートで、日本のクライアントは、シンガポールと中国に続いて、日本のCDNが最も好まれる次のCDN優先リストを受け取ったとします。

00:04:03.000 --> 00:04:09.000
現在、日本のユーザーは日本のCDNからストリーミングしています。

00:04:09.000 --> 00:04:16.000
ネットワーク停止が発生すると、日本のCDNは優先リストからペナルティとしてマークされます。

00:04:16.000 --> 00:04:26.000
クライアントは、優先リストの次のCDN（この場合はシンガポールのCDN）に移動し、ネットワークトラフィックをリダイレクトします。

00:04:26.000 --> 00:04:32.000
これで、日本のユーザーは中断することなく番組を見続けることができます。

00:04:32.000 --> 00:04:39.000
私たちの例があなたに示したことは、私たちの新しいHLS機能、コンテンツステアリングのハイレベルな概要です。

00:04:39.000 --> 00:04:45.000
では、この素晴らしい機能をストリームに統合する方法を詳しく見てみましょう。

00:04:45.000 --> 00:04:52.000
これは、利用可能なすべてのバリアントを複製するさまざまなCDN URLの簡単なリストです。

00:04:52.000 --> 00:04:59.000
前に説明したように、このようなプレイリストには、CDNの優先順位が一定で最終的な順序があります。

00:04:59.000 --> 00:05:03.000
コンテンツプロバイダーは、後で再生中に変更することはできません。

00:05:03.000 --> 00:05:10.000
では、このプレイリストにコンテンツステアリングサポートを追加する方法を見てみましょう。

00:05:10.000 --> 00:05:14.000
変化がほとんど導入されなかったことに驚くかもしれません。

00:05:14.000 --> 00:05:18.000
実際、変更は現在のHLSクライアントと下位互換性があります。

00:05:18.000 --> 00:05:21.000
追加を歩きましょう。

00:05:21.000 --> 00:05:34.000
最も注目すべきは、各バリアントストリームのPATHWAY-ID属性によってバリアントストリームを異なる経路にグループ化するようになりました。各経路は通常1つのCDNに対応します。

00:05:34.000 --> 00:05:46.000
この例では、バリアントストリームを経路CN、JP、SGにグループ化し、それぞれ中国、日本、シンガポールのCDNを表します。

00:05:46.000 --> 00:05:54.000
ただし、パスウェイには、より高度なユースケースを可能にするために、異なるCDNからのバリアントストリームが含まれている場合があります。

00:05:54.000 --> 00:06:01.000
クライアントが経路を選択すると、その経路からのバリアントストリームのみがバリアント選択の対象となります。

00:06:01.000 --> 00:06:10.000
新しいCONTENT-STEERINGタグのPATHWAY-ID属性は、再生起動時に使用する最初の経路を指定します。

00:06:10.000 --> 00:06:18.000
したがって、この場合、クライアントは最初の再生時にCN経路に属するバリアントストリームからのみ選択します。

00:06:18.000 --> 00:06:23.000
SERVER-URI属性は、コンテンツステアリングサーバーがどこにあるかを指定します。

00:06:23.000 --> 00:06:28.000
クライアントは、このURIからコンテンツステアリングの更新を取得します。

00:06:28.000 --> 00:06:31.000
しかし、プレイリストにメディアグループが含まれている場合はどうなりますか?

00:06:31.000 --> 00:06:32.000
問題ありません。

00:06:32.000 --> 00:06:36.000
コンテンツステアリングを有効にするのはまだ非常に簡単です。

00:06:36.000 --> 00:06:45.000
あなたがしなければならないのは、各経路のメディアグループを複製し、一意のGROUP-IDで割り当てることだけです。

00:06:45.000 --> 00:06:56.000
たとえば、このプレイリストのオーディオグループは経路ごとに複製されており、GROUP-IDはCN経路などのCN-audioに設定されています。

00:06:56.000 --> 00:07:05.000
HLSクライアントがコンテンツステアリングタグ付きのマスタープレイリストをロードすると、わずかに異なる起動ルーチンがトリガーされます。

00:07:05.000 --> 00:07:14.000
まず、最初のバリアントストリーム選択を実行すると、最初の経路からのバリアントストリームのみが使用されます。

00:07:14.000 --> 00:07:22.000
その後、選択したバリアントストリームとそのメディアセグメントを通常どおりロードして再生を開始します。

00:07:22.000 --> 00:07:30.000
しかし、通常の再生ルーチンと並行して、クライアントはバックグラウンドで定期的なステアリングマニフェスト要求を開始します。

00:07:30.000 --> 00:07:36.000
ステアリングマニフェストのリクエストがどのようなものか見てみましょう。

00:07:36.000 --> 00:07:45.000
これは、マスタープレイリストURLに基づいてSERVER-URI属性からこの解決済みURIに送信される単純なHTTP GETリクエストです。

00:07:45.000 --> 00:07:49.000
ステアリングサーバーはステアリングマニフェストで応答します。

00:07:49.000 --> 00:07:53.000
その形式を例で解剖しましょう。

00:07:53.000 --> 00:07:56.000
ステアリングマニフェストはJSONドキュメントです。

00:07:56.000 --> 00:08:02.000
ステアリングサーバーは、クライアントごとにカスタマイズされたステアリングマニフェストを作成できます。

00:08:02.000 --> 00:08:08.000
これにより、ステアリングサーバーは管理されたネットワークトラフィックを形作る上で大きな可能性を秘めています。

00:08:08.000 --> 00:08:14.000
このステアリングマニフェストで最も重要なプロパティは、PATHWAY-PRIORITYフィールドです。

00:08:14.000 --> 00:08:21.000
これは、優先順位順に並べられた経路IDのリストであり、最初のものが最も好ましいものです。

00:08:21.000 --> 00:08:30.000
この例では、CN経路が最も好まれ、続いてJP、次にSGが優先されます。

00:08:30.000 --> 00:08:42.000
ステアリングサーバーからステアリングマニフェストを受け取ると、クライアントはコンテンツステアリング評価を実行して、別の経路に切り替えるかどうかを判断します。

00:08:42.000 --> 00:08:47.000
まず、クライアントは選択対象外のバリアントストリームを除外します。

00:08:47.000 --> 00:08:52.000
これには、ネットワークエラーによるペナルティバリアントストリームが含まれます。

00:08:52.000 --> 00:09:00.000
また、通常のバリアント選択と同様に、サポートされていないコーデックを持つバリアントストリームも行います。

00:09:00.000 --> 00:09:11.000
少なくとも1つの適格なバリアントストリームを持ち、すべての適格な経路の中で最も高い経路優先度を持つ経路を選択します。

00:09:11.000 --> 00:09:20.000
選択した経路が現在使用している経路と異なる場合、クライアントはすぐに新しい経路に切り替えます。

00:09:20.000 --> 00:09:31.000
適切な経路が選択されていない場合、またはすでに選択した経路を使用している場合、クライアントは何もせず、現在の経路を使用してプレイし続けます。

00:09:31.000 --> 00:09:39.000
最後に、クライアントは、ステアリングサーバーから最新のアップデートを引き出すために、次のステアリングマニフェストリクエストをスケジュールします。

00:09:39.000 --> 00:09:42.000
では、このスケジューリングはどのように機能しますか?

00:09:42.000 --> 00:09:45.000
ステアリングマニフェストを見直しましょう。

00:09:45.000 --> 00:09:56.000
次のステアリングマニフェストリクエストを送信するまで、クライアントが待機する秒数を指定するTTLフィールドがあることに注意してください。

00:09:56.000 --> 00:10:12.000
この例では、クライアントがこのステアリングマニフェストの経路優先度リストを使用してコンテンツステアリング評価を実行した後、次のステアリングマニフェストリクエストを300秒（5分）でスケジュールします。

00:10:12.000 --> 00:10:24.000
また、ステアリングサーバーは、各ステアリングマニフェスト応答でこのTTL値を変更でき、クライアントが次のリクエストをスケジュールする時間に影響を与えることも注目に値します。

00:10:24.000 --> 00:10:33.000
また、サーバーの負荷を分散するために、サーバーが各クライアントのTTL値にランダム性を注入することも便利です。

00:10:33.000 --> 00:10:41.000
さらに、オプションのRELOAD-URIフィールドは、次のステアリングマニフェストを要求する場所をクライアントに伝えます。

00:10:41.000 --> 00:10:50.000
ステアリングサーバーは、このフィールドを活用して、クライアント固有の状態またはセッションデータをURLに注入し、次のリクエストでエコーすることができます。

00:10:50.000 --> 00:10:55.000
今、あなたはコンテンツステアリングの主要な技術的な詳細を見ました。

00:10:55.000 --> 00:11:02.000
初期の例の1つに戻って、ボンネットの下でどのように機能するかを見てみましょう。

00:11:02.000 --> 00:11:18.000
この場合、中国のすべてのユーザーがCN経路が最も好まれるステアリングマニフェストを受け取り、対応する中国のCDNはユーザー数の増加のために過負荷になっているとしましょう。

00:11:18.000 --> 00:11:30.000
そのため、ステアリングサーバーが動作し、中国のユーザーの30%に異なるステアリングマニフェストを送信し、最も好ましい経路がJPに変更されました。

00:11:30.000 --> 00:11:47.000
コンテンツステアリング評価を行った後、中国の30%のクライアントはJPパスウェイに切り替え、ネットワークトラフィックを日本のCDNにリダイレクトし、中国のCDNのネットワーク輻輳状況を解決します。

00:11:47.000 --> 00:11:56.000
最後に、コンテンツステアリングの新しいHLS機能を紹介し、その仕組みとストリームに統合する方法を説明しました。

00:11:56.000 --> 00:12:03.000
この素晴らしい機能により、グローバルストリーミングの可用性を微調整することができます。

00:12:03.000 --> 00:12:10.000
技術的な詳細については、このビデオの下の「HLSコンテンツステアリング仕様」のリンクに従ってください。

00:12:10.000 --> 00:12:20.000
また、プレイリストとステアリングマニフェストの検証は、最新のHTTPライブストリーミングツールでもサポートされていることもお伝えしたいと思います。

00:12:20.000 --> 00:12:28.000
また、HLSインタレストIETFフォーラムで業界メンバーから受け取ったフィードバックと支援に感謝したいと思います。

00:12:28.000 --> 00:12:33.000
今後のフィードバックや提案も歓迎します。

00:12:33.000 --> 00:12:41.000
そして、これらすべてが実施されると、HLSコンテンツステアリングは、今年のWWDCシードビルドで開発者とユーザーが利用できるようになります。

00:12:41.000 --> 00:12:54.000
したがって、より多くの可用性を備えたより良いグローバルストリーミング配信が必要な場合は、今すぐ行動してHLSコンテンツステアリングをストリームに統合し、顧客により良いストリーミング体験を提供します。

00:12:54.000 --> 00:12:55.000
どうもありがとうございます。

00:12:55.000 --> 23:59:59.000
♪

