WEBVTT

00:00:00.000 --> 00:00:05.000
♪ベース音楽の演奏♪

00:00:05.000 --> 00:00:09.000
♪

00:00:09.000 --> 00:00:19.000
トミー・ポーリー：こんにちは、私はトミー・ポーリーです。同僚のデルジエルと一緒に、インターネットプライバシーのエキサイティングな新機能を紹介します。

00:00:19.000 --> 00:00:29.000
iCloudプライベートリレーは、ネットワークやサーバーがインターネット上でユーザーのアクティビティを監視するのを防ぐ新しいサービスです。

00:00:29.000 --> 00:00:34.000
そして、それはすべてのiCloud+サブスクリプションの一部として利用可能です。

00:00:34.000 --> 00:00:51.000
プライベートリレーは、ユーザーがウェブを閲覧しているときにユーザーを保護するだけでなく、アプリによって生成されたトラフィックに保護を追加して、意図せずにユーザー情報を漏洩したり、ユーザーをセキュリティ攻撃にさらしたりしないようにします。

00:00:51.000 --> 00:01:11.000
今日は、iCloudプライベートリレーとは何か、それがアプリにどのように影響するか、アプリがプライベートリレーでうまく機能することを確認する方法、ウェブサイトとサーバーを準備する方法、そして最後に、プライベートリレーが有効になっているときにネットワークを管理し、トラフィックを監視する方法を学びます。

00:01:11.000 --> 00:01:14.000
始めましょう。

00:01:14.000 --> 00:01:22.000
プライベートリレーはiOSとmacOSに組み込まれているので、アプリから採用するために何もする必要はありません。

00:01:22.000 --> 00:01:26.000
また、アプリに必ずしも影響を与えるわけではないことを理解することも重要です。

00:01:26.000 --> 00:01:34.000
これは、ユーザーがiCloud+の加入者であり、プライベートリレーが有効になっている場合にのみ適用されます。

00:01:34.000 --> 00:01:38.000
あなたはおそらく疑問に思っているでしょう、それは実際に何をしますか?

00:01:38.000 --> 00:01:42.000
プライベートリレーなしで現在どのように機能するかは次のとおりです。

00:01:42.000 --> 00:01:54.000
誰かがインターネットにアクセスすると、ローカルネットワーク上の誰もが、DNSクエリの検査に基づいてアクセスするすべてのウェブサイトの名前を見ることができます。

00:01:54.000 --> 00:02:01.000
この情報は、ユーザーの指紋を採取し、時間の経過とともに活動の履歴を構築するために使用できます。

00:02:01.000 --> 00:02:13.000
公共のWi-Fiオペレーター、ネットワーク上の別のユーザー、インターネットサービスプロバイダーなど、誰もこのすべての情報を静かに収集できるべきではありません。

00:02:13.000 --> 00:02:20.000
接続がWebサイトを実行するサーバーに到達すると、それらのサーバーはユーザーのIPアドレスを見ることができます。

00:02:20.000 --> 00:02:26.000
これにより、サーバーは明示的な許可なしにユーザーの位置を決定できます。

00:02:26.000 --> 00:02:42.000
さらに悪いことに、Safariのインテリジェントトラッキング防止などのツールがクッキーを介して相関関係を妨げている場合でも、サーバーはユーザーの身元をフィンガープリントし、異なるウェブサイトでユーザーを認識することができます。

00:02:42.000 --> 00:02:53.000
これらはユーザーのプライバシーにとって大きな問題であり、それらを修正するためには、設計によってプライバシーが組み込まれた新しいアプローチが必要です。

00:02:53.000 --> 00:03:01.000
iCloudプライベートリレーは、ユーザーのトラフィックをルーティングし、それをプライベートに保つために、複数の安全なプロキシを追加します。

00:03:01.000 --> 00:03:04.000
プロキシは別々のエンティティによって実行されます。

00:03:04.000 --> 00:03:09.000
1つはアップル、もう1つはコンテンツプロバイダーです。

00:03:09.000 --> 00:03:20.000
これで、誰かがインターネットにアクセスすると、クライアントのIPアドレスのみがネットワークプロバイダーと最初のプロキシの両方に表示されます。

00:03:20.000 --> 00:03:29.000
2番目のプロキシは、ユーザーが要求している名前のみを表示し、それを使用してサーバーへの接続を構築します。

00:03:29.000 --> 00:03:39.000
このチェーンの誰も、Appleでさえ、クライアントのIPアドレスとユーザーがアクセスしているものの両方を見ることができないことに注意することが重要です。

00:03:39.000 --> 00:03:43.000
指紋採取の機会は取り除かれました。

00:03:43.000 --> 00:03:48.000
これは設計上のプライバシーです。

00:03:48.000 --> 00:03:59.000
プライベートリレーは、最新のトランスポートプロトコルとプライバシー保護認証を使用して、すべてのトランザクションが安全で高速であることを保証します。

00:03:59.000 --> 00:04:07.000
この技術の詳細については、「Appleのプライバシーの柱に焦点を当てる」セッションで学ぶことができます。

00:04:07.000 --> 00:04:15.000
プライベートリレーは、ユーザーエクスペリエンスに影響を与えることなく、システム上で最も機密性の高いトラフィックを保護することに重点を置いています。

00:04:15.000 --> 00:04:30.000
iOS 15とmacOS 12では、プライベートリレーは、SafariのすべてのWebブラウジング、すべてのDNS名前解決クエリ、およびアプリからのトラフィックの小さなサブセットに適用されます。

00:04:30.000 --> 00:04:39.000
具体的には、TCPポート80など、安全でないすべてのHTTPトラフィックが含まれます。

00:04:39.000 --> 00:04:51.000
アプリがコンテンツフィルターまたはペアレンタルコントロールフィルターを提供している場合、プライベートリレーを通過する前にトラフィックが表示されるので、以前と同じようにフィルターを適用できます。

00:04:51.000 --> 00:04:57.000
これについて詳しくは、「Meet the Screen Time API」セッションで学ぶことができます。

00:04:57.000 --> 00:05:07.000
アプリによって行われるすべてのネットワーキングがパブリックインターネット上で行われるわけではないので、プライベートリレーの影響を受けないトラフィックのいくつかのカテゴリがあります。

00:05:07.000 --> 00:05:15.000
アプリがローカルネットワークまたはプライベートドメイン名に接続しても影響を受けません。

00:05:15.000 --> 00:05:30.000
同様に、アプリがVPNまたはアプリプロキシ機能を追加するためのネットワーク拡張機能を提供する場合、拡張機能はプライベートリレーを使用せず、拡張機能を使用するアプリトラフィックも使用しません。

00:05:30.000 --> 00:05:34.000
プロキシを使用するトラフィックも免除されます。

00:05:34.000 --> 00:05:42.000
次に、アプリがプライベートリレーでうまく機能する準備ができていることを確認するために何をする必要があるかを取り上げましょう。

00:05:42.000 --> 00:05:47.000
素晴らしいニュースは、ほとんどすべてのアプリで、新しいことをする必要がないということです!

00:05:47.000 --> 00:05:50.000
プライベートリレーはちょうど動作します。

00:05:50.000 --> 00:05:55.000
しかし、知っておくべきベストプラクティスがいくつかあります。 

00:05:55.000 --> 00:05:59.000
プライベートリレーは、使用しているネットワークAPIに関係なく機能します。

00:05:59.000 --> 00:06:09.000
数年間、アプリがURLSessionやNWConnectionなどの最新のAPIを使用することを推奨してきました。

00:06:09.000 --> 00:06:13.000
今、アプリ全体でそれらを採用する理由がもう1つあります。

00:06:13.000 --> 00:06:22.000
これらのAPIは、プライベートリレーがトラフィックにどのように適用されているかを理解するための最良のツールを提供します。

00:06:22.000 --> 00:06:34.000
URLSessionを使用する場合は、プライベートリレーを通過している場合でも、ネットワークXcodeインストゥルメントを使用してタスクを検査できます。

00:06:34.000 --> 00:06:42.000
これを行う方法については、「InstrumentsでHTTPトラフィックを分析する」セッションで詳しく知ることができます。

00:06:42.000 --> 00:06:52.000
また、URLSessionとNetwork.frameworkの両方でメトリクスAPIを使用して、接続がプライベートリレーを使用するタイミングを理解できます。

00:06:52.000 --> 00:07:00.000
TaskTransactionMetricsでは、タスクがプロキシを使用したかどうかを確認できます。

00:07:00.000 --> 00:07:12.000
NWConnectionのEstablishmentReportでは、DNS名前解決のタイミングとプロキシ接続確立の各段階を調べることもできます。

00:07:12.000 --> 00:07:20.000
プライベートリレーは、暗号化されていない安全でないHTTP接続を過去のものにするために大きな一歩を踏み出します。

00:07:20.000 --> 00:07:23.000
あなたもこの取り組みに参加できます!

00:07:23.000 --> 00:07:32.000
まだ安全でないHTTPを使用している場合 - それはTCPポート80の接続です - 今が変更する時です。

00:07:32.000 --> 00:07:43.000
プライベートリレーを有効にすると、これらの安全でない接続がプロキシされ、クライアントとプロキシ間のローカルネットワーク上の攻撃者から保護されます。

00:07:43.000 --> 00:07:51.000
ただし、すべてのユーザーにとって接続をエンドからエンドまで安全に保つことが最善です。

00:07:51.000 --> 00:08:02.000
これを行うには、サーバーがTLSをサポートしていることを確認し、URLをhttp://からhttps://に変更します。

00:08:02.000 --> 00:08:08.000
あなたのアプリには、安全でないトラフィックを許可するためのアプリトランスポートセキュリティの例外があるかもしれません。

00:08:08.000 --> 00:08:18.000
このリストを見て、アプリが使用する安全でないトラフィックを監査し、これらの例外を削除することができます。

00:08:18.000 --> 00:08:33.000
アプリが位置情報に基づいて機能を提供する場合、IPアドレスから位置を推測するサーバーに頼るのではなく、Core LocationのAPIを使用していることを確認する絶好の機会でもあります。

00:08:33.000 --> 00:08:40.000
IPアドレスのジオロケーションは、多くの場合、信頼性が低く、不正確です。

00:08:40.000 --> 00:08:49.000
コアロケーションでは、必要な場所の精度を指定でき、明示的なユーザー許可に基づいています。

00:08:49.000 --> 00:08:58.000
ロケーションアクセスの最新の機能強化については、「Appleのプライバシーの柱に焦点を当てる」セッションで詳しく知ることができます。

00:08:58.000 --> 00:09:03.000
アプリがプライベートリレーの準備ができていることを確認したら、試してみてください!

00:09:03.000 --> 00:09:16.000
iCloud+サブスクリプションでiPhone、iPad、またはMacにサインインし、設定アプリのiCloudセクションまたはシステム環境設定でプライベートリレーが有効になっていることを確認してください。

00:09:16.000 --> 00:09:22.000
フィードバックアプリで「iCloud Private Relay」というタグでフィードバックを提供できます。

00:09:22.000 --> 00:09:25.000
今、私はそれを同僚のDelzielに手渡します。

00:09:25.000 --> 00:09:27.000
デルジエル・フェルナンデス:ありがとう、トミー。

00:09:27.000 --> 00:09:35.000
こんにちは、私はデルジエル・フェルナンデスです。サーバーを準備し、プライベートリレーでネットワークを管理する方法について話します。

00:09:35.000 --> 00:09:45.000
アプリが依存しているサーバーがある場合、またはSafariでユーザーがアクセスしている場合は、プライベートリレーの準備のためにできることがいくつかあります。

00:09:45.000 --> 00:09:53.000
サーバーは、プロキシIPアドレスを認識することで、プライベートリレーを使用して入ってくる接続を識別できます。

00:09:53.000 --> 00:09:58.000
これらのプロキシIPアドレスは、地域内の多くのユーザーによって共有される可能性があります。

00:09:58.000 --> 00:10:02.000
各住所は、特定の都市または地域にマッピングされます。

00:10:02.000 --> 00:10:10.000
したがって、正しいジオIPマッピングデータベースを適用しても、サーバーには引き続き関連情報があります。

00:10:10.000 --> 00:10:21.000
プライベートリレーは、ユーザーがシステムを使用して別の地域のふりをできないことを保証するため、地域ベースのアクセス制限を引き続き実施できます。

00:10:21.000 --> 00:10:27.000
プロキシIPアドレスの詳細は、このセッションに関連する記事として入手できます。

00:10:27.000 --> 00:10:32.000
それでは、プライベートリレーを使用するデバイスからのネットワーク接続を見てみましょう。

00:10:32.000 --> 00:10:38.000
デバイスがサーバーにアクセスしようとすると、まず入力プロキシへのネットワーク接続を設定します。

00:10:38.000 --> 00:10:44.000
この接続は、ネットワークプロバイダーによって割り当てられたIPアドレスを使用して設定されます。

00:10:44.000 --> 00:10:52.000
次に、デバイスは入力プロキシを使用して、入力プロキシIPアドレスを使用して出力プロキシにネットワーク要求を転送します。

00:10:52.000 --> 00:11:02.000
その後、出力プロキシは、デバイスの都市または地域にマップするIPアドレスを選択することで、これらの要求を宛先サーバーに転送します。

00:11:02.000 --> 00:11:12.000
一般的に、サーバーやウェブサイトは、ユーザーの位置や身元を決定するためにクライアントのIPアドレスのみに頼るのをやめるべきです。

00:11:12.000 --> 00:11:20.000
位置情報アクセスが必要な場合は、ユーザーの位置情報を明示的に要求し、必要な粒度でのみ要求することを検討してください。

00:11:20.000 --> 00:11:32.000
ユーザーを特定する必要がある場合は、IPアドレスがアイデンティティに関連付けられていると仮定するのではなく、ログインまたはその他の形式の明示的な識別を要求してください。

00:11:32.000 --> 00:11:39.000
最後に、プライベートリレーが使用されているときにネットワークを管理するためのヒントをいくつか取り上げましょう。

00:11:39.000 --> 00:11:47.000
プライベートリレーが使用されているときにローカルネットワークでパケットトレースを実行している場合は、いくつかの新しいトラフィックパターンが表示されます。

00:11:47.000 --> 00:11:52.000
これで、UDPポート443で実行されているトラフィックが増えます。

00:11:52.000 --> 00:11:59.000
これは、プライベートリレープロキシとの通信に使用されているQUICまたはHTTP / 3トラフィックです。

00:11:59.000 --> 00:12:11.000
ネットワーク上のUDPポート443を許可し、ルーターまたはネットワークアドレストランスレータがそれをうまく処理するように調整されていることを確認することで、トラフィックがうまく機能することを確認できます。

00:12:11.000 --> 00:12:16.000
また、ネットワーク上のクリアテキストUDP DNSクエリも少なくなります。

00:12:16.000 --> 00:12:22.000
プライベートリレーが使用されていないときに、デバイスからの一般的なネットワーク接続要求を見てみましょう。

00:12:22.000 --> 00:12:29.000
デバイスがサーバーにアクセスしようとすると、まずサーバーのホスト名のDNSクエリを送信します。

00:12:29.000 --> 00:12:39.000
ホスト名がIPアドレスに解決されると、デバイスはTCPのようなトランスポートプロトコルを使用してサーバーのIPアドレスに接続します。

00:12:39.000 --> 00:12:49.000
その後、デバイスはサーバーとTCP 3ウェイハンドシェイクを実行し、続いてTLS交換を実行してサーバーとの安全な接続を設定します。

00:12:49.000 --> 00:13:02.000
しかし、ご覧のとおり、プライベートリレーがなければ、サーバーのホスト名とサーバーに接続しているデバイスのIPアドレスは、ネットワーク上のパケットを観察するだけで表示されます。

00:13:02.000 --> 00:13:09.000
プライベートリレーでは、デバイスは最初にQUICまたはHTTP/3を使用して入力プロキシへの接続を設定します。

00:13:09.000 --> 00:13:16.000
パケットキャプチャでは、入力プロキシのポート443に送信されたUDPパケットに気付くでしょう。

00:13:16.000 --> 00:13:26.000
入力プロキシへのネットワーク接続が確立されると、入力プロキシへの接続内でサーバーへのアクセスが保護されます。

00:13:26.000 --> 00:13:29.000
サーバー側では、プロトコルに変更はありません。

00:13:29.000 --> 00:13:33.000
TCP/TLS交換は、プライベートリレーのないトラフィックに似ています。

00:13:33.000 --> 00:13:43.000
唯一の違いは、サーバーがデバイスのIPアドレスではなく、プロキシIPアドレスからの着信接続を見ることです。

00:13:43.000 --> 00:13:47.000
ほとんどのネットワークは、すべてのユーザートラフィックを監査または監視する必要はありません。

00:13:47.000 --> 00:13:56.000
ただし、企業または学校のネットワークを運営している場合、ネットワークにはすべてのトラフィックを傍受する必要があるポリシーがある場合があります。

00:13:56.000 --> 00:14:02.000
このユースケースをサポートするために、iCloudプライベートリレープロキシサーバーのホスト名をブロックすることができます。

00:14:02.000 --> 00:14:11.000
その後、デバイスがネットワークに接続すると、ユーザーは現在のネットワークでプライベートリレーがブロックされていることを示すプロンプトを受け取ります。

00:14:11.000 --> 00:14:18.000
その後、そのネットワークのプライベートリレーを無効にするか、ネットワークを切り替えるかを選択できます。

00:14:18.000 --> 00:14:24.000
プロキシホスト名に関する情報は、このセッションに関連付けられた記事として提供されます。

00:14:24.000 --> 00:14:31.000
ペアレンタルコントロールの場合、最善の解決策は、NetworkExtensionフレームワークが提供するコンテンツフィルターAPIを使用することです。

00:14:31.000 --> 00:14:36.000
これにより、プライベートリレーが有効になっている場合でも、デバイスでトラフィックを監査できます。

00:14:36.000 --> 00:14:45.000
コンテンツフィルターAPIの詳細については、「Meet the Screen Time API」と「Network extension for the modern Mac」のセッションをご覧ください。

00:14:45.000 --> 00:15:00.000
物事をまとめるには、アプリでURLSessionのような最新の安全なネットワークAPIを使用し、プライベートリレーでアプリをテストし、プライベートリレーを介してルーティングされた接続を受信したときにサーバーとウェブサイトがうまく機能することを確認します。

00:15:00.000 --> 00:15:01.000
見てくれてありがとう、みんな!

00:15:01.000 --> 23:59:59.000
♪

