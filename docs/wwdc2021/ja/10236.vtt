WEBVTT

00:00:02.000 --> 00:00:16.000
こんにちは、私の名前はデビッドで、ここアップルのドキュメンテーションツールチームのエンジニアです。

00:00:16.000 --> 00:00:24.000
このセッションでは、DocCドキュメントのホスティングとドキュメントビルドの自動化について学びます。

00:00:24.000 --> 00:00:32.000
まず、Xcodeでのドキュメントの構築と、構築されたドキュメントアーカイブをサーバーでホストする方法について説明します。

00:00:32.000 --> 00:00:41.000
次に、ドキュメントの構築方法と、ドキュメントの構築を自動化する方法について詳しく説明します。

00:00:41.000 --> 00:00:48.000
この講演を通して、同僚と私が取り組んできたプロジェクトであるSlothCreatorを紹介します。

00:00:48.000 --> 00:00:51.000
私たちは、人々が始めるのを助けるためにウェブサイトを作りました。

00:00:51.000 --> 00:01:00.000
そして今、Xcodeの新しいドキュメント機能を使用して、ウェブサイトでホストできるドキュメントのバージョンを構築することに本当に興奮しています。

00:01:00.000 --> 00:01:03.000
これにより、人々がさらに簡単に始めることができます。

00:01:03.000 --> 00:01:08.000
それでは、それをどのように達成できるかを見てみましょう。

00:01:08.000 --> 00:01:18.000
Xcode 13の新しいドキュメント機能により、Swiftフレームワーク、ライブラリ、パッケージのドキュメントを簡単に作成できます。

00:01:18.000 --> 00:01:27.000
セットアップなしですぐに使用を開始し、時間の経過とともに追加の資料を使用してドキュメントを拡張できます。

00:01:27.000 --> 00:01:34.000
また、開発者ドキュメントウィンドウからドキュメントをエクスポートするのと同じくらい簡単です。

00:01:34.000 --> 00:01:46.000
エクスポートされたドキュメントアーカイブを他の人と共有して、Xcodeでドキュメントをインポートして読み取ることも、ドキュメントアーカイブをオンラインでホストすることもできます。

00:01:46.000 --> 00:02:01.000
Xcodeのドキュメントとシンボルのドキュメントの作成についてもっと知りたい場合は、同僚のVictoriaとEthanが「Meet DocC documentation in Xcode」セッションでそれについて話します。

00:02:01.000 --> 00:02:07.000
このプレゼンテーションの後半では、コマンドラインでのドキュメントの構築を自動化する方法について説明します。

00:02:07.000 --> 00:02:15.000
しかし、今のところ、Xcodeからエクスポートしたドキュメントアーカイブを使用して、サーバー上でホストします。

00:02:15.000 --> 00:02:25.000
ドキュメントアーカイブ自体は、Xcodeでドキュメントを読み、オンラインでホストするためのすべてのデータを保持するコンテナです。

00:02:25.000 --> 00:02:38.000
これは、参照ドキュメントと記事、および豊富でインタラクティブなチュートリアルの両方をレンダリングするために使用される単一ページのVue.js Webアプリとして構成されています。

00:02:38.000 --> 00:02:44.000
ドキュメントアーカイブをホストするためにサーバーが処理する必要がある要求には2つの異なるタイプがあります。

00:02:44.000 --> 00:03:06.000
リクエストURLが/documentation/または/tutorials/で始まるドキュメントとチュートリアルページのリクエスト、およびリクエストURLがドキュメントアーカイブ内のファイルの1つの相対ファイルパスと一致するWebアプリによってロードされる追加のファイルとデータのリクエスト。

00:03:06.000 --> 00:03:14.000
ページを構成するリクエストの例と、サーバーがそれらにどのように応答すべきかを見てみましょう。

00:03:14.000 --> 00:03:32.000
開発者がホストされているドキュメントを読みに行き、ブラウザがページを要求すると、リクエストが/documentation/または/tutorials/で始まる場合、サーバーはドキュメントアーカイブにあるindex.htmlファイルで応答する必要があります。

00:03:32.000 --> 00:03:43.000
そのファイルは、ブラウザがウェブアプリの残りの部分を読み込むように要求するドキュメントアーカイブ内のCSSとJavaScriptを参照しています。

00:03:43.000 --> 00:03:52.000
それが読み込まれると、ウェブアプリはそのページのコンテンツと、参照する画像やその他のメディアを要求します。

00:03:52.000 --> 00:04:06.000
index.htmlファイルによって参照されるファイルと、ウェブアプリによってロードされるコンテンツとメディアの両方が、ドキュメントアーカイブのフォルダ構造に一致するリクエストURLを使用します。

00:04:06.000 --> 00:04:13.000
ホスティングサーバーが着信要求にどのように応答する必要があるかを見たので、デモでそれを見てみましょう。

00:04:13.000 --> 00:04:16.000
あなたの多くは、すでにあなたのウェブサイトをホストするサーバーを持っているかもしれません。

00:04:16.000 --> 00:04:23.000
私たちのプロジェクトでは、Apacheサーバーを使用していますが、カスタムルーティングを可能にする任意のサーバーを使用できます。

00:04:23.000 --> 00:04:26.000
これは SlothCreatorに関する当社のウェブサイトです。

00:04:26.000 --> 00:04:33.000
ページの中央にある入門テキストの下にこの「ドキュメントを読む」ボタンを追加しましたが、ボタンはまだ機能しません。

00:04:33.000 --> 00:04:36.000
だから、それを直しましょう。

00:04:36.000 --> 00:04:43.000
私はすでにドキュメントアーカイブをウェブサイトをホストしているディレクトリにコピーし、空の.htaccessファイルを追加しました。

00:04:43.000 --> 00:04:49.000
しかし、私はその中にルーティングを設定していません。

00:04:49.000 --> 00:04:59.000
追加する必要があるルーティングルールは2つあります。1つはドキュメントとチュートリアルページ用、もう1つは追加のファイルとデータ用です。

00:04:59.000 --> 00:05:10.000
最初のルールでは、一致させたいパターンは、最初のパスコンポーネントとして「ドキュメント」または「チュートリアル」で始まるURLです。

00:05:10.000 --> 00:05:19.000
このパターンに一致するリクエストは、ドキュメントアーカイブ内のindex.htmlファイルに再ルーティングしたいです。

00:05:19.000 --> 00:05:27.000
最後に、リクエストがこのルールと一致する場合、ルールの評価を停止するフラグでルールを終了します。

00:05:27.000 --> 00:05:31.000
2番目のルールでは、パターンについてもっと明確にします。

00:05:31.000 --> 00:05:42.000
また、このサーバーでウェブサイトをホストしているため、ウェブサイトのリクエストをドキュメントアーカイブのファイルに再ルーティングしたくありません。

00:05:42.000 --> 00:05:51.000
ドキュメントアーカイブの内部を見ると、パターンで一致できるトップレベルのファイルとフォルダがいくつかあることがわかります。

00:05:51.000 --> 00:05:57.000
だから、それらすべてに一致するパターンを追加します。

00:05:57.000 --> 00:06:11.000
この場合、リクエストURLはドキュメントアーカイブ内のファイルの1つの相対ファイルパスであるため、リクエストを一致したパターンに再ルーティングしますが、先頭に SlothCreator.doccarchiveを付けます。

00:06:11.000 --> 00:06:17.000
そして、以前と同じように、ルールの評価を停止するために同じフラグを追加しました。

00:06:17.000 --> 00:06:29.000
さて、ウェブページをリロードしてドキュメントリンクをクリックすると、サーバーが当社のウェブサイトとドキュメントの両方をホストしていることがわかります。

00:06:29.000 --> 00:06:39.000
メインの SlothCreatorページでは、重要なシンボルを上位レベルのタスクに関連するトピックにグループ化します。

00:06:39.000 --> 00:06:50.000
そして、これらのグループのそれぞれは、より具体的なトピックに関連付けられています。

00:06:50.000 --> 00:06:57.000
DocCには、さまざまなプロジェクトにうまく適合するように作られた、クリーンなデザインが組み込まれています。

00:06:57.000 --> 00:07:06.000
これにより、ここでの SlothCreatorのドキュメントのように、プロジェクトのための見栄えの良いエレガントなドキュメントを本当に簡単に作成できます。

00:07:06.000 --> 00:07:15.000
ウェブサイトでドキュメントのコピーをホストしたので、ドキュメントアーカイブの構築と更新を自動化する方法を見てみましょう。

00:07:15.000 --> 00:07:19.000
これを行うには、xcodebuildを呼び出すスクリプトを書くつもりです。

00:07:19.000 --> 00:07:28.000
これを行うスクリプトを入手したら、新しい変更が行われるたびに実行できるため、ホストされたドキュメントが常に最新になります。

00:07:28.000 --> 00:07:37.000
Xcode 13の新機能では、xcodebuildの新しいdocbuildアクションを使用して、コマンドラインでドキュメントを構築できます。

00:07:37.000 --> 00:07:47.000
Xcodeまたはxcodebuildでドキュメントをビルドすると、ドキュメントもビルドする標準ビルドのように機能します。

00:07:47.000 --> 00:08:11.000
ビルド中、Swiftコンパイラは、すべてのパブリックシンボル、その関係、およびインソースドキュメントコメントに関する詳細情報を収集し、これをシンボルグラフと呼ばれるファイルとしてドキュメントコンパイラに渡して、Xcodeでドキュメントを読み、オンラインでホストするために必要なすべてのデータを含むドキュメントアーカイブを作成します。

00:08:11.000 --> 00:08:28.000
ターゲットがプロジェクトの追加記事、メディア、またはチュートリアルを含む関連するドキュメントカタログを持っている場合、ドキュメントコンパイラは、ドキュメントアーカイブを生成するときに、そのすべてのコンテンツをシンボル情報と組み合わせます。

00:08:28.000 --> 00:08:48.000
ドキュメントカタログについて詳しく知りたい場合は、「XcodeでDocCドキュメントを昇格する」セッションでは、同僚のBeaとJackがさまざまな種類のドキュメントと、それぞれを活用して開発者にプロジェクトについて学ぶための素晴らしい方法を提供する方法について話します。

00:08:48.000 --> 00:08:52.000
建物のドキュメントは、ターゲットに適用されるだけではありません。

00:08:52.000 --> 00:09:07.000
ターゲットに他のSwiftフレームワーク、ライブラリ、またはパッケージへの依存関係がある場合、同じプロセスがそれらすべてにも適用され、プロジェクトに関連するすべてのドキュメントを1か所で取得できます。

00:09:07.000 --> 00:09:18.000
スクリプトを使用してホストされているドキュメントの構築と更新を自動化しようとしているので、コマンドライン上のxcodebuildはそれに最適です。

00:09:18.000 --> 00:09:27.000
Xcodebuildの新しいdocbuildアクションは、デフォルトのビルドアクションと同じように機能しますが、ドキュメントもビルドします。

00:09:27.000 --> 00:09:35.000
ビルドアクションと同様に、構築したいスキームと、その一部であるプロジェクトまたはワークスペースを渡します。

00:09:35.000 --> 00:09:44.000
また、プロジェクト、ワークスペース、またはSwiftパッケージを含むディレクトリ内からxcodebuildを呼び出すことができ、スキームのみを渡すことができます。

00:09:44.000 --> 00:09:55.000
プロジェクトとスキームによっては、sdk、宛先、構成などの他のフラグを渡して、プロジェクトの構築方法をカスタマイズできる場合があります。

00:09:55.000 --> 00:09:57.000
そうする必要はありません。そうする必要はありません。

00:09:57.000 --> 00:10:07.000
しかし、より簡単にフォローできるように、ビルド製品とビルドドキュメントが書き込まれるカスタムd derivedDataPathを指定します。

00:10:07.000 --> 00:10:21.000
ビルドが完了したら、.doccarchiveファイル拡張子を使用して構築されたドキュメントアーカイブをすべて見つけ、それぞれを別の場所または別のマシンにコピーできます。

00:10:21.000 --> 00:10:25.000
デモでそれを見てみましょう。 

00:10:25.000 --> 00:10:28.000
これは以前からホストしていたドキュメントです。

00:10:28.000 --> 00:10:38.000
関連するシンボルをトピックにグループ化して、開発者が特定のタスクのコアタイプを簡単に見つけられるようにします。

00:10:38.000 --> 00:10:45.000
このバージョンを構築して以来、私の同僚はエッセンシャルセクションに表示されるいくつかの新しい記事やチュートリアルを追加しました。

00:10:45.000 --> 00:10:54.000
だから今は、最新のドキュメントを構築し、私たちのウェブサイトを更新する自動化スクリプトを書くのに最適な時期です。

00:10:54.000 --> 00:11:11.000
先ほど見たように、xcodebuildのdocbuildアクションを呼び出してドキュメントを作成し、ドキュメントアーカイブを見つけてウェブサイトをホストしているディレクトリにコピーしてウェブサイトを更新します。

00:11:11.000 --> 00:11:18.000
Xcodeのスキームセレクタで見るのと同じなので、どのスキームを渡す必要があるかはすでにわかっています。

00:11:18.000 --> 00:11:29.000
Xcodeをまだ開いていない場合は、コマンドラインでxcodebuild -listを実行して、利用可能なすべてのスキームを一覧表示することもできます。

00:11:29.000 --> 00:11:42.000
繰り返しますが、カスタムdededDataPathは必要ありませんが、構築されたドキュメントが書かれ、見つかった場所に従うことが容易になります。

00:11:42.000 --> 00:11:52.000
ビルドが完了したら、すべてのドキュメントアーカイブを見つけて、それぞれをウェブサイトをホストしているディレクトリにコピーできます。

00:11:52.000 --> 00:12:02.000
そして、それが終わったら、私はスクリプトを実行する準備ができています。

00:12:02.000 --> 00:12:09.000
さて、更新すると、エッセンシャルセクションで追加された記事とチュートリアルを見ることができます。

00:12:09.000 --> 00:12:13.000
これらの最新の変更により、私たちのドキュメントはより完全に見えます。

00:12:13.000 --> 00:12:35.000
そして、 SlothCreatorを初めて行う人は、記事の内容やチュートリアルの1つでステップバイステップの指示を好むかどうかにかかわらず、始めるのに最適な場所を持っています。

00:12:35.000 --> 00:12:40.000
これで、ホストされているドキュメントの更新は、スクリプトを実行するのと同じくらい簡単です。

00:12:40.000 --> 00:12:51.000
また、継続的インテグレーションサーバー上のマージ後のフックの一部として実行すると、ホストされているドキュメントを常に最新の状態に保つことができます。

00:12:51.000 --> 00:13:05.000
このセッションで話したことを要約すると、ドキュメントアーカイブを共有したり、オンラインでホストしたりして、Xcodeで使い始める前から、フレームワークの消費者に素晴らしいドキュメント体験を提供することができます。

00:13:05.000 --> 00:13:13.000
また、コマンドラインでドキュメントを構築すると、自動化ワークフローにドキュメントを含めることができます。

00:13:13.000 --> 00:13:25.000
DocCドキュメントについてもっと知りたい場合は、「XcodeでDocCドキュメントに会う」は、Xcodeの新しいドキュメント機能の素晴らしい紹介です。

00:13:25.000 --> 00:13:33.000
「XcodeでDocCドキュメントを昇格する」は、DocCカタログでドキュメントを強化する方法について深く掘り下げています。

00:13:33.000 --> 00:13:43.000
そして、「DocCを使用してインタラクティブなチュートリアルを構築する」は、アイデアを構造化し、プロジェクトのための素晴らしいチュートリアルを作成する方法を詳述しています。

00:13:43.000 --> 00:13:44.000
ご覧いただきありがとうございます。

00:13:44.000 --> 23:59:59.000
[音楽]。

