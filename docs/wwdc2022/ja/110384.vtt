WEBVTT

00:00:00.000 --> 00:00:09.000
♪インストゥルメンタルヒップホップ音楽♪

00:00:09.000 --> 00:00:11.000
こんにちは、私の名前はフェリペです。

00:00:11.000 --> 00:00:14.000
私はtvOSチームのソフトウェアエンジニアです。

00:00:14.000 --> 00:00:22.000
今日は、アプリで複数のユーザーを簡単にサポートできるように、tvOS 16で行った改善点を皆さんと共有できることを嬉しく思います。

00:00:22.000 --> 00:00:26.000
Apple TVは誰もが使えるように設計されています。

00:00:26.000 --> 00:00:31.000
tvOS 13以来、Apple TVの複数のユーザーを改善してきました。

00:00:31.000 --> 00:00:38.000
tvOS 16には、すべてのアプリで複数のユーザーを簡単にサポートできる新機能があります。

00:00:38.000 --> 00:00:43.000
Apple TVの複数のユーザー機能の概要から始めます。

00:00:43.000 --> 00:00:48.000
誰もが使用するデバイスでアプリをパーソナライズするのがいかに簡単かを示しています。

00:00:48.000 --> 00:00:56.000
次に、ストリーミングアプリの各ユーザーのプロファイル選択を保存するのがいかに簡単かを実演します。

00:00:56.000 --> 00:01:00.000
あなた自身のアプリに最適なアプローチのための推奨事項で締めくくります。

00:01:00.000 --> 00:01:06.000
tvOS 16では、家族全員がApple TVで簡単にできるようにしています。

00:01:06.000 --> 00:01:12.000
Siri RemoteのTVボタンを長押しすると、コントロールセンターが表示されます。

00:01:12.000 --> 00:01:16.000
一番上にあるのは、このApple TVにいるユーザーのリストです。

00:01:16.000 --> 00:01:29.000
tvOS 16の新機能であるユーザーリストには、まだ追加されていないiCloudファミリーメンバーが含まれているため、家族全員がApple TVでこれまで以上に簡単になります。

00:01:29.000 --> 00:01:32.000
ここでは、アンはまだApple TVを使っていません。

00:01:32.000 --> 00:01:35.000
プラスアイコンは、提案されたユーザーを示します。

00:01:35.000 --> 00:01:41.000
アンに参加させるには、提案されたユーザーを選択するだけです。

00:01:41.000 --> 00:01:52.000
アンがする必要があるのは、iPhoneをApple TVと同じ部屋に持ち込み、iPhoneで接続を確認することだけです。

00:01:52.000 --> 00:01:54.000
そして、それがすべてです。

00:01:54.000 --> 00:01:58.000
アンは現在、Apple TVで彼らのデータにアクセスできます。

00:01:58.000 --> 00:02:02.000
では、ちょっとアンのiPhoneに戻りましょう。

00:02:02.000 --> 00:02:06.000
アンのお気に入りのビデオストリーミングアプリを見てみましょう。 

00:02:06.000 --> 00:02:12.000
このアプリは家族全員で使用され、一人一人が自分のプロフィールを持っています。

00:02:12.000 --> 00:02:18.000
アプリが最初に起動すると、プロフィールピッカーが表示され、アンは彼女のプロフィールを選びます。

00:02:18.000 --> 00:02:31.000
個人用デバイスで実行されているアプリは、優先プロファイルをNSUserDefaultsに保存したり、CloudKitに入れてすべてのデバイスに同期させることもできます。

00:02:31.000 --> 00:02:38.000
家族の各メンバーのiPhoneは、その人の好みのプロフィールを覚えています。

00:02:38.000 --> 00:02:42.000
アプリが開いたときにどのプロファイルを使用するかを尋ね続ける必要はありません。

00:02:42.000 --> 00:02:54.000
Apple TVは家族全員が共有するデバイスであり、Apple TVを使用するすべての人が自分のコンテンツやデータにアクセスできることが本当に重要だと考えています。

00:02:54.000 --> 00:03:01.000
tvOS 14では、アプリを現在のユーザーとして実行する機能を導入しました。

00:03:01.000 --> 00:03:16.000
「現在のユーザーとして実行」の資格を追加する単一のチェックボックスで、コードはまったく変更されないため、アプリはiPhoneと同じように各ユーザー自身のデータにアクセスできます。

00:03:16.000 --> 00:03:27.000
これらのAPIを呼び出すiOSコードは、Apple TVでそのまま実行でき、各人が自分の個人的なApple TVを使用しているように振る舞うことができます。

00:03:27.000 --> 00:03:30.000
アプリが起動すると、tvOSがすべてを処理します。

00:03:30.000 --> 00:03:35.000
プライバシーとセキュリティ、すべてシステムによって処理されます。

00:03:35.000 --> 00:03:43.000
「現在のユーザーとして実行」資格は、個々の進歩に関するゲームやアプリに最適です。

00:03:43.000 --> 00:03:47.000
ただし、プロファイル付きのメディアアプリは、もう少し必要です。

00:03:47.000 --> 00:03:52.000
これまでの私の例では、サインインという重要な部分をスキップしました。

00:03:52.000 --> 00:03:58.000
私たちは、サインインはできるだけ簡単でまれにする必要があると信じています。

00:03:58.000 --> 00:04:09.000
tvOS 15では、iPhoneやiPadを使ってtvOSアプリにシームレスにサインインできる機能を導入しました。

00:04:09.000 --> 00:04:18.000
これは、デバイスが連携してApple TVでサインインする最も便利な方法を提供するファーストクラスのサインイン体験です。

00:04:18.000 --> 00:04:25.000
iCloudキーチェーンのパスワードなど、Apple TVでは直接利用できない機能は、タップするだけです。

00:04:25.000 --> 00:04:36.000
優れたサインイン体験を構築する方法を学ぶには、WWDC 2021の「tvOSアプリのサインインを簡素化する」をご覧ください。

00:04:36.000 --> 00:04:42.000
そして今年は、tvOSでOAuthとパスキーのサポートを導入します。

00:04:42.000 --> 00:04:48.000
パスキーは、アプリやウェブサイトのパスワードを置き換えるための素晴らしい新しい認証技術です。

00:04:48.000 --> 00:04:53.000
パスキーの詳細については、「パスキーに会う」ビデオをご覧ください。

00:04:53.000 --> 00:04:57.000
しかし、使いやすさと利便性がすべてではありません。

00:04:57.000 --> 00:05:01.000
サインインを一度だけ行うことは依然として重要です。

00:05:01.000 --> 00:05:09.000
この最適なユーザーエクスペリエンスを実現するために、「現在のユーザーとして実行」で、tvOS 16にシンプルな新しいAPIを導入しています。

00:05:09.000 --> 00:05:17.000
これは、アプリがユーザーに依存しないキーチェーンにアクセスできるようにするキーチェーンサービスの新しい定数です。

00:05:17.000 --> 00:05:23.000
この新しいキーを使用して保存されたアイテムは、Apple TVのすべてのユーザーが常にアクセスできます。

00:05:23.000 --> 00:05:26.000
例を見てみましょう。 例を見てみましょう。

00:05:26.000 --> 00:05:33.000
これは、ユーザー名とパスワードを使用して、キーチェーンにアイテムを保存する方法です。

00:05:33.000 --> 00:05:43.000
アイテムをユーザーに依存しないキーチェーンに保存するには、関数SecItemAddに渡される属性辞書に新しいキーを追加するだけです。

00:05:43.000 --> 00:05:51.000
キーkSecUseUserIndependentKeychainの値としてtrueを渡すだけです。

00:05:51.000 --> 00:05:58.000
ユーザーに依存しないキーチェーンセットを使用すると、読み書きしたアイテムがすべてのユーザーに表示されます。

00:05:58.000 --> 00:06:16.000
新しいキーチェーンAPIと「現在のユーザーとして実行」の両方の資格の組み合わせにより、アプリはiPhoneとApple TVの最高のものを手に入れることができます。Apple TVでのシングルサインイン体験を維持しながら、共有デバイス上のシンプルなユーザーごとのデータ分離。

00:06:16.000 --> 00:06:24.000
tvOS 16では、TVUserManagerでシステムユーザーにプロファイルを手動でマッピングする方法を廃止しました。

00:06:24.000 --> 00:06:29.000
もはや、プロファイルへのユーザーのマップを維持する必要はありません。

00:06:29.000 --> 00:06:31.000
システムはあなたのためにそれを処理します。

00:06:31.000 --> 00:06:36.000
iOSで使用しているのと同じAPIは、Apple TVでも使用できます。

00:06:36.000 --> 00:06:39.000
それはとても簡単です。

00:06:39.000 --> 00:06:42.000
デモですべてのアクションをお見せしましょう。

00:06:42.000 --> 00:06:47.000
プロフィール付きのメディアアプリを表すサンプルアプリを紹介します。

00:06:47.000 --> 00:06:51.000
これは私のストリーミングビデオアプリです。

00:06:51.000 --> 00:06:55.000
現在、私が話した機能のどれも使用していません。

00:06:55.000 --> 00:07:00.000
現在のユーザーとして実行されないし、新しいキーチェーンAPIも使用しない。

00:07:00.000 --> 00:07:06.000
サインインしてお見せします。

00:07:06.000 --> 00:07:10.000
サインイン後、プロフィールのリストが表示されます。

00:07:10.000 --> 00:07:16.000
現在のユーザーはメイなので、彼女のプロフィールを選びます。

00:07:16.000 --> 00:07:22.000
プロフィールを選ぶと、メイが見たいパーソナライズされたコンテンツが表示されます。

00:07:22.000 --> 00:07:26.000
その後、アンはソファに座ってテレビを見ます。

00:07:26.000 --> 00:07:32.000
彼らはSiri Remoteのテレビボタンを長押ししてコントロールセンターを開きます。

00:07:32.000 --> 00:07:37.000
コントロールセンターの上部にあるのは、ユーザーのリストです。

00:07:37.000 --> 00:07:40.000
緑色のチェックマークは、現在のユーザーを示しています。

00:07:40.000 --> 00:07:45.000
今からアンに切り替えてアプリを開きます。

00:07:45.000 --> 00:07:49.000
予想通り、アプリはプロファイルピッカーを再び表示します。

00:07:49.000 --> 00:07:54.000
だから、アンは自分のプロフィールを選ぶことができます。

00:07:54.000 --> 00:08:02.000
しかし、メイに切り替えたときに何が起こるかを見てください。

00:08:02.000 --> 00:08:04.000
アプリはアンのプロフィールに残ります。

00:08:04.000 --> 00:08:08.000
メイが以前に彼女の好みのプロフィールを選んだことを覚えていません。

00:08:08.000 --> 00:08:14.000
tvOS 16の新機能により、ユーザーエクスペリエンスははるかに向上する可能性があります。

00:08:14.000 --> 00:08:19.000
アプリを使用している人は、誰を見ているかを再度選択する必要がないようにしたい。

00:08:19.000 --> 00:08:22.000
Xcodeに行きましょう、そして私はそれがどれほど簡単かをお見せします。

00:08:22.000 --> 00:08:27.000
アプリを現在のユーザーとして実行するのは簡単です。

00:08:27.000 --> 00:08:31.000
私がしなければならないのは、アプリのターゲットに1つの機能を追加することだけです。

00:08:31.000 --> 00:08:37.000
私のアプリのターゲットでは、「署名と機能」タブに移動します。

00:08:37.000 --> 00:08:43.000
タブのすぐ下、ここの左上にある「機能の追加」ボタンをクリックします。

00:08:43.000 --> 00:08:46.000
機能のリストが開きます。

00:08:46.000 --> 00:08:49.000
私が興味を持っているのはユーザー管理と呼ばれています。

00:08:49.000 --> 00:08:53.000
「ユーザー」と入力してリストをフィルタリングします。

00:08:53.000 --> 00:08:58.000
これで、アプリに追加したい機能をダブルクリックするだけです。

00:08:58.000 --> 00:09:05.000
ここでは、「現在のユーザーとして実行」チェックボックスがデフォルトで選択されています。

00:09:05.000 --> 00:09:08.000
それはまさに私が必要としているものです。

00:09:08.000 --> 00:09:13.000
この資格により、私のアプリのプロセスは常に現在選択されているユーザーとして起動されます。

00:09:13.000 --> 00:09:18.000
システムは、各ユーザーのデータが区別されていることを確認します。

00:09:18.000 --> 00:09:20.000
キーチェーンを含むそのすべて。

00:09:20.000 --> 00:09:26.000
しかし、私のアプリにとって、ユーザーごとに異なるキーチェーンを持つことは、予期せぬ副作用をもたらすでしょう。

00:09:26.000 --> 00:09:30.000
各ユーザーは別々にサインインする必要があります。

00:09:30.000 --> 00:09:39.000
tvOS 16では、現在のユーザーとして実行している間、すべてのユーザーに単一のアカウントを持つという経験を維持することができます。

00:09:39.000 --> 00:09:44.000
新しいキーチェーンAPIを使用して、ユーザーに依存しないキーチェーンにアクセスします。

00:09:44.000 --> 00:09:52.000
今からKeychainControllerクラスに行き、それを使ってキーチェーンを読み書きします。

00:09:52.000 --> 00:10:00.000
ここには、キーチェーン内のアプリの資格情報にアクセスするために必要なキーを持つプロパティbaseQueryがあります。

00:10:00.000 --> 00:10:07.000
新しいユーザーに依存しないキーチェーンを使用するように更新するには、辞書に新しい要素を追加するだけです。

00:10:07.000 --> 00:10:15.000
新しいkSecUseUserIndependentKeychainを追加し、trueに設定します。

00:10:15.000 --> 00:10:20.000
そして、アプリがすべてのユーザーと資格情報を共有するために変更する必要があるのはそれだけです。

00:10:20.000 --> 00:10:22.000
他には何もありません。

00:10:22.000 --> 00:10:27.000
ただし、他のすべてのデータはユーザーごとに異なることに注意することが重要です。

00:10:27.000 --> 00:10:34.000
UserDefaultsのように、各ユーザーのプロファイル選択を記憶するために使用します。

00:10:34.000 --> 00:10:37.000
では、私のProfileDataクラスを開きましょう。

00:10:37.000 --> 00:10:41.000
このファイルは、私のiOSプロジェクトとtvOSプロジェクト間で共有されています。

00:10:41.000 --> 00:10:50.000
実際、私のアプリのiOSバージョンは、すでにUserDefaultsにプロファイルの選択を保存していますが、iOSで実行している場合にのみ保存されています。

00:10:50.000 --> 00:10:54.000
そして、それはiPhoneが個人用デバイスだからです。

00:10:54.000 --> 00:11:00.000
しかし、私のアプリが現在のユーザーとして実行されるようになった今、Apple TVは個人的なものになることができます。

00:11:00.000 --> 00:11:05.000
iOSチェックを削除して、Apple TVでコードを同じように動作させることができます。

00:11:05.000 --> 00:11:12.000
システムは、ユーザーごとに正しいUserDefaultsを使用するようにします。

00:11:12.000 --> 00:11:16.000
新しいバージョンのアプリを実行すると、現在のユーザーであるMeiとして起動します。

00:11:16.000 --> 00:11:20.000
メイはサインインしてプロフィールを選ぶ。

00:11:20.000 --> 00:11:26.000
アプリが現在のユーザーとして実行されていると、Apple TVがその時点で個人用デバイスであるかのように動作します。

00:11:26.000 --> 00:11:28.000
メイのデバイス。

00:11:28.000 --> 00:11:32.000
Meiのプロフィール選択は、彼女のUserDefaultsに保存されます。

00:11:32.000 --> 00:11:38.000
アンが見る時間になると、彼らはコントロールセンターを使用してユーザーに切り替えます。

00:11:38.000 --> 00:11:48.000
システムは切り替えユーザーUIを設置し、プロセスが再起動する前に最後のタスクを完了する時間を与えます。

00:11:48.000 --> 00:11:52.000
tvOSは現在、アンとしてアプリを再起動します。

00:11:52.000 --> 00:11:54.000
今、Apple TVはアンのデバイスです。

00:11:54.000 --> 00:12:02.000
資格情報は、すべてのユーザーがアクセスできるユーザーに依存しないキーチェーンに保存されているため、サインインプロンプトはスキップされます。

00:12:02.000 --> 00:12:09.000
しかし、アンはまだUserDefaultsにプロファイル選択を保存しておらず、プロファイルピッカーが表示されます。

00:12:09.000 --> 00:12:15.000
アンのプロフィールを選択すると、選択内容がUserDefaultsに保存されます。

00:12:15.000 --> 00:12:19.000
さて、この時点でメイとアンは両方ともプロフィールを選択しました。

00:12:19.000 --> 00:12:24.000
ユーザーを切り替えると、アプリにはインタースティシャルプロンプトが表示されなくなります。

00:12:24.000 --> 00:12:31.000
常にコンテンツに直行し、各人の正しいプロファイルを自動的に選択します。

00:12:31.000 --> 00:12:32.000
毎回。

00:12:32.000 --> 00:12:39.000
tvOS 16では、各ユーザーのプロフィールを覚えやすくなりました。

00:12:39.000 --> 00:12:48.000
ユーザーに依存しないキーチェーンにアクセスするためのシンプルな新しいAPIで、システムは各ユーザーのデータを分離します。

00:12:48.000 --> 00:12:58.000
全員が別々にサインインしなくても、各ユーザーのプロファイルの選択を覚えておく方法を見たので、Apple TVでアプリがどのように機能するかを確認しましょう。

00:12:58.000 --> 00:13:04.000
現在のユーザー権限として実行されていないアプリは、デフォルトユーザーのリソースを使用します。

00:13:04.000 --> 00:13:09.000
あなたはそれをApple TV独自のリソースと考えることができます。

00:13:09.000 --> 00:13:14.000
ユーザーの切り替えは、アプリのプロセスに影響を与えません。

00:13:14.000 --> 00:13:18.000
これは、あなたがパーソナライズしたいときのための私の推奨事項です。

00:13:18.000 --> 00:13:25.000
この表は、tvOSアプリで使用している機能に応じて、利用可能な機能を示しています。

00:13:25.000 --> 00:13:44.000
アプリがメディアアプリの場合、またはそのような場合は、プロファイルを通じてパーソナライズされたコンテンツを表示します。Apple TVを使用しているすべての人間で単一のアカウントを共有しながら、Runs as Current Userエンタイトルメントを採用し、新しいユーザーに依存しないキーチェーンAPIを使用します。

00:13:44.000 --> 00:13:55.000
ゲームのように、あなたのアプリが個々の進歩に関するものである場合、あなたがしなければならないのは現在のユーザーの資格として実行を採用することだけで、tvOSは残りを処理します。

00:13:55.000 --> 00:14:04.000
そして、他のすべてのアプリでは、レシピアプリなど、すべてのユーザーに同じコンテンツを提示するアプリは、何もする必要はありません。

00:14:04.000 --> 00:14:08.000
Xcodeで新しいtvOSアプリプロジェクトを作成するだけです。

00:14:08.000 --> 00:14:14.000
現在のユーザーとしての実行の詳細については、WWDC 2020のセッションをご覧ください。

00:14:14.000 --> 00:14:21.000
私たちは、合理化された直接コンテンツ体験がtvOSアプリに最適なものだと信じています。

00:14:21.000 --> 00:14:26.000
これらすべての機能が、アプリに素晴らしい大画面体験を実装するのに役立つことを願っています。

00:14:26.000 --> 23:59:59.000
見てくれてありがとう、そして会議を楽しんでください。

