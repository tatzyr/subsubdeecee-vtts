WEBVTT

00:00:00.000 --> 00:00:03.000
♪ Nhạc cụ hip-hip êm dịu ♪

00:00:03.000 --> 00:00:09.000
♪

00:00:09.000 --> 00:00:13.000
Xin chào và chào mừng đến với WWDC.

00:00:13.000 --> 00:00:16.000
Tên tôi là Karim, và tôi là một kỹ sư HealthKit.

00:00:16.000 --> 00:00:29.000
Khung HealthKit cung cấp nền tảng để xây dựng trải nghiệm sức khỏe tuyệt vời và Apple Watch đi kèm với nhiều tính năng an toàn và sức khỏe, giúp bạn theo dõi mọi thứ.

00:00:29.000 --> 00:00:38.000
Một trong những điều phổ biến nhất là theo dõi giấc ngủ và chúng tôi đang cập nhật để thu thập dữ liệu giấc ngủ chi tiết hơn.

00:00:38.000 --> 00:00:44.000
Chúng tôi cũng có những bổ sung mới tuyệt vời khác cho HealthKit trong năm nay.

00:00:44.000 --> 00:00:51.000
Chúng tôi đã nâng cao các API của mình để giúp truy vấn dữ liệu dễ dàng hơn với Swift không đồng bộ.

00:00:51.000 --> 00:00:57.000
Chúng tôi đang cải thiện các bài tập với một đại diện tập luyện phong phú hơn.

00:00:57.000 --> 00:01:07.000
Và chúng tôi đang bổ sung hỗ trợ để tiết kiệm đơn thuốc thị lực, bao gồm một bản sao kỹ thuật số của đơn thuốc vật lý.

00:01:07.000 --> 00:01:14.000
Tôi rất vui được cho bạn biết thêm về tất cả các bản cập nhật này và cách các ứng dụng của bạn có thể tận dụng chúng.

00:01:14.000 --> 00:01:17.000
Hãy bắt đầu nào!

00:01:17.000 --> 00:01:33.000
Giấc ngủ là một chức năng thiết yếu cho phép cơ thể và tâm trí của chúng ta nạp năng lượng, và tôi thích sử dụng Apple Watch để quản lý lịch trình giấc ngủ của mình và có được thông tin chi tiết giúp tôi hiểu và cải thiện giấc ngủ của mình.

00:01:33.000 --> 00:01:41.000
Năm nay chúng tôi đang làm cho việc theo dõi giấc ngủ thậm chí còn tốt hơn bằng cách giới thiệu các giai đoạn giấc ngủ.

00:01:41.000 --> 00:01:53.000
Apple Watch sẽ tự động theo dõi tất cả các giai đoạn ngủ khác nhau mà bạn trải qua khi ngủ và dữ liệu này sẽ có thể truy cập được từ ứng dụng Sức khỏe và được lưu trong HealthKit.

00:01:53.000 --> 00:02:01.000
Tất nhiên, ứng dụng của bạn sẽ có thể đọc và lưu dữ liệu giai đoạn ngủ.

00:02:01.000 --> 00:02:12.000
Dữ liệu giấc ngủ được lưu bởi Apple Watch hoặc ứng dụng của bạn được thể hiện trong HealthKit bằng các mẫu danh mục với mã định danh sleepAnalysis.

00:02:12.000 --> 00:02:20.000
Chúng tôi sẽ hỗ trợ ba giai đoạn ngủ: REM, core và deep.

00:02:20.000 --> 00:02:31.000
Khi lưu dữ liệu giấc ngủ vào HealthKit, bạn nên đảm bảo tạo một mẫu cho mỗi khoảng thời gian liên tục trong một giai đoạn ngủ nhất định.

00:02:31.000 --> 00:02:35.000
Đây là giá trị mẫu ngủ enum trông như thế nào.

00:02:35.000 --> 00:03:09.000
Chúng tôi đang thêm ba trường hợp để đại diện cho các giai đoạn ngủ, bắt đầu với sleepCore, tương ứng với giai đoạn một và hai của mô hình tính điểm từ Học viện Y học Giấc ngủ Hoa Kỳ hoặc AASM; sleepDeep, tương ứng với giai đoạn ba của mô hình tính điểm AASM; và cuối cùng, asleepREM, tương ứng với giai đoạn

00:03:09.000 --> 00:03:24.000
Bây giờ chúng tôi đã thêm các giai đoạn ngủ, chúng tôi đang phản đối trường hợp ngủ để chuyển sang ngủ Không xác định, điều này cho thấy rằng người dùng đang ngủ nhưng không có giai đoạn ngủ nào được chỉ định.

00:03:24.000 --> 00:03:32.000
Với các mẫu ngủ được cập nhật enum, giờ đây có thể lưu và đọc dữ liệu các giai đoạn ngủ từ HealthKit.

00:03:32.000 --> 00:03:38.000
Chúng tôi đã thêm một vị ngữ mới để dễ dàng đọc các mẫu giấc ngủ cho một giai đoạn nhất định.

00:03:38.000 --> 00:03:44.000
Giả sử tôi muốn đọc các mẫu giấc ngủ trong giai đoạn REM.

00:03:44.000 --> 00:03:52.000
Đầu tiên, tôi tạo một vị ngữ bằng cách sử dụng phương pháp predicateForSamples mới với giá trị asleepREM.

00:03:52.000 --> 00:03:55.000
Bây giờ, tôi có thể bắt đầu xây dựng truy vấn của mình.

00:03:55.000 --> 00:04:02.000
Tôi tạo một vị ngữ cho truy vấn của mình với loại mẫu sleepAnalysis và vị ngữ giai đoạn ngủ.

00:04:02.000 --> 00:04:07.000
Và với vị ngữ truy vấn này, bây giờ tôi có thể tạo truy vấn của mình.

00:04:07.000 --> 00:04:13.000
Chạy truy vấn sẽ trả lại cho tôi một loạt các mẫu giấc ngủ trong giai đoạn REM.

00:04:13.000 --> 00:04:28.000
Tuy nhiên, nếu bạn quan tâm đến việc đọc các mẫu cho tất cả các giai đoạn ngủ, bao gồm cả không xác định, điều quan trọng là bạn phải cập nhật ứng dụng của mình để sử dụng .allAsleepValues mới khi xây dựng vị ngữ của mình.

00:04:28.000 --> 00:04:36.000
Nếu bạn chưa xem HealthKit kể từ năm ngoái, cú pháp ngắn hơn này để truy vấn có thể trông không quen thuộc với bạn.

00:04:36.000 --> 00:04:44.000
Kể từ iOS 15.4, chúng tôi đã cập nhật API truy vấn của mình để hỗ trợ Swift không đồng bộ.

00:04:44.000 --> 00:04:54.000
Truy vấn là một phần thiết yếu của HealthKit và với sự hỗ trợ không đồng bộ của Swift, chúng dễ sử dụng hơn với cú pháp ngắn gọn hơn.

00:04:54.000 --> 00:05:03.000
Các truy vấn cho phép bạn đọc nhiều dữ liệu khác nhau từ HealthKit, sử dụng các vị ngữ để lọc kết quả và cũng theo dõi dữ liệu mới khi nó xuất hiện.

00:05:03.000 --> 00:05:08.000
Tất cả các truy vấn là các lớp con của HKQuery.

00:05:08.000 --> 00:05:20.000
Nếu tôi muốn biết tổng lượng calo bị đốt cháy trong một khoảng thời gian nhất định, một truy vấn tuyệt vời để có được những số liệu thống kê được tính toán này là HKStatisticsCollectionQuery.

00:05:20.000 --> 00:05:27.000
Để có được kết quả ban đầu, bạn sẽ đặt đóng truy vấn initialResultsHandler.

00:05:27.000 --> 00:05:36.000
Và nếu bạn quan tâm đến việc xem bất kỳ bản cập nhật nào, bạn sẽ đặt thêm số liệu thống kê đóng UpdateHandler.

00:05:36.000 --> 00:05:41.000
Khi truy vấn được bắt đầu, các lần đóng này sẽ được gọi với kết quả.

00:05:41.000 --> 00:05:46.000
Nhờ Swift không đồng bộ, chúng tôi đang làm cho điều này trở nên đơn giản hơn.

00:05:46.000 --> 00:05:56.000
Mỗi truy vấn hiện có một bộ mô tả truy vấn phù hợp, vì vậy HKStatisticsCollectionQuery trở thành HKStatisticsCollectionQuery Descriptor.

00:05:56.000 --> 00:06:02.000
Bạn nhận được kết quả ban đầu bằng cách gọi phương thức kết quả không đồng bộ (cho:).

00:06:02.000 --> 00:06:16.000
Mặt khác, nếu bạn muốn nhận kết quả ban đầu và cũng theo dõi các bản cập nhật, bạn gọi kết quả (cho:), trả về Trình tự không đồng bộ mà bạn có thể lặp lại để đọc kết quả.

00:06:16.000 --> 00:06:24.000
HealthKit rất tuyệt vời để theo dõi các bài tập và các chỉ số liên quan như lượng calo đã đốt cháy.

00:06:24.000 --> 00:06:32.000
Để tìm ra tôi đã đốt cháy bao nhiêu calo trong tuần này, tôi có thể sử dụng bộ mô tả truy vấn thu thập số liệu thống kê.

00:06:32.000 --> 00:06:38.000
Đầu tiên, tôi tạo mô tả truy vấn với một vị ngữ để khớp với các mẫu calo.

00:06:38.000 --> 00:06:44.000
Tôi sử dụng tùy chọn cumulativeSum vì tôi muốn tổng số tiền.

00:06:44.000 --> 00:06:50.000
Tôi quan tâm đến dữ liệu của tuần này, vì vậy tôi sử dụng thisSunday làm anchorDate của mình.

00:06:50.000 --> 00:06:58.000
Và cuối cùng, tôi muốn tổng lượng calo của mình được tính toán trong khoảng thời gian một tuần.

00:06:58.000 --> 00:07:07.000
Khi tôi tạo bộ mô tả truy vấn của mình, tất cả những gì tôi cần làm là gọi kết quả (cho:) với một đối tượng healthStore.

00:07:07.000 --> 00:07:13.000
Đối tượng statisticsCollection được trả về cung cấp cho tôi ảnh chụp nhanh dữ liệu hiện tại của tôi.

00:07:13.000 --> 00:07:25.000
Nhưng nếu tôi muốn cập nhật trực tiếp khi lượng calo của mình thay đổi, nó đơn giản như gọi kết quả (cho:) và lặp qua chuỗi không đồng bộ được trả về để đọc kết quả.

00:07:25.000 --> 00:07:32.000
Khi tôi xem xong các bản cập nhật, tôi chỉ cần thoát ra khỏi vòng lặp và điều đó sẽ dừng truy vấn.

00:07:32.000 --> 00:07:36.000
Bây giờ, hãy nói về việc tập luyện.

00:07:36.000 --> 00:07:48.000
HealthKit là một nơi tuyệt vời để tiết kiệm các bài tập và tất cả các chỉ số liên quan của chúng cho dù bạn đang đi xe đạp bình thường hay đẩy bản thân đến giới hạn tại một cuộc đua.

00:07:48.000 --> 00:07:53.000
Và đôi khi, tập luyện có thể chứa nhiều hơn một hoạt động riêng biệt.

00:07:53.000 --> 00:08:05.000
Bạn có thể lặp lại bài tập tương tự với việc tập luyện ngắt quãng hoặc tham gia cuộc đua ba môn phối hợp bao gồm bơi lội, đạp xe và chạy bộ.

00:08:05.000 --> 00:08:19.000
Chúng tôi đang cập nhật API tập luyện của mình trong iOS 16 và watchOS 9 để có thể nắm bắt các loại bài tập này và số liệu thống kê liên quan cho từng hoạt động.

00:08:19.000 --> 00:08:24.000
Đây là dòng thời gian của một bài tập bơi-xe đạp mà tôi đã thực hiện gần đây.

00:08:24.000 --> 00:08:34.000
Tôi bắt đầu với bơi lội, sau đó tôi dành một chút thời gian để sẵn sàng cho phần đạp xe của bài tập, và cuối cùng là chạy.

00:08:34.000 --> 00:08:41.000
Mỗi hoạt động được đại diện bởi một đối tượng HKWorkoutActivity.

00:08:41.000 --> 00:08:49.000
Mỗi hoạt động tập luyện được tạo ra với cấu hình tập luyện riêng, bao gồm loại hoạt động.

00:08:49.000 --> 00:08:56.000
Một hoạt động tập luyện chứa một danh sách các sự kiện xảy ra trong quá trình hoạt động.

00:08:56.000 --> 00:09:08.000
Và bạn sẽ có thể đọc số liệu thống kê cho từng hoạt động, điều này thật tuyệt vời khi bạn chỉ quan tâm đến việc phân tích những gì đã xảy ra trong một hoạt động cụ thể.

00:09:08.000 --> 00:09:16.000
Quay trở lại dòng thời gian của tôi, ba hoạt động của tôi được cấu hình với loại hoạt động phù hợp của chúng.

00:09:16.000 --> 00:09:19.000
Các hoạt động không thể trùng lặp theo thời gian.

00:09:19.000 --> 00:09:27.000
Và bởi vì có thể có một giai đoạn chuyển tiếp giữa mỗi hoạt động, chúng không bắt buộc phải tiếp giáp nhau.

00:09:27.000 --> 00:09:39.000
Nếu tôi quan tâm đến việc phân tích những gì đã xảy ra trong các giai đoạn chuyển tiếp, tôi có thể tạo một HKWorkoutActivity cho mỗi quá trình chuyển đổi với loại chuyển đổi.

00:09:39.000 --> 00:09:47.000
Tất cả các hoạt động này sẽ được lưu với đối tượng HKWorkout trong thuộc tính workoutActivities.

00:09:47.000 --> 00:10:04.000
Nếu bạn đang sử dụng HKWorkoutBuilder để thêm các bài tập vào HealthKit, việc thêm một hoạt động cũng dễ dàng như tạo một đối tượng HKWorkoutActivity với Cấu hình tập luyện, ngày bắt đầu và kết thúc và siêu dữ liệu tùy chọn.

00:10:04.000 --> 00:10:10.000
Và sau đó, bạn chỉ cần gọi addWorkoutActivity trên trình tạo bài tập.

00:10:10.000 --> 00:10:21.000
Trên Apple Watch, bạn có thể sử dụng một buổi tập luyện để theo dõi bài tập bơi-xe đạp và trình tạo bài tập liên quan để lưu bài tập trong HealthKit.

00:10:21.000 --> 00:10:23.000
Hãy quay lại dòng thời gian tập luyện của tôi.

00:10:23.000 --> 00:10:31.000
Để theo dõi bài tập này trên Apple Watch, tôi cần thiết lập một buổi tập luyện và xây dựng.

00:10:31.000 --> 00:10:38.000
Tôi bắt đầu bằng cách tạo ra một cấu hình tập luyện với loại swimBikeRun.

00:10:38.000 --> 00:10:43.000
Sau đó, tôi tạo một HKWorkoutSession bằng cách sử dụng cấu hình của mình.

00:10:43.000 --> 00:10:53.000
Khi bắt đầu tập luyện, tôi chỉ cần gọi startActivity trong phiên và beginCollection trên trình tạo bài tập liên quan.

00:10:53.000 --> 00:11:05.000
Bây giờ phiên và người xây dựng của tôi đã sẵn sàng, tôi có thể thêm hoạt động đầu tiên của mình bằng cách sử dụng phương pháp beginNewActivity với cấu hình bài tập bơi và ngày bắt đầu.

00:11:05.000 --> 00:11:15.000
Khi bắt đầu mỗi hoạt động, bạn nên đảm bảo cập nhật nguồn dữ liệu trình tạo bài tập để chỉ thu thập các loại dữ liệu mà bạn quan tâm.

00:11:15.000 --> 00:11:21.000
Bởi vì đây là một hoạt động bơi lội, tôi muốn thu thập khoảng cách bơi lội.

00:11:21.000 --> 00:11:28.000
Vào cuối hoạt động, tôi gọi endCurrentActivity với ngày kết thúc.

00:11:28.000 --> 00:11:40.000
Bởi vì tôi quan tâm đến việc phân tích giai đoạn chuyển tiếp từ bơi lội sang đạp xe, tôi sẽ bắt đầu một hoạt động chuyển tiếp mới ngay sau khi bơi kết thúc.

00:11:40.000 --> 00:11:53.000
Một lần nữa, vì đây là sự khởi đầu của một hoạt động, tôi cập nhật nguồn dữ liệu của người xây dựng để vô hiệu hóa việc thu thập khoảng cách bơi, vì nó không còn phù hợp nữa.

00:11:53.000 --> 00:11:58.000
Tôi kết thúc hoạt động chuyển tiếp ngay trước khi bắt đầu đạp xe.

00:11:58.000 --> 00:12:03.000
Tôi có thể theo dõi các hoạt động còn lại trong quá trình tập luyện của mình theo cùng một cách.

00:12:03.000 --> 00:12:10.000
Khi kết thúc bài tập, kết thúc buổi tập cũng sẽ kết thúc bất kỳ hoạt động chạy bộ nào.

00:12:10.000 --> 00:12:16.000
Sau đó, tôi có thể hoàn thành công cụ xây dựng bài tập, nó sẽ lưu và trả lại một đối tượng HKWorkout.

00:12:16.000 --> 00:12:29.000
Tôi có thể sử dụng bài tập trở lại để đọc một số chỉ số liên quan như totalEnergyBurned và totalDistance, và hiển thị bản tóm tắt bài tập trong ứng dụng của mình.

00:12:29.000 --> 00:12:35.000
Tuy nhiên, tập hợp các thuộc tính nhỏ này không còn đủ nữa.

00:12:35.000 --> 00:12:43.000
totalSwimmingStrokeCount không liên quan đến tất cả các bài tập và một số bài tập có thể thu thập nhiều chỉ số hơn.

00:12:43.000 --> 00:12:56.000
Để dễ dàng đọc các số liệu cho tất cả các loại bài tập hơn, chúng tôi đang phản đối các thuộc tính này để ủng hộ một phương pháp mới trả về số liệu thống kê cho một loại số lượng nhất định.

00:12:56.000 --> 00:13:08.000
Xin nhắc lại, phương pháp này cũng có sẵn trên HKWorkoutActivity, cho phép bạn tập trung vào những gì đã xảy ra trong một hoạt động.

00:13:08.000 --> 00:13:20.000
Những thống kê này sẽ được tính toán tự động từ bất kỳ mẫu nào được thu thập trong quá trình tập luyện, chỉ khi sử dụng HKWorkoutBuilder hoặc HKLiveWorkoutBuilder.

00:13:20.000 --> 00:13:32.000
Cùng với đại diện tập luyện phong phú hơn này, chúng tôi cũng có một bộ vị ngữ mới để giúp bạn chỉ truy vấn các bài tập mà bạn quan tâm khi thúc đẩy phân tích hoặc trực quan hóa của mình.

00:13:32.000 --> 00:13:42.000
Để cho bạn một ví dụ, đây là danh sách các bài tập gần đây của tôi với nhịp tim trung bình cho mỗi hoạt động.

00:13:42.000 --> 00:13:50.000
Tôi muốn tìm các bài tập của mình với các hoạt động cường độ cao trong đó nhịp tim trung bình của tôi trên 150.

00:13:50.000 --> 00:14:00.000
Đầu tiên, tôi bắt đầu bằng cách tạo một vị ngữ bằng cách sử dụng phương pháp predicateForWorkoutActivities mới, phương pháp này sẽ tác động lên các hoạt động tập luyện.

00:14:00.000 --> 00:14:05.000
Tôi muốn nhịp tim trung bình lớn hơn 150 nhịp mỗi phút.

00:14:05.000 --> 00:14:13.000
Tiếp theo, vì tôi muốn truy vấn các bài tập, tôi gói vị ngữ nhịp tim của mình bên trong một vị ngữ tập luyện.

00:14:13.000 --> 00:14:17.000
Sau đó, tôi tạo một truy vấn bằng cách sử dụng vị ngữ đó.

00:14:17.000 --> 00:14:26.000
Và tôi gọi phương thức kết quả (cho: healthStore) của bộ mô tả truy vấn của mình để có được danh sách các bài tập phù hợp với vị ngữ của tôi.

00:14:26.000 --> 00:14:31.000
Và đó là cách tôi có thể truy vấn chỉ cho các bài tập mà tôi quan tâm.

00:14:31.000 --> 00:14:36.000
Một trong những bài tập gần đây của tôi bao gồm bốn khoảng thời gian chạy.

00:14:36.000 --> 00:14:42.000
Sử dụng HKWorkoutActivity là một cách tuyệt vời để ghi lại những khoảng thời gian này.

00:14:42.000 --> 00:14:50.000
Bạn chỉ cần đảm bảo rằng tất cả các hoạt động của một bài tập ngắt quãng đều có cùng loại hoạt động với bài tập.

00:14:50.000 --> 00:14:57.000
Vì vậy, đối với một bài tập chạy bộ, tất cả các hoạt động đều được cấu hình với loại .running.

00:14:57.000 --> 00:15:04.000
Một lợi ích của việc sử dụng các hoạt động tập luyện để theo dõi khoảng thời gian là bạn có thể nhận được số liệu thống kê cho mỗi khoảng thời gian.

00:15:04.000 --> 00:15:14.000
Với những cập nhật này, các bài tập giờ đây bao gồm một bức tranh toàn diện hơn về các hoạt động của họ và bối cảnh xung quanh chúng.

00:15:14.000 --> 00:15:33.000
Để cung cấp một bức tranh phong phú hơn nữa, chúng tôi đang giới thiệu các chỉ số chạy mới sẽ được thu thập tự động trên Apple Watch Series 6, SE và các chỉ số mới hơn như độ dài sải chân chạy hoặc công suất tính bằng watt.

00:15:33.000 --> 00:15:37.000
Đối với các bài tập bơi, chúng tôi đang thêm điểm SWOLF.

00:15:37.000 --> 00:15:45.000
Nó được định nghĩa là số lần vuốt được thực hiện trong một độ dài nhất định và thời gian cần thiết để bơi theo độ dài đó.

00:15:45.000 --> 00:15:55.000
Điểm số này sẽ được tính cho mỗi sự kiện vòng đua và sự kiện phân đoạn cho các bài tập bơi được ghi lại trên Apple Watch.

00:15:55.000 --> 00:16:09.000
Mặc dù các chỉ số này làm phong phú thêm các bài tập của bạn và cho phép bạn hiểu rõ hơn về cách bạn thực hiện, một chỉ số quan trọng khác được ghi lại sau khi bài tập kết thúc là phục hồi nhịp tim.

00:16:09.000 --> 00:16:23.000
Đó là ước tính nhịp tim của bạn giảm nhanh như thế nào sau khi tập thể dục và nó có thể được sử dụng để hiểu cách tim phục hồi sau khi căng thẳng và tiết lộ các vấn đề sức khỏe tiềm ẩn.

00:16:23.000 --> 00:16:28.000
Với iOS 16, chúng tôi đang giới thiệu một loại dữ liệu Cardio Recovery mới.

00:16:28.000 --> 00:16:37.000
Nó sẽ có thể truy cập được từ ứng dụng Sức khỏe và các ứng dụng của bạn sẽ có thể đọc và lưu dữ liệu này trong HealthKit.

00:16:37.000 --> 00:16:46.000
Phục hồi nhịp tim là một loại số lượng có mã định danh .heartRateRecoveryOneMinute.

00:16:46.000 --> 00:16:54.000
Thông tin ngữ cảnh bổ sung về mỗi mẫu phục hồi nhịp tim có thể được thêm vào dưới dạng siêu dữ liệu.

00:16:54.000 --> 00:17:03.000
Trong bài tập bơi-xe đạp gần đây của tôi, tôi đã đẩy mình đến giới hạn của mình, và sau đó quan sát nhịp tim của tôi phục hồi.

00:17:03.000 --> 00:17:08.000
Tôi mất khoảng ba tiếng rưỡi để hoàn thành bài tập.

00:17:08.000 --> 00:17:14.000
Tôi đã đạt nhịp tim tối đa 184 nhịp mỗi phút khi tôi đang chạy.

00:17:14.000 --> 00:17:20.000
Và phút sau khi tập luyện, nhịp tim của tôi giảm 50 nhịp.

00:17:20.000 --> 00:17:33.000
Khi sử dụng HKLiveWorkoutBuilder trên Apple Watch, một mẫu phục hồi nhịp tim, cùng với ngữ cảnh xung quanh, sẽ tự động được lưu trong HealthKit sau khi tập luyện.

00:17:33.000 --> 00:17:42.000
Nếu không, để lưu mẫu phục hồi nhịp tim, tôi tạo một mẫu số lượng với loại .heartRateRecoveryOneMinute.

00:17:42.000 --> 00:17:50.000
Nhịp tim của tôi giảm 50 nhịp một phút sau khi tập luyện, vì vậy tôi đặt nó làm số lượng mẫu của mình.

00:17:50.000 --> 00:17:54.000
Tôi cũng đặt ngày bắt đầu và ngày kết thúc cho mẫu.

00:17:54.000 --> 00:18:03.000
Sau đó, tôi đặt thông tin ngữ cảnh bổ sung vào từ điển siêu dữ liệu, bắt đầu với loại kiểm tra khôi phục.

00:18:03.000 --> 00:18:09.000
Bởi vì tập luyện của tôi là một nỗ lực toàn diện, loại bài kiểm tra là .maxExercise.

00:18:09.000 --> 00:18:15.000
Bài tập của tôi là swimBikeRun, vì vậy tôi đặt nó làm loại hoạt động.

00:18:15.000 --> 00:18:23.000
Tôi cũng có thể thêm thời lượng tập luyện bằng cách sử dụng phím HeartRateRecoveryActivity Duration.

00:18:23.000 --> 00:18:32.000
Cuối cùng, tôi thêm nhịp tim tối đa quan sát được trong quá trình tập luyện, là 184 nhịp mỗi phút.

00:18:32.000 --> 00:18:39.000
Với những cập nhật này, giờ đây việc theo dõi bơi-xe đạp và tập luyện ngắt quãng trở nên dễ dàng hơn bao giờ hết.

00:18:39.000 --> 00:18:52.000
Ngoài ra, việc giới thiệu các số liệu mới cung cấp một bức tranh toàn diện hơn cho việc tập luyện của bạn và những cách mới hơn để đánh giá tiến độ theo thời gian.

00:18:52.000 --> 00:19:03.000
Mặc dù hoạt động và thể dục là thứ ảnh hưởng đến tất cả mọi người nhưng có những khía cạnh khác của sức khỏe ảnh hưởng đến nhiều người trong chúng ta, chẳng hạn như thị lực.

00:19:03.000 --> 00:19:17.000
Trên thực tế, theo Hội đồng Thị lực Hoa Kỳ, khoảng 75 phần trăm người trưởng thành ở Hoa Kỳ dựa vào việc điều chỉnh thị lực bằng kính theo toa hoặc kính áp tròng.

00:19:17.000 --> 00:19:27.000
Tuy nhiên, những đơn thuốc này rất dễ bị mất và đó là một thứ nữa bạn cần mang theo bên mình khi đặt mua kính theo toa hoặc kính áp tròng.

00:19:27.000 --> 00:19:31.000
Vậy hãy đặt chúng vào điện thoại của chúng ta.

00:19:31.000 --> 00:19:39.000
Bắt đầu với iOS 16, các ứng dụng của bạn giờ đây có thể lưu kính và đơn thuốc danh bạ trong HealthKit.

00:19:39.000 --> 00:19:45.000
Đơn thuốc thị lực là một mẫu với visionPrescriptionType.

00:19:45.000 --> 00:19:54.000
Ngày bắt đầu của mẫu tương ứng với ngày cấp đơn thuốc, trong khi ngày kết thúc tương ứng với ngày hết hạn.

00:19:54.000 --> 00:20:02.000
Tùy chọn, một bản sao kỹ thuật số của đơn thuốc vật lý có thể được đính kèm vào mẫu.

00:20:02.000 --> 00:20:10.000
Mẫu đơn thuốc kính hoặc kính áp tròng là một phân lớp của HKVisionPrescription.

00:20:10.000 --> 00:20:20.000
Đối với kính, bạn sử dụng lớp con HKGlassesPrescription, và đối với kính áp tròng, lớp con HKContactsPrescription.

00:20:20.000 --> 00:20:29.000
Mỗi đơn thuốc kính được tạo ra bằng cách sử dụng hai đối tượng đặc điểm kỹ thuật của thấu kính thủy tinh; một cho mỗi mắt.

00:20:29.000 --> 00:20:36.000
Và tương tự, đơn thuốc tiếp xúc được tạo ra với hai đối tượng đặc điểm kỹ thuật của kính áp tròng.

00:20:36.000 --> 00:20:42.000
Bây giờ, hãy lưu đơn thuốc kính đọc sách của tôi cho HealthKit.

00:20:42.000 --> 00:20:48.000
Bước đầu tiên là tạo ra một HKGlassesLensSpecification cho mỗi mắt.

00:20:48.000 --> 00:20:54.000
Một số thông số, chẳng hạn như khoảng cách đỉnh và lăng kính, là tùy chọn.

00:20:54.000 --> 00:21:00.000
Tôi có thể tạo ra thông số kỹ thuật ống kính mắt phù hợp theo cùng một cách.

00:21:00.000 --> 00:21:09.000
Tiếp theo, tôi tạo ra một mẫu đơn thuốc kính với thông số kỹ thuật ống kính mắt phải và mắt trái của mình.

00:21:09.000 --> 00:21:16.000
Đơn thuốc này dành cho kính đọc sách của tôi, vì vậy tôi sẽ thêm nó vào phần mô tả.

00:21:16.000 --> 00:21:20.000
Sau đó, tôi chỉ cần gọi tiết kiệm trên healthStore với đơn thuốc của mình.

00:21:20.000 --> 00:21:25.000
Và với điều đó, đơn thuốc của tôi hiện đã được lưu trong HealthKit.

00:21:25.000 --> 00:21:31.000
Tôi cũng đã chụp một bức ảnh về nó, mà tôi muốn đính kèm vào mẫu mà tôi vừa lưu.

00:21:31.000 --> 00:21:37.000
Tệp đính kèm được đại diện bởi một đối tượng HKAttachment.

00:21:37.000 --> 00:21:43.000
Bạn sử dụng HKAttachmentStore để lưu và đọc tệp đính kèm.

00:21:43.000 --> 00:21:50.000
Chỉ những hình ảnh tĩnh hoặc tệp PDF mới có thể được đính kèm vào đơn thuốc.

00:21:50.000 --> 00:22:01.000
Để đính kèm hình ảnh tôi đã chụp vào mẫu đơn thuốc của mình, tôi bắt đầu bằng cách tạo một đối tượng HKAttachmentStore bằng cách sử dụng healthStore.

00:22:01.000 --> 00:22:07.000
Sau đó, tôi gọi addAttachment(to:) với mẫu đơn thuốc của mình.

00:22:07.000 --> 00:22:09.000
Tôi đặt tên cho tệp đính kèm.

00:22:09.000 --> 00:22:13.000
Đây, tôi đang đính kèm một tệp PNG.

00:22:13.000 --> 00:22:17.000
Và cuối cùng, chuyển URL của tệp.

00:22:17.000 --> 00:22:30.000
Đơn thuốc tôi vừa đính kèm chứa nhiều thông tin hơn là chỉ thông số kỹ thuật ống kính - thông tin nhạy cảm, như tên đầy đủ và ngày sinh của tôi.

00:22:30.000 --> 00:22:40.000
Một trong những nguyên tắc cốt lõi của HealthKit là bảo vệ quyền riêng tư của bạn và đảm bảo rằng bạn luôn kiểm soát dữ liệu bạn chia sẻ.

00:22:40.000 --> 00:22:52.000
Bởi vì có thể dễ dàng chia sẻ nhiều dữ liệu hơn dự định với các đơn thuốc bao gồm tệp đính kèm, chúng tôi đang giới thiệu một mô hình ủy quyền mới cho các đơn thuốc.

00:22:52.000 --> 00:22:57.000
Quyền đọc được cấp cho từng đối tượng kê đơn riêng biệt.

00:22:57.000 --> 00:23:07.000
Người dùng có thể chọn chính xác đơn thuốc mà họ cấp quyền truy cập ứng dụng của bạn và cập nhật lựa chọn của họ bất cứ lúc nào.

00:23:07.000 --> 00:23:14.000
Chúng tôi có một API mới để yêu cầu ủy quyền cho các đối tượng theo toa thị lực.

00:23:14.000 --> 00:23:22.000
Cũng giống như các loại dữ liệu khác, bạn có thể sử dụng các truy vấn để đọc các đơn thuốc mà ứng dụng của bạn có quyền truy cập.

00:23:22.000 --> 00:23:27.000
Nếu bạn chỉ quan tâm đến một số đơn thuốc nhất định, bạn có thể sử dụng một vị ngữ.

00:23:27.000 --> 00:23:37.000
Để yêu cầu ủy quyền, chỉ cần gọi phương thức ủy quyền requestPerObjectRead của healthStore với visionType.

00:23:37.000 --> 00:23:48.000
Làm như vậy sẽ luôn hiển thị lời nhắc ủy quyền trong ứng dụng của bạn với danh sách tất cả các đơn thuốc phù hợp với vị ngữ của bạn.

00:23:48.000 --> 00:23:56.000
Đảm bảo rằng bạn đang yêu cầu ủy quyền trong bối cảnh thích hợp để đảm bảo trải nghiệm người dùng tốt nhất.

00:23:56.000 --> 00:24:05.000
Đây chỉ là một số điều mới mà chúng tôi đã thêm vào HealthKit để trao quyền cho các ứng dụng của bạn để cung cấp trải nghiệm sức khỏe và thể dục tốt hơn.

00:24:05.000 --> 00:24:09.000
Chúng tôi nóng lòng muốn xem bạn sẽ xây dựng gì tiếp theo.

00:24:09.000 --> 00:24:17.000
Chúc bạn có một WWDC tuyệt vời, và nếu bạn có bất kỳ câu hỏi nào, chúng tôi sẽ sẵn lòng giúp bạn trong Diễn đàn Nhà phát triển.

00:24:17.000 --> 23:59:59.000
♪

