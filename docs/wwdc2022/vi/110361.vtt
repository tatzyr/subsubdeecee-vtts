WEBVTT

00:00:00.000 --> 00:00:15.000
Suzy: Xin chào và chào mừng đến với "Các bài kiểm tra nhanh chóng và đáng tin cậy của tác giả cho Xcode Cloud."

00:00:15.000 --> 00:00:18.000
Tôi là Suzy, và tôi làm việc trên XCTest.

00:00:18.000 --> 00:00:24.000
Trong phiên này, tôi sẽ chia sẻ những cách hiệu quả nhất để bắt đầu thử nghiệm cho Xcode Cloud.

00:00:24.000 --> 00:00:30.000
Các nhóm của chúng tôi đã thiết kế Xcode Cloud để trở thành một công cụ mạnh mẽ cho tất cả các nhà phát triển.

00:00:30.000 --> 00:00:34.000
Trên thực tế, chúng tôi sử dụng nó để tự kiểm tra Xcode và tôi thích nó.

00:00:34.000 --> 00:00:41.000
Một trong những tính năng yêu thích của tôi về Xcode Cloud là khả năng mở rộng đáng kể một bộ thử nghiệm nhất định.

00:00:41.000 --> 00:01:10.000
Bằng cách định cấu hình hầu hết các thử nghiệm để chạy trên đám mây, giờ đây bạn có một cách thực tế để chạy các thử nghiệm trên nhiều điểm đến, bao gồm cả những thử nghiệm chạy các phiên bản hệ điều hành khác nhau để tận dụng các nền tảng đa dạng như iPhone, iPad, Apple Watch, Apple TV và Mac và chạy các cấu hình kế hoạch thử nghiệm khác nhau

00:01:10.000 --> 00:01:16.000
Khi chúng tôi đã vượt qua một bộ kiểm tra kỹ lưỡng như vậy, chúng tôi có thể tự tin rằng mã đã sẵn sàng để vận chuyển.

00:01:16.000 --> 00:01:27.000
Giảm tải các bài kiểm tra sang Xcode Cloud cho phép chạy một bộ kiểm tra rộng hơn mà không ảnh hưởng đến chu kỳ mã, biên dịch và kiểm tra trên máy tính để bàn của các nhà phát triển.

00:01:27.000 --> 00:01:34.000
Với bộ kiểm tra hiện đã được mở rộng này, có khả năng tăng số lượng các bài kiểm tra không đáng tin cậy.

00:01:34.000 --> 00:01:37.000
Tình huống này có thể trở nên không thể quản lý được.

00:01:37.000 --> 00:01:42.000
Như vậy, đảm bảo độ tin cậy là điều cần thiết.

00:01:42.000 --> 00:01:53.000
Ngoài độ tin cậy, một số lượng lớn các bài kiểm tra như vậy cũng cần phải chạy hiệu quả để hạn chế tác động của chúng đối với quá trình tích hợp liên tục.

00:01:53.000 --> 00:01:55.000
Trước tiên hãy giải quyết độ tin cậy.

00:01:55.000 --> 00:02:00.000
Tôi sẽ trình bày cách tạo ra các bài kiểm tra đáng tin cậy hơn cho Xcode Cloud bằng cách sử dụng Food Truck.

00:02:00.000 --> 00:02:06.000
Food Truck là một ứng dụng chuyển đổi vòi và vuốt thành bánh rán ngon.

00:02:06.000 --> 00:02:15.000
Bằng cách chạy bộ thử nghiệm trong Xcode Cloud, chúng tôi có thể xác nhận rằng tất cả các nền tảng của Apple đều hỗ trợ đặt hàng bánh rán yêu thích của tôi, sô cô la với rắc.

00:02:15.000 --> 00:02:21.000
Mỗi cải tiến đối với Quy trình làm việc đám mây Xcode sẽ được xác định và chứng minh.

00:02:21.000 --> 00:02:36.000
Để biết thêm thông tin về việc bắt đầu với Xcode Cloud Workflows, hãy xem "Gặp gỡ Xcode Cloud." Bước đầu tiên để tạo ra các bài kiểm tra đáng tin cậy hơn là đảm bảo thiết lập và gỡ bỏ của mỗi bài kiểm tra là kỹ lưỡng.

00:02:36.000 --> 00:02:43.000
Các thử nghiệm chạy trong Xcode Cloud sử dụng một trình mô phỏng mới có thể không đáp ứng các giả định ban đầu của nhà phát triển.

00:02:43.000 --> 00:02:50.000
Hãy xác định một số giả định cấu hình thiết bị đôi khi được thấy trong mã thử nghiệm.

00:02:50.000 --> 00:02:54.000
Một số bài kiểm tra nhất định có thể dựa trên ngày và giờ cụ thể.

00:02:54.000 --> 00:02:58.000
Ví dụ, một máy chủ có thể đang chạy ở một múi giờ khác.

00:02:58.000 --> 00:03:02.000
Các bài kiểm tra nên tránh cụ thể về múi giờ.

00:03:02.000 --> 00:03:09.000
Các giá trị dựa trên ngôn ngữ, chẳng hạn như định dạng số và định hướng ngôn ngữ, có thể dẫn đến kết quả không mong muốn.

00:03:09.000 --> 00:03:14.000
Tránh vấn đề này bằng cách thiết lập rõ ràng ngôn ngữ trình giả lập của bạn.

00:03:14.000 --> 00:03:21.000
Một giả định có vấn đề khác là sự phụ thuộc vào một số quyền thiết bị nhất định như truy cập internet.

00:03:21.000 --> 00:03:28.000
Tốt nhất là mô phỏng quyền của thiết bị trong bài kiểm tra đơn vị và sử dụng trình xử lý cảnh báo trong Bài kiểm tra giao diện người dùng.

00:03:28.000 --> 00:03:32.000
Cuối cùng, một số bài kiểm tra phụ thuộc vào dữ liệu được tải sẵn.

00:03:32.000 --> 00:03:37.000
Ví dụ, một bài kiểm tra có thể mong đợi có một thư mục tài liệu trống.

00:03:37.000 --> 00:03:46.000
Mặc dù cấu hình rõ ràng trình giả lập đôi khi là lựa chọn dễ dàng nhất, nhưng việc nâng cao phương pháp thiết lập của bài kiểm tra nói chung là mạnh mẽ hơn.

00:03:46.000 --> 00:03:50.000
Ví dụ, Food Truck phụ thuộc vào một tệp thực đơn.

00:03:50.000 --> 00:03:58.000
Là một phần của việc khởi tạo đối tượng xe tải trong chức năng thiết lập, chúng tôi tạo một tệp dữ liệu giả chứa các mục menu bánh rán.

00:03:58.000 --> 00:04:08.000
Lưu ý rằng thay vì dựa vào các phương pháp teardown để chuẩn bị cho các bài kiểm tra tiếp theo, chúng tôi khuyên bạn nên thiết lập tất cả việc chuẩn bị trạng thái trong phương pháp thiết lập.

00:04:08.000 --> 00:04:15.000
Trong nhiều trường hợp, các tệp chỉ đọc có thể được kiểm tra vào kho lưu trữ và sau đó được truy cập bằng các bài kiểm tra.

00:04:15.000 --> 00:04:26.000
Tuy nhiên, khi các tệp này cần được xây dựng, Xcode Cloud hỗ trợ chạy tập lệnh xây dựng tùy chỉnh, nơi bạn có thể tạo tệp một lần để truy cập nhiều bài kiểm tra.

00:04:26.000 --> 00:04:34.000
Để biết thêm chi tiết về cách định cấu hình tập lệnh của bạn, hãy xem "Tùy chỉnh quy trình làm việc Xcode Cloud nâng cao của bạn."

00:04:34.000 --> 00:04:38.000
Điều đó kết thúc thiết lập mô phỏng thích hợp.

00:04:38.000 --> 00:04:43.000
Bây giờ, hãy đề cập đến cách xử lý các bài kiểm tra không đáp ứng các điều kiện tiên quyết.

00:04:43.000 --> 00:04:52.000
XCTSkip là một lỗi hướng dẫn XCTest Runner ngừng thực hiện bài kiểm tra hiện tại và đánh dấu nó là đã bỏ qua.

00:04:52.000 --> 00:04:58.000
Điều này có thể được sử dụng để bỏ qua phiên bản hệ điều hành hoặc loại thiết bị chưa được hỗ trợ.

00:04:58.000 --> 00:05:06.000
Bạn cũng có thể tận dụng XCTSkip bằng cách thiết lập một biến môi trường để bỏ qua các bài kiểm tra cụ thể cho môi trường dàn dựng hoặc sản xuất.

00:05:06.000 --> 00:05:12.000
Hãy xem xét cách chúng ta có thể kiểm soát luồng thử nghiệm bằng cách sử dụng biến môi trường.

00:05:12.000 --> 00:05:22.000
Các biến môi trường có thể cung cấp các tham số cho cả ứng dụng chạy thử nghiệm XCTest trên thiết bị của bạn và máy chủ thử nghiệm chạy xcodebuild.

00:05:22.000 --> 00:05:29.000
Trong Xcode Cloud, các biến môi trường có tiền tố TEST_RUNNER_ được chuyển vào trình chạy thử nghiệm XCTest.

00:05:29.000 --> 00:05:35.000
Tiền tố này sẽ bị loại bỏ trước khi biến được cung cấp cho mã của bạn.

00:05:35.000 --> 00:05:48.000
Vì vậy, ví dụ, một biến trong mã kiểm tra của bạn có tên BASE_URL sẽ được chuyển vào dưới dạng biến môi trường có tên TEST_RUNNER_BASE_URL.

00:05:48.000 --> 00:05:51.000
Các kế hoạch kiểm tra yêu cầu cùng định dạng với mã kiểm tra.

00:05:51.000 --> 00:05:56.000
Cụ thể, chúng tôi không thêm tiền tố TEST_RUNNER_.

00:05:56.000 --> 00:06:00.000
Các biến môi trường có thể được tham chiếu ở bất kỳ đâu trong mã thử nghiệm.

00:06:00.000 --> 00:06:08.000
Ví dụ, chúng có thể được sử dụng với XCTSkip để bỏ qua bài kiểm tra để thực sự đặt bánh rán khi chúng tôi ở trong môi trường sản xuất.

00:06:08.000 --> 00:06:11.000
Tất nhiên là trừ khi bạn đói.

00:06:11.000 --> 00:06:22.000
Điều quan trọng cần lưu ý là việc xác định lại một biến môi trường ở nhiều nơi, chẳng hạn như cả kế hoạch thử nghiệm và Giao diện người dùng đám mây Xcode, có thể dẫn đến kết quả không mong muốn.

00:06:22.000 --> 00:06:31.000
Trong trường hợp cụ thể này, các biến Môi trường của Xcode Cloud sẽ được ưu tiên hơn những gì được chỉ định trong kế hoạch thử nghiệm dự án của bạn.

00:06:31.000 --> 00:06:41.000
Bây giờ chúng tôi đang tham chiếu biến môi trường của mình trong mã thử nghiệm, chúng tôi có thể đặt giá trị của nó trong Giao diện người dùng đám mây Xcode.

00:06:41.000 --> 00:06:48.000
Để làm điều này, hãy điều hướng đến Báo cáo Đám mây của bạn và nhấp chuột điều khiển vào Xe tải Thực phẩm.

00:06:48.000 --> 00:06:57.000
Để chỉnh sửa các biến môi trường của chúng tôi trong Quy trình làm việc, chúng tôi sẽ chọn "Quản lý quy trình làm việc" trong menu ngữ cảnh.

00:06:57.000 --> 00:07:03.000
Chúng tôi đang chỉnh sửa quy trình làm việc tích hợp cụ thể, vì vậy chúng tôi sẽ nhấp đúp vào nó.

00:07:03.000 --> 00:07:19.000
Bây giờ, trong thanh bên, chúng ta có thể chọn "Môi trường" và ở giữa trang tính, bên dưới "Biến môi trường", chúng ta có thể thêm tên và giá trị của biến.

00:07:19.000 --> 00:07:28.000
Để thay thế cho việc thiết lập biến môi trường trong Xcode Cloud Workflow, thay vào đó chúng tôi có thể đặt nó trong kế hoạch thử nghiệm.

00:07:28.000 --> 00:07:31.000
Trong ví dụ này, chúng tôi chưa có kế hoạch kiểm tra.

00:07:31.000 --> 00:07:43.000
Để kích hoạt các kế hoạch kiểm tra, hãy mở trình chỉnh sửa sơ đồ, chọn "Kiểm tra" trong thanh bên, sau đó nhấp vào "Chuyển đổi để sử dụng các kế hoạch kiểm tra".

00:07:43.000 --> 00:07:47.000
Được rồi, bây giờ chúng ta có một kế hoạch thử nghiệm mà tôi gọi là "Xe tải thực phẩm".

00:07:47.000 --> 00:07:54.000
Để thêm biến môi trường, chúng ta cần nhấp vào kế hoạch thử nghiệm để mở trình chỉnh sửa của nó.

00:07:54.000 --> 00:07:58.000
Gần phía trên, chúng ta có thể chọn giữa "Kiểm tra" và "Cấu hình".

00:07:58.000 --> 00:08:02.000
Hãy chọn "Cấu hình."

00:08:02.000 --> 00:08:10.000
Bây giờ, trong phần "Tranh luận", chúng tôi sẽ thêm biến bằng cách nhấp vào "Biến môi trường".

00:08:10.000 --> 00:08:18.000
Một cửa sổ bật lên sẽ xuất hiện nơi chúng ta có thể nhập tên và giá trị của biến.

00:08:18.000 --> 00:08:21.000
Bây giờ thử nghiệm của chúng tôi sẽ bị bỏ qua khi ở trong môi trường sản xuất.

00:08:21.000 --> 00:08:28.000
Để tìm hiểu thêm về việc bỏ qua các bài kiểm tra, hãy xem "XCTBỏ qua các bài kiểm tra của bạn."

00:08:28.000 --> 00:08:36.000
Bây giờ chúng tôi đã đề cập đến việc sử dụng các biến môi trường để kiểm soát XCTSkip, hãy nói về thời gian chờ kỳ vọng.

00:08:36.000 --> 00:08:41.000
Một bài kiểm tra có thể thất bại do thời gian chờ bất ngờ.

00:08:41.000 --> 00:08:48.000
Ví dụ, đây có thể là kết quả của một máy chủ chậm hoặc một bài kiểm tra giao diện người dùng quá lo lắng.

00:08:48.000 --> 00:08:59.000
Một cách tiếp cận để giải quyết một trong hai vấn đề sẽ là tăng thời gian chờ XCTestExpectation để tương tác có đủ thời gian kết thúc.

00:08:59.000 --> 00:09:07.000
Trong ví dụ này, chúng tôi tăng thời gian chờ OrderDonut từ 5 lên 10 giây để cho phép máy chủ có thêm thời gian phản hồi.

00:09:07.000 --> 00:09:16.000
Thay vào đó, thường tốt hơn là thay thế cả ứng dụng và xử lý thời gian chờ mã thử nghiệm bằng async/await.

00:09:16.000 --> 00:09:24.000
Cách tiếp cận này cho phép kiểm tra tạm dừng cho đến khi cuộc gọi chờ kết thúc mà không có bất kỳ thời gian chờ nào.

00:09:24.000 --> 00:09:29.000
Chúng tôi đã giải quyết các bài kiểm tra phụ thuộc vào thời gian, vì vậy hãy xử lý mọi lỗi kiểm tra trong bộ kiểm tra.

00:09:29.000 --> 00:09:37.000
Ví dụ, chúng tôi có một bài kiểm tra dựa trên một dịch vụ trong môi trường dàn dựng không hoạt động để bảo trì.

00:09:37.000 --> 00:09:42.000
Chúng ta có thể sử dụng XCTExpectFailure thay vì vô hiệu hóa hoặc bỏ qua bài kiểm tra này.

00:09:42.000 --> 00:09:56.000
Với XCTExpectFailure, bài kiểm tra của bạn thực hiện bình thường và kết quả được chuyển đổi như sau: một thất bại trong một bài kiểm tra bây giờ sẽ được báo cáo là một thất bại dự kiến, trong khi bài kiểm tra thất bại trong bộ của nó sẽ được báo cáo là vượt qua.

00:09:56.000 --> 00:10:02.000
Cách tiếp cận này loại bỏ tiếng ồn được tạo ra bởi các lỗi dự kiến.

00:10:02.000 --> 00:10:06.000
Ví dụ, testOrderDonut đang thất bại.

00:10:06.000 --> 00:10:15.000
Tôi biết rằng dịch vụ cung cấp bánh rán đặt hàng hiện đang được bảo trì, vì vậy tôi đã thêm một cuộc gọi đến đây tới XCTExpectFailure.

00:10:15.000 --> 00:10:23.000
Để tìm hiểu thêm về XCTExpectFailure, hãy xem "Nắm bắt những thất bại dự kiến trong XCTest."

00:10:23.000 --> 00:10:31.000
Bây giờ chúng tôi đã tuyên bố thất bại dự kiến, hãy tận dụng các lần lặp lại kiểm tra để chứng minh mã và chẩn đoán mã không đáng tin cậy.

00:10:31.000 --> 00:10:42.000
Lặp lại bài kiểm tra là một công cụ chạy cùng một bài kiểm tra nhiều lần chờ đợi những điều sau: thất bại đầu tiên, thành công đầu tiên hoặc kết quả thống kê.

00:10:42.000 --> 00:10:55.000
Ví dụ, tại bàn làm việc của chúng tôi, chúng tôi chạy mã mới và các trường hợp kiểm tra nhiều lần với các lần lặp lại để xác nhận độ tin cậy của ứng dụng ban đầu và kiểm tra mã trước khi kiểm tra mã.

00:10:55.000 --> 00:11:00.000
Chúng tôi đã có thể phát hiện ra rằng testOrderDonut chỉ có tỷ lệ thành công 80%.

00:11:00.000 --> 00:11:02.000
Uh-oh!

00:11:02.000 --> 00:11:08.000
Biết lỗi tồn tại, bây giờ chúng tôi sử dụng chế độ lặp lại cho đến khi thất bại để chẩn đoán lỗi cục bộ.

00:11:08.000 --> 00:11:13.000
Đây là một cách khác để sử dụng các lần lặp lại bài kiểm tra.

00:11:13.000 --> 00:11:24.000
Đối với các bài kiểm tra dựa trên dịch vụ bên ngoài không đáng tin cậy, bạn có thể muốn tận dụng chính sách lặp lại thử lại khi không thành công để xác nhận bài kiểm tra có thể thành công.

00:11:24.000 --> 00:11:30.000
Mặc dù thử lại các bài kiểm tra là một cách tiếp cận mạnh mẽ, nhưng thay vào đó tốt hơn là chế giễu các dịch vụ bên ngoài khi có thể.

00:11:30.000 --> 00:11:36.000
Ưu điểm của dịch vụ được chế giễu bao gồm độ tin cậy và tốc độ xác định.

00:11:36.000 --> 00:11:46.000
Để tìm hiểu cách chế giễu sự phụ thuộc của bạn, hãy xem "Mẹo &amp; Thủ thuật Kiểm tra". Hãy cùng khám phá cách lặp lại bài kiểm tra có thể được kích hoạt.

00:11:46.000 --> 00:11:56.000
Để cho phép lặp lại bài kiểm tra trong kế hoạch kiểm tra của bạn, hãy quay lại trình chỉnh sửa kế hoạch kiểm tra và chọn "Cấu hình".

00:11:56.000 --> 00:12:04.000
Sau đó, trong phần "Thực thi thử nghiệm", có một cửa sổ bật lên để chọn chế độ lặp lại bài kiểm tra của bạn.

00:12:04.000 --> 00:12:13.000
Trong trường hợp này, chúng tôi sẽ chọn "Thử lại lỗi", được sử dụng chủ yếu để làm việc xung quanh các dịch vụ bên ngoài không đáng tin cậy.

00:12:13.000 --> 00:12:16.000
Bây giờ chúng tôi đã bật chế độ lặp lại bài kiểm tra của mình.

00:12:16.000 --> 00:12:24.000
Để biết thêm thông tin về việc tận dụng các lần lặp lại bài kiểm tra, hãy xem "Chẩn đoán mã không đáng tin cậy với sự lặp lại bài kiểm tra."

00:12:24.000 --> 00:12:30.000
Vì vậy, chúng tôi đã xem xét nhiều công cụ có thể được sử dụng để cải thiện độ tin cậy của bài kiểm tra.

00:12:30.000 --> 00:12:36.000
Để biết thêm thông tin về việc viết bài kiểm tra chất lượng, hãy xem "Viết bài kiểm tra để thất bại."

00:12:36.000 --> 00:12:40.000
Bây giờ các bài kiểm tra của chúng tôi đáng tin cậy, hãy làm cho chúng chạy nhanh!

00:12:40.000 --> 00:12:44.000
Một số tùy chọn cấu hình tồn tại để đạt được kết quả nhanh hơn.

00:12:44.000 --> 00:12:51.000
Hãy làm những gì chúng ta có thể để giảm thời gian chạy bộ thử nghiệm.

00:12:51.000 --> 00:12:56.000
Một kỹ thuật chúng tôi sử dụng để cải thiện hiệu suất là chia các bài kiểm tra của chúng tôi thành nhiều kế hoạch kiểm tra.

00:12:56.000 --> 00:13:00.000
Đôi khi, hai là đủ.

00:13:00.000 --> 00:13:10.000
Bạn có thể xác định một bộ kiểm tra rút gọn để xác minh như một phần của mỗi lần mở hoặc cập nhật yêu cầu kéo.

00:13:10.000 --> 00:13:23.000
Ví dụ, chúng tôi có thể chạy các bài kiểm tra đơn vị cùng với chỉ một tập hợp con chính của các bài kiểm tra giao diện người dùng cho một nền tảng duy nhất.

00:13:23.000 --> 00:13:32.000
Bộ kiểm tra đầy đủ trên tất cả các nền tảng được hỗ trợ vẫn có thể chạy, nhưng bây giờ ở chế độ nền và không chặn các yêu cầu kéo.

00:13:32.000 --> 00:13:40.000
Cách tiếp cận này cho phép chúng tôi thêm các bài kiểm tra và nền tảng mới trong khi vẫn giữ cho quá trình tích hợp liên tục của chúng tôi kịp thời.

00:13:40.000 --> 00:13:43.000
Hãy thiết lập một quy trình làm việc để chạy một bộ kiểm tra được chọn.

00:13:43.000 --> 00:13:51.000
Trong ví dụ này, chúng tôi đã tạo một kế hoạch kiểm tra mới được gọi là "Yêu cầu kéo" và mở nó trong trình chỉnh sửa kế hoạch kiểm tra.

00:13:51.000 --> 00:13:55.000
Gần đầu chúng ta có thể chọn giữa "Kiểm tra" và "Cấu hình".

00:13:55.000 --> 00:14:01.000
Hãy chọn "Kiểm tra."

00:14:01.000 --> 00:14:07.000
Ở đây chúng tôi đã chọn một tập hợp con các bài kiểm tra để được xác minh cho một yêu cầu kéo.

00:14:07.000 --> 00:14:21.000
Bây giờ để thiết lập Quy trình làm việc để chạy kế hoạch kiểm tra "Pull Requests" của chúng tôi, chúng tôi sẽ quay lại Xcode Cloud Manage Workflows giống như chúng tôi đã làm khi chúng tôi thêm một biến môi trường để bỏ qua các bài kiểm tra.

00:14:21.000 --> 00:14:28.000
Để tạo một quy trình làm việc mới, chúng tôi sẽ nhấp vào nút "Thêm" ở phía dưới bên trái của trang "Quản lý quy trình làm việc".

00:14:28.000 --> 00:14:34.000
Để đơn giản, hãy đặt tên cho quy trình làm việc của chúng tôi là "Yêu cầu kéo" và chọn điều kiện bắt đầu.

00:14:34.000 --> 00:14:39.000
Chúng tôi muốn quy trình làm việc này ngăn chặn bất kỳ đăng ký nào với các bài kiểm tra không thành công.

00:14:39.000 --> 00:14:48.000
Trong thanh bên, ở bên phải của "Điều kiện bắt đầu", chúng ta sẽ nhấp vào nút "Thêm".

00:14:48.000 --> 00:14:51.000
Một menu sẽ xuất hiện hiển thị các tùy chọn điều kiện bắt đầu.

00:14:51.000 --> 00:14:56.000
Trong trường hợp của chúng tôi, chúng tôi sẽ chọn "Kéo yêu cầu thay đổi."

00:14:56.000 --> 00:15:00.000
Bây giờ, bây giờ chúng ta có một điều kiện bắt đầu yêu cầu kéo.

00:15:00.000 --> 00:15:05.000
Chạy thử nghiệm yêu cầu ứng dụng Xe tải Thực phẩm trước tiên phải được xây dựng.

00:15:05.000 --> 00:15:08.000
Để làm điều này, chúng ta cần thêm một hành động xây dựng.

00:15:08.000 --> 00:15:14.000
Một lần nữa trong thanh bên, bên dưới "Điều kiện bắt đầu", hãy thêm một hành động.

00:15:14.000 --> 00:15:24.000
Chúng tôi sẽ nhấp vào nút "Thêm" bên cạnh "Hành động", và sau đó chọn "Xây dựng" từ trình đơn ngữ cảnh.

00:15:24.000 --> 00:15:29.000
Bây giờ chúng tôi có một hành động xây dựng ứng dụng của mình, chúng tôi sẽ thêm một hành động khác để chạy các thử nghiệm của mình.

00:15:29.000 --> 00:15:36.000
Một lần nữa chúng tôi sẽ nhấp vào thêm hành động, nhưng lần này chúng tôi sẽ chọn "Kiểm tra".

00:15:36.000 --> 00:15:39.000
Tuyệt vời, chúng tôi có một hành động kiểm tra.

00:15:39.000 --> 00:15:42.000
Hãy chọn kế hoạch kiểm tra để chạy.

00:15:42.000 --> 00:15:46.000
Ở giữa tờ giấy, có một trình đơn thả xuống để kiểm tra.

00:15:46.000 --> 00:15:53.000
Tại đây chúng ta có thể chọn kế hoạch kiểm tra "Yêu cầu kéo" của mình.

00:15:53.000 --> 00:15:54.000
Tuyệt vời!

00:15:54.000 --> 00:15:58.000
Bây giờ Quy trình làm việc của chúng tôi được cấu hình để chạy kế hoạch thử nghiệm của chúng tôi theo yêu cầu kéo.

00:15:58.000 --> 00:16:05.000
Để tạo quy trình làm việc thứ hai sẽ chạy bộ kiểm tra hoàn chỉnh của bạn theo lịch trình, bạn có thể làm theo một bộ các bước tương tự.

00:16:05.000 --> 00:16:15.000
Tuy nhiên, lần này, hãy chọn điều kiện bắt đầu là "Theo lịch trình cho một chi nhánh" và sau đó đặt quy trình làm việc để chạy kế hoạch kiểm tra bộ đầy đủ của bạn.

00:16:15.000 --> 00:16:22.000
Chúng tôi có cả Quy trình làm việc được định cấu hình trong Xcode Cloud và chạy các kế hoạch thử nghiệm liên quan của chúng.

00:16:22.000 --> 00:16:28.000
Để tìm hiểu thêm về các kế hoạch kiểm tra, hãy xem "Kiểm tra trong Xcode."

00:16:28.000 --> 00:16:32.000
Bây giờ chúng tôi đã tạo yêu cầu kéo và các bộ kiểm tra quy trình làm việc đã lên lịch.

00:16:32.000 --> 00:16:37.000
Một cải tiến khác mà chúng tôi có thể thực hiện cho tốc độ là chạy thử nghiệm đồng thời.

00:16:37.000 --> 00:16:43.000
Theo mặc định, Xcode Cloud kiểm tra song song các nền tảng của bạn.

00:16:43.000 --> 00:16:52.000
Ngoài ra, bạn có thể kích hoạt Xcode để chạy các bài kiểm tra song song ở cấp độ lớp đối tượng mục tiêu và kiểm tra.

00:16:52.000 --> 00:17:04.000
Để cho phép thực hiện kiểm tra song song trong Xcode, chúng tôi sẽ lại truy cập trình chỉnh sửa kế hoạch kiểm tra của mình và chọn "Kiểm tra".

00:17:04.000 --> 00:17:11.000
Sau đó, ở bên phải gói thử nghiệm "Kiểm tra xe tải thực phẩm" của chúng tôi, chúng tôi nhấp vào nút "Tùy chọn".

00:17:11.000 --> 00:17:16.000
Một trong những tùy chọn cho phép chúng tôi "Thực hiện song song" khi có thể.

00:17:16.000 --> 00:17:23.000
Nếu máy chủ có đủ lõi có sẵn, nhiều mục tiêu và các lớp đối tượng thử nghiệm có thể được thực thi đồng thời.

00:17:23.000 --> 00:17:29.000
Vì vậy, hãy bật tùy chọn này để cải thiện thời gian quay vòng bộ thử nghiệm của chúng tôi.

00:17:29.000 --> 00:17:33.000
Bây giờ các bài kiểm tra của chúng tôi được cấu hình để chạy song song.

00:17:33.000 --> 00:17:39.000
Lưu ý rằng các bài kiểm tra phải được thiết kế để chạy độc lập để tận dụng lợi thế của việc thực thi song song.

00:17:39.000 --> 00:17:47.000
Thiết lập và tháo dỡ đúng cách là điều cần thiết cho hành vi trường hợp thử nghiệm đáng tin cậy.

00:17:47.000 --> 00:17:52.000
Với các bài kiểm tra của chúng tôi chạy song song, đã đến lúc chuyển sự chú ý của chúng tôi sang các bài kiểm tra chạy trốn.

00:17:52.000 --> 00:17:56.000
Các bài kiểm tra bỏ chạy là những bài kiểm tra không kết thúc kịp thời.

00:17:56.000 --> 00:18:03.000
Một số ví dụ bao gồm một vòng lặp vô hạn hoặc chờ đợi vô thời hạn cho một máy chủ bị lỗi.

00:18:03.000 --> 00:18:07.000
Chúng tôi có thể dừng các bài kiểm tra này bằng cách đặt phụ cấp thời gian thực hiện trong kế hoạch kiểm tra của mình.

00:18:07.000 --> 00:18:15.000
Phụ cấp thời gian thực hiện chỉ định số giây để một bài kiểm tra chạy trước khi nó không thành công với lỗi thời gian chờ.

00:18:15.000 --> 00:18:23.000
Điều này ngăn chặn một bộ kiểm tra bị mắc kẹt trong một bài kiểm tra cá nhân.

00:18:23.000 --> 00:18:26.000
Trong trường hợp này, bài kiểm tra thứ năm bị kẹt vì một số lý do.

00:18:26.000 --> 00:18:33.000
Bằng cách đặt phụ cấp thời gian thực hiện, bài kiểm tra chạy trốn này cuối cùng đã bị dừng lại và được đánh dấu là thất bại.

00:18:33.000 --> 00:18:38.000
XCTest Test Runner sau đó tiếp tục chạy thử nghiệm tiếp theo trong bộ phần mềm.

00:18:38.000 --> 00:18:44.000
Hãy định cấu hình phụ cấp thời gian thực hiện cho kế hoạch kiểm tra của chúng tôi.

00:18:44.000 --> 00:18:53.000
Để đặt phụ cấp thời gian thực hiện, chúng tôi sẽ truy cập trình chỉnh sửa kế hoạch kiểm tra của mình và chọn "Cấu hình".

00:18:53.000 --> 00:19:00.000
Trong danh mục "Thực hiện kiểm tra", chúng tôi có thể bật "Thời gian chờ kiểm tra" và chỉ định số giây để chờ.

00:19:00.000 --> 00:19:05.000
Lưu ý rằng mặc định là 600 giây.

00:19:05.000 --> 00:19:12.000
Sau khi định cấu hình phụ cấp thời gian thực hiện tối đa, một thử nghiệm chạy trốn duy nhất sẽ không còn làm gián đoạn quy trình kiểm tra của chúng tôi nữa.

00:19:12.000 --> 00:19:19.000
Ví dụ, một bộ kiểm tra qua đêm hiện có thể hoàn thành đúng hạn và cung cấp đầy đủ các kết quả hữu ích.

00:19:19.000 --> 00:19:26.000
Yay! Cuối cùng chúng tôi đã dừng các bài kiểm tra chạy trốn đó, vì vậy chúng tôi có thể chuyển sang cải tiến tiếp theo.

00:19:26.000 --> 00:19:34.000
Như bạn có thể nhớ lại, chúng tôi đã có thể tận dụng các lần lặp lại bài kiểm tra để tăng độ tin cậy của các bài kiểm tra dựa trên các dịch vụ bên ngoài.

00:19:34.000 --> 00:19:41.000
Chúng tôi đã định cấu hình kế hoạch kiểm tra của mình để thử lại lỗi và chọn một giá trị lặp lại đủ.

00:19:41.000 --> 00:19:47.000
Tuy nhiên, những lần lặp lại này có thể làm tăng thêm thời gian cần thiết để chạy bộ thử nghiệm.

00:19:47.000 --> 00:19:54.000
Những lần lặp lại không cần thiết là lãng phí và bạn có thể muốn tối ưu hóa giá trị lặp lại bài kiểm tra thành một con số thấp hơn.

00:19:54.000 --> 00:20:01.000
Hơn nữa, bạn có thể cân nhắc loại bỏ hoàn toàn bài kiểm tra có vấn đề khỏi quy trình làm việc yêu cầu kéo.

00:20:01.000 --> 00:20:05.000
Hãy xem qua cách chúng ta có thể làm điều này.

00:20:05.000 --> 00:20:11.000
Hãy quay lại cấu hình lặp lại bài kiểm tra trong trình chỉnh sửa kế hoạch kiểm tra.

00:20:11.000 --> 00:20:16.000
Trước đó chúng tôi đã đặt chế độ lặp lại bài kiểm tra thành "Thử lại khi thất bại".

00:20:16.000 --> 00:20:20.000
Bây giờ chúng ta có thể điều chỉnh giá trị "Lời lặp lại kiểm tra tối đa".

00:20:20.000 --> 00:20:29.000
Ví dụ, chúng tôi có thể đã chọn cho phép tối đa 10 lần thử nghiệm dựa trên máy chủ bên ngoài không thành công 5% thời gian.

00:20:29.000 --> 00:20:32.000
Hầu hết thời gian, chúng tôi sẽ thành công trong lần thử đầu tiên.

00:20:32.000 --> 00:20:39.000
Tuy nhiên, nếu cùng một bài kiểm tra đó có một lỗi không liên quan, nó sẽ thất bại mọi lúc và sử dụng tất cả 10 lần thử.

00:20:39.000 --> 00:20:45.000
Có lẽ 3 lần thử là đủ và là một lựa chọn tốt hơn.

00:20:45.000 --> 00:20:55.000
Mặc dù chúng tôi muốn giảm các lần thử lại để cải thiện hiệu suất, lưu ý rằng trước đó chúng tôi đã đề xuất tăng các lần thử lại để cải thiện độ tin cậy trong một số trường hợp.

00:20:55.000 --> 00:21:02.000
Như vậy, giá trị được chọn tối thiểu này phải tiếp tục đủ để chạy các bài kiểm tra đó một cách đáng tin cậy.

00:21:02.000 --> 00:21:07.000
Điều đó kết thúc cấu hình để có kết quả nhanh hơn.

00:21:07.000 --> 00:21:14.000
Để đi vào chi tiết hơn về việc nhận kết quả kiểm tra nhanh hơn, hãy xem "Nhận kết quả kiểm tra của bạn nhanh hơn."

00:21:14.000 --> 00:21:19.000
Tóm lại, chúng tôi đã đề cập đến những cách hiệu quả nhất để bắt đầu thử nghiệm cho Xcode Cloud.

00:21:19.000 --> 00:21:28.000
Chúng tôi tập trung vào việc cấu hình các bài kiểm tra vừa đáng tin cậy vừa nhanh chóng để bạn có thể tránh các lỗi không liên quan và xác minh các thay đổi mã của mình một cách nhanh chóng.

00:21:28.000 --> 00:21:32.000
Cảm ơn bạn, và tôi hy vọng bạn tận hưởng phần còn lại của WWDC!

00:21:32.000 --> 23:59:59.000
.

