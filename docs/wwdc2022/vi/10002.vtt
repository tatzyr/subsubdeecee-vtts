WEBVTT

00:00:00.000 --> 00:00:14.000
Benjamin Poulain: Xin chào mọi người, và chào mừng đến với phiên của chúng tôi về ảo hóa.

00:00:14.000 --> 00:00:17.000
Đây là những gì chúng ta sẽ làm cùng nhau hôm nay.

00:00:17.000 --> 00:00:24.000
Chúng tôi sẽ xem cách bạn có thể chạy macOS và Linux bên trong các máy ảo, trên Apple silicon.

00:00:24.000 --> 00:00:28.000
Vào cuối phiên này, bạn sẽ có thể làm điều tương tự trên máy Mac của riêng mình.

00:00:28.000 --> 00:00:33.000
Điều này có vẻ hơi tham vọng, nhưng hãy gắn bó với chúng tôi, và chúng tôi sẽ làm điều đó cùng nhau.

00:00:33.000 --> 00:00:35.000
Đây là chương trình nghị sự của chúng tôi cho ngày hôm nay.

00:00:35.000 --> 00:00:43.000
Chúng ta sẽ bắt đầu với một cái nhìn tổng quan về các công nghệ ảo hóa, và chúng ta sẽ xem cách sử dụng khung Ảo hóa để xây dựng các máy ảo.

00:00:43.000 --> 00:00:47.000
Sau đó chúng ta sẽ đi sâu vào macOS.

00:00:47.000 --> 00:00:51.000
Chúng ta sẽ xem cách chúng ta có thể thiết lập một máy Mac ảo và cài đặt macOS vào đó.

00:00:51.000 --> 00:00:56.000
Và cuối cùng, chúng ta sẽ đi sâu lần thứ hai, lần này là vào Linux.

00:00:56.000 --> 00:01:01.000
Chúng ta sẽ xem cách chạy các bản phân phối Linux đầy đủ và một số tính năng mới thú vị.

00:01:01.000 --> 00:01:03.000
Hãy bắt đầu với cái nhìn tổng quan.

00:01:03.000 --> 00:01:08.000
Đầu tiên chúng ta sẽ xem xét ngăn xếp cho phép ảo hóa.

00:01:08.000 --> 00:01:10.000
Tất cả bắt đầu với phần cứng.

00:01:10.000 --> 00:01:16.000
Apple silicon có phần cứng đặc biệt cho phép ảo hóa CPU và bộ nhớ.

00:01:16.000 --> 00:01:20.000
Điều này có nghĩa là bạn có thể chạy nhiều hệ điều hành trên một SoC duy nhất.

00:01:20.000 --> 00:01:24.000
Tiếp theo, chúng ta cần phần mềm để tận dụng phần cứng này.

00:01:24.000 --> 00:01:27.000
Và cái này được tích hợp ngay vào nhân macOS.

00:01:27.000 --> 00:01:30.000
Bạn không còn cần phải viết phần mở rộng hạt nhân, hoặc KEXT nữa.

00:01:30.000 --> 00:01:33.000
Tất cả đều được tích hợp sẵn.

00:01:33.000 --> 00:01:37.000
Để sử dụng những khả năng đó từ ứng dụng của bạn, bạn có thể sử dụng khung Hypervisor.

00:01:37.000 --> 00:01:43.000
Khung Hypervisor là một API cấp thấp cho phép bạn ảo hóa CPU và bộ nhớ.

00:01:43.000 --> 00:01:50.000
Nhưng, bởi vì nó là một khuôn khổ cấp thấp, bạn cần viết từng chi tiết của môi trường ảo.

00:01:50.000 --> 00:01:53.000
Thông thường, chúng tôi muốn chạy các hệ điều hành đầy đủ.

00:01:53.000 --> 00:01:58.000
Đối với điều này, có một API cấp cao hơn, đó là khung Ảo hóa.

00:01:58.000 --> 00:02:08.000
Khung ảo hóa cho phép tạo ra các máy ảo chạy macOS trên Apple silicon hoặc Linux trên cả Apple silicon và Intel.

00:02:08.000 --> 00:02:11.000
Hôm nay, phiên của chúng tôi sẽ tập trung vào khuôn khổ Ảo hóa.

00:02:11.000 --> 00:02:14.000
Khi sử dụng khung Ảo hóa, chúng ta sẽ xử lý hai loại đối tượng.

00:02:14.000 --> 00:02:17.000
Loại đầu tiên là các đối tượng cấu hình.

00:02:17.000 --> 00:02:20.000
Họ xác định tất cả các thuộc tính của máy ảo của chúng tôi.

00:02:20.000 --> 00:02:22.000
Loại thứ hai là các đối tượng máy ảo.

00:02:22.000 --> 00:02:27.000
Những đối tượng đó trừu tượng hóa các máy ảo và cách tương tác với chúng.

00:02:27.000 --> 00:02:31.000
Chúng ta sẽ bắt đầu với việc xem xét cấu hình.

00:02:31.000 --> 00:02:34.000
Cấu hình xác định phần cứng.

00:02:34.000 --> 00:02:38.000
Tạo một cấu hình giống như cấu hình một máy Mac trên Apple Store.

00:02:38.000 --> 00:02:42.000
Chúng tôi xác định chúng tôi muốn bao nhiêu CPU, bao nhiêu bộ nhớ, loại thiết bị nào.

00:02:42.000 --> 00:02:45.000
Chúng ta có thể bắt đầu từ một cấu hình đơn giản.

00:02:45.000 --> 00:02:47.000
Chúng ta có thể thêm một màn hình, và chúng ta có thể xem nội dung.

00:02:47.000 --> 00:02:50.000
Chúng ta có thể thêm một bàn phím, và chúng ta có thể gõ.

00:02:50.000 --> 00:02:53.000
Chúng ta có thể thêm một bàn di chuột, và chúng ta có thể tương tác với giao diện người dùng.

00:02:53.000 --> 00:02:57.000
Cấu hình một máy ảo là như vậy.

00:02:57.000 --> 00:03:01.000
Nhưng vì chúng tôi đang xử lý các máy ảo, chúng tôi sẽ làm điều này bằng mã.

00:03:01.000 --> 00:03:05.000
Hãy xem cách chúng ta có thể viết cấu hình bằng Swift.

00:03:05.000 --> 00:03:07.000
Xác định phần cứng rất đơn giản.

00:03:07.000 --> 00:03:12.000
Chúng tôi bắt đầu với một đối tượng thuộc loại VZVirtualMachineConfiguration.

00:03:12.000 --> 00:03:15.000
Đây là đối tượng gốc của tất cả các cấu hình.

00:03:15.000 --> 00:03:19.000
Tiếp theo, chúng tôi xác định máy của chúng tôi nên có bao nhiêu CPU.

00:03:19.000 --> 00:03:22.000
Ở đây chúng tôi cung cấp bốn CPU.

00:03:22.000 --> 00:03:24.000
Sau đó, chúng tôi đặt bao nhiêu bộ nhớ chúng tôi muốn.

00:03:24.000 --> 00:03:28.000
Trong trường hợp này, chúng tôi cung cấp bốn gigabyte bộ nhớ.

00:03:28.000 --> 00:03:31.000
Cuối cùng, chúng tôi xác định các thiết bị mà máy của chúng tôi sẽ có.

00:03:31.000 --> 00:03:38.000
Trong ví dụ này, chúng tôi đặt một thiết bị lưu trữ duy nhất, đĩa để khởi động và một thiết bị trỏ, giống như một con chuột.

00:03:38.000 --> 00:03:40.000
Có rất nhiều thiết bị có sẵn.

00:03:40.000 --> 00:03:44.000
Những cái bạn thiết lập phụ thuộc vào vấn đề bạn muốn giải quyết.

00:03:44.000 --> 00:03:46.000
Bây giờ chúng ta đã thấy cấu hình.

00:03:46.000 --> 00:03:53.000
Nó bắt đầu với VZVirtualMachineConfiguration, trên đó chúng tôi thêm CPU, bộ nhớ và các thiết bị.

00:03:53.000 --> 00:03:58.000
Tiếp theo, chúng ta sẽ xem xét các đối tượng máy ảo.

00:03:58.000 --> 00:04:00.000
Sau khi chúng tôi đã cấu hình máy Mac của mình, chúng tôi nhận được nó qua thư.

00:04:00.000 --> 00:04:03.000
Đã đến lúc mở hộp và bắt đầu nó.

00:04:03.000 --> 00:04:08.000
Nhưng vì chúng ta đang xử lý máy ảo, chúng ta cần phải làm điều đó bằng mã.

00:04:08.000 --> 00:04:11.000
Hãy xem cách chúng ta có thể làm điều đó trong Swift.

00:04:11.000 --> 00:04:16.000
Đầu tiên, chúng tôi sẽ tạo một phiên bản của VZVirtualMachine từ cấu hình của chúng tôi.

00:04:16.000 --> 00:04:20.000
VZVirtualMachine tóm tắt một ví dụ của phần cứng ảo.

00:04:20.000 --> 00:04:23.000
Bây giờ chúng ta đã có máy ảo, chúng ta có thể vận hành nó.

00:04:23.000 --> 00:04:27.000
Ví dụ, trong trường hợp này, chúng tôi gọi start() để bắt đầu nó.

00:04:27.000 --> 00:04:30.000
Chúng ta thường sẽ muốn tương tác với các máy ảo của mình.

00:04:30.000 --> 00:04:33.000
Đối với điều này, chúng tôi có các đối tượng khác để giúp chúng tôi.

00:04:33.000 --> 00:04:39.000
Ví dụ, nếu chúng tôi muốn hiển thị màn hình ảo của mình, chúng tôi có thể sử dụng một đối tượng thuộc loại VZVirtualMachineView.

00:04:39.000 --> 00:04:41.000
Chúng tôi bắt đầu bằng cách tạo ra một chế độ xem.

00:04:41.000 --> 00:04:47.000
Sau đó, chúng tôi đặt máy ảo của mình làm thuộc tính Máy ảo trên chế độ xem và nó đã sẵn sàng.

00:04:47.000 --> 00:04:51.000
Bây giờ chúng ta có thể sử dụng đối tượng VZVirtualMachineView này giống như bất kỳ NSView nào.

00:04:51.000 --> 00:04:56.000
Chúng tôi có thể tích hợp nó vào ứng dụng của mình để xem nội dung của máy ảo.

00:04:56.000 --> 00:05:00.000
Để kết thúc, chúng tôi đã thấy cấu hình.

00:05:00.000 --> 00:05:08.000
Cấu hình bắt đầu với VZVirtualMachineConfiguration, từ đó chúng tôi xác định CPU, bộ nhớ và thiết bị của mình.

00:05:08.000 --> 00:05:13.000
Từ cấu hình, chúng tôi sẽ tạo ra một máy ảo và chúng tôi sẽ sử dụng các đối tượng máy ảo.

00:05:13.000 --> 00:05:23.000
Chúng tôi đã thấy VZVirtualMachine trừu tượng hóa chính VM, VZVirtualMachineView để hiển thị nội dung và có những đối tượng khác có thể giúp chúng tôi sử dụng VM.

00:05:23.000 --> 00:05:29.000
Chúng tôi đã thấy rằng cấu hình mang lại rất nhiều sự linh hoạt trong cách chúng tôi xác định các máy ảo.

00:05:29.000 --> 00:05:33.000
Thật không may, có quá nhiều tính năng để đề cập trong một phiên.

00:05:33.000 --> 00:05:37.000
Trong phiên này, chúng ta sẽ xem xét một số khả năng cốt lõi.

00:05:37.000 --> 00:05:42.000
Đối với mọi thứ khác, chúng tôi có tài liệu và tôi mời bạn kiểm tra nó.

00:05:42.000 --> 00:05:46.000
Trong tổng quan, chúng ta vừa thấy cách xây dựng máy ảo.

00:05:46.000 --> 00:05:50.000
Bây giờ là lúc để xem xét cách chúng ta có thể chạy một hệ điều hành đầy đủ trong đó.

00:05:50.000 --> 00:05:52.000
Và chúng ta sẽ bắt đầu với macOS.

00:05:52.000 --> 00:05:56.000
Khung ảo hóa hỗ trợ macOS trên Apple silicon.

00:05:56.000 --> 00:06:03.000
Khi chúng tôi xây dựng khung Ảo hóa trên Apple silicon, chúng tôi đã cùng nhau phát triển khung macOS và Ảo hóa.

00:06:03.000 --> 00:06:08.000
Điều này mang lại cho chúng ta hiệu quả đáng kinh ngạc khi chạy macOS bên trong các máy ảo.

00:06:08.000 --> 00:06:16.000
Đây là những gì chúng ta sẽ thấy: Đầu tiên, chúng ta sẽ xem xét những gì chúng ta cần để biến một máy ảo thành một máy Mac ảo.

00:06:16.000 --> 00:06:20.000
Sau đó, chúng tôi sẽ xem xét các bước để cài đặt macOS trên máy Mac ảo của chúng tôi.

00:06:20.000 --> 00:06:25.000
Tiếp theo, chúng ta sẽ xem một số thiết bị đặc biệt mà chúng ta có cho macOS.

00:06:25.000 --> 00:06:34.000
Và cuối cùng, chúng ta sẽ xem xét một trường hợp sử dụng rất quan trọng, đó là chia sẻ tệp giữa hệ thống máy chủ và máy Mac ảo.

00:06:34.000 --> 00:06:36.000
Hãy bắt đầu với cấu hình.

00:06:36.000 --> 00:06:40.000
Chúng ta đã thấy trước đây cách xây dựng một máy ảo chung chung.

00:06:40.000 --> 00:06:45.000
Bây giờ chúng tôi muốn thêm các thuộc tính đặc biệt sẽ biến máy ảo thành máy Mac.

00:06:45.000 --> 00:06:49.000
Vậy làm thế nào để chúng ta tạo ra một máy Mac ảo?

00:06:49.000 --> 00:06:51.000
Đầu tiên, chúng tôi sẽ xác định một nền tảng đặc biệt.

00:06:51.000 --> 00:06:57.000
Nền tảng là một đối tượng chứa tất cả các thuộc tính của một loại máy ảo cụ thể.

00:06:57.000 --> 00:07:02.000
Có ba thuộc tính duy nhất cho phần cứng Mac ảo.

00:07:02.000 --> 00:07:04.000
Đầu tiên, chúng tôi có mô hình phần cứng.

00:07:04.000 --> 00:07:09.000
Mô hình phần cứng chỉ định phiên bản Mac ảo mà chúng tôi muốn.

00:07:09.000 --> 00:07:11.000
Thứ hai, có kho lưu trữ phụ trợ.

00:07:11.000 --> 00:07:16.000
Bộ lưu trữ phụ trợ là một dạng bộ nhớ không bay hơi được hệ thống sử dụng.

00:07:16.000 --> 00:07:19.000
Và thứ ba, có mã định danh máy.

00:07:19.000 --> 00:07:26.000
Mã định danh máy là một số duy nhất đại diện cho máy, giống như máy Mac vật lý có số sê-ri duy nhất.

00:07:26.000 --> 00:07:34.000
Khi chúng tôi có nền tảng, chúng tôi có tất cả các phần để mô tả phần cứng, nhưng chúng tôi cần thêm một phần nữa, đó là một cách để khởi động macOS.

00:07:34.000 --> 00:07:39.000
Đối với điều này, chúng tôi sẽ sử dụng một trình tải khởi động đặc biệt, trình tải khởi động macOS.

00:07:39.000 --> 00:07:43.000
Hãy xem cách thực hiện tất cả những điều này trong Swift.

00:07:43.000 --> 00:07:44.000
Chúng tôi bắt đầu từ cùng một cơ sở như trước đây.

00:07:44.000 --> 00:07:48.000
Mã này là những gì chúng ta đã thấy trong tổng quan.

00:07:48.000 --> 00:07:52.000
Sau đó chúng tôi tạo ra một Cấu hình Nền tảng VZMac.

00:07:52.000 --> 00:07:56.000
Đây là đối tượng nền tảng của chúng tôi dành cho máy Mac ảo.

00:07:56.000 --> 00:07:58.000
Chúng tôi cần một mô hình phần cứng cho máy Mac này.

00:07:58.000 --> 00:08:01.000
Ở đây chúng tôi sử dụng một cái mà chúng tôi đã lưu trước đó.

00:08:01.000 --> 00:08:06.000
Trong các máy ảo, bộ lưu trữ phụ trợ được hỗ trợ bởi một tệp trên hệ thống tệp cục bộ.

00:08:06.000 --> 00:08:09.000
Ở đây, chúng tôi khởi tạo bộ nhớ phụ trợ của mình từ URL tệp.

00:08:09.000 --> 00:08:15.000
Đối với mã định danh duy nhất, chúng tôi khởi tạo VZMacMacMacIdentifier từ mã định danh mà chúng tôi đã lưu trước đó.

00:08:15.000 --> 00:08:19.000
Đối với một cài đặt mới, chúng tôi cũng có thể tạo một mã định danh mới.

00:08:19.000 --> 00:08:23.000
Chúng tôi đã thiết lập cả ba thuộc tính. Nền tảng của chúng tôi đã sẵn sàng.

00:08:23.000 --> 00:08:27.000
Tất cả những gì chúng ta phải làm là đặt nó trên đối tượng cấu hình.

00:08:27.000 --> 00:08:31.000
Điều này cho chúng ta phần cứng. Tiếp theo chúng ta cần một cách để khởi động nó.

00:08:31.000 --> 00:08:36.000
Để làm điều đó, chúng tôi đã thiết lập trình tải khởi động với VZMacBootLoader.

00:08:36.000 --> 00:08:38.000
Bây giờ máy của chúng tôi đã sẵn sàng để khởi động.

00:08:38.000 --> 00:08:43.000
Những gì chúng tôi đã làm cho đến nay là xác định máy Mac ảo và cách khởi động nó.

00:08:43.000 --> 00:08:48.000
Nhưng chúng tôi vẫn cần cài đặt phần mềm trên đó, điều này đưa chúng tôi đến cài đặt.

00:08:48.000 --> 00:08:51.000
Cài đặt macOS được thực hiện trong ba bước.

00:08:51.000 --> 00:08:56.000
Đầu tiên, chúng ta cần tải xuống hình ảnh khôi phục với phiên bản macOS mà chúng ta muốn cài đặt.

00:08:56.000 --> 00:09:01.000
Sau đó, chúng ta cần tạo một cấu hình tương thích với phiên bản macOS đó.

00:09:01.000 --> 00:09:07.000
Và cuối cùng, chúng tôi sẽ cài đặt hình ảnh khôi phục của mình trong máy ảo tương thích.

00:09:07.000 --> 00:09:10.000
Vì vậy, trước tiên, chúng ta cần tải xuống một hình ảnh khôi phục.

00:09:10.000 --> 00:09:16.000
Bạn có thể tải xuống hình ảnh khôi phục từ trang web của nhà phát triển, nhưng Ảo hóa cũng có thể giúp chúng tôi.

00:09:16.000 --> 00:09:25.000
Bạn có thể gọi VZMacOSRestoreImage.latestSupported để lấy đối tượng khôi phục hình ảnh cho phiên bản ổn định mới nhất của macOS.

00:09:25.000 --> 00:09:29.000
Đối tượng này có thuộc tính URL mà chúng ta có thể sử dụng để tải xuống tệp.

00:09:29.000 --> 00:09:35.000
Sau đó, chúng tôi muốn tạo một máy ảo tương thích với phiên bản macOS mà chúng tôi đã tải xuống.

00:09:35.000 --> 00:09:37.000
Ảo hóa cũng có thể giúp chúng ta ở đây.

00:09:37.000 --> 00:09:42.000
Chúng tôi có thể yêu cầu đối tượng khôi phục hình ảnh cho các yêu cầu cấu hình.

00:09:42.000 --> 00:09:47.000
Nếu hình ảnh khôi phục có thể được chạy trên hệ thống hiện tại, chúng tôi sẽ nhận được một đối tượng liệt kê các yêu cầu.

00:09:47.000 --> 00:09:53.000
Từ các yêu cầu, chúng tôi có thể có được mô hình phần cứng cần thiết để chạy phiên bản macOS này.

00:09:53.000 --> 00:09:55.000
Trước đây chúng tôi đã thấy cách khôi phục mô hình phần cứng.

00:09:55.000 --> 00:09:59.000
Đây là cách chúng tôi có được một cái mới.

00:09:59.000 --> 00:10:03.000
Các yêu cầu cũng bao gồm hai thuộc tính hữu ích.

00:10:03.000 --> 00:10:11.000
Đối tượng có thể cho chúng ta biết cần bao nhiêu CPU và bao nhiêu bộ nhớ để chạy phiên bản macOS này.

00:10:11.000 --> 00:10:14.000
Cuối cùng, chúng tôi đã sẵn sàng để bắt đầu cài đặt.

00:10:14.000 --> 00:10:18.000
Chúng tôi bắt đầu bằng cách tạo ra một máy ảo mới từ cấu hình của chúng tôi.

00:10:18.000 --> 00:10:20.000
Sau đó chúng tôi tạo ra một trình cài đặt.

00:10:20.000 --> 00:10:28.000
Trình cài đặt nhận hai đối số, máy ảo tương thích mà chúng tôi đã tạo và đường dẫn đến hình ảnh khôi phục mà chúng tôi đã tải xuống.

00:10:28.000 --> 00:10:33.000
Bây giờ chúng ta chỉ có thể gọi install(), và voilà, chúng ta đã sẵn sàng để chạy macOS.

00:10:33.000 --> 00:10:41.000
Bây giờ chúng ta có thể thiết lập một máy Mac ảo và cài đặt macOS, hãy xem một số thiết bị đặc biệt cho máy Mac.

00:10:41.000 --> 00:10:44.000
Khả năng tuyệt vời đầu tiên là tăng tốc GPU.

00:10:44.000 --> 00:10:50.000
Chúng tôi đã xây dựng một thiết bị đồ họa hiển thị các khả năng GPU cho máy Mac ảo.

00:10:50.000 --> 00:10:56.000
Điều này có nghĩa là bạn có thể chạy Metal trong máy ảo và có được hiệu suất đồ họa tuyệt vời trong macOS.

00:10:56.000 --> 00:10:59.000
Hãy xem cách thiết lập nó.

00:10:59.000 --> 00:11:02.000
Chúng tôi bắt đầu bằng cách tạo ra cấu hình thiết bị đồ họa.

00:11:02.000 --> 00:11:06.000
Ở đây, chúng tôi sẽ sử dụng VZMacGraphicsDeviceConfiguration.

00:11:06.000 --> 00:11:08.000
Tiếp theo, chúng tôi muốn trưng bày nó.

00:11:08.000 --> 00:11:13.000
Chúng tôi thiết lập màn hình bằng cách xác định kích thước và mật độ điểm ảnh của nó.

00:11:13.000 --> 00:11:15.000
Bây giờ cấu hình thiết bị của chúng tôi đã sẵn sàng.

00:11:15.000 --> 00:11:18.000
Như thường lệ, chúng tôi đặt nó trên đối tượng cấu hình chính.

00:11:18.000 --> 00:11:23.000
Chúng tôi đặt nó làm thiết bị đồ họa cho máy ảo của mình.

00:11:23.000 --> 00:11:26.000
Tiếp theo, chúng ta có một thiết bị mới để tương tác với Mac.

00:11:26.000 --> 00:11:31.000
Trong macOS Ventura, chúng tôi đang thêm hỗ trợ bàn di chuột Mac vào máy Mac ảo.

00:11:31.000 --> 00:11:37.000
Với bàn di chuột mới, có thể sử dụng các cử chỉ như xoay, chụm để phóng to, v.v.

00:11:37.000 --> 00:11:40.000
Thiết bị mới này sử dụng trình điều khiển mới trong macOS.

00:11:40.000 --> 00:11:45.000
Vì vậy, để sử dụng nó, bạn sẽ cần macOS 13 cả trên hệ thống máy chủ và trong máy ảo.

00:11:45.000 --> 00:11:48.000
Hãy xem cách thiết lập nó.

00:11:48.000 --> 00:11:50.000
Nó rất dễ dàng.

00:11:50.000 --> 00:11:54.000
Chúng tôi tạo ra một đối tượng mới thuộc loại VZMacTrackpadConfiguration.

00:11:54.000 --> 00:11:58.000
Sau đó chúng tôi đặt nó làm thiết bị trỏ trên máy ảo.

00:11:58.000 --> 00:12:03.000
Bây giờ khi chúng ta sử dụng chế độ xem với máy Mac ảo của mình, chúng ta có thể sử dụng các cử chỉ.

00:12:03.000 --> 00:12:11.000
Cuối cùng, hãy xem xét một trường hợp sử dụng phổ biến đối với nhiều người trong chúng ta, chia sẻ tệp giữa hệ thống máy chủ và máy ảo.

00:12:11.000 --> 00:12:16.000
Trong macOS 12, chúng tôi đã giới thiệu thiết bị hệ thống tệp Virtio để chia sẻ tệp trên Linux.

00:12:16.000 --> 00:12:20.000
Trong macOS Ventura, chúng tôi đang thêm hỗ trợ cho macOS.

00:12:20.000 --> 00:12:23.000
Bây giờ bạn có thể chọn các thư mục mà bạn muốn chia sẻ với máy ảo.

00:12:23.000 --> 00:12:29.000
Bất kỳ thay đổi nào bạn thực hiện từ hệ thống máy chủ đều được phản ánh ngay lập tức trong máy ảo và ngược lại.

00:12:29.000 --> 00:12:32.000
Hãy xem cách thiết lập nó.

00:12:32.000 --> 00:12:37.000
Đầu tiên, chúng tôi tạo một VZShareDirectory với một thư mục mà chúng tôi muốn chia sẻ.

00:12:37.000 --> 00:12:39.000
Sau đó chúng tôi tạo ra một đối tượng chia sẻ.

00:12:39.000 --> 00:12:43.000
Ở đây chúng tôi sẽ sử dụng VZSingleDirectoryShare để chia sẻ một thư mục duy nhất.

00:12:43.000 --> 00:12:48.000
Bạn cũng có thể chia sẻ nhiều thư mục bằng cách sử dụng VZMultipleDirectoryShare.

00:12:48.000 --> 00:12:51.000
Bây giờ chúng ta đã có phần, chúng ta cần tạo ra một thiết bị.

00:12:51.000 --> 00:12:54.000
Nhưng chúng ta sẽ bắt đầu một cái gì đó đặc biệt.

00:12:54.000 --> 00:12:56.000
Các thiết bị hệ thống tệp được xác định bằng một thẻ.

00:12:56.000 --> 00:13:03.000
Trong macOS Ventura, chúng tôi đã thêm một thẻ đặc biệt để yêu cầu máy ảo tự động gắn thiết bị này.

00:13:03.000 --> 00:13:07.000
Ở đây, chúng tôi lấy thẻ đặc biệt này, macOSGuestAutomountTag.

00:13:07.000 --> 00:13:11.000
Sau đó chúng tôi tạo thiết bị và sử dụng thẻ đặc biệt của chúng tôi.

00:13:11.000 --> 00:13:15.000
Chúng tôi đặt chia sẻ từ thư mục duy nhất mà chúng tôi đã định cấu hình.

00:13:15.000 --> 00:13:19.000
Và cuối cùng, chúng tôi thêm thiết bị vào cấu hình như bình thường.

00:13:19.000 --> 00:13:23.000
Cuối cùng, hãy cùng nhau xem xét mọi thứ trong một bản demo.

00:13:23.000 --> 00:13:26.000
Chúng tôi bắt đầu từ một cấu hình cơ bản.

00:13:26.000 --> 00:13:33.000
Chúng tôi có một VZVirtualMachineConfiguration chỉ với CPU, bộ nhớ, bàn phím và đĩa.

00:13:33.000 --> 00:13:35.000
Chúng tôi muốn một máy Mac ảo.

00:13:35.000 --> 00:13:39.000
Để làm điều đó, chúng ta cần bắt đầu bằng cách thiết lập nền tảng.

00:13:39.000 --> 00:13:43.000
Chúng tôi sẽ sử dụng createMacPlatform được xác định ở trên để làm điều đó.

00:13:43.000 --> 00:13:46.000
Phần thứ hai của máy Mac ảo là bộ nạp khởi động.

00:13:46.000 --> 00:13:50.000
Chúng ta cần một trình tải khởi động biết cách khởi động macOS.

00:13:50.000 --> 00:13:55.000
Để có được điều đó, chúng tôi đặt trình tải khởi động của nền tảng thành VZMacOSBootLoader().

00:13:55.000 --> 00:13:58.000
Tiếp theo, chúng tôi muốn thiết lập các thiết bị.

00:13:58.000 --> 00:14:00.000
Chúng tôi muốn đồ họa tăng tốc.

00:14:00.000 --> 00:14:04.000
Để có được nó, chúng tôi sẽ thiết lập một VZMacGraphicsConfiguration.

00:14:04.000 --> 00:14:12.000
Chúng tôi tạo đối tượng, xác định kích thước hiển thị và mật độ điểm ảnh, và chúng tôi thêm nó vào cấu hình.

00:14:12.000 --> 00:14:14.000
Tiếp theo, chúng tôi muốn sử dụng bàn di chuột mới.

00:14:14.000 --> 00:14:19.000
Tất cả những gì chúng ta cần làm là đặt thiết bị trỏ thành VZMacTrackpadConfiguration.

00:14:19.000 --> 00:14:20.000
Thế là xong.

00:14:20.000 --> 00:14:24.000
Bây giờ, chúng ta có thể khởi động VM, nhưng hãy thêm quả anh đào lên trên.

00:14:24.000 --> 00:14:27.000
Chúng tôi đã thấy cách chúng tôi có thể chia sẻ thư mục.

00:14:27.000 --> 00:14:29.000
Hãy làm điều đó ở đây.

00:14:29.000 --> 00:14:32.000
Chúng tôi bắt đầu bằng cách tạo cấu hình thiết bị hệ thống tệp.

00:14:32.000 --> 00:14:37.000
Ở đây, lưu ý rằng chúng tôi sử dụng thẻ đặc biệt để tự động gắn nó vào macOS.

00:14:37.000 --> 00:14:38.000
Sau đó chúng tôi xác định phần của mình.

00:14:38.000 --> 00:14:42.000
Ở đây chúng tôi sử dụng một thư mục duy nhất chia sẻ từ một đường dẫn trên hệ thống tệp.

00:14:42.000 --> 00:14:47.000
Ở đây, chúng tôi sẽ chia sẻ dự án này mà chúng tôi đang chỉnh sửa ngay bây giờ.

00:14:47.000 --> 00:14:51.000
Chúng tôi thêm thiết bị vào cấu hình của mình và chúng tôi đã hoàn tất.

00:14:51.000 --> 00:14:55.000
Mọi thứ đã sẵn sàng. Chúng tôi khởi chạy ứng dụng của mình.

00:14:55.000 --> 00:15:01.000
Vì chúng tôi đã cấu hình thiết bị đồ họa Mac, VZVirtualMachineView có thể hiển thị nội dung.

00:15:01.000 --> 00:15:04.000
Đây là những gì bạn thấy ở đây trong cửa sổ.

00:15:04.000 --> 00:15:08.000
Và nó đây rồi. Chúng tôi đã cấu hình macOS từ đầu.

00:15:08.000 --> 00:15:11.000
Chúng ta có thể thấy thư mục được chia sẻ và dự án mà chúng ta đang chỉnh sửa ngay bây giờ.

00:15:11.000 --> 00:15:14.000
Cuối cùng, chúng ta sẽ hướng mắt về Linux.

00:15:14.000 --> 00:15:20.000
Khung ảo hóa đã hỗ trợ Linux ngay từ khi bắt đầu trong macOS Big Sur.

00:15:20.000 --> 00:15:26.000
Trong macOS Ventura, chúng tôi đã thêm một số tính năng mới khá thú vị và chúng tôi muốn chia sẻ một số tính năng đó với bạn.

00:15:26.000 --> 00:15:33.000
Đầu tiên, chúng ta sẽ xem cách chúng ta có thể cài đặt các bản phân phối Linux đầy đủ, hoàn toàn chưa được sửa đổi, trong các máy ảo.

00:15:33.000 --> 00:15:37.000
Sau đó, chúng tôi sẽ xem xét một thiết bị mới mà chúng tôi đang thêm để hiển thị giao diện người dùng từ Linux.

00:15:37.000 --> 00:15:44.000
Và cuối cùng, chúng ta sẽ xem xét cách chúng ta có thể tận dụng lợi thế của Rosetta 2 để chạy các tệp nhị phân Linux trong các máy ảo.

00:15:44.000 --> 00:15:47.000
Hãy bắt đầu với việc cài đặt.

00:15:47.000 --> 00:15:52.000
Nếu chúng tôi muốn cài đặt Linux trên một máy vật lý, chúng tôi sẽ bắt đầu bằng cách tải xuống tệp ISO với trình cài đặt.

00:15:52.000 --> 00:15:55.000
Sau đó, chúng tôi sẽ xóa một ổ đĩa flash với ISO.

00:15:55.000 --> 00:15:59.000
Và cuối cùng, chúng tôi sẽ cắm ổ đĩa vào máy tính và khởi động từ nó.

00:15:59.000 --> 00:16:03.000
Khi xử lý các máy ảo, chúng ta sẽ trải qua cùng một quy trình.

00:16:03.000 --> 00:16:07.000
Nhưng thay vì sử dụng ổ USB vật lý, chúng tôi sẽ sử dụng ổ đĩa ảo.

00:16:07.000 --> 00:16:10.000
Hãy xem nó hoạt động như thế nào.

00:16:10.000 --> 00:16:14.000
Chúng tôi bắt đầu bằng cách tạo một URL từ đường dẫn đến tệp ISO mà chúng tôi đã tải xuống.

00:16:14.000 --> 00:16:18.000
Sau đó, chúng tôi tạo một tệp đính kèm hình ảnh đĩa từ tệp.

00:16:18.000 --> 00:16:24.000
Tệp đính kèm hình ảnh đĩa đại diện cho một phần lưu trữ mà chúng ta có thể gắn vào thiết bị.

00:16:24.000 --> 00:16:28.000
Tiếp theo, chúng tôi cấu hình một thiết bị lưu trữ ảo.

00:16:28.000 --> 00:16:35.000
Trong trường hợp này, chúng tôi muốn lưu trữ USB, vì vậy chúng tôi sử dụng VZUSBMassStorageDeviceConfiguration.

00:16:35.000 --> 00:16:39.000
Cuối cùng, như mọi khi, chúng tôi thêm thiết bị của mình vào cấu hình chính.

00:16:39.000 --> 00:16:45.000
Ở đây, thiết bị USB xuất hiện bên cạnh một thiết bị lưu trữ khác, đĩa chính mà chúng tôi sẽ cài đặt Linux.

00:16:45.000 --> 00:16:50.000
Bây giờ chúng ta có một ổ USB, nhưng chúng ta cần một cách để khởi động từ nó.

00:16:50.000 --> 00:16:54.000
Trong macOS Ventura, chúng tôi đã thêm hỗ trợ cho EFI.

00:16:54.000 --> 00:16:58.000
EFI là một tiêu chuẩn công nghiệp để khởi động cả phần cứng ARM và Intel.

00:16:58.000 --> 00:17:02.000
Chúng tôi đang mang lại sự hỗ trợ tương tự cho các máy ảo.

00:17:02.000 --> 00:17:05.000
EFI có một cơ chế khám phá khởi động.

00:17:05.000 --> 00:17:09.000
Điều này sẽ cho phép là khám phá trình cài đặt trên ổ USB của chúng tôi.

00:17:09.000 --> 00:17:13.000
EFI xem xét từng ổ đĩa để tìm một ổ đĩa có thể khởi động được.

00:17:13.000 --> 00:17:16.000
Nó sẽ tìm thấy trình cài đặt và bắt đầu từ đó.

00:17:16.000 --> 00:17:19.000
Bản thân trình cài đặt sẽ cho EFI biết ổ đĩa nào sẽ sử dụng tiếp theo.

00:17:19.000 --> 00:17:23.000
Sau khi cài đặt, EFI có thể bắt đầu phân phối Linux.

00:17:23.000 --> 00:17:26.000
Hãy xem cách thiết lập EFI trong mã.

00:17:26.000 --> 00:17:31.000
Đầu tiên, chúng tôi tạo ra một trình tải khởi động loại VZEFIBootLoader.

00:17:31.000 --> 00:17:35.000
EFI yêu cầu bộ nhớ không bay hơi để lưu trữ thông tin giữa các lần khởi động.

00:17:35.000 --> 00:17:38.000
Đây được gọi là kho biến EFI.

00:17:38.000 --> 00:17:42.000
Với các máy ảo, chúng ta có thể sao lưu trữ như vậy bằng một tệp trên hệ thống tệp.

00:17:42.000 --> 00:17:46.000
Ở đây, chúng tôi tạo ra một cửa hàng biến đổi mới từ đầu.

00:17:46.000 --> 00:17:47.000
Bây giờ EFI đã sẵn sàng.

00:17:47.000 --> 00:17:51.000
Chúng ta chỉ cần đặt nó làm trình tải khởi động trên cấu hình.

00:17:51.000 --> 00:17:57.000
Tiếp theo, chúng ta sẽ xem xét một khả năng mới cho Linux VMs, đồ họa.

00:17:57.000 --> 00:18:01.000
Trong macOS Ventura, chúng tôi đã thêm hỗ trợ cho Virtio GPU 2D.

00:18:01.000 --> 00:18:08.000
Virtio GPU 2D là một thiết bị ảo hóa cho phép Linux cung cấp các bề mặt cho máy chủ macOS.

00:18:08.000 --> 00:18:14.000
Linux hiển thị nội dung, cung cấp khung kết xuất cho khung Ảo hóa, sau đó có thể hiển thị nó.

00:18:14.000 --> 00:18:21.000
Bây giờ bạn có thể hiển thị nội dung này trong ứng dụng của mình với VZVirtualMachineView giống như trên macOS.

00:18:21.000 --> 00:18:24.000
Hãy xem cách thiết lập nó.

00:18:24.000 --> 00:18:28.000
Thiết lập thiết bị tương tự như những gì chúng tôi đã làm cho macOS.

00:18:28.000 --> 00:18:32.000
Chúng tôi bắt đầu bằng cách tạo ra một VZVirtioGraphicsDeviceConfiguration.

00:18:32.000 --> 00:18:36.000
Chúng ta cần xác định kích thước của màn hình ảo của mình.

00:18:36.000 --> 00:18:39.000
Theo thuật ngữ Virtio, màn hình ảo là một "quét".

00:18:39.000 --> 00:18:44.000
Vì vậy, chúng tôi tạo ra một bản quét với kích thước của màn hình.

00:18:44.000 --> 00:18:49.000
Cuối cùng, chúng tôi đặt thiết bị mới làm thiết bị đồ họa trong cấu hình của chúng tôi.

00:18:49.000 --> 00:18:54.000
Bây giờ máy ảo của chúng tôi đã sẵn sàng để hiển thị nội dung với VZVirtualMachineView.

00:18:54.000 --> 00:18:58.000
Tiếp theo, hãy cùng nhau xem mọi thứ trong một bản demo.

00:18:58.000 --> 00:19:00.000
Chúng tôi bắt đầu từ nơi chúng tôi đã dừng lại.

00:19:00.000 --> 00:19:03.000
Hãy xóa mã dành riêng cho Mac.

00:19:03.000 --> 00:19:05.000
Vậy thì hãy thay đổi đĩa mà chúng ta đang khởi động.

00:19:05.000 --> 00:19:09.000
Chúng tôi sẽ hoán đổi đường dẫn từ ổ đĩa Mac sang ổ đĩa Linux của chúng tôi.

00:19:09.000 --> 00:19:12.000
Tiếp theo, chúng ta cần một bộ nạp khởi động.

00:19:12.000 --> 00:19:16.000
Chúng tôi thiết lập EFI với VZEFIBootLoader.

00:19:16.000 --> 00:19:19.000
Đầu tiên chúng tôi tạo ra đối tượng trình tải khởi động EFI.

00:19:19.000 --> 00:19:22.000
Sau đó chúng tôi tải kho biến từ tệp của nó.

00:19:22.000 --> 00:19:27.000
Và cuối cùng, chúng tôi đặt EFI làm trình tải khởi động trên cấu hình của mình.

00:19:27.000 --> 00:19:31.000
Bây giờ chúng ta có thể khởi động, nhưng sẽ rất tuyệt nếu hiển thị giao diện người dùng.

00:19:31.000 --> 00:19:35.000
Hãy thêm Virtio GPU vào cấu hình của chúng tôi.

00:19:35.000 --> 00:19:40.000
Chúng tôi chỉ đơn giản là tạo ra một thiết bị đồ họa loại VZVirtioGraphicsDeviceConfiguration.

00:19:40.000 --> 00:19:43.000
Sau đó, chúng tôi xác định một bản quét với kích thước của màn hình ảo.

00:19:43.000 --> 00:19:49.000
Và chúng tôi đặt Virtio GPU làm thiết bị đồ họa trên cấu hình của mình.

00:19:49.000 --> 00:19:53.000
Lần chạm cuối cùng là làm cho chuột hoạt động.

00:19:53.000 --> 00:19:58.000
Chúng tôi chỉ sử dụng một thiết bị con trỏ tọa độ màn hình USB ảo và chúng tôi sẽ có một con chuột trong Linux.

00:19:58.000 --> 00:20:01.000
Thế là xong. Chúng ta có thể điều hành dự án.

00:20:01.000 --> 00:20:04.000
EFI nhìn vào đĩa và thấy nó có thể khởi động được.

00:20:04.000 --> 00:20:10.000
Sau đó Linux hiển thị nội dung của giao diện người dùng thông qua thiết bị Virtio GPU.

00:20:10.000 --> 00:20:12.000
Và chúng ta có thể sử dụng chuột để tương tác với Linux.

00:20:12.000 --> 00:20:20.000
Cuối cùng nhưng không kém phần quan trọng, chúng ta sẽ xem cách chúng ta có thể tận dụng công nghệ Rosetta 2 bên trong Linux.

00:20:20.000 --> 00:20:29.000
Đối với nhiều người trong chúng ta, chúng tôi thích phát triển các dịch vụ trên máy Mac của mình, nhưng một khi công việc của chúng tôi đã sẵn sàng, các tệp nhị phân mà chúng tôi tạo có thể cần phải chạy trên các máy chủ x86.

00:20:29.000 --> 00:20:35.000
Mô phỏng hướng dẫn x86 rất tốt cho việc này, nhưng chúng ta có thể làm tốt hơn.

00:20:35.000 --> 00:20:40.000
Trong macOS Ventura, chúng tôi đang đưa sức mạnh của Rosetta 2 vào các tệp nhị phân Linux.

00:20:40.000 --> 00:20:46.000
Những gì Rosetta 2 làm là dịch các tệp nhị phân Linux x86-64 bên trong máy ảo của bạn.

00:20:46.000 --> 00:20:53.000
Điều này có nghĩa là bạn có thể chạy bản phân phối ARM Linux yêu thích của mình và các ứng dụng x86-64 của nó có thể chạy với Rosetta.

00:20:53.000 --> 00:20:54.000
Và nó nhanh.

00:20:54.000 --> 00:21:00.000
Đó là cùng một công nghệ mà chúng tôi đã sử dụng trên Mac, có nghĩa là chúng tôi có hiệu suất đáng kinh ngạc.

00:21:00.000 --> 00:21:03.000
Hãy xem cách sử dụng nó.

00:21:03.000 --> 00:21:07.000
Đầu tiên, chúng ta cần cấp quyền truy cập Linux vào Rosetta.

00:21:07.000 --> 00:21:11.000
Để làm điều này, chúng tôi sử dụng cùng một công nghệ chia sẻ tệp mà chúng tôi đã thấy trên macOS.

00:21:11.000 --> 00:21:18.000
Thay vì chia sẻ một thư mục, chúng tôi sử dụng một loại đối tượng đặc biệt, VZLinuxRosettaDirectoryShare.

00:21:18.000 --> 00:21:24.000
Sau đó, chúng tôi tạo một thiết bị chia sẻ và thiết lập chia sẻ thư mục Rosetta.

00:21:24.000 --> 00:21:28.000
Cuối cùng, chúng tôi thiết lập thiết bị của mình trên cấu hình như bình thường.

00:21:28.000 --> 00:21:32.000
Bây giờ máy ảo của chúng tôi đã sẵn sàng để sử dụng Rosetta.

00:21:32.000 --> 00:21:36.000
Tiếp theo, hãy xem Linux có thể tận dụng nó như thế nào.

00:21:36.000 --> 00:21:41.000
Trong Linux, chúng tôi bắt đầu bằng cách gắn thư mục được chia sẻ trong hệ thống tệp.

00:21:41.000 --> 00:21:46.000
Những gì chúng ta thấy từ Linux là một tệp nhị phân Rosetta có thể dịch các ứng dụng.

00:21:46.000 --> 00:21:53.000
Sau đó, chúng ta có thể sử dụng update-binfmts để yêu cầu hệ thống sử dụng Rosetta để xử lý bất kỳ tệp nhị phân x86-64 nào.

00:21:53.000 --> 00:21:55.000
Đừng lo lắng về việc ghi nhớ lệnh này.

00:21:55.000 --> 00:21:58.000
Tất cả đều có trong tài liệu.

00:21:58.000 --> 00:22:00.000
Bây giờ Linux đã sẵn sàng.

00:22:00.000 --> 00:22:07.000
Mỗi tệp nhị phân x86-64 được khởi chạy sẽ được dịch bởi Rosetta.

00:22:07.000 --> 00:22:11.000
Trước khi chúng ta kết thúc phần Linux của mình, hãy cùng nhau xem mọi thứ.

00:22:11.000 --> 00:22:15.000
Ở đây, chúng tôi có một bản phân phối Linux đầy đủ được cài đặt từ đầu.

00:22:15.000 --> 00:22:18.000
Chúng tôi có thể hiển thị giao diện người dùng của nó với Virtio GPU 2D.

00:22:18.000 --> 00:22:22.000
Từ bên trong VM, chúng tôi chạy một máy chủ PHP với Rosetta.

00:22:22.000 --> 00:22:27.000
Và chúng ta chỉ có thể kết nối với nó từ máy chủ macOS.

00:22:27.000 --> 00:22:31.000
Chúng tôi đã thấy rằng việc tạo ra các máy ảo chưa bao giờ đơn giản hơn thế.

00:22:31.000 --> 00:22:37.000
Với khung Ảo hóa, bạn có thể chạy các máy ảo chỉ với một vài dòng mã.

00:22:37.000 --> 00:22:42.000
Chúng tôi cũng đã thấy rằng các máy ảo nhanh một cách nực cười trên macOS.

00:22:42.000 --> 00:22:47.000
Để tìm hiểu thêm về Ảo hóa, tôi mời bạn kiểm tra các mẫu mã và tài liệu.

00:22:47.000 --> 00:22:51.000
Và thay mặt cho nhóm, chúng tôi nóng lòng muốn xem bạn sẽ làm gì tiếp theo với công nghệ này.

00:22:51.000 --> 23:59:59.000
.

