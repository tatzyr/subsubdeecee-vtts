WEBVTT

00:00:00.000 --> 00:00:03.000
♪ Nhạc hip-hop nhạc cụ êm dịu ♪

00:00:03.000 --> 00:00:09.000
♪

00:00:09.000 --> 00:00:18.000
Xin chào, tôi là Teja, một kỹ sư trong nhóm Trải nghiệm Hệ thống iOS, và trong phiên này, bạn sẽ gặp các bộ lọc Focus.

00:00:18.000 --> 00:00:24.000
Focus đã được giới thiệu trong iOS 15, macOS Monterey và watchOS 8.

00:00:24.000 --> 00:00:31.000
Đó là một cách để mọi người tập trung vào những gì quan trọng bằng cách định cấu hình hành vi của hệ thống trong một khoảng thời gian.

00:00:31.000 --> 00:00:39.000
Tiêu điểm được kích hoạt bằng cách chỉ cần vào Trung tâm điều khiển và chọn từ hệ thống Tiêu điểm hoặc Tiêu điểm tùy chỉnh.

00:00:39.000 --> 00:00:45.000
Trong thời gian Focus được bật, hành vi thông báo có thể được tùy chỉnh.

00:00:45.000 --> 00:00:57.000
Ví dụ, trong quá trình Tập trung công việc, ai đó có thể chỉ muốn cho phép thông báo từ đồng nghiệp của họ hoặc chỉ cho phép thông báo cho một vài ứng dụng được chọn có liên quan đến công việc.

00:00:57.000 --> 00:01:04.000
Đối với mỗi Tiêu điểm, hành vi hệ thống có thể được cấu hình và lên lịch trong Cài đặt.

00:01:04.000 --> 00:01:10.000
iOS 16 và macOS Ventura nâng cao tính năng Focus với các bộ lọc Focus.

00:01:10.000 --> 00:01:15.000
Tôi sẽ bắt đầu bằng cách giới thiệu cho bạn các bộ lọc Focus và cách chúng hoạt động.

00:01:15.000 --> 00:01:20.000
Sau đó, tôi sẽ xem xét cách xác định bộ lọc Focus trong ứng dụng của bạn.

00:01:20.000 --> 00:01:25.000
Sau đó, tôi sẽ đề cập đến ý nghĩa của việc hành động trên bộ lọc Tiêu điểm.

00:01:25.000 --> 00:01:31.000
Và cuối cùng, tôi sẽ đề cập đến cách ứng dụng của bạn có thể cung cấp ngữ cảnh bổ sung trở lại hệ thống.

00:01:31.000 --> 00:01:39.000
Bộ lọc lấy nét là một cách để ai đó tùy chỉnh hành vi của ứng dụng dựa trên Focus hiện đang được bật.

00:01:39.000 --> 00:01:44.000
Có một số ví dụ tuyệt vời về các ứng dụng hệ thống đã áp dụng bộ lọc Focus.

00:01:44.000 --> 00:01:53.000
Ứng dụng Lịch cho phép mọi người lọc lịch nào sẽ hiển thị theo mặc định khi bật Tiêu điểm.

00:01:53.000 --> 00:01:55.000
Đây là lịch của tôi thường trông như thế nào.

00:01:55.000 --> 00:02:01.000
Và như bạn có thể thấy, tôi có sự kết hợp giữa công việc và các sự kiện lịch cá nhân.

00:02:01.000 --> 00:02:08.000
Tôi có thể định cấu hình bộ lọc Tiêu điểm cho Lịch, trong Tiêu điểm Cá nhân, để chỉ hiển thị lịch cá nhân của tôi.

00:02:08.000 --> 00:02:13.000
Sau khi thiết lập bộ lọc Tiêu điểm, đây là lịch của tôi trông như thế nào.

00:02:13.000 --> 00:02:19.000
Lịch đã chỉ ra rằng điều này được lọc bởi Focus và cung cấp một cách để chuyển đổi bộ lọc.

00:02:19.000 --> 00:02:26.000
Bây giờ tôi sẽ không bị choáng ngợp với lịch làm việc của mình khi cố gắng tận hưởng thời gian cá nhân.

00:02:26.000 --> 00:02:32.000
Hộp thư đến của ứng dụng Thư có thể được lọc để chỉ hiển thị các hộp thư có liên quan trong quá trình Tập trung.

00:02:32.000 --> 00:02:40.000
Thông báo qua thư cũng được lọc để chỉ hiển thị các thông báo có liên quan một cách nổi bật.

00:02:40.000 --> 00:02:52.000
Điều này có nghĩa là tôi có thể thiết lập Thư để chỉ gửi thông báo Thư liên quan đến công việc trong Trọng tâm Công việc và ngăn thông báo thư cá nhân làm gián đoạn tôi.

00:02:52.000 --> 00:02:56.000
Có nhiều lý do tại sao ứng dụng của bạn có thể muốn triển khai các bộ lọc Focus.

00:02:56.000 --> 00:03:04.000
Có lẽ ứng dụng của bạn quản lý nhiều tài khoản và việc liên kết Focus với một tài khoản cụ thể là phù hợp.

00:03:04.000 --> 00:03:09.000
Các ứng dụng có lượng dữ liệu lớn có thể cần lọc nội dung cho Focus.

00:03:09.000 --> 00:03:23.000
Nếu bạn muốn giúp người dùng của mình tránh bị phân tâm trong khi tập trung, bạn có thể làm điều này bằng cách giảm số lượng huy hiệu, cảnh báo trong ứng dụng và thông báo thành những gì nổi bật cho Focus được bật.

00:03:23.000 --> 00:03:30.000
Về ngoại hình, ứng dụng của bạn có thể muốn hiển thị chủ đề hoặc bố cục dựa trên Tiêu điểm đã bật.

00:03:30.000 --> 00:03:41.000
Về cơ bản, nếu ứng dụng của bạn có thể hiển thị nội dung khác nhau dựa trên ngữ cảnh, bạn có thể sử dụng bộ lọc Focus để nâng cao trải nghiệm người dùng.

00:03:41.000 --> 00:03:44.000
Hãy để tôi giải thích cách các bộ lọc Focus hoạt động.

00:03:44.000 --> 00:03:52.000
Ứng dụng của bạn xác định những gì có thể được tùy chỉnh bởi người dùng cho mỗi Focus và điều này được thực hiện bằng cách sử dụng AppIntent.

00:03:52.000 --> 00:03:57.000
Hệ thống sẽ hiển thị những gì có thể được cấu hình cho mỗi Tiêu điểm.

00:03:57.000 --> 00:04:05.000
Giao diện người dùng để định cấu hình các thuộc tính được xác định bởi AppIntent của bạn sẽ được hiển thị trong cài đặt Focus dưới dạng bộ lọc Focus.

00:04:05.000 --> 00:04:15.000
Người dùng có thể định cấu hình ứng dụng của bạn để hoạt động theo một cách nhất định bằng cách điều hướng đến cài đặt Focus và định cấu hình bộ lọc Focus cho ứng dụng của bạn.

00:04:15.000 --> 00:04:21.000
Bây giờ, tôi sẽ xem xét cách bạn có thể kết hợp các bộ lọc Focus vào cơ sở mã của mình.

00:04:21.000 --> 00:04:24.000
Có một vài phần để xác định bộ lọc Tiêu điểm của bạn.

00:04:24.000 --> 00:04:28.000
Đầu tiên là triển khai SetFocusFilterIntent.

00:04:28.000 --> 00:04:35.000
Điều này cho hệ thống biết rằng ứng dụng của bạn quan tâm đến việc có các cài đặt tùy chỉnh cho mỗi Tiêu điểm.

00:04:35.000 --> 00:04:38.000
Bước thứ hai là xác định các thông số ứng dụng của bạn.

00:04:38.000 --> 00:04:44.000
Những thứ này sẽ đại diện cho những gì người dùng có thể được cấu hình trong ứng dụng của bạn.

00:04:44.000 --> 00:04:52.000
Bước cuối cùng là đặt biểu diễn hiển thị, để bộ lọc Tiêu điểm của bạn xuất hiện trong cài đặt hệ thống với nội dung chính xác.

00:04:52.000 --> 00:04:57.000
Bằng cách này, người dùng nhận thức được những gì được cấu hình.

00:04:57.000 --> 00:04:59.000
Tôi sẽ đi sâu vào một số mã.

00:04:59.000 --> 00:05:07.000
Điều đầu tiên bạn cần làm là nhập AppIntents và xác định một cấu trúc triển khai SetFocusFilterIntent.

00:05:07.000 --> 00:05:10.000
Đây là bộ lọc Tiêu điểm của bạn.

00:05:10.000 --> 00:05:17.000
Đặt tiêu đề và mô tả sẽ giúp người dùng khám phá Focus của bạn là gì.

00:05:17.000 --> 00:05:22.000
Bộ lọc tiêu điểm xuất hiện trong chế độ xem lưới trong Cài đặt.

00:05:22.000 --> 00:05:28.000
Trước khi bộ lọc Tiêu điểm của bạn được định cấu hình, nó sẽ được hiển thị cho người dùng với giao diện này.

00:05:28.000 --> 00:05:40.000
Biểu tượng ở đây là biểu tượng ứng dụng của bạn, văn bản chính là tên ứng dụng của bạn và văn bản phụ sẽ khớp với biến tiêu đề mà bạn đã đặt trong bộ lọc Focus của mình.

00:05:40.000 --> 00:05:46.000
Khi người dùng nhấn vào để định cấu hình bộ lọc của bạn, nội dung tương tự sẽ được hiển thị.

00:05:46.000 --> 00:05:54.000
Lần này, hệ thống cũng bao gồm chuỗi mô tả mà bạn đã cung cấp, cho ngữ cảnh bổ sung.

00:05:54.000 --> 00:06:02.000
Cả chuỗi tiêu đề và chuỗi mô tả đều tĩnh và chúng được hệ thống đọc tại thời điểm ứng dụng của bạn được cài đặt.

00:06:02.000 --> 00:06:13.000
Khi xác định bộ lọc Tiêu điểm của bạn, bạn sẽ phải chỉ định những gì một người có thể tùy chỉnh bằng cách cung cấp một loạt các thuộc tính được trang trí dưới dạng tham số.

00:06:13.000 --> 00:06:17.000
Khi chỉ định một tham số, bạn phải đặt tên và kiểu dữ liệu cho nó.

00:06:17.000 --> 00:06:23.000
Các tham số có thể thuộc loại dữ liệu tiêu chuẩn như Bool, string, float, vân vân.

00:06:23.000 --> 00:06:32.000
Nếu bạn có một loại dữ liệu tùy chỉnh mà bạn muốn định cấu hình, bạn có thể biến nó thành một thực thể, cho phép bạn trang trí nó như một tham số.

00:06:32.000 --> 00:06:38.000
Để tìm hiểu thêm về các thực thể và Ý định ứng dụng, hãy xem phiên "Đi sâu vào ý định ứng dụng".

00:06:38.000 --> 00:06:44.000
Khi xác định bộ lọc Focus của bạn, bạn sẽ chỉ chỉ định loại dữ liệu và tên cho mỗi tham số.

00:06:44.000 --> 00:06:52.000
Tùy thuộc vào người dùng để định cấu hình giá trị của tham số sẽ được áp dụng trong mỗi lần Tập trung.

00:06:52.000 --> 00:06:57.000
Các thông số có thể được đánh dấu là tùy chọn, có nghĩa là chúng không cần phải được định cấu hình.

00:06:57.000 --> 00:07:03.000
Các thông số không phải là tùy chọn nên cung cấp các giá trị mặc định.

00:07:03.000 --> 00:07:15.000
Trong mã, bạn chỉ định một tham số - hoặc một tham số tùy chọn - bằng cách xác định một biến thuộc loại bạn muốn trong bộ lọc Focus của mình và trang trí nó như một tham số.

00:07:15.000 --> 00:07:23.000
Ở đây, tôi đã tạo một tham số Bool bắt buộc đại diện cho việc bộ lọc Tiêu điểm của tôi có nên luôn sử dụng Chế độ tối hay không.

00:07:23.000 --> 00:07:25.000
Tôi đã đặt mặc định của nó là sai.

00:07:25.000 --> 00:07:33.000
Tôi cũng đã tạo một tham số chuỗi tùy chọn đại diện cho thông báo trạng thái của người dùng trong Tiêu điểm này.

00:07:33.000 --> 00:07:44.000
Cuối cùng, tôi đã bao gồm một tham số tài khoản tùy chọn là một thực thể được xác định bởi ứng dụng của tôi; nó chứa thông tin về một tài khoản cụ thể.

00:07:44.000 --> 00:07:54.000
Tiêu đề, được đặt trên cả ba tham số này, được hiển thị trong Cài đặt để mô tả tham số cho người dùng.

00:07:54.000 --> 00:08:02.000
Trong cài đặt Focus, khi người dùng định cấu hình bộ lọc Focus của ứng dụng của bạn, nó sẽ được trình bày trong một lưới tương tự như những gì tôi đã hiển thị trước đó.

00:08:02.000 --> 00:08:11.000
Nhưng lần này, vì bộ lọc đã được cấu hình, nội dung rất năng động để phản ánh những gì đã được cấu hình.

00:08:11.000 --> 00:08:14.000
Biểu tượng ở đây vẫn là biểu tượng ứng dụng của bạn.

00:08:14.000 --> 00:08:24.000
Văn bản chính và văn bản phụ có thể được tùy chỉnh bằng cách sử dụng thuộc tính biểu diễn hiển thị trên FocusFilterIntent của bạn.

00:08:24.000 --> 00:08:34.000
Văn bản chính phải đại diện cho những thông số đã được định cấu hình, chẳng hạn như Chọn tài khoản, Đặt trạng thái, v.v.

00:08:34.000 --> 00:08:43.000
Văn bản phụ phải đại diện cho những gì các tham số đã được cấu hình, chẳng hạn như Tài khoản Công việc hoặc Làm việc.

00:08:43.000 --> 00:08:49.000
Trong mã của tôi, tôi đặt biểu diễn hiển thị được tạo động.

00:08:49.000 --> 00:08:59.000
Vì tài khoản và trạng thái là các tham số tùy chọn, chúng chỉ được đưa vào các văn bản chính và phụ động nếu chúng thực sự được đặt.

00:08:59.000 --> 00:09:09.000
Vì alwaysUseDarkMode là một tham số bắt buộc, nó luôn được bao gồm trong các văn bản chính và phụ.

00:09:09.000 --> 00:09:17.000
Được rồi, bây giờ bạn đã xác định bộ lọc Tiêu điểm của mình, vì vậy người dùng có thể vào cài đặt Tiêu điểm và tùy chỉnh các giá trị nhất định cho một Tiêu điểm cụ thể.

00:09:17.000 --> 00:09:20.000
Nhưng làm thế nào ứng dụng của bạn có thể biết những gì ai đó đã tùy chỉnh?

00:09:20.000 --> 00:09:23.000
Và làm thế nào ứng dụng của bạn có thể tự cập nhật cho phù hợp?

00:09:23.000 --> 00:09:26.000
Nó phải hành động dựa trên một sự thay đổi từ hệ thống.

00:09:26.000 --> 00:09:36.000
Khi thay đổi Tiêu điểm xảy ra và hệ thống đã xác định rằng điều quan trọng là ứng dụng của bạn phải biết về thay đổi này, nó sẽ cung cấp thông tin này cho bạn theo một trong hai cách.

00:09:36.000 --> 00:09:44.000
Nếu ứng dụng đang chạy, bạn sẽ nhận được một cuộc gọi đến phương thức thực hiện trong FocusFilterIntent của mình, nếu bạn đã triển khai nó.

00:09:44.000 --> 00:09:49.000
Nếu ứng dụng không chạy, bạn có thể triển khai một tiện ích mở rộng sẽ được quay lên.

00:09:49.000 --> 00:09:58.000
Một lần nữa, nếu bạn đã triển khai thực hiện trong FocusFilterIntent của mình, điều đó sẽ được gọi trong tiện ích mở rộng của bạn.

00:09:58.000 --> 00:10:06.000
Vì perform có thể được gọi trên ứng dụng hoặc tiện ích mở rộng của bạn, không phải mọi ứng dụng đều cần tiện ích mở rộng.

00:10:06.000 --> 00:10:18.000
Thông thường, nếu ứng dụng của bạn chỉ cập nhật chế độ xem của riêng nó để đáp ứng với quá trình chuyển đổi Focus, thì việc triển khai chỉ trong ứng dụng là đủ.

00:10:18.000 --> 00:10:29.000
Nếu tiện ích, thông báo hoặc huy hiệu của ứng dụng của bạn cần thay đổi dựa trên quá trình chuyển đổi Focus, thì bạn có thể cân nhắc triển khai tiện ích mở rộng.

00:10:29.000 --> 00:10:37.000
Về cơ bản, nếu ứng dụng của bạn muốn cập nhật bất cứ thứ gì ngoài chế độ xem của chính nó, bạn sẽ cần triển khai tiện ích mở rộng.

00:10:37.000 --> 00:10:47.000
Đối với phần còn lại của phiên này, tôi có thể đề cập đến "ứng dụng của bạn" nhưng điều đó có thể có nghĩa là ứng dụng hoặc tiện ích mở rộng của bạn tùy thuộc vào ngữ cảnh này.

00:10:47.000 --> 00:11:02.000
Để phản hồi bộ lọc Tiêu điểm, hãy triển khai chức năng thực hiện, truy cập các giá trị đã điền cho các tham số được cung cấp thông qua Cài đặt và sau đó sử dụng các giá trị này để cập nhật chế độ xem và hành vi của ứng dụng của bạn.

00:11:02.000 --> 00:11:10.000
Việc triển khai thực hiện của bạn được gọi khi hệ thống xác định rằng ứng dụng của bạn cần phản hồi quá trình chuyển đổi Focus.

00:11:10.000 --> 00:11:18.000
Thực hiện cũng được gọi khi hệ thống xác định rằng các giá trị được phân phối trước đó không còn phù hợp nữa.

00:11:18.000 --> 00:11:24.000
Trong trường hợp này, các thông số bộ lọc Tiêu điểm của bạn được cấu hình với các giá trị mặc định.

00:11:24.000 --> 00:11:32.000
Khi thực hiện được gọi trên bộ lọc Tiêu điểm của ứng dụng của bạn, các giá trị của tất cả các thông số sẽ được điền để khớp với những gì đã được định cấu hình trong Cài đặt.

00:11:32.000 --> 00:11:39.000
Các giá trị của các tham số được đặt tên có thể được đọc bằng cách gọi tự."tên của tham số."

00:11:39.000 --> 00:11:46.000
Trong ví dụ này, khi kết thúc buổi biểu diễn, tôi cập nhật ứng dụng của mình với dữ liệu tôi nhận được.

00:11:46.000 --> 00:11:50.000
Đôi khi, bạn có thể cần truy vấn các thông số bộ lọc Tiêu điểm hiện tại.

00:11:50.000 --> 00:12:02.000
Trong trường hợp của tôi, vì bộ lọc của tôi được gọi là ExampleChatAppFocusFilter, tôi truy cập ExampleChatAppFocus Filter.current.

00:12:02.000 --> 00:12:16.000
Bây giờ ứng dụng của bạn có thể hoạt động trên bộ lọc Focus, bước tiếp theo là đưa trải nghiệm người dùng đi xa hơn bằng cách cung cấp ngữ cảnh bổ sung về cách hành vi ứng dụng của bạn đã thay đổi trở lại hệ thống.

00:12:16.000 --> 00:12:22.000
Bằng cách cung cấp ngữ cảnh bổ sung, bạn có thể ảnh hưởng đến hành vi ứng dụng của mình bên ngoài tầm nhìn của ứng dụng.

00:12:22.000 --> 00:12:30.000
Ví dụ về điều này bao gồm lọc thông báo và cài đặt số lượng huy hiệu thông báo của ứng dụng của bạn.

00:12:30.000 --> 00:12:35.000
Một cách bạn có thể cung cấp thông tin hệ thống là thông qua đối tượng App Context.

00:12:35.000 --> 00:12:41.000
Đây là một đối tượng có thể được trả về như một phần của kết quả của hàm thực hiện.

00:12:41.000 --> 00:12:50.000
Hoặc bạn có thể trả lại App Context bất cứ lúc nào trong bộ lọc Focus của mình và buộc hệ thống nhận được giá trị cập nhật bằng cách gọi vô hiệu hóa.

00:12:50.000 --> 00:13:00.000
Khi bộ lọc Focus đang hoạt động, ứng dụng của bạn có thể có ngữ cảnh bổ sung để xác định xem một thông báo cụ thể có làm gián đoạn người dùng hay không.

00:13:00.000 --> 00:13:08.000
Để chuyển thông tin này, ứng dụng của bạn phải đặt thuộc tính filterPredicate trong AppContext.

00:13:08.000 --> 00:13:17.000
Vị ngữ bộ lọc này hoạt động kết hợp với một thuộc tính chuỗi mới được gọi là filterCriteria trên UNNotification.

00:13:17.000 --> 00:13:26.000
Nếu tiêu chí bộ lọc trên thông báo không khớp với vị ngữ bộ lọc, thông báo sẽ bị tắt tiếng.

00:13:26.000 --> 00:13:32.000
Để thiết lập vị ngữ bộ lọc từ FocusFilterIntent của bạn, hãy đưa nó vào Ngữ cảnh Ứng dụng của bạn.

00:13:32.000 --> 00:13:46.000
Giả sử thiết bị đã bật Tiêu điểm Cá nhân và người dùng đã thiết lập nó để chỉ chọn tài khoản cá nhân; trong trường hợp này, tôi đã thiết lập vị ngữ bộ lọc làm số nhận dạng của tài khoản cá nhân.

00:13:46.000 --> 00:13:53.000
Nếu thông báo đến không phải từ tài khoản cá nhân, nó sẽ không làm gián đoạn người dùng.

00:13:53.000 --> 00:14:00.000
Ở đây, khi tôi định cấu hình thông báo này, tôi đặt filterCriteria làm mã định danh của tài khoản công việc.

00:14:00.000 --> 00:14:19.000
Điều này là do tôi biết thông báo này đang được gửi đến tài khoản công việc và tôi hy vọng rằng thông báo này sẽ bị tắt tiếng vì số nhận dạng tài khoản không khớp với vị ngữ mà tôi vừa đặt, chỉ khớp với số nhận dạng của tài khoản cá nhân.

00:14:19.000 --> 00:14:29.000
Ví dụ này dành cho thông báo cục bộ nhưng tiêu chí bộ lọc cũng có thể được đặt trên tải trọng JSON của thông báo từ xa.

00:14:29.000 --> 00:14:39.000
Một cách khác để cung cấp cho hệ thống ngữ cảnh bổ sung là cập nhật số lượng huy hiệu ứng dụng của bạn để phản ánh những gì quan trọng trong quá trình Tập trung hiện được kích hoạt.

00:14:39.000 --> 00:14:42.000
Điều này ngăn chặn sự phân tâm cho người dùng của bạn.

00:14:42.000 --> 00:14:47.000
Có một API mới trong UserNotifications cho mục đích này.

00:14:47.000 --> 00:14:57.000
Trên UNUserNotificationCenter, bạn chỉ cần gọi setBadgeCount với một số nguyên không dấu đại diện cho giá trị huy hiệu mới.

00:14:57.000 --> 00:15:02.000
Bây giờ, bạn đã biết cách cung cấp ngữ cảnh bổ sung để lọc thông báo hoặc đặt số lượng huy hiệu.

00:15:02.000 --> 00:15:08.000
Hãy nhớ rằng, mục tiêu của tính năng này là làm nổi bật những gì phù hợp nhất với người dùng khi họ tập trung.

00:15:08.000 --> 00:15:16.000
Đôi khi điều này đòi hỏi phải giảm thiểu nội dung không liên quan để ngăn chặn sự phân tâm khi Tiêu điểm được bật.

00:15:16.000 --> 00:15:34.000
Đối với các bước tiếp theo, tôi khuyến khích bạn bắt đầu xem xét những phần nào trong ứng dụng của bạn sẽ được hưởng lợi từ bộ lọc Focus, xác định thuộc tính nào có thể được định cấu hình, thiết lập ứng dụng và tiện ích mở rộng của bạn để xử lý việc này, sau đó tiến thêm một bước nữa bằng cách đánh giá xem có nên cung cấp ngữ cảnh bổ

00:15:34.000 --> 00:15:36.000
Đó là nó cho các bộ lọc Focus!

00:15:36.000 --> 00:15:40.000
Cảm ơn bạn đã tham gia phiên họp này và có một phần còn lại tuyệt vời của WWDC.

00:15:40.000 --> 23:59:59.000
♪

