WEBVTT

00:00:00.000 --> 00:00:10.000
♪ ♪

00:00:10.000 --> 00:00:13.000
Xin chào, và chào mừng đến với WWDC.

00:00:13.000 --> 00:00:18.000
Tên tôi là David, và tôi muốn nói với bạn về cách bạn có thể khám phá nhiều nội dung hơn với MusicKit.

00:00:18.000 --> 00:00:25.000
Khung MusicKit được ra mắt vào năm 2021, cung cấp một bộ API để truy cập và phát nhạc nguyên bản trong Swift.

00:00:25.000 --> 00:00:32.000
Khung này giúp ứng dụng của bạn dễ dàng tích hợp với Apple Music, cung cấp quyền truy cập vào toàn bộ danh mục Apple Music.

00:00:32.000 --> 00:00:36.000
Hôm nay, tôi muốn nói về một số cải tiến lớn mà chúng tôi đã thực hiện cho MusicKit.

00:00:36.000 --> 00:00:46.000
Tôi sẽ bắt đầu với một số bổ sung để tận dụng tối đa danh mục Apple Music, với các loại mục nhạc mới, yêu cầu mới và siêu dữ liệu mới.

00:00:46.000 --> 00:00:53.000
Sau đó, tôi sẽ thảo luận về cách bạn có thể tìm nạp nội dung được cá nhân hóa để cung cấp trải nghiệm phù hợp cho từng người dùng của mình.

00:00:53.000 --> 00:00:56.000
Tiếp theo, tôi sẽ vượt ra ngoài danh mục Apple Music.

00:00:56.000 --> 00:01:02.000
Năm nay, bạn có thể đưa ứng dụng của mình lên một tầm cao mới bằng cách bao gồm nhạc từ thư viện của người dùng.

00:01:02.000 --> 00:01:12.000
Cuối cùng, tôi sẽ thảo luận về cách tương tác tích cực với thư viện, chẳng hạn như thêm các mục vào thư viện hoặc danh sách phát, cũng như tạo và chỉnh sửa danh sách phát.

00:01:12.000 --> 00:01:14.000
Hãy đi sâu vào các bổ sung nội dung danh mục.

00:01:14.000 --> 00:01:22.000
Bản phát hành ban đầu của MusicKit đã giới thiệu một lớp mô hình mới cho âm nhạc, bao gồm các loại cốt lõi như Bài hát, Album và Danh sách phát.

00:01:22.000 --> 00:01:32.000
Năm nay, chúng tôi đang giúp việc khám phá âm nhạc mới với MusicKit trở nên dễ dàng hơn với việc bổ sung hai loại mới: Curator và Radio Show.

00:01:32.000 --> 00:01:49.000
Ngoài ra, MusicKit hiện cũng cho phép bạn xây dựng giao diện người dùng tuyệt vời để tìm kiếm thông qua danh mục, truy cập các bảng xếp hạng hàng đầu để có được các bài hát, album phổ biến nhất và hơn thế nữa và tìm nạp các thuộc tính mới như siêu dữ liệu âm thanh chất lượng cao hơn như Âm thanh không gian với Dolby Atmos.

00:01:49.000 --> 00:01:54.000
Hãy bắt đầu với những người phụ trách và các chương trình phát thanh, đó là những nguồn tài nguyên tuyệt vời để khám phá âm nhạc.

00:01:54.000 --> 00:01:58.000
Ở đây, chúng ta đang xem xét một ví dụ Người quản lý, Nike.

00:01:58.000 --> 00:02:02.000
Các ví dụ khác về người phụ trách là Shazam và Beats của Tiến sĩ. Dre.

00:02:02.000 --> 00:02:07.000
Tại đây, chúng tôi có thể dễ dàng tìm thấy tất cả danh sách phát do người phụ trách này tạo ra.

00:02:07.000 --> 00:02:14.000
Chức năng này cho phép mọi người truy cập nhanh vào danh sách phát mà họ có thể yêu thích, tìm các bài hát mới hoặc xem lại các mục yêu thích cũ.

00:02:14.000 --> 00:02:18.000
Bây giờ chúng ta hãy đi sâu vào các chi tiết kỹ thuật hơn.

00:02:18.000 --> 00:02:20.000
Người phụ trách lưu trữ nhiều thuộc tính khác nhau.

00:02:20.000 --> 00:02:28.000
Một số thuộc tính chính của loại Người quản lý mới này là tên, url, tác phẩm nghệ thuật và loại.

00:02:28.000 --> 00:02:38.000
Thuộc tính loại là một enum có thể là "biên tập" hoặc "bên ngoài" cho biết liệu một người phụ trách nhất định là người phụ trách Apple hay người phụ trách bên thứ ba.

00:02:38.000 --> 00:02:47.000
Người phụ trách cũng có mối quan hệ danh sách phát hiển thị danh sách phát do người phụ trách đó tạo ra, thực sự phục vụ khái niệm khám phá âm nhạc mà chúng tôi vừa thấy.

00:02:47.000 --> 00:02:50.000
Tiếp theo, chúng tôi có loại Radio Show.

00:02:50.000 --> 00:02:59.000
Các chương trình phát thanh như "New Music Daily của Zane Lowe" và "Pop Hits Radio của Brooke Reese" là một cách khác để khám phá âm nhạc mới thông qua các chuyên gia dày dạn kinh nghiệm.

00:02:59.000 --> 00:03:06.000
Giống như loại Curator, các chương trình phát thanh cũng có mối quan hệ danh sách phát để tìm âm nhạc mà chương trình phát thanh có.

00:03:06.000 --> 00:03:23.000
Giống như hai loại mới này giữ mối quan hệ với danh sách phát, chúng tôi cũng đang hiển thị hai mối quan hệ mới trên loại Danh sách phát, "Trình quản lý" và "RadioShow" cho logic đảo ngược: đưa ra một danh sách phát, chúng tôi có thể dễ dàng có được cấu trúc của thực thể đã tạo danh sách phát đã nói.

00:03:23.000 --> 00:03:31.000
MusicKit cho phép tìm kiếm danh mục nội dung từ rất nhiều loại và bây giờ chúng tôi đang thêm hỗ trợ cho các loại mặt hàng mới của mình, như người phụ trách và chương trình phát thanh.

00:03:31.000 --> 00:03:37.000
Danh sách tiếp tục phát triển, và kết quả là, việc xây dựng giao diện người dùng tốt ngày càng trở nên khó khăn hơn.

00:03:37.000 --> 00:03:43.000
Đó là lý do tại sao năm nay, chúng tôi sẽ giúp bạn dễ dàng hơn nhiều thông qua các kết quả và đề xuất hàng đầu.

00:03:43.000 --> 00:03:47.000
Chúng ta hãy xem xét tiện ích mà những cải tiến này mang lại cho giao diện người dùng.

00:03:47.000 --> 00:03:53.000
Khi nhập để tìm kiếm nội dung, bạn có thể muốn cung cấp hỗ trợ tự động hoàn thành mạnh mẽ, liên quan đến âm nhạc.

00:03:53.000 --> 00:03:59.000
Đó là nơi các đề xuất phát huy tác dụng, cung cấp các điều khoản mà mọi người có thể đang cố gắng đạt được.

00:03:59.000 --> 00:04:06.000
Bạn thậm chí có thể tiến thêm một bước nữa và hiển thị các kết quả hàng đầu để truy cập nhanh vào những gì mọi người có thể đang tìm kiếm.

00:04:06.000 --> 00:04:12.000
Để có kết quả tốt nhất, bạn có thể không quan tâm đến loại mặt hàng, mà thay vào đó muốn tập trung vào mức độ liên quan.

00:04:12.000 --> 00:04:15.000
Đây là sức mạnh của những kết quả hàng đầu.

00:04:15.000 --> 00:04:20.000
Bây giờ, chúng ta hãy xem việc triển khai điều này sẽ như thế nào, bắt đầu với Kết quả hàng đầu.

00:04:20.000 --> 00:04:28.000
Ở đây chúng tôi có cách hiện có để tạo yêu cầu tìm kiếm danh mục, yêu cầu cụm từ tìm kiếm và các loại mục mà bạn muốn đại diện.

00:04:28.000 --> 00:04:35.000
Phản hồi bao gồm các bộ sưu tập được phân loại theo các loại được yêu cầu, có nghĩa là nhiều danh sách các kết quả cụ thể của loại.

00:04:35.000 --> 00:04:41.000
Mặc dù điều này thật tuyệt, chúng tôi muốn hiển thị một danh sách duy nhất các kết quả phù hợp nhất là loại bất khả tri.

00:04:41.000 --> 00:04:45.000
Và yêu cầu thông tin này đơn giản như thêm một dòng.

00:04:45.000 --> 00:04:53.000
Ở đây chúng tôi đang đặt thuộc tính includeTopResults theo yêu cầu thành true và một thuộc tính mới được điền vào phản hồi.

00:04:53.000 --> 00:04:58.000
Thuộc tính mới này được đặt tên là topResults chứa các mục thuộc bất kỳ loại nào được yêu cầu.

00:04:58.000 --> 00:05:02.000
Đây là đầu ra của câu lệnh in trông như thế nào.

00:05:02.000 --> 00:05:11.000
Chúng ta có thể thấy rằng kết quả hàng đầu được trả về là sự kết hợp của các bài hát, nghệ sĩ và album trong một bộ sưu tập duy nhất và được sắp xếp theo mức độ liên quan.

00:05:11.000 --> 00:05:16.000
Bây giờ tôi sẽ chỉ cho bạn cách giúp mọi người đến đích tìm kiếm của họ nhanh hơn với Gợi ý.

00:05:16.000 --> 00:05:20.000
Đơn giản chỉ cần tạo một yêu cầu đề xuất với một thuật ngữ chuỗi.

00:05:20.000 --> 00:05:25.000
Khi gọi phản hồi, bạn sẽ nhận được phản hồi đề xuất.

00:05:25.000 --> 00:05:27.000
Phản hồi chứa một loạt các Đề xuất.

00:05:27.000 --> 00:05:34.000
Và mỗi đề xuất bao gồm một thuật ngữ hiển thị phù hợp với giao diện người dùng của bạn, cũng như một cụm từ tìm kiếm.

00:05:34.000 --> 00:05:41.000
Khi mọi người chọn một đề xuất, bạn có thể tìm nạp các kết quả tương ứng bằng cách thực hiện yêu cầu tìm kiếm với cụm từ tìm kiếm.

00:05:41.000 --> 00:05:46.000
Bảng xếp hạng danh mục là một cách tuyệt vời để cập nhật những bài hát phổ biến nhất.

00:05:46.000 --> 00:05:50.000
MusicKit cung cấp nhiều loại bảng xếp hạng khác nhau để xem những gì đang thịnh hành.

00:05:50.000 --> 00:06:01.000
Các loại bảng xếp hạng được cung cấp là các bảng xếp hạng hàng đầu, chẳng hạn như Bài hát hàng đầu hoặc Album hàng đầu, tương ứng với âm nhạc được chơi nhiều nhất, bảng xếp hạng thành phố và top 100 hàng ngày.

00:06:01.000 --> 00:06:06.000
Bạn cũng có thể chỉ định các biểu đồ được yêu cầu để được lọc theo một thể loại cụ thể.

00:06:06.000 --> 00:06:09.000
Việc truy xuất các biểu đồ này thông qua mã cực kỳ đơn giản.

00:06:09.000 --> 00:06:15.000
Yêu cầu biểu đồ danh mục tuân theo các mẫu đã được thiết lập đã được sử dụng trong yêu cầu tìm kiếm danh mục.

00:06:15.000 --> 00:06:18.000
Đầu tiên, khởi tạo một yêu cầu biểu đồ.

00:06:18.000 --> 00:06:22.000
Sau đó, bạn có thể chỉ định các loại biểu đồ bạn muốn.

00:06:22.000 --> 00:06:30.000
Theo mặc định, điều này sẽ tìm nạp nội dung được chơi nhiều nhất, nhưng bạn cũng có thể bao gồm các bảng xếp hạng hàng đầu toàn cầu hàng ngày và bảng xếp hạng hàng đầu thành phố.

00:06:30.000 --> 00:06:33.000
Cuối cùng, chỉ cần chỉ định các loại bạn muốn biểu đồ của mình chứa.

00:06:33.000 --> 00:06:35.000
Và thế là xong.

00:06:35.000 --> 00:06:43.000
Khi chúng tôi truy cập biểu đồ danh sách phát đầu tiên trong phản hồi, chúng tôi nhận được Biểu đồ MusicCatalog đại diện cho các bảng xếp hạng hàng đầu toàn cầu hàng ngày.

00:06:43.000 --> 00:06:48.000
Các mục của nó là danh sách phát như "Top 100: Global" và "Top 100: USA".

00:06:48.000 --> 00:06:58.000
Nếu bạn đã tìm nạp các biểu đồ danh mục bằng cách sử dụng MusicDataRequest trong quá khứ, bạn không còn cần nữa, vì MusicKit sẽ thực hiện công việc cho bạn, với hỗ trợ phân trang được tích hợp trong bộ sưu tập các mặt hàng.

00:06:58.000 --> 00:07:09.000
Vào năm 2021, chúng tôi đã giới thiệu những trải nghiệm âm thanh đột phá với âm thanh đa chiều thực sự và rõ ràng: Âm thanh không gian với sự hỗ trợ cho Dolby Atmos.

00:07:09.000 --> 00:07:15.000
Trải nghiệm nhập vai này đã có sẵn cho hàng nghìn bài hát và bây giờ bạn có thể truy cập dữ liệu này.

00:07:15.000 --> 00:07:25.000
MusicKit hiển thị tài nguyên âm thanh nào có sẵn cho bất kỳ bài hát hoặc album nào thông qua Audio Variants, vì vậy bây giờ, bạn có thể chuyển tiếp thông tin này cho người khác.

00:07:25.000 --> 00:07:34.000
Ví dụ về các biến thể âm thanh là Âm thanh không gian đã được đề cập trước đó với Dolby Atmos, Âm thanh không mất dữ liệu và hơn thế nữa.

00:07:34.000 --> 00:07:43.000
Chúng tôi cũng đang giới thiệu một thuộc tính boolean mới cùng với các biến thể âm thanh, là Apple Digital Master, là bản chính chất lượng cao nhất được hỗ trợ.

00:07:43.000 --> 00:07:51.000
Vì siêu dữ liệu này được hiển thị ở cấp độ mục, các biến thể âm thanh hoàn hảo để xem chi tiết, cho phép bạn đạt được giao diện người dùng như thế này.

00:07:51.000 --> 00:07:54.000
Ở đây chúng tôi có một cái nhìn chi tiết của một album.

00:07:54.000 --> 00:08:02.000
Và ở đây, chúng ta có thể thấy các huy hiệu thích hợp dựa trên thuộc tính biến thể âm thanh đã đề cập trước đó, cho người dùng biết chất lượng âm thanh mà họ có thể mong đợi.

00:08:02.000 --> 00:08:08.000
Trong trường hợp này, âm thanh không gian và âm thanh không mất dữ liệu có sẵn cho album cụ thể này.

00:08:08.000 --> 00:08:11.000
Bây giờ hãy xem cách chúng ta có thể viết mã để đạt được điều này.

00:08:11.000 --> 00:08:14.000
Tải các biến thể âm thanh giống như tải bất kỳ thuộc tính mở rộng nào khác.

00:08:14.000 --> 00:08:22.000
Lấy một album hoặc bài hát hiện có, trong trường hợp này là một album và sử dụng phương pháp with để tải thuộc tính mở rộng audioVariants.

00:08:22.000 --> 00:08:27.000
Bây giờ album chi tiết của bạn có thuộc tính audioVariants được điền vào.

00:08:27.000 --> 00:08:32.000
Ở đây chúng ta có thể thấy thuộc tính biến thể âm thanh, là một mảng có phần tử là AudioVariant.

00:08:32.000 --> 00:08:40.000
Với những giá trị này, bạn có thể chỉ ra trong giao diện người dùng của mình các tài nguyên âm thanh có sẵn cho phần tử cụ thể đó, giống như chúng ta đã thấy trước đó.

00:08:40.000 --> 00:08:45.000
Bây giờ, điều này thật tuyệt, nhưng bạn có thể muốn hiển thị các huy hiệu âm thanh này không chỉ ở chế độ xem cấp cao nhất hoặc chi tiết.

00:08:45.000 --> 00:08:52.000
Đó là lý do tại sao chúng tôi cũng đang tiến thêm một bước nữa và phơi bày biến thể âm thanh chủ động cho trình phát nhạc.

00:08:52.000 --> 00:09:01.000
Truy cập biến thể âm thanh đang hoạt động cho phép hiển thị trực quan về chất lượng âm thanh cho mục hiện đang phát, chẳng hạn như Dolby Atmos trong chế độ xem này.

00:09:01.000 --> 00:09:09.000
Và API trình phát MusicKit tự động chọn chất lượng âm thanh chính xác dựa trên cài đặt người dùng và điều kiện mạng.

00:09:09.000 --> 00:09:17.000
Để truy cập đặc điểm hoạt động từ trình phát, trước tiên, chúng tôi truy cập trạng thái phát lại của ApplicationMusicPlayer trong một đối tượng quan sát được.

00:09:17.000 --> 00:09:27.000
Sau đó, chúng tôi có thể truy cập audioVariant đang hoạt động trực tiếp từ trạng thái phát lại Bây giờ, chúng tôi chỉ cần kiểm tra thuộc tính audioVariant để xem đó có phải là dolbyAtmos không và thêm giao diện người dùng bổ sung nếu có.

00:09:27.000 --> 00:09:37.000
Bởi vì trạng thái phát lại là một đối tượng quan sát, chế độ xem này sẽ tự động cập nhật bất cứ khi nào mục hiện đang phát thay đổi, đảm bảo chế độ xem của bạn luôn được cập nhật.

00:09:37.000 --> 00:09:42.000
Bây giờ chúng ta đã xem qua một số bổ sung danh mục, hãy đi sâu vào việc tìm nạp nội dung được cá nhân hóa.

00:09:42.000 --> 00:09:49.000
Nội dung được cá nhân hóa là dữ liệu dành riêng cho người đăng ký, cung cấp trải nghiệm độc đáo và phù hợp cho mọi người dùng trong ứng dụng của bạn.

00:09:49.000 --> 00:09:59.000
Thông thường, nội dung được cá nhân hóa yêu cầu xác thực đặc biệt và mã thông báo người dùng, nhưng trong khuôn khổ MusicKit, chúng tôi đã tự động hóa tất cả để bạn không phải đối phó với bất kỳ rắc rối nào.

00:09:59.000 --> 00:10:06.000
Nội dung được cá nhân hóa mà chúng tôi đang mang đến cho các nhà phát triển là quyền truy cập vào các mục đã chơi gần đây và các đề xuất cá nhân.

00:10:06.000 --> 00:10:12.000
Nội dung được phát gần đây là một phần dữ liệu có giá trị cho trải nghiệm tiêu thụ âm nhạc của một người.

00:10:12.000 --> 00:10:16.000
Nó cho phép truy cập nhanh chóng và dễ dàng vào các mục âm nhạc mà bạn biết họ thích.

00:10:16.000 --> 00:10:22.000
Và khi nghe nhạc mới, nó cho phép mọi người sau này quay lại và tham khảo lịch sử của họ.

00:10:22.000 --> 00:10:29.000
Để tìm nạp các vùng chứa đã phát gần đây như album, danh sách phát và trạm, bạn có thể tạo yêu cầu vùng chứa đã phát gần đây.

00:10:29.000 --> 00:10:34.000
Lưu ý rằng nếu bạn phát một bài hát từ danh sách phát hoặc album, loại vùng chứa sẽ được truy xuất.

00:10:34.000 --> 00:10:43.000
Trong phản hồi, bạn sẽ tìm thấy các mục âm nhạc được phát gần đây, cung cấp các trình truy cập tiện lợi cho tiêu đề, phụ đề và tác phẩm nghệ thuật.

00:10:43.000 --> 00:10:48.000
Bạn cũng có thể tìm nạp các mục đã chơi gần đây thuộc các loại cụ thể hơn, như bài hát hoặc đài.

00:10:48.000 --> 00:10:56.000
Ở đây, chúng tôi tạo một yêu cầu đã chơi gần đây, chỉ định loại Bài hát thông qua tham số chung, được biểu thị bằng dấu ngoặc nhọn.

00:10:56.000 --> 00:10:59.000
Phản hồi của chúng tôi bây giờ chỉ chứa những bài hát mà chúng tôi đã chơi.

00:10:59.000 --> 00:11:02.000
Bây giờ, vào các đề xuất cá nhân.

00:11:02.000 --> 00:11:11.000
Các đề xuất cá nhân cho phép trải nghiệm ứng dụng của bạn cảm thấy thân mật và hấp dẫn hơn vì chúng được tạo ra dựa trên thư viện và lịch sử nghe của người dùng.

00:11:11.000 --> 00:11:20.000
Các đề xuất được sắp xếp độc đáo theo chủ đề, dẫn đến các nhóm theo thể loại, nghệ sĩ, bộ sưu tập như "Made for You" và hơn thế nữa.

00:11:20.000 --> 00:11:25.000
Để tìm nạp các đề xuất cá nhân, chỉ cần tạo một yêu cầu đề xuất cá nhân.

00:11:25.000 --> 00:11:28.000
Phản hồi là một tập hợp các khuyến nghị.

00:11:28.000 --> 00:11:34.000
Khi chúng tôi ghi lại đề xuất đầu tiên, chúng tôi có thể thấy rằng yếu tố cụ thể này đại diện cho đề xuất "Made for You".

00:11:34.000 --> 00:11:38.000
Các đề xuất có ID, tiêu đề và nextRefreshDate.

00:11:38.000 --> 00:11:45.000
NextRefreshDate đại diện cho ngày giờ khi đề xuất này nên được làm mới cho các đề xuất cập nhật nhất.

00:11:45.000 --> 00:11:49.000
Thuộc tính danh sách phát chứa tất cả các danh sách phát được tạo cho tôi.

00:11:49.000 --> 00:11:52.000
Hãy xem xét một ví dụ khác về đề xuất.

00:11:52.000 --> 00:11:56.000
Ở đây chúng tôi sẽ in ra yếu tố thứ hai của phản hồi đề xuất.

00:11:56.000 --> 00:12:04.000
Tôi nghe rất nhiều nhạc thay thế, và đề xuất này bao gồm sự kết hợp của các loại khác nhau, trong trường hợp này là Album và Danh sách phát.

00:12:04.000 --> 00:12:11.000
Chúng được nhóm lại trong một bộ sưu tập các mặt hàng duy nhất, được sắp xếp theo mức độ liên quan, giống như các kết quả hàng đầu để tìm kiếm danh mục.

00:12:11.000 --> 00:12:21.000
Bây giờ, hãy tiến thêm một bước nữa và nói về cách bạn có thể tạo ra những trải nghiệm phù hợp hơn nữa xung quanh âm nhạc bằng cách kết hợp nội dung từ thư viện của người dùng vào ứng dụng của bạn.

00:12:21.000 --> 00:12:39.000
Năm nay, MusicKit cho phép ứng dụng của bạn tìm nạp các mục từ thư viện với hai loại yêu cầu: yêu cầu thư viện và yêu cầu phân đoạn thư viện, tìm kiếm nội dung trong thư viện của người dùng và tải các thuộc tính và mối quan hệ mở rộng cụ thể từ thư viện.

00:12:39.000 --> 00:12:45.000
Trước khi chúng tôi xem các chi tiết kỹ thuật, hãy xem cách chúng tôi có thể sử dụng nội dung thư viện để nâng cao ứng dụng của bạn.

00:12:45.000 --> 00:12:50.000
Tôi đang làm việc trên một ứng dụng thể dục có tên Music Marathon sẽ theo dõi các lần chạy ngoài trời của bạn.

00:12:50.000 --> 00:12:59.000
Bằng cách kết hợp MusicKit trong dự án, chúng tôi cho phép mọi người phát nhạc trực tiếp thông qua ứng dụng thay vì chuyển đổi ngữ cảnh giữa ứng dụng Apple Music và ứng dụng này.

00:12:59.000 --> 00:13:04.000
Hãy bắt đầu một bài tập mới và tìm kiếm nội dung âm nhạc.

00:13:04.000 --> 00:13:12.000
Ở đây chúng tôi thấy một số danh sách phát được đề xuất được truy xuất từ yêu cầu đề xuất cá nhân, để cung cấp cho mọi người quyền truy cập nhanh vào danh sách phát mà chúng tôi nghĩ rằng họ sẽ yêu thích.

00:13:12.000 --> 00:13:17.000
Đi đến tab thư viện, chúng ta có thể thấy đó là một chế độ xem trống.

00:13:17.000 --> 00:13:21.000
Thật tuyệt khi có thể xem tất cả danh sách phát cá nhân của tôi, vì vậy hãy viết tính năng đó.

00:13:21.000 --> 00:13:29.000
Tôi đã có một số giao diện người dùng được thiết lập để xử lý những điều cơ bản của chế độ xem này và bây giờ tôi muốn tải danh sách phát từ thư viện của mình.

00:13:29.000 --> 00:13:33.000
Đầu tiên, tôi sẽ đưa ra yêu cầu thư viện...

00:13:33.000 --> 00:13:42.000
Chỉ định danh sách phát trong tham số chung để chỉ ra rằng chúng tôi muốn danh sách phát từ thư viện của người dùng.

00:13:42.000 --> 00:13:47.000
Và tôi sẽ lưu trữ nó trong một biến cục bộ mà tôi sẽ đặt tên là "yêu cầu".

00:13:47.000 --> 00:13:53.000
Tiếp theo tôi sẽ nhận yêu cầu này và gọi chức năng phản hồi.

00:13:53.000 --> 00:13:58.000
Phương pháp này là một phương pháp ném không đồng bộ, vì vậy hãy thêm các từ khóa thử và chờ đợi.

00:13:58.000 --> 00:14:04.000
Và một lần nữa lưu trữ nó trong một biến phản hồi.

00:14:04.000 --> 00:14:11.000
Sau đó, tôi sẽ cập nhật đối tượng trạng thái để nhận được phản hồi này.

00:14:11.000 --> 00:14:17.000
Bây giờ tất cả những gì còn lại cần làm là cập nhật danh sách để chúng ta có thể xem danh sách phát trong giao diện người dùng của tôi.

00:14:17.000 --> 00:14:25.000
Tôi sẽ lặp lại các mục trong phản hồi bằng cách sử dụng ForEach...

00:14:25.000 --> 00:14:30.000
Và truy xuất từng danh sách phát trong MusicItemCollection.

00:14:30.000 --> 00:14:35.000
Bây giờ chúng ta đã có danh sách phát, tôi sẽ chuyển chúng vào PlaylistCell mà tôi đã tạo.

00:14:35.000 --> 00:14:44.000
Bây giờ nếu chúng ta chạy lại...

00:14:44.000 --> 00:14:50.000
Và điều hướng trở lại ứng dụng, chúng ta có thể xem tất cả danh sách phát cá nhân của tôi trong thư viện.

00:14:50.000 --> 00:14:57.000
Bây giờ, tôi có thể chọn nghe các đề xuất cá nhân, bất cứ thứ gì từ danh mục Apple Music và thư viện cá nhân của riêng tôi.

00:14:57.000 --> 00:15:02.000
Bây giờ chúng ta đã thấy việc truy cập nội dung thư viện dễ dàng như thế nào, hãy xem yêu cầu thư viện có thể làm gì khác.

00:15:02.000 --> 00:15:07.000
Yêu cầu thư viện nhạc là một API mạnh mẽ để tìm nạp các mục từ thư viện của người dùng.

00:15:07.000 --> 00:15:15.000
Trên iOS, không giống như các yêu cầu khác để tìm nạp nội dung từ danh mục nhạc, MusicLibraryRequest sẽ không thực sự tải dữ liệu từ mạng.

00:15:15.000 --> 00:15:21.000
Thay vào đó, nó sẽ tải các mục từ bản sao thư viện của người dùng được lưu trữ trên thiết bị.

00:15:21.000 --> 00:15:27.000
Những điều cơ bản của yêu cầu này chỉ yêu cầu bạn chỉ định loại mục nhạc nào được mong muốn.

00:15:27.000 --> 00:15:32.000
Loại mục này được chuyển qua tham số chung của MusicLibraryRequest.

00:15:32.000 --> 00:15:39.000
Bạn có thể áp dụng nhiều bộ lọc và tùy chọn sắp xếp theo yêu cầu để tinh chỉnh cuộc gọi của bạn để phù hợp với yêu cầu của bạn.

00:15:39.000 --> 00:15:46.000
Yêu cầu này cũng có khả năng tìm nạp nội dung đã được tải xuống, hỗ trợ trải nghiệm ngoại tuyến hoàn toàn.

00:15:46.000 --> 00:15:55.000
Hãy bắt đầu với yêu cầu đơn giản, cơ bản, cùng một yêu cầu mà chúng tôi đã viết trong ứng dụng Music Marathon, nhưng lần này, hãy yêu cầu Album trong thư viện.

00:15:55.000 --> 00:15:58.000
Loại album được chỉ định thông qua tham số chung.

00:15:58.000 --> 00:16:01.000
Để thực hiện yêu cầu, hãy gọi hàm phản hồi.

00:16:01.000 --> 00:16:11.000
Nhìn vào đầu ra, chúng tôi có MusicLibraryResponse, trong đó các mục của nó là MusicItemCollection của tất cả các album được tìm thấy trong thư viện nhạc của người dùng.

00:16:11.000 --> 00:16:19.000
Ở đây chúng tôi nhận thấy rằng những Album này có cùng cấu trúc Album mà bạn sẽ nhận được từ một trong những yêu cầu danh mục khác nhau của chúng tôi và có cùng khả năng.

00:16:19.000 --> 00:16:27.000
Trong khi trong ví dụ này, chúng tôi đang tìm nạp mọi album trong thư viện, chúng tôi biết có những tình huống mà bạn chỉ muốn một tập hợp con cụ thể của album.

00:16:27.000 --> 00:16:34.000
Đó là lý do tại sao MusicLibraryRequest cũng cho phép bạn cụ thể hơn về những mục bạn muốn lấy từ thư viện.

00:16:34.000 --> 00:16:38.000
Hãy thực hiện cùng một yêu cầu mà chúng tôi đã viết trước đây và thêm một bộ lọc.

00:16:38.000 --> 00:16:44.000
Ở đây, chúng tôi muốn tải tất cả các album trong đó thuộc tính isCompilation bằng true.

00:16:44.000 --> 00:16:52.000
Khi bạn gọi phương thức lọc, tự động hoàn thành của Xcode sẽ chỉ cung cấp các đường dẫn khóa cụ thể được hỗ trợ cho loại mục bạn đang yêu cầu.

00:16:52.000 --> 00:16:56.000
Bây giờ, câu trả lời chỉ có các album là tổng hợp.

00:16:56.000 --> 00:16:59.000
Nhưng đó không phải là tất cả sức mạnh mà MusicLibraryRequest mang lại.

00:16:59.000 --> 00:17:04.000
Bạn có thể xâu chuỗi nhiều bộ lọc, cung cấp cho bạn một yêu cầu tinh tế hơn với mỗi lần bổ sung.

00:17:04.000 --> 00:17:08.000
Điều gì sẽ xảy ra nếu chúng ta muốn tất cả các bản tổng hợp của một thể loại cụ thể?

00:17:08.000 --> 00:17:11.000
Chúng ta có thể thêm một bộ lọc khác vào yêu cầu.

00:17:11.000 --> 00:17:15.000
Ví dụ, ở đây chúng ta có một ví dụ về Thể loại có tên là "Nhảy".

00:17:15.000 --> 00:17:22.000
Bạn có thể lọc theo mối quan hệ của thể loại để hạn chế kết quả chỉ bao gồm các bản tổng hợp có chứa thể loại cụ thể này.

00:17:22.000 --> 00:17:25.000
Bây giờ phản hồi của chúng tôi chỉ chứa các bản tổng hợp khiêu vũ.

00:17:25.000 --> 00:17:29.000
Làm thế nào về việc chỉ bao gồm các bản tổng hợp khiêu vũ đã được tải xuống?

00:17:29.000 --> 00:17:33.000
Để làm điều đó, chỉ cần đặt includeOnlyDownloadedContent thành true theo yêu cầu.

00:17:33.000 --> 00:17:34.000
Và thế là xong.

00:17:34.000 --> 00:17:41.000
Phản hồi giống nhau MusicLibraryResponse, nhưng các mục hiện chỉ chứa các yếu tố được tải xuống.

00:17:41.000 --> 00:17:50.000
Như bạn có thể thấy, yêu cầu thư viện nhạc rất mạnh mẽ và mở ra các khả năng mới không thể thực hiện được với MusicDataRequest tùy chỉnh.

00:17:50.000 --> 00:17:54.000
Nhưng MusicKit cung cấp nhiều tùy chọn hơn để tìm nạp dữ liệu từ thư viện của người dùng.

00:17:54.000 --> 00:17:57.000
Đáp ứng Yêu cầu Phân đoạn Thư viện.

00:17:57.000 --> 00:18:02.000
Yêu cầu được phân đoạn có thể tìm nạp các mục được nhóm theo các phần.

00:18:02.000 --> 00:18:07.000
Kết quả là, yêu cầu được phân đoạn nhận hai tham số chung riêng biệt.

00:18:07.000 --> 00:18:11.000
Đầu tiên đại diện cho loại phần, và thứ hai, loại mục.

00:18:11.000 --> 00:18:23.000
Yêu cầu phân đoạn thư viện hỗ trợ các khả năng tương tự như yêu cầu thư viện thông thường, chẳng hạn như nhiều phương pháp lọc và sắp xếp khác nhau mà bạn có thể áp dụng cho các phần hoặc các mục.

00:18:23.000 --> 00:18:29.000
Đây là cách bạn có thể tìm nạp tất cả các album được phân đoạn theo thể loại của chúng bằng cách sử dụng yêu cầu phân đoạn thư viện.

00:18:29.000 --> 00:18:38.000
Phản hồi được phân đoạn chứa một thuộc tính có tên "phần" trong đó mỗi phần tử tương ứng với tham số chung đầu tiên của yêu cầu, Thể loại trong trường hợp này.

00:18:38.000 --> 00:18:46.000
Mỗi thể loại không chỉ hiển thị các thuộc tính riêng của nó mà còn chứa một bộ sưu tập các album, có thể truy cập thông qua thuộc tính vật phẩm.

00:18:46.000 --> 00:18:50.000
Những mục đó tương ứng với đối số chung thứ hai.

00:18:50.000 --> 00:18:53.000
Ở đây, điểm nổi bật cho thấy các album có thể loại là Alternative.

00:18:53.000 --> 00:18:59.000
Và như đã đề cập trước đây, khả năng lọc và sắp xếp cũng có sẵn cho yêu cầu được phân đoạn này.

00:18:59.000 --> 00:19:06.000
Giả sử chúng ta muốn cùng một album, được phân chia theo thể loại, nhưng các album được sắp xếp theo tên nghệ sĩ của họ.

00:19:06.000 --> 00:19:07.000
Chúng tôi thêm một bộ lọc sắp xếp.

00:19:07.000 --> 00:19:15.000
Bằng cách chỉ định keyPath artistName trên Album và nói rằng chúng tôi muốn những thứ này tăng dần, chúng tôi đang sắp xếp phản hồi.

00:19:15.000 --> 00:19:21.000
Lưu ý rằng phương thức là sortItems vì chúng tôi đang chỉ định sắp xếp được áp dụng cho các mục chứ không phải các phần.

00:19:21.000 --> 00:19:27.000
Nếu chúng tôi muốn chỉ định các phần, một tập hợp các phần lọc và các phương thức sortSection có sẵn.

00:19:27.000 --> 00:19:32.000
Hãy cùng xem phản hồi mới.

00:19:32.000 --> 00:19:37.000
Bây giờ chúng ta có thể thấy rằng các album của chúng ta được sắp xếp theo thứ tự bảng chữ cái theo tên nghệ sĩ thay vì theo tiêu đề của chúng.

00:19:37.000 --> 00:19:48.000
Cả yêu cầu thư viện và yêu cầu phân đoạn thư viện đều cực kỳ mạnh mẽ, nhưng bạn cũng có thể muốn bổ sung cho giao diện người dùng tìm kiếm nhạc của mình bằng cách thêm kết quả tìm kiếm từ thư viện của người dùng.

00:19:48.000 --> 00:19:59.000
Vì vậy, chúng tôi đã thêm một yêu cầu có cấu trúc mới hoạt động gần như giống hệt với tìm kiếm danh mục, nhưng thay vì tải kết quả từ danh mục, nó tìm thấy các mục có liên quan trong thư viện của người dùng.

00:19:59.000 --> 00:20:06.000
Cũng giống như đối tác danh mục của nó, yêu cầu tìm kiếm thư viện chỉ yêu cầu cụm từ tìm kiếm và một mảng các loại.

00:20:06.000 --> 00:20:13.000
Bây giờ chúng ta đã thấy các cách khác nhau để truy xuất các mục từ thư viện của người dùng, còn việc tải các thuộc tính và mối quan hệ mở rộng thì sao?

00:20:13.000 --> 00:20:22.000
Như bạn có thể đã biết, bản phát hành ban đầu của MusicKit đã giới thiệu phương thức with, tải các thuộc tính này từ Apple Music API một cách đơn giản.

00:20:22.000 --> 00:20:28.000
Năm nay, chúng tôi đang tăng cường dòng điện bằng phương pháp để cũng lấy một tham số nguồn ưa thích.

00:20:28.000 --> 00:20:38.000
Nguồn ưa thích này chỉ ra nơi tải dữ liệu, cho các thuộc tính và mối quan hệ mở rộng có sẵn trong cả danh mục Apple Music và thư viện của người dùng.

00:20:38.000 --> 00:20:47.000
Và đối với các thuộc tính chỉ tồn tại trong danh mục hoặc thư viện, chúng vẫn sẽ được tìm nạp bất kể nguồn ưa thích nào để đảm bảo không có gì bị bỏ qua.

00:20:47.000 --> 00:20:56.000
Ngoài ra, bạn có thể sử dụng chức năng này bất kể mục ban đầu đến từ đâu, cho dù đó là yêu cầu danh mục, yêu cầu thư viện hay nơi khác.

00:20:56.000 --> 00:20:58.000
Tất cả chỉ hoạt động.

00:20:58.000 --> 00:21:02.000
Ở đây chúng ta có cách nhận được mối quan hệ của một vật phẩm âm nhạc.

00:21:02.000 --> 00:21:09.000
Chúng tôi đang tải các bản nhạc của một album và khi chúng tôi hiển thị đầu ra, chúng tôi có thể xem tất cả các bản nhạc cho album đó.

00:21:09.000 --> 00:21:17.000
Tuy nhiên, với việc bổ sung mới thuộc tính preferredSource, chúng tôi có thể chỉ định rằng chúng tôi muốn tìm nạp mối quan hệ này từ thư viện.

00:21:17.000 --> 00:21:22.000
Bây giờ đầu ra của chúng tôi chỉ chứa các bản nhạc của album được tìm thấy trong thư viện.

00:21:22.000 --> 00:21:31.000
Với nhiều cách khác nhau mà bây giờ bạn có thể tìm nạp các mục từ thư viện của người dùng, chỉ có ý nghĩa khi cho phép người dùng có thể tương tác trực tiếp với thư viện của họ thông qua MusicKit.

00:21:31.000 --> 00:21:37.000
Hãy quay trở lại ứng dụng mẫu của tôi, Music Marathon, để xem một số khả năng mà thư viện cung cấp.

00:21:37.000 --> 00:21:43.000
Khi tôi đang tập luyện, tôi muốn duyệt qua một số đề xuất cá nhân của mình.

00:21:43.000 --> 00:21:48.000
Khi tôi xem qua các bản nhạc, tôi nhận ra rằng một trong những bài hát này sẽ hoàn hảo cho danh sách phát tập luyện của tôi.

00:21:48.000 --> 00:21:53.000
Nếu giữ một trong những ô này, một menu ngữ cảnh sẽ bật lên, cho phép tôi thêm bài hát này vào danh sách phát.

00:21:53.000 --> 00:21:57.000
Khi chúng tôi nhấn nó, một cửa sổ bật lên của tất cả danh sách phát của tôi sẽ xuất hiện trở lại.

00:21:57.000 --> 00:22:01.000
Hãy viết mã để thêm bản nhạc đã chọn vào bất kỳ danh sách phát nào tôi chọn.

00:22:01.000 --> 00:22:13.000
Tôi đã chuyển mục đã chọn vào ô AddToPlaylistCell của chúng tôi, vì vậy tất cả những gì chúng tôi phải làm là truy cập MusicLibrary thông qua phiên bản được chia sẻ.

00:22:13.000 --> 00:22:23.000
Chúng tôi sẽ gọi phương thức "thêm", chỉ định bản nhạc đã chọn của chúng tôi và danh sách phát mà chúng tôi muốn thêm vào.

00:22:23.000 --> 00:22:31.000
Phương pháp này cũng là một chức năng ném không đồng bộ, vì vậy chúng tôi thêm một lần nữa các từ khóa thử và chờ đợi.

00:22:31.000 --> 00:22:38.000
Cuối cùng, chúng tôi sẽ loại bỏ bộ chọn bằng cách đặt biến ràng buộc isShowingPlaylistPicker thành sai.

00:22:38.000 --> 00:22:47.000
Bây giờ nếu chúng ta chạy lại và thêm một bản nhạc vào danh sách phát và chọn một trong các danh sách phát của chúng ta, chúng ta sẽ thấy mục này được thêm vào.

00:22:47.000 --> 00:22:53.000
Điều hướng trở lại tab thư viện trong ứng dụng, chúng ta có thể thấy bài hát hiện đã được thêm vào danh sách phát tập luyện của chúng ta.

00:22:53.000 --> 00:22:56.000
Và đó là cách đơn giản để thêm một mục vào danh sách phát.

00:22:56.000 --> 00:22:59.000
Hãy xem xét một số chức năng khác mà thư viện cung cấp.

00:22:59.000 --> 00:23:10.000
Nhiều cách khác để tương tác với thư viện là thêm nội dung vào thư viện, tạo danh sách phát và chỉnh sửa siêu dữ liệu và danh sách theo dõi của danh sách phát.

00:23:10.000 --> 00:23:24.000
Thêm nội dung vào thư viện nhạc của người dùng cho phép mọi người tìm thấy các bài hát hoặc album cụ thể trong tab thư viện của ứng dụng Apple Music, cũng như đồng bộ hóa trên tất cả các thiết bị khi "Đồng bộ hóa Thư viện" được bật trong Cài đặt.

00:23:24.000 --> 00:23:34.000
Cung cấp chức năng này trực tiếp trong ứng dụng của bạn giúp mọi người không chuyển đổi ngữ cảnh giữa ứng dụng Apple Music và ứng dụng của bạn, vì vậy họ có thể tiếp tục tham gia vào nội dung bạn đang cung cấp.

00:23:34.000 --> 00:23:46.000
Ngoài ra, bằng cách tích hợp thêm vào thư viện cùng với các yêu cầu thư viện mới được giới thiệu, ứng dụng của bạn có thể hưởng lợi ngay lập tức từ những kết quả này, giúp người dùng dễ dàng truy cập vào nội dung họ yêu thích.

00:23:46.000 --> 00:23:51.000
Ngay cả với dịch vụ mạnh mẽ này, bạn vẫn có thể muốn tạo ra những trải nghiệm âm nhạc cụ thể.

00:23:51.000 --> 00:23:56.000
Vì vậy, năm nay, chúng tôi sẽ đưa việc tạo và chỉnh sửa danh sách phát vào MusicKit.

00:23:56.000 --> 00:23:59.000
Bây giờ bạn có thể tạo danh sách phát thay mặt cho người dùng của mình.

00:23:59.000 --> 00:24:07.000
Chúng tôi cũng cho phép các mục, chẳng hạn như bài hát hoặc thậm chí toàn bộ album, được thêm vào bất kỳ danh sách phát đủ điều kiện nào trong thư viện của người dùng.

00:24:07.000 --> 00:24:14.000
Tạo danh sách phát thật tuyệt vời để nhóm nội dung mà mọi người yêu thích hoặc phù hợp với bất kỳ tâm trạng nào mà ứng dụng của bạn muốn thiết lập.

00:24:14.000 --> 00:24:22.000
Và bằng cách thêm nội dung vào danh sách phát hiện có, bạn cho phép các công cụ khám phá âm nhạc khác nhau mà MusicKit cung cấp ảnh hưởng trực tiếp đến mọi người.

00:24:22.000 --> 00:24:30.000
Bây giờ bạn cũng có thể chỉnh sửa danh sách phát mà bạn đã tạo, có thể chỉnh sửa danh sách bài hát và siêu dữ liệu để đảm bảo mọi thứ đều như bạn muốn.

00:24:30.000 --> 00:24:35.000
Và đó là những cách bạn có thể tương tác với thư viện của người dùng từ bên trong ứng dụng của mình.

00:24:35.000 --> 00:24:39.000
Để kết thúc, MusicKit đã nhận được một số nâng cấp lớn trong năm nay.

00:24:39.000 --> 00:24:49.000
Dễ dàng kết hợp các cải tiến danh mục của chúng tôi cho các loại, thuộc tính mới và tăng cường tìm kiếm cho các ứng dụng hiện có của bạn để có trải nghiệm tốt hơn nữa.

00:24:49.000 --> 00:24:57.000
Tích hợp nội dung và chức năng thư viện để mở khóa các khả năng hoàn toàn mới và cho phép người dùng kiểm soát trải nghiệm của họ.

00:24:57.000 --> 00:25:00.000
Và sử dụng MusicKit có thể nâng cao nhiều loại ứng dụng khác nhau.

00:25:00.000 --> 00:25:08.000
Các ứng dụng thể dục, trò chơi, ứng dụng truyền thông xã hội, ứng dụng lập bản đồ và hơn thế nữa đều có thể hưởng lợi từ việc chơi hoặc chia sẻ nhạc.

00:25:08.000 --> 00:25:12.000
Để tiến xa hơn nữa, hãy đảm bảo kiểm tra một số phiên liên quan.

00:25:12.000 --> 00:25:19.000
Đi sâu hơn vào Swift và tìm hiểu về những bổ sung mới cho ngôn ngữ để tận dụng tối đa MusicKit và các Khung Apple khác.

00:25:19.000 --> 00:25:28.000
Kiểm tra phiên MusicKit từ năm 2021 để tìm hiểu cách thiết lập ứng dụng của bạn để sử dụng khuôn khổ, bắt đầu phát lại và trình bày các ưu đãi đăng ký.

00:25:28.000 --> 00:25:37.000
Và nếu bạn quan tâm đến việc tích hợp với Apple Music trên Android hoặc web, chúng tôi có một phiên khác xem xét cách sử dụng Apple Music API trực tiếp.

00:25:37.000 --> 00:25:42.000
Tôi hy vọng bạn thích phiên của chúng tôi và đảm bảo luôn cập nhật và tương tác thông qua các diễn đàn dành cho nhà phát triển của chúng tôi.

00:25:42.000 --> 23:59:59.000
Cảm ơn bạn đã xem, và tận hưởng WWDC 2022.

