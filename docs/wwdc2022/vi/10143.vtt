WEBVTT

00:00:00.000 --> 00:00:09.000
♪ ♪

00:00:09.000 --> 00:00:13.000
Bob: Xin chào, tôi là Bob Whiteman, Kỹ sư quản lý thiết bị iOS cao cấp.

00:00:13.000 --> 00:00:22.000
Tôi rất hân hạnh được chia sẻ với bạn một tính năng bảo mật mới quan trọng cho các thiết bị được quản lý trong môi trường doanh nghiệp và giáo dục.

00:00:22.000 --> 00:00:26.000
Hãy bắt đầu bằng cách xem lại bối cảnh bảo mật thiết bị.

00:00:26.000 --> 00:00:34.000
Người dùng của bạn cần truy cập tài nguyên tổ chức, chẳng hạn như trang web, máy chủ ứng dụng và cơ sở dữ liệu.

00:00:34.000 --> 00:00:39.000
Và có những kẻ tấn công cũng muốn truy cập vào những tài nguyên đó.

00:00:39.000 --> 00:00:43.000
Mô hình cổ điển để bảo mật tài nguyên là bảo mật chu vi.

00:00:43.000 --> 00:00:53.000
Bạn vẽ ranh giới bảo mật xung quanh mạng nội bộ và dựng tường lửa hoặc VPN cho phép khách hàng hợp pháp và từ chối các mối đe dọa.

00:00:53.000 --> 00:00:59.000
Nhưng mô hình này đã không theo kịp cách mọi người tương tác với các tổ chức hiện đại.

00:00:59.000 --> 00:01:04.000
Các nhà cung cấp dịch vụ đám mây đặt tài nguyên bên ngoài chu vi.

00:01:04.000 --> 00:01:08.000
Các mối đe dọa có thể bắt đầu từ bên trong chu vi.

00:01:08.000 --> 00:01:15.000
Và các mối đe dọa có thể giả mạo khách hàng hợp pháp để xâm nhập vào chu vi.

00:01:15.000 --> 00:01:20.000
Một mô hình bảo mật hiện đại hơn không tin tưởng vào chu vi mạng.

00:01:20.000 --> 00:01:24.000
Thay vào đó, mỗi tài nguyên thực hiện đánh giá niềm tin của riêng mình.

00:01:24.000 --> 00:01:29.000
Đây là một nguyên tắc cốt lõi của kiến trúc không tin cậy.

00:01:29.000 --> 00:01:41.000
Bạn có thể nghĩ về đánh giá niềm tin như một chức năng: đầu vào là thông tin tư thế về khách hàng và đầu ra là quyết định cấp hoặc từ chối quyền truy cập.

00:01:41.000 --> 00:01:45.000
Điều quan trọng là phải đánh giá đúng về niềm tin.

00:01:45.000 --> 00:01:55.000
Âm tính giả cản trở các hoạt động của người dùng, hoặc tệ hơn, âm tính giả cho phép kẻ tấn công truy cập tài nguyên của bạn.

00:01:55.000 --> 00:02:00.000
Và điều đó có nghĩa là có thông tin tư thế chính xác cũng rất quan trọng.

00:02:00.000 --> 00:02:03.000
Hãy điều tra các thành phần phổ biến của tư thế.

00:02:03.000 --> 00:02:13.000
Bạn sử dụng tất cả thông tin có sẵn về khách hàng và yêu cầu của nó: ai đang đưa ra yêu cầu, họ đang sử dụng thiết bị nào, họ đang ở đâu, v.v.

00:02:13.000 --> 00:02:20.000
Đánh giá niềm tin có thể sử dụng các chi tiết khác nhau trong tư thế để truy cập các tài nguyên khác nhau.

00:02:20.000 --> 00:02:30.000
Truy cập tài nguyên bảo mật thấp có thể chỉ yêu cầu danh tính của người dùng, nhưng truy cập cơ sở hạ tầng quan trọng có thể yêu cầu đánh giá tất cả các mục tư thế.

00:02:30.000 --> 00:02:36.000
Tùy thuộc vào tổ chức để quyết định chi tiết nào có liên quan.

00:02:36.000 --> 00:02:40.000
Một yếu tố trung tâm của tư thế là danh tính của người dùng.

00:02:40.000 --> 00:02:44.000
Điều này cho biết ai đang đưa ra yêu cầu.

00:02:44.000 --> 00:02:59.000
Các thiết bị của Apple cung cấp một số công nghệ để hỗ trợ danh tính người dùng, chẳng hạn như tính năng Đăng nhập một lần có thể mở rộng, bao gồm tiện ích mở rộng Kerberos tích hợp, để tạo điều kiện xác thực người dùng cho các ứng dụng, trang web và tài khoản.

00:02:59.000 --> 00:03:09.000
Và tính năng Đăng nhập một lần đăng ký mới cho phép một ứng dụng tạo điều kiện xác thực người dùng trong và sau quá trình đăng ký Đăng ký người dùng.

00:03:09.000 --> 00:03:15.000
Nhưng phiên này không phải là về danh tính người dùng, mà là về nhận dạng thiết bị.

00:03:15.000 --> 00:03:22.000
Yếu tố tư thế này cho biết thiết bị nào đang thực hiện yêu cầu.

00:03:22.000 --> 00:03:31.000
UDID mà thiết bị báo cáo trong mỗi giao tiếp MDM là cách chính mà máy chủ MDM của bạn biết nó đang quản lý thiết bị nào.

00:03:31.000 --> 00:03:39.000
Truy vấn DeviceInformation cũng cung cấp cho các thuộc tính máy chủ MDM của thiết bị, bao gồm cả số sê-ri.

00:03:39.000 --> 00:03:47.000
Một thiết bị được quản lý thường giao tiếp với các hệ thống khác bên trong tổ chức ngoài máy chủ MDM.

00:03:47.000 --> 00:03:57.000
Vì vậy, thường thì máy chủ MDM định cấu hình thiết bị với chứng chỉ máy khách khai báo danh tính của thiết bị cho các hệ thống khác đó.

00:03:57.000 --> 00:04:07.000
Những phương pháp xác định một thiết bị này đã phục vụ chúng tôi rất tốt, nhưng chúng tương đương với việc tin tưởng rằng thiết bị đó là thiết bị mà nó tuyên bố là như vậy.

00:04:07.000 --> 00:04:14.000
Khi bối cảnh thay đổi, với các thiết bị được phân phối nhiều hơn bao giờ hết, nhu cầu bảo mật của chúng tôi đã phát triển.

00:04:14.000 --> 00:04:24.000
Để giải quyết vấn đề này, tôi rất vui được chia sẻ một phương pháp mới mạnh mẽ để chứng minh danh tính của thiết bị, Chứng thực thiết bị được quản lý.

00:04:24.000 --> 00:04:32.000
Với Chứng thực Thiết bị được Quản lý, một thiết bị cung cấp bằng chứng mạnh mẽ về chính nó khi đưa ra yêu cầu.

00:04:32.000 --> 00:04:39.000
Nó cải thiện thông tin tư thế, vì vậy các đánh giá tin cậy dựa trên điều đó chính xác hơn.

00:04:39.000 --> 00:04:48.000
Nói tóm lại, Chứng thực thiết bị được quản lý có nghĩa là các thiết bị hợp pháp truy cập tài nguyên một cách đáng tin cậy và những kẻ tấn công bị cản trở.

00:04:48.000 --> 00:04:58.000
Bản phát hành này mang đến Chứng thực Thiết bị được Quản lý cho iOS 16, iPadOS 16 và tvOS 16.

00:04:58.000 --> 00:05:10.000
Phiên này chúng ta sẽ bắt đầu với tổng quan về các tính năng chứng thực mới, giải thích lợi ích của việc sử dụng chứng thực và sau đó đi sâu vào chi tiết triển khai.

00:05:10.000 --> 00:05:14.000
Đầu tiên, chứng thực là gì?

00:05:14.000 --> 00:05:18.000
Chứng thực là một tuyên bố về một sự thật.

00:05:18.000 --> 00:05:25.000
Nếu bạn tin tưởng thực thể đưa ra yêu cầu bồi thường, bạn chấp nhận rằng sự thật là đúng.

00:05:25.000 --> 00:05:30.000
Trong phần mềm, chứng thực là một thực tế được ký bằng mật mã.

00:05:30.000 --> 00:05:33.000
Đây thường là chứng chỉ X.509.

00:05:33.000 --> 00:05:38.000
Nếu bạn tin tưởng người ký, bạn chấp nhận rằng sự thật là đúng.

00:05:38.000 --> 00:05:47.000
Đối với Chứng thực Thiết bị được Quản lý, sự thật là danh tính và các thuộc tính khác của thiết bị và người ký là Apple.

00:05:47.000 --> 00:05:51.000
Chấp nhận tính chính xác của những sự thật về thiết bị này đòi hỏi phải tin tưởng Apple.

00:05:51.000 --> 00:05:58.000
Tuy nhiên, nó không yêu cầu tin tưởng vào mọi dòng mã từng được Apple viết.

00:05:58.000 --> 00:06:08.000
Nó chỉ yêu cầu tin tưởng Secure Enclave và các máy chủ chứng thực của Apple, truy cập vào hồ sơ sản xuất và danh mục hệ điều hành của Apple.

00:06:08.000 --> 00:06:15.000
Và nếu bạn giữ dữ liệu của mình trên các thiết bị Apple, bạn hoàn toàn tin tưởng chúng.

00:06:15.000 --> 00:06:20.000
Đây là cách chúng tôi mang sức mạnh của chứng thực đến các thiết bị được quản lý.

00:06:20.000 --> 00:06:26.000
Chứng thực thiết bị được quản lý cung cấp hai cách để sử dụng chứng chỉ chứng thực.

00:06:26.000 --> 00:06:34.000
Chúng tôi đã cải tiến lệnh DeviceInformation MDM, giúp các lợi ích của chứng thực có sẵn cho máy chủ MDM.

00:06:34.000 --> 00:06:50.000
Và chúng tôi đã thêm hỗ trợ cho Môi trường Quản lý Chứng chỉ Tự động, hoặc ACME, giao thức bằng cách thêm tải trọng hồ sơ ACME, điều này làm cho lợi ích của chứng thực có sẵn trong toàn bộ cơ sở hạ tầng của tổ chức.

00:06:50.000 --> 00:06:58.000
Đối với chứng thực DeviceInformation, máy chủ MDM đưa ra truy vấn DeviceInformation và chỉ định một số khóa mới.

00:06:58.000 --> 00:07:05.000
Thiết bị nhận được chứng thực từ các máy chủ của Apple và trả lại cho máy chủ MDM.

00:07:05.000 --> 00:07:10.000
Sau đó, máy chủ MDM đánh giá chứng thực.

00:07:10.000 --> 00:07:11.000
Nhưng hãy cẩn thận.

00:07:11.000 --> 00:07:19.000
Chứng thực DeviceInformation khai báo cho máy chủ MDM, "Một thiết bị tồn tại với các thuộc tính này."

00:07:19.000 --> 00:07:25.000
Nó không chứng minh rằng thiết bị mà máy chủ MDM hiện đang giao tiếp là cùng một thiết bị đó.

00:07:25.000 --> 00:07:31.000
Đối với điều đó, bạn cần chứng thực tải trọng ACME.

00:07:31.000 --> 00:07:37.000
Chứng thực tải trọng ACME cung cấp bằng chứng mạnh mẽ nhất về danh tính của thiết bị.

00:07:37.000 --> 00:07:45.000
Khi bạn cài đặt một hồ sơ chứa tải trọng ACME, thiết bị sẽ yêu cầu chứng chỉ từ máy chủ ACME của tổ chức.

00:07:45.000 --> 00:07:49.000
Điều này rất giống với việc cài đặt tải trọng SCEP.

00:07:49.000 --> 00:07:53.000
Thiết bị cung cấp chứng thực cho máy chủ ACME.

00:07:53.000 --> 00:08:04.000
Dựa trên bằng chứng mạnh mẽ này về danh tính của thiết bị, máy chủ ACME cấp chứng chỉ khách hàng mới mà các máy chủ còn lại của tổ chức bạn tin tưởng.

00:08:04.000 --> 00:08:22.000
Hai tính năng mới này sử dụng chứng chỉ chứng thực để chứng minh một số điều: thiết bị là phần cứng chính hãng của Apple; thiết bị là một thiết bị cụ thể; thiết bị có một số thuộc tính nhất định; và khóa riêng được liên kết với thiết bị.

00:08:22.000 --> 00:08:28.000
Và nó chứng minh cho các máy chủ khác nhau rằng họ đang giao tiếp với cùng một thiết bị.

00:08:28.000 --> 00:08:32.000
Những chứng thực này mang lại lợi ích cho bạn như thế nào?

00:08:32.000 --> 00:08:40.000
Chứng thực chủ yếu là một tính năng bảo mật, vì vậy tôi sẽ mô tả một số mối đe dọa và cách chứng thực giảm thiểu chúng.

00:08:40.000 --> 00:08:47.000
Đầu tiên, một thiết bị bị xâm phạm nằm về các thuộc tính của nó, vì vậy Apple chứng thực các thuộc tính.

00:08:47.000 --> 00:08:52.000
Ngay cả khi hệ điều hành bị xâm phạm, điều đó không ảnh hưởng đến độ tin cậy của chứng thực.

00:08:52.000 --> 00:08:56.000
Nó chỉ yêu cầu Secure Enclave phải còn nguyên vẹn.

00:08:56.000 --> 00:09:03.000
Hoặc một thiết bị bị xâm phạm cung cấp một chứng thực lỗi thời về các thuộc tính đã thay đổi.

00:09:03.000 --> 00:09:09.000
Một nonce trong chứng thực đảm bảo rằng các sự kiện được cập nhật.

00:09:09.000 --> 00:09:12.000
Chứng thực tải trọng ACME giảm thiểu các mối đe dọa khác.

00:09:12.000 --> 00:09:20.000
Một thiết bị bị xâm phạm sẽ gửi số nhận dạng của một thiết bị khác khi giao tiếp với máy chủ MDM.

00:09:20.000 --> 00:09:29.000
Vì vậy, Apple chứng thực số nhận dạng thiết bị theo cách gắn liền với danh tính khách hàng mà thiết bị sử dụng để xác thực kết nối TLS của nó.

00:09:29.000 --> 00:09:37.000
Điều này chứng minh cho máy chủ MDM của bạn và các máy chủ tổ chức khác họ đang giao tiếp với thiết bị nào.

00:09:37.000 --> 00:09:47.000
Hoặc, kẻ tấn công trích xuất khóa riêng tư từ một thiết bị hợp pháp và sử dụng nó để thực hiện các yêu cầu, giả mạo thiết bị hợp pháp.

00:09:47.000 --> 00:09:57.000
Apple chứng thực rằng khóa riêng tư được bảo vệ bởi Secure Enclave, có các biện pháp bảo vệ đặc biệt mạnh mẽ chống lại việc xuất hoặc nhập khóa riêng tư.

00:09:57.000 --> 00:10:06.000
Cuối cùng, kẻ tấn công chiếm đoạt yêu cầu chứng chỉ để có được cơ quan cấp chứng chỉ cho một thiết bị khác.

00:10:06.000 --> 00:10:19.000
Apple chứng thực danh tính của thiết bị yêu cầu theo cách liên kết nó với yêu cầu chứng chỉ, vì vậy cơ quan cấp chứng chỉ chỉ cấp chứng chỉ cho thiết bị hợp pháp.

00:10:19.000 --> 00:10:23.000
Chứng thực cung cấp cho bạn các lợi ích bảo mật giúp giảm thiểu một số mối đe dọa.

00:10:23.000 --> 00:10:26.000
Vậy bạn sử dụng chúng như thế nào trong môi trường của bạn?

00:10:26.000 --> 00:10:31.000
Hãy đi vào chi tiết về cách triển khai Chứng thực Thiết bị được Quản lý.

00:10:31.000 --> 00:10:36.000
Đầu tiên, có những cải tiến cho lệnh DeviceInformation.

00:10:36.000 --> 00:10:40.000
Máy chủ MDM có thể đưa ra lệnh này cho một thiết bị được quản lý.

00:10:40.000 --> 00:10:45.000
Yêu cầu bao gồm một danh sách các thuộc tính mà máy chủ muốn biết.

00:10:45.000 --> 00:10:49.000
Chúng tôi đã thêm một thuộc tính mới, DevicePropertiesAttestation.

00:10:49.000 --> 00:10:56.000
Thêm nó vào mảng Truy vấn có nghĩa là máy chủ MDM đang yêu cầu chứng thực.

00:10:56.000 --> 00:11:04.000
Để đảm bảo rằng chứng thực là mới, máy chủ MDM có thể sử dụng khóa DeviceAttestationNonce.

00:11:04.000 --> 00:11:08.000
Điều này xuất hiện ở cùng cấp độ trong yêu cầu với khóa Truy vấn.

00:11:08.000 --> 00:11:10.000
Chìa khóa này là tùy chọn.

00:11:10.000 --> 00:11:15.000
Giá trị của nó là một đối tượng dữ liệu, với kích thước tối đa là 32 byte.

00:11:15.000 --> 00:11:19.000
Đây là một ví dụ yêu cầu chứng thực.

00:11:19.000 --> 00:11:26.000
Mảng Truy vấn chứa khóa DevicePropertiesAttestation và có 32 byte nonce.

00:11:26.000 --> 00:11:34.000
Khi có được chứng thực thành công, phản hồi chứa khóa DevicePropertiesAttestation.

00:11:34.000 --> 00:11:37.000
Giá trị của nó là một mảng các đối tượng dữ liệu.

00:11:37.000 --> 00:11:42.000
Mỗi phần tử trong mảng là một chứng chỉ trong một chuỗi chứng chỉ.

00:11:42.000 --> 00:11:44.000
Đây là một câu trả lời ví dụ.

00:11:44.000 --> 00:11:53.000
Chứng chỉ lá xuất hiện đầu tiên trong mảng và nó chứa các thuộc tính thiết bị trong các OID tùy chỉnh.

00:11:53.000 --> 00:11:59.000
Hai OID đầu tiên là các thuộc tính nhận dạng thiết bị, số sê-ri và UDID.

00:11:59.000 --> 00:12:05.000
Chúng bị bỏ qua khỏi chứng chỉ nếu đăng ký MDM là Đăng ký Người dùng.

00:12:05.000 --> 00:12:10.000
Các OID còn lại là ẩn danh và có sẵn cho tất cả các loại đăng ký.

00:12:10.000 --> 00:12:17.000
Phiên bản sepOS đề cập đến phiên bản của hệ điều hành chạy trên Secure Enclave.

00:12:17.000 --> 00:12:24.000
Và sự hiện diện của giá trị chính xác trong nonce OID chứng minh rằng chứng chỉ vừa được tạo.

00:12:24.000 --> 00:12:30.000
Khi máy chủ MDM nhận được chứng thực, nó phải xác thực cẩn thận, theo thứ tự sau.

00:12:30.000 --> 00:12:36.000
Nó xác minh rằng chuỗi chứng chỉ bắt nguồn từ cơ quan cấp chứng chỉ Apple dự kiến.

00:12:36.000 --> 00:12:42.000
Cơ quan cấp chứng chỉ Apple có sẵn từ Kho lưu trữ PKI riêng tư của Apple.

00:12:42.000 --> 00:12:50.000
Nó xác minh rằng nonce trong chứng chỉ lá khớp với nonce trong yêu cầu Thông tin Thiết bị, nếu một yêu cầu được chỉ định.

00:12:50.000 --> 00:12:55.000
Và sau đó nó phân tích các OID còn lại và đánh giá các giá trị của chúng.

00:12:55.000 --> 00:13:10.000
Tạo chứng thực mới sử dụng tài nguyên đáng kể trên thiết bị và máy chủ của Apple, vì vậy có giới hạn tỷ lệ về tần suất có thể yêu cầu chứng chỉ chứng thực mới, hiện tại cứ bảy ngày lại có một chứng thực mới.

00:13:10.000 --> 00:13:16.000
Bạn yêu cầu một chứng thực mới bằng cách chỉ định một nonce mới.

00:13:16.000 --> 00:13:24.000
Bỏ qua một nonce chỉ ra rằng độ tươi không phải là một mối quan tâm, vì vậy thiết bị có thể trả lại chứng thực gần đây nhất của nó thay thế.

00:13:24.000 --> 00:13:32.000
Và nếu nonce được chỉ định và khớp với chứng thực được lưu trong bộ nhớ cache, chứng thực được lưu trong bộ nhớ cache sẽ được trả về.

00:13:32.000 --> 00:13:44.000
Khi máy chủ MDM xác thực nonce trong một chứng thực, nó sẽ phát hiện một nonce không khớp và xác định xem điều đó có được mong đợi do bộ nhớ đệm hay không.

00:13:44.000 --> 00:13:50.000
Nhưng đừng yêu cầu chứng thực mới bảy ngày một lần chỉ vì đó là giới hạn tỷ lệ.

00:13:50.000 --> 00:13:58.000
Làm điều đó sẽ chỉ trì hoãn việc máy chủ MDM của bạn phát hiện ra những thay đổi trong thuộc tính thiết bị nhanh như thế nào, chưa kể đến tài nguyên lãng phí.

00:13:58.000 --> 00:14:05.000
Thay vào đó, hãy theo dõi các thay đổi có liên quan trong các thuộc tính DeviceInformation khác, chẳng hạn như phiên bản OS.

00:14:05.000 --> 00:14:10.000
Khi một trong những thay đổi đó, hãy yêu cầu một chứng thực mới.

00:14:10.000 --> 00:14:18.000
Điều này đảm bảo chứng thực được cập nhật nhanh nhất có thể sau khi thay đổi, thay vì chờ giới hạn tỷ lệ hết hạn.

00:14:18.000 --> 00:14:29.000
Và, chỉ trong trường hợp thiết bị bị xâm phạm và nói dối về các thuộc tính khác này, thỉnh thoảng hãy đưa ra yêu cầu ngẫu nhiên về một chứng thực mới để giữ cho thiết bị trung thực.

00:14:29.000 --> 00:14:33.000
Yêu cầu chứng thực có thể thất bại.

00:14:33.000 --> 00:14:38.000
Khi điều đó xảy ra, thiết bị vẫn phản hồi nhưng một số thông tin bị bỏ qua.

00:14:38.000 --> 00:14:47.000
Trường DevicePropertiesAttestation bị bỏ qua khỏi phản hồi, hoặc một OID dự kiến hoặc giá trị của nó bị bỏ qua.

00:14:47.000 --> 00:14:55.000
Có nhiều lý do tiềm ẩn cho sự cố: thiết bị gặp sự cố mạng đến các máy chủ chứng thực của Apple.

00:14:55.000 --> 00:15:02.000
Không có máy chủ nào hoạt động 100% thời gian, vì vậy có thể có vấn đề với các máy chủ chứng thực của Apple.

00:15:02.000 --> 00:15:08.000
Hoặc phần cứng hoặc phần mềm của thiết bị có thể bị xâm phạm, hoặc nó thậm chí không phải là phần cứng chính hãng của Apple.

00:15:08.000 --> 00:15:17.000
Trong ba trường hợp cuối cùng này, các máy chủ chứng thực của Apple từ chối đưa ra chứng thực cho các thuộc tính mà họ không thể xác minh.

00:15:17.000 --> 00:15:24.000
Các nguyên nhân khác nhau của việc chứng thực không thành công bao gồm từ trục trặc mạng vô hại đến tấn công chủ động.

00:15:24.000 --> 00:15:30.000
Thật không may, không có cách nào đáng tin cậy để máy chủ MDM biết nguyên nhân chính xác.

00:15:30.000 --> 00:15:39.000
Điều này là do nguồn thông tin duy nhất về sự cố là bản thân thiết bị, có thể là một thiết bị bị xâm phạm đang nói dối.

00:15:39.000 --> 00:15:43.000
Vậy máy chủ MDM nên giải thích lỗi như thế nào?

00:15:43.000 --> 00:15:48.000
Đừng lúc nào cũng giả định điều tồi tệ nhất khi chứng thực thất bại.

00:15:48.000 --> 00:15:52.000
Nếu bạn có kiến trúc không tin cậy, đây là cách bạn có thể xử lý nó.

00:15:52.000 --> 00:16:02.000
Tổ chức tính toán điểm tin cậy cho thiết bị, với chứng thực cũ không thành công hoặc bất ngờ làm giảm điểm đó.

00:16:02.000 --> 00:16:15.000
Điểm tin cậy thấp hơn kích hoạt các hành động khác nhau, chẳng hạn như từ chối quyền truy cập vào các dịch vụ, gắn cờ thiết bị để điều tra thủ công hoặc khắc phục bằng cách xóa nó và thu hồi chứng chỉ của nó.

00:16:15.000 --> 00:16:20.000
Điều này đảm bảo phản hồi thích hợp đối với chứng thực không thành công.

00:16:20.000 --> 00:16:24.000
Hãy chuyển sang triển khai chứng thực tải trọng ACME.

00:16:24.000 --> 00:16:28.000
Cài đặt tải trọng ACME bao gồm một số bước.

00:16:28.000 --> 00:16:33.000
Tôi sẽ mô tả những người tham gia khác nhau trong quy trình, sau đó là từng bước đó.

00:16:33.000 --> 00:16:38.000
Chúng tôi bắt đầu với iPhone, iPad hoặc Apple TV.

00:16:38.000 --> 00:16:43.000
Trong hầu hết các trường hợp, điều này được quản lý bởi một máy chủ MDM.

00:16:43.000 --> 00:16:45.000
Có một máy chủ ACME.

00:16:45.000 --> 00:16:56.000
Điều này triển khai giao thức ACME, RFC 8555, vì vậy nó có thể cấp chứng chỉ khách hàng từ cơ quan cấp chứng chỉ tổ chức.

00:16:56.000 --> 00:17:03.000
Và có các máy chủ chứng thực của Apple phát hành các chứng thực.

00:17:03.000 --> 00:17:10.000
Bước đầu tiên là để máy chủ MDM cài đặt một hồ sơ chứa tải trọng ACME.

00:17:10.000 --> 00:17:27.000
Tải trọng chỉ định các thuộc tính của khóa mà thiết bị sẽ tạo, các thuộc tính của chứng chỉ mà thiết bị sẽ yêu cầu và cách yêu cầu chứng chỉ từ máy chủ ACME.

00:17:27.000 --> 00:17:33.000
Để bắt đầu cài đặt hồ sơ, thiết bị sẽ tạo ra loại khóa được yêu cầu.

00:17:33.000 --> 00:17:38.000
Để sử dụng chứng thực, chìa khóa phải bị ràng buộc bởi phần cứng.

00:17:38.000 --> 00:17:47.000
Trong khi tải trọng ACME hỗ trợ RSA và các kích cỡ khóa khác nhau, để có được khóa ràng buộc phần cứng, bạn phải sử dụng ECSECPrimeRandom.

00:17:47.000 --> 00:17:58.000
Lựa chọn tốt nhất của bạn là khóa ECSECPrimeRandom 384 bit vì đó là khóa ràng buộc phần cứng bảo mật cao nhất.

00:17:58.000 --> 00:18:05.000
Khi khóa được tạo, thiết bị sẽ liên hệ ban đầu với máy chủ ACME.

00:18:05.000 --> 00:18:14.000
Thiết bị yêu cầu DirectoryURL, chỉ định các URL để sử dụng cho phần còn lại của quá trình giao tiếp với máy chủ ACME.

00:18:14.000 --> 00:18:18.000
Sau đó hai hệ thống tạo một tài khoản và một đơn đặt hàng.

00:18:18.000 --> 00:18:24.000
Máy chủ cung cấp loại xác thực device-attest-01.

00:18:24.000 --> 00:18:32.000
Sau đó, máy chủ ACME tạo ra một nonce và gửi nó đến thiết bị trong trường mã thông báo.

00:18:32.000 --> 00:18:36.000
Giao thức ACME ban đầu được sử dụng để cấp chứng chỉ máy chủ.

00:18:36.000 --> 00:18:50.000
Tuy nhiên, ở đây, loại xác thực mà chúng tôi sử dụng đã được giới thiệu trong bản nháp IETF chỉ định phần mở rộng của giao thức ACME để nhận chứng thực và cấp chứng chỉ khách hàng.

00:18:50.000 --> 00:18:53.000
Chứng thực là tùy chọn.

00:18:53.000 --> 00:18:59.000
Khi tải trọng chỉ định chứng thực, thiết bị yêu cầu chứng thực từ Apple.

00:18:59.000 --> 00:19:03.000
Điều này gần giống với chứng thực DeviceInformation.

00:19:03.000 --> 00:19:10.000
Nó sử dụng cùng một OID và các OID nhận dạng thiết bị bị bỏ qua cho Đăng ký Người dùng.

00:19:10.000 --> 00:19:13.000
Nhưng có một vài sự khác biệt.

00:19:13.000 --> 00:19:20.000
Nonce được băm bằng SHA-256 trước khi nhúng nó vào chứng thực.

00:19:20.000 --> 00:19:25.000
Nonce đến từ máy chủ ACME, không phải máy chủ MDM.

00:19:25.000 --> 00:19:33.000
Và khóa riêng khớp với chứng chỉ lá chứng thực là khóa mà thiết bị vừa tạo.

00:19:33.000 --> 00:19:42.000
Chứng chỉ chứng thực khớp với khóa riêng, tuy nhiên chứng chỉ đó không thể được sử dụng cho bất kỳ mục đích nào ngoài chứng thực.

00:19:42.000 --> 00:19:53.000
Vì vậy, thiết bị yêu cầu từ máy chủ ACME một chứng chỉ khác khớp với khóa riêng và chứng chỉ này tốt cho TLS.

00:19:53.000 --> 00:20:00.000
Thiết bị cung cấp yêu cầu ký chứng chỉ chứa các thuộc tính yêu cầu chứng chỉ từ tải trọng.

00:20:00.000 --> 00:20:03.000
Nó cung cấp chuỗi chứng thực.

00:20:03.000 --> 00:20:08.000
Và nó cung cấp Mã định danh khách hàng từ tải trọng ACME.

00:20:08.000 --> 00:20:15.000
Thông thường, điều này được sử dụng như một vé tốt cho việc cấp một chứng chỉ duy nhất, để ngăn chặn các yêu cầu lặp đi lặp lại.

00:20:15.000 --> 00:20:23.000
Máy chủ ACME phải xác thực cẩn thận yêu cầu trước khi cấp chứng chỉ, theo thứ tự này.

00:20:23.000 --> 00:20:28.000
Nó phải xác minh rằng ClientIdentifier hợp lệ và không được sử dụng.

00:20:28.000 --> 00:20:34.000
Chứng chỉ chứng thực phải được xâu chuỗi với Apple CA chính xác.

00:20:34.000 --> 00:20:40.000
Khóa công khai trong chứng chỉ lá chứng thực phải khớp với CSR.

00:20:40.000 --> 00:20:47.000
Nonce phải khớp với hàm băm SHA-256 của hàm băm mà máy chủ ACME đã gửi trước đó.

00:20:47.000 --> 00:20:52.000
Và sau đó máy chủ ACME có thể đánh giá các OID còn lại.

00:20:52.000 --> 00:20:55.000
Và hãy nhớ rằng chứng thực có thể thất bại.

00:20:55.000 --> 00:21:05.000
Máy chủ ACME nên xem xét cẩn thận lỗi khi cấp chứng chỉ, giống như chúng tôi đã xem xét với chứng thực không thành công trong trường hợp Thông tin thiết bị.

00:21:05.000 --> 00:21:08.000
Từ đây, mọi thứ nhanh chóng kết thúc.

00:21:08.000 --> 00:21:17.000
Máy chủ ACME cấp chứng chỉ máy khách từ tổ chức CA và trả lại cho thiết bị.

00:21:17.000 --> 00:21:22.000
Máy chủ ACME là cơ quan cuối cùng để cấp chứng chỉ khách hàng.

00:21:22.000 --> 00:21:28.000
Nó có thể chọn tôn trọng hoặc ghi đè các thuộc tính trong CSR như SubjectAltName.

00:21:28.000 --> 00:21:36.000
Thiết bị lưu trữ chứng chỉ trong móc khóa và điều này hoàn tất việc cài đặt tải trọng ACME.

00:21:36.000 --> 00:21:39.000
Hãy kết hợp tất cả những điều này lại với nhau.

00:21:39.000 --> 00:21:45.000
Làm thế nào để các máy chủ biết thiết bị giao tiếp với họ là thiết bị mà nó tuyên bố là?

00:21:45.000 --> 00:21:58.000
Thiết bị sử dụng cùng một khóa riêng theo nhiều cách: khi nhận chứng thực từ Apple, khi nhận chứng chỉ máy khách từ máy chủ ACME và khi sử dụng TLS để giao tiếp với các máy chủ khác.

00:21:58.000 --> 00:22:05.000
Bởi vì chìa khóa bị ràng buộc bởi phần cứng, chúng tôi biết tất cả những hành động này được thực hiện bởi cùng một thiết bị.

00:22:05.000 --> 00:22:11.000
Và chúng tôi có một chứng chỉ chứng thực mô tả thiết bị đó.

00:22:11.000 --> 00:22:21.000
Kết hợp những điều này, các máy chủ tổ chức hiện có niềm tin vào danh tính của thiết bị khi cấp quyền truy cập.

00:22:21.000 --> 00:22:30.000
Cũng giống như với chứng chỉ và tải trọng SCEP, các tải trọng khác trong hồ sơ có thể tham chiếu tải trọng ACME để sử dụng chứng chỉ.

00:22:30.000 --> 00:22:36.000
Sử dụng nó cho MDM, Wi-Fi, VPN, Kerberos, Safari.

00:22:36.000 --> 00:22:42.000
Tất cả các hệ thống này đều được hưởng lợi từ chứng thực.

00:22:42.000 --> 00:22:48.000
Một thiết bị có thể có tối đa 10 tải trọng ACME sử dụng chứng thực được cài đặt cùng một lúc.

00:22:48.000 --> 00:22:58.000
Lưu ý rằng các khóa ràng buộc phần cứng không được giữ nguyên khi bản sao lưu của thiết bị được quản lý được khôi phục, ngay cả khi khôi phục vào cùng một thiết bị.

00:22:58.000 --> 00:23:10.000
Và nếu bạn không làm gì khác với Chứng thực thiết bị được quản lý, hãy sử dụng tải trọng ACME cho danh tính máy khách MDM để máy chủ MDM có thể chắc chắn nó đang quản lý thiết bị nào.

00:23:10.000 --> 00:23:12.000
Hãy kết thúc.

00:23:12.000 --> 00:23:17.000
Bạn sử dụng Chứng thực thiết bị được quản lý để khắc phục nhiều loại mối đe dọa.

00:23:17.000 --> 00:23:27.000
Bạn tận dụng chứng thực DeviceInformation để cải thiện thành phần nhận dạng thiết bị của tư thế để đánh giá độ tin cậy tốt hơn.

00:23:27.000 --> 00:23:35.000
Và, bây giờ bạn có thể chứng minh danh tính của thiết bị khi nó truy cập tài nguyên tổ chức bằng chứng thực ACME.

00:23:35.000 --> 00:23:40.000
Chúng tôi mong muốn bạn triển khai Chứng thực Thiết bị được Quản lý.

00:23:40.000 --> 00:23:44.000
Cùng nhau, chúng tôi sẽ cải thiện tính bảo mật của việc triển khai thiết bị của bạn.

00:23:44.000 --> 23:59:59.000
Cảm ơn bạn, và chúc bạn có một WWDC tuyệt vời.

