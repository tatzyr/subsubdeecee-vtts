WEBVTT

00:00:00.000 --> 00:00:03.000
♪ Nhạc hip-hop nhạc cụ êm dịu ♪

00:00:03.000 --> 00:00:09.000
♪

00:00:09.000 --> 00:00:12.000
Xin chào mọi người! Tên tôi là Ankur Soni.

00:00:12.000 --> 00:00:16.000
Tôi là quản lý kỹ thuật trong nhóm Dịch vụ Bản đồ tại Apple.

00:00:16.000 --> 00:00:21.000
Hôm nay, chúng ta sẽ xem xét một số khả năng mới thú vị đến với hệ sinh thái nhà phát triển Bản đồ.

00:00:21.000 --> 00:00:23.000
Vậy hãy bắt đầu nào.

00:00:23.000 --> 00:00:28.000
Ứng dụng Bản đồ của chúng tôi cung cấp nhiều trải nghiệm người dùng cuối khác nhau cho khách hàng của Apple trên toàn cầu.

00:00:28.000 --> 00:00:38.000
Chúng tôi trao quyền cho các nhà phát triển tạo ra trải nghiệm định vị địa lý tuyệt đẹp cho các ứng dụng và trang web của họ thông qua các dịch vụ MapKit và MapKit JS của chúng tôi.

00:00:38.000 --> 00:00:43.000
Tuy nhiên, việc cung cấp nhà phát triển Apple Maps của chúng tôi luôn lấy khách hàng làm trung tâm.

00:00:43.000 --> 00:00:47.000
Chúng tôi đã lắng nghe cẩn thận tất cả phản hồi tuyệt vời của bạn.

00:00:47.000 --> 00:00:54.000
Bạn muốn có một cách để tăng cường dữ liệu của riêng bạn trên MapKit mà không ảnh hưởng đến hiệu suất hoặc sức mạnh.

00:00:54.000 --> 00:01:01.000
Vì vậy, để hoàn thiện hệ sinh thái của chúng tôi, chúng tôi rất vui mừng được giới thiệu các API Máy chủ Apple Maps.

00:01:01.000 --> 00:01:12.000
Chúng tôi đang giới thiệu bốn API máy chủ mới: Mã hóa địa lý, Mã hóa địa lý ngược, Tìm kiếm, Thời gian đến dự kiến - hoặc ETA.

00:01:12.000 --> 00:01:20.000
Các API này sẽ giúp bạn giải quyết nhiều trường hợp sử dụng khác nhau trong khi tích hợp Bản đồ vào các ứng dụng của bạn.

00:01:20.000 --> 00:01:26.000
Với Geocoding APIs, bạn có thể chuyển đổi một địa chỉ thành tọa độ địa lý vĩ độ và kinh độ.

00:01:26.000 --> 00:01:33.000
Tương tự, với Mã hóa địa lý ngược, bạn có thể làm ngược lại - đi từ tọa độ địa lý đến một địa chỉ.

00:01:33.000 --> 00:01:43.000
Với API Tìm kiếm, bạn có thể cung cấp cho người dùng khả năng nhập chuỗi tìm kiếm để khám phá các địa điểm như doanh nghiệp, điểm quan tâm và hơn thế nữa.

00:01:43.000 --> 00:01:47.000
Có thể bạn muốn phủ lên một số dữ liệu của riêng mình và trình bày nó cho người dùng.

00:01:47.000 --> 00:01:56.000
Với ETA API, bạn có thể giúp khách hàng của mình biết được doanh nghiệp của bạn cách họ bao xa hoặc thực hiện một số tính toán để tìm cửa hàng gần nhất.

00:01:56.000 --> 00:02:00.000
Khả năng là vô tận!

00:02:00.000 --> 00:02:05.000
Chúng tôi nghĩ rằng bạn sẽ yêu thích API máy chủ vì ba lý do quan trọng.

00:02:05.000 --> 00:02:13.000
Bây giờ bạn có thể cung cấp trải nghiệm liền mạch bằng cách tận dụng MapKit, MapKit JS và Apple Maps Server APIs mới.

00:02:13.000 --> 00:02:18.000
Điều này sẽ đơn giản hóa kiến trúc ứng dụng của bạn mang lại cho bạn một ngăn xếp Apple Maps đầy đủ.

00:02:18.000 --> 00:02:20.000
Điều này sẽ làm cho cuộc sống của bạn dễ dàng hơn nhiều.

00:02:20.000 --> 00:02:21.000
Chắc chắn, nó đã giúp tôi.

00:02:21.000 --> 00:02:24.000
Nhưng này, tôi thiên vị!

00:02:24.000 --> 00:02:27.000
Lợi ích tiếp theo là giảm các cuộc gọi mạng.

00:02:27.000 --> 00:02:38.000
Nhiều lần, chúng ta thấy mình trong tình huống mà chúng ta đang thực hiện các yêu cầu lặp đi lặp lại và dư thừa từ các thiết bị của người dùng như iPhone, iPad, trang web, v.v.

00:02:38.000 --> 00:02:44.000
Có thể bạn đang tra cứu cùng một địa chỉ lặp đi lặp lại từ ứng dụng của bạn đang chạy trên các thiết bị người dùng khác nhau.

00:02:44.000 --> 00:02:48.000
Điều này gây ra rất nhiều cuộc gọi mạng và lãng phí băng thông.

00:02:48.000 --> 00:02:58.000
Ủy thác hoạt động chung này cho máy chủ của bạn và chỉ thực hiện nó một lần ở phía sau bằng cách sử dụng API máy chủ sẽ giúp ứng dụng của bạn tiêu thụ ít băng thông hơn.

00:02:58.000 --> 00:03:09.000
Một tác dụng phụ tuyệt vời của điều này là bây giờ ứng dụng của bạn cũng tiết kiệm năng lượng, vì một số quá trình xử lý hiện được ủy quyền cho máy chủ của bạn bằng API Máy chủ Apple Maps.

00:03:09.000 --> 00:03:12.000
Bây giờ hãy lấy một số API này để quay.

00:03:12.000 --> 00:03:17.000
Giả sử chúng tôi đang xây dựng các thẻ liên hệ này cho ứng dụng định vị cửa hàng của bạn.

00:03:17.000 --> 00:03:22.000
Ở đây chúng tôi thấy ba cửa hàng với địa chỉ và khoảng cách từ vị trí của khách hàng.

00:03:22.000 --> 00:03:29.000
Trong ví dụ này, chúng tôi sẽ giả định rằng khách hàng đã cung cấp vị trí của họ.

00:03:29.000 --> 00:03:32.000
Hiện tại, hãy tập trung vào việc xây dựng một trong những thẻ liên lạc này.

00:03:32.000 --> 00:03:41.000
Chúng tôi sẽ giả định rằng những địa chỉ này nằm trên một máy chủ lưu trữ và phục vụ vị trí của các hiệu sách truyện tranh.

00:03:41.000 --> 00:03:47.000
Có nhiều cách để xây dựng điều này, nhưng trong một giây, hãy giả sử chúng ta không có các API máy chủ mới này.

00:03:47.000 --> 00:03:49.000
Một kiến trúc cơ bản sẽ trông như thế nào?

00:03:49.000 --> 00:03:52.000
Ứng dụng khách hàng của bạn sẽ lấy dữ liệu này như thế nào?

00:03:52.000 --> 00:03:58.000
Trong sơ đồ này, ứng dụng của chúng tôi đang thực hiện cuộc gọi đến máy chủ để lấy danh sách các địa chỉ cửa hàng.

00:03:58.000 --> 00:04:04.000
Máy chủ phụ trợ trả về một danh sách các địa chỉ cửa hàng cho thiết bị khách hàng của bạn.

00:04:04.000 --> 00:04:13.000
Vì chúng tôi không có API máy chủ trong ví dụ này, bây giờ ứng dụng khách của chúng tôi phải thực hiện các hành động khác nhau trên địa chỉ để xây dựng thẻ liên hệ.

00:04:13.000 --> 00:04:20.000
Để thực hiện một tác vụ duy nhất, một khách hàng có thể phải thực hiện nhiều cuộc gọi đến các dịch vụ phụ trợ khác nhau.

00:04:20.000 --> 00:04:29.000
Tại đây bạn có thể thấy rằng ứng dụng khách đang thực hiện cuộc gọi trực tiếp đến Máy chủ Apple Maps, bằng cách sử dụng MapKit hoặc MapKit JS.

00:04:29.000 --> 00:04:36.000
Sự trò chuyện này giữa máy khách và mặt sau có thể ảnh hưởng xấu đến hiệu suất và quy mô của ứng dụng.

00:04:36.000 --> 00:04:47.000
Qua mạng di động có độ trễ cao điển hình, việc sử dụng các yêu cầu riêng lẻ theo cách này là không hiệu quả và có thể dẫn đến kết nối bị hỏng hoặc yêu cầu không đầy đủ.

00:04:47.000 --> 00:04:58.000
Mặc dù mỗi yêu cầu có thể được thực hiện song song, ứng dụng phải gửi, chờ và xử lý dữ liệu cho mỗi yêu cầu trên tất cả các kết nối riêng biệt làm tăng khả năng thất bại.

00:04:58.000 --> 00:05:02.000
Cuối cùng, bạn sẽ phải hợp nhất tất cả các phản hồi trên khách hàng.

00:05:02.000 --> 00:05:07.000
Và trong khi tất cả các cuộc gọi này xảy ra, bạn đang hiển thị một con quay cho người dùng.

00:05:07.000 --> 00:05:12.000
Thêm vào đó, thiết bị khách hàng đang sử dụng nhiều băng thông và năng lượng hơn cho các cuộc gọi bổ sung này.

00:05:12.000 --> 00:05:14.000
Đó không phải là một trải nghiệm người dùng tốt.

00:05:14.000 --> 00:05:20.000
Bây giờ, hãy xem xét một kiến trúc mô hình với quyền truy cập vào Apple Maps Server APIs.

00:05:20.000 --> 00:05:27.000
Bạn có thể bắt đầu sử dụng máy chủ phụ trợ của mình như một cổng để giảm sự trò chuyện giữa máy khách và các dịch vụ.

00:05:27.000 --> 00:05:34.000
Cũng giống như trước đây, ở đây chúng tôi yêu cầu một danh sách các cửa hàng được hiển thị từ khách hàng của bạn.

00:05:34.000 --> 00:05:39.000
Tiếp theo, chúng tôi đưa ra yêu cầu từ máy chủ để thực hiện mã hóa địa lý.

00:05:39.000 --> 00:05:45.000
Sau đó chúng tôi nhận được phản hồi cho từng API từ Máy chủ Apple Maps.

00:05:45.000 --> 00:05:52.000
Máy chủ truyện tranh kết hợp các phản hồi từ mỗi dịch vụ và gửi phản hồi đến ứng dụng.

00:05:52.000 --> 00:06:02.000
Mô hình này có thể giảm số lượng yêu cầu mà ứng dụng thực hiện cho các dịch vụ phụ trợ và cải thiện hiệu suất ứng dụng trên các mạng có độ trễ cao.

00:06:02.000 --> 00:06:07.000
Tóm lại, khách hàng của bạn thực hiện một cuộc gọi đến máy chủ của bạn để lấy danh sách các cửa hàng.

00:06:07.000 --> 00:06:16.000
Máy chủ của bạn sau đó thực hiện công việc nặng nhọc để thực hiện các lệnh gọi API thích hợp để soạn phản hồi phù hợp nhất với người dùng của bạn.

00:06:16.000 --> 00:06:19.000
Vì vậy, hãy quay lại ví dụ nghiên cứu điển hình của chúng tôi ở đây.

00:06:19.000 --> 00:06:24.000
Chúng tôi sẽ sử dụng Geocoding và ETA API để có khoảng cách đến cửa hàng.

00:06:24.000 --> 00:06:33.000
Chúng ta có thể sử dụng Geocode API để tìm vĩ độ và kinh độ cho các địa chỉ cửa hàng, sau này chúng ta sẽ sử dụng để tính toán ETA.

00:06:33.000 --> 00:06:42.000
Trong ví dụ này, trước tiên, chúng ta sẽ lấy địa chỉ cho cửa hàng truyện tranh và URL mã hóa nó.

00:06:42.000 --> 00:06:50.000
Tiếp theo, chúng tôi sẽ sử dụng Geocode API và chuyển địa chỉ được mã hóa URL này làm tham số truy vấn.

00:06:50.000 --> 00:06:55.000
Chúng tôi sẽ bỏ qua các chi tiết xác thực ngay bây giờ và quay lại với nó trong một vài trang trình bày.

00:06:55.000 --> 00:07:01.000
Trong phản hồi, bạn có thể thấy vĩ độ và kinh độ của địa chỉ được trả về.

00:07:01.000 --> 00:07:06.000
Chúng tôi sẽ lặp lại quy trình tương tự để tìm vĩ độ và kinh độ cho địa chỉ của khách hàng.

00:07:06.000 --> 00:07:10.000
Điều này sau này sẽ được sử dụng để tính toán ETA.

00:07:10.000 --> 00:07:13.000
Như bạn có thể thấy, có nhiều trường hơn trong phản hồi.

00:07:13.000 --> 00:07:18.000
Tôi sẽ liên kết tài liệu chi tiết trong phần Tài nguyên bên dưới.

00:07:18.000 --> 00:07:26.000
Bây giờ, chúng ta có thể đặt nguồn gốc và điểm đến trên API ETA với dữ liệu chúng ta nhận được từ Geocode API.

00:07:26.000 --> 00:07:34.000
Như tôi đã đề cập trước đây, chúng ta có vĩ độ gốc, kinh độ và vĩ độ đích, kinh độ.

00:07:34.000 --> 00:07:38.000
Chúng tôi có thể chỉ định tối đa 10 điểm đến ở đây nếu cần.

00:07:38.000 --> 00:07:47.000
Chúng tôi sẽ cung cấp thông số đó trong API ETA dưới dạng tham số truy vấn nguồn gốc và đích được mã hóa URL.

00:07:47.000 --> 00:07:53.000
Phản hồi cho API là một danh sách các ETA, một cho mỗi điểm đến được cung cấp.

00:07:53.000 --> 00:07:58.000
Trong trường hợp này, chúng tôi chỉ có một vì chúng tôi đã cung cấp một điểm đến.

00:07:58.000 --> 00:08:04.000
Ở đây cho ví dụ của chúng tôi, chúng tôi quan tâm đến distanceMeters để tính toán khoảng cách đến cửa hàng.

00:08:04.000 --> 00:08:12.000
Với điều này, chúng tôi có tất cả các phần chúng tôi cần: địa chỉ cửa hàng và khoảng cách để người dùng đến cửa hàng của bạn.

00:08:12.000 --> 00:08:19.000
Bạn cũng có thể chọn tăng cường hoặc phủ lên dữ liệu này bằng thông tin cửa hàng của riêng bạn, như giờ cửa hàng.

00:08:19.000 --> 00:08:25.000
Bằng cách này, bạn có thể tận dụng các API máy chủ khác nhau để xây dựng các ứng dụng của mình.

00:08:25.000 --> 00:08:29.000
Đối với các API khác, vui lòng tham khảo tài liệu được liên kết bên dưới bài nói chuyện này.

00:08:29.000 --> 00:08:33.000
Một phần quan trọng mà chúng tôi chưa nói đến là xác thực.

00:08:33.000 --> 00:08:37.000
Tất cả các API Máy chủ Apple Maps đều được xác thực.

00:08:37.000 --> 00:08:41.000
Nếu bạn đang sử dụng MapKit JS, bạn đã đi được nửa chặng đường.

00:08:41.000 --> 00:08:47.000
Apple Maps Server APIs sử dụng cơ chế tương tự như MapKit JS để xác thực.

00:08:47.000 --> 00:08:51.000
Đầu tiên, bạn sẽ tải xuống khóa riêng tư từ tài khoản nhà phát triển của mình.

00:08:51.000 --> 00:08:56.000
Sau đó, bạn sẽ sử dụng khóa riêng này để tạo mã thông báo xác thực Bản đồ ở định dạng JWT.

00:08:56.000 --> 00:09:00.000
Có một tài liệu chi tiết về cách tạo một tài liệu được liên kết bên dưới.

00:09:00.000 --> 00:09:06.000
Sau đó, bạn có thể trao đổi mã thông báo xác thực Bản đồ này bằng cách sử dụng API mã thông báo để nhận mã thông báo truy cập Bản đồ.

00:09:06.000 --> 00:09:13.000
Chúng tôi sẽ xác thực mã thông báo xác thực Bản đồ ở mặt sau và gửi lại mã thông báo truy cập Bản đồ.

00:09:13.000 --> 00:09:18.000
Cái này ở định dạng JWT và sẽ được sử dụng cho tất cả các tương tác API.

00:09:18.000 --> 00:09:25.000
Mã thông báo truy cập này cần được làm mới sau mỗi 30 phút bằng cách lặp lại quy trình được đánh dấu ở đây.

00:09:25.000 --> 00:09:35.000
Bây giờ chúng ta đã thấy quy trình xác thực trông như thế nào, đây là một ví dụ đơn giản về cách sử dụng API mã thông báo để tìm nạp mã thông báo truy cập.

00:09:35.000 --> 00:09:39.000
Chúng tôi đang sử dụng mã thông báo API ở đây.

00:09:39.000 --> 00:09:43.000
Chúng tôi đang chuyển mã thông báo xác thực Bản đồ dưới dạng tiêu đề.

00:09:43.000 --> 00:09:48.000
Bạn sẽ nhận lại mã thông báo truy cập Bản đồ có thể được sử dụng để truy cập API.

00:09:48.000 --> 00:09:55.000
Điều này sẽ ở định dạng JWT và sẽ có các trường tiêu chuẩn như hết hạn, phát hành At, v.v.

00:09:55.000 --> 00:10:01.000
Để thuận tiện, trường expiresInSeconds hiển thị mã thông báo có hiệu lực trong bao lâu.

00:10:01.000 --> 00:10:04.000
Trong trường hợp này, đó là 30 phút.

00:10:04.000 --> 00:10:10.000
Hãy nhớ rằng mã thông báo xác thực Bản đồ không giống như mã thông báo truy cập Bản đồ.

00:10:10.000 --> 00:10:18.000
Bạn trao đổi mã thông báo xác thực Bản đồ để nhận mã thông báo truy cập Bản đồ dài 30 phút để truy cập API máy chủ.

00:10:18.000 --> 00:10:24.000
Chúng ta hãy xem nhanh tương tác API với mã thông báo truy cập Maps trông như thế nào.

00:10:24.000 --> 00:10:29.000
Chúng tôi sẽ chuyển mã thông báo truy cập Bản đồ cùng với lệnh gọi API máy chủ.

00:10:29.000 --> 00:10:34.000
Nó được thêm vào dưới dạng tiêu đề cho lệnh gọi API, giống như chúng ta đã thấy một vài trang trình bày trước đây.

00:10:34.000 --> 00:10:37.000
Máy chủ Apple Maps sẽ xác thực mã thông báo truy cập Maps.

00:10:37.000 --> 00:10:44.000
Khi xác thực thành công, Máy chủ Apple Maps sẽ phản hồi bằng phản hồi API.

00:10:44.000 --> 00:10:50.000
Bây giờ tôi đã đề cập đến API và xác thực, hãy để tôi nói về giới hạn sử dụng.

00:10:50.000 --> 00:10:55.000
Quyền lực lớn đi kèm với trách nhiệm lớn, vì vậy hãy sử dụng hạn ngạch của bạn một cách khôn ngoan.

00:10:55.000 --> 00:11:01.000
Có giới hạn hàng ngày về số lượng lệnh gọi API bạn có thể thực hiện và nó rất lớn!

00:11:01.000 --> 00:11:05.000
Bạn sẽ nhận được tổng cộng 25.000 cuộc gọi dịch vụ mỗi ngày.

00:11:05.000 --> 00:11:11.000
Hãy nhớ rằng, các dịch vụ gọi điện qua MapKit JS và API máy chủ sử dụng cùng một hạn ngạch.

00:11:11.000 --> 00:11:14.000
Nếu bạn cần thêm, vui lòng liên hệ với chúng tôi.

00:11:14.000 --> 00:11:18.000
Vậy, làm thế nào để bạn theo dõi tất cả những điều này?

00:11:18.000 --> 00:11:23.000
Bạn có thể xem số liệu thống kê sử dụng của mình tại bảng điều khiển dành cho nhà phát triển Bản đồ.

00:11:23.000 --> 00:11:24.000
Có ai đang sử dụng MapKit JS không?

00:11:24.000 --> 00:11:27.000
Điều này sẽ trông rất quen thuộc với bạn.

00:11:27.000 --> 00:11:34.000
Việc sử dụng API máy chủ được phân loại là Dịch vụ, bạn có thể thấy được đánh dấu ở đây.

00:11:34.000 --> 00:11:50.000
Khi vượt quá hạn ngạch hàng ngày, có nghĩa là hơn 25.000 cuộc gọi API máy chủ, chúng tôi sẽ bắt đầu từ chối các cuộc gọi dịch vụ mới và phản hồi với trạng thái HTTP 429, có nghĩa là quá nhiều yêu cầu.

00:11:50.000 --> 00:11:55.000
Bạn nên đảm bảo rằng trải nghiệm ứng dụng xuống cấp một cách duyên dáng trong những tình huống như vậy.

00:11:55.000 --> 00:12:07.000
Trong những tình huống hiếm hoi, khi dịch vụ của bạn thực hiện một số lượng yêu cầu bất thường - có thể là do một số lỗi trong mã hoặc cơ sở hạ tầng của bạn - bạn cũng có thể nhận được trạng thái HTTP 429.

00:12:07.000 --> 00:12:13.000
Khi bạn nhận được HTTP 429, điều quan trọng là không chỉ đơn giản là lặp lại nhiều lần trong việc đưa ra các yêu cầu.

00:12:13.000 --> 00:12:18.000
Một cách tiếp cận tốt hơn là thử lại với sự chậm trễ ngày càng tăng giữa các lần thử.

00:12:18.000 --> 00:12:21.000
Cách tiếp cận này được gọi là lùi theo cấp số nhân.

00:12:21.000 --> 00:12:24.000
Vậy, hôm nay chúng ta đã học được gì?

00:12:24.000 --> 00:12:27.000
Chúng tôi đang phát hành bốn API máy chủ mới.

00:12:27.000 --> 00:12:33.000
Các API này là Mã hóa địa lý, Mã hóa địa lý ngược, Tìm kiếm và ETA.

00:12:33.000 --> 00:12:42.000
Sử dụng các API này kết hợp với MapKit và MapKit JS sẽ giúp bạn kiến trúc tốt hơn các ứng dụng của mình bằng cách sử dụng ngăn xếp Apple Maps.

00:12:42.000 --> 00:12:51.000
Bạn có thể tối ưu hóa các cuộc gọi dự phòng và lặp đi lặp lại bằng cách ủy thác các tác vụ đó cho máy chủ phụ trợ của mình bằng cách sử dụng API Máy chủ Apple Maps.

00:12:51.000 --> 00:12:58.000
Hạn ngạch hàng ngày cho các API này là 25.000 và được chia sẻ với việc sử dụng dịch vụ MapKit JS của bạn.

00:12:58.000 --> 00:13:01.000
Và đó là API Máy chủ Apple Maps mới dành cho bạn.

00:13:01.000 --> 00:13:07.000
Hãy chắc chắn kiểm tra các phiên khác được đề cập ở đây và tài liệu chi tiết được liên kết bên dưới.

00:13:07.000 --> 00:13:10.000
Chúng tôi mong muốn được xem bạn tận dụng chúng như thế nào.

00:13:10.000 --> 00:13:11.000
Cảm ơn bạn!

00:13:11.000 --> 23:59:59.000
♪

