[
  {
    "text": "Hello, my name is Michael Ford ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=1"
  },
  {
    "text": "and I'm an engineer on the CloudKit team.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=3"
  },
  {
    "text": "Today we're going to talk about GDPR and CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=5"
  },
  {
    "text": "GDPR stands for General Data Protection Regulation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=9"
  },
  {
    "text": "It's a European Union regulation that went into effect ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=13"
  },
  {
    "text": "on May 25th, 2018.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=16"
  },
  {
    "text": "The regulation focuses on giving users visibility into, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=19"
  },
  {
    "text": "and control over, their personal data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=22"
  },
  {
    "text": "and how companies use it.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=25"
  },
  {
    "text": "At Apple, we value user privacy, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=27"
  },
  {
    "text": "and we want to make sure that developers ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=30"
  },
  {
    "text": "have the tools they need to build great applications ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=31"
  },
  {
    "text": "while protecting their user's privacy.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=34"
  },
  {
    "text": "During this talk, we'll discuss new and existing CloudKit APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=37"
  },
  {
    "text": "that you can use to fulfill user requests ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=41"
  },
  {
    "text": "related to GDPR or other regulations.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=44"
  },
  {
    "text": "If you're interested in a broader privacy discussion, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=48"
  },
  {
    "text": "take a look at the \"Better Apps through Better Privacy\" session ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=51"
  },
  {
    "text": "from WWDC 2018.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=54"
  },
  {
    "text": "Now, you might ask, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=57"
  },
  {
    "text": "\"Why are we only talking about CloudKit APIs?\" ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=58"
  },
  {
    "text": "Let's talk through some of the iCloud syncing services ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=62"
  },
  {
    "text": "that are available for developers to use, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=64"
  },
  {
    "text": "and you will soon see why.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=67"
  },
  {
    "text": "As a developer, you can save user data to iCloud ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=69"
  },
  {
    "text": "using iCloud Backup, Key Value Store, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=72"
  },
  {
    "text": "iCloud Drive, and CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=75"
  },
  {
    "text": "Let's talk through their data isolation, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=78"
  },
  {
    "text": "data interaction, and API availabilities.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=80"
  },
  {
    "text": "For Backup, Key Value, and iCloud Drive, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=84"
  },
  {
    "text": "data is always stored for a single user.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=88"
  },
  {
    "text": "CloudKit offers developers a more flexible API, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=91"
  },
  {
    "text": "where you can share data between users, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=94"
  },
  {
    "text": "or make data available to all users.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=96"
  },
  {
    "text": "When a user initiates an iCloud Backup restore, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=100"
  },
  {
    "text": "application data that was saved is automatically restored.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=102"
  },
  {
    "text": "Application data saved to Key Value Store and iCloud Drive ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=107"
  },
  {
    "text": "are automatically synced between all of the devices ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=111"
  },
  {
    "text": "where the user is signed in to their iCloud account.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=114"
  },
  {
    "text": "In contrast, data that your application saves to CloudKit ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=118"
  },
  {
    "text": "is not automatically mirrored to another device.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=121"
  },
  {
    "text": "You can use the Fetch Changes APIs or Query APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=124"
  },
  {
    "text": "to access all or part of the data stored in CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=128"
  },
  {
    "text": "Backup, Key Value, and Drive APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=132"
  },
  {
    "text": "are only available on device.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=135"
  },
  {
    "text": "You can use Objective-C or Swift versions ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=137"
  },
  {
    "text": "of the CloudKit APIs on device, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=140"
  },
  {
    "text": "or you can use the CloudKit web services ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=142"
  },
  {
    "text": "to access CloudKit data from a browser.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=145"
  },
  {
    "text": "As you can see, CloudKit is unique.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=148"
  },
  {
    "text": "It's more flexible and there are more ways to interact with it.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=151"
  },
  {
    "text": "When fulfilling GDPR requests for data saved to iCloud Backup, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=154"
  },
  {
    "text": "Key Value Store, or iCloud Drive, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=158"
  },
  {
    "text": "you can treat the data like other data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=160"
  },
  {
    "text": "that your application has stored locally.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=163"
  },
  {
    "text": "However, with CloudKit, you may need to interact ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=165"
  },
  {
    "text": "with the server to complete the GDPR request.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=168"
  },
  {
    "text": "Now, as we talk about GDPR more, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=172"
  },
  {
    "text": "I want you to remember that I am an engineer, not a lawyer.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=174"
  },
  {
    "text": "If you have questions about GDPR compliance, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=178"
  },
  {
    "text": "you should consult a lawyer.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=181"
  },
  {
    "text": "That said, let's get into some of the user rights ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=183"
  },
  {
    "text": "guaranteed by GDPR.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=185"
  },
  {
    "text": "GDPR guarantees users the right to know ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=188"
  },
  {
    "text": "what data is stored about them and how it is being used.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=190"
  },
  {
    "text": "A user has the right to access data stored about them.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=194"
  },
  {
    "text": "They have the right to export data.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=198"
  },
  {
    "text": "A user can request that processing of their data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=200"
  },
  {
    "text": "be paused.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=203"
  },
  {
    "text": "They can request that their data be deleted.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=205"
  },
  {
    "text": "This is commonly known as the right to be forgotten.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=207"
  },
  {
    "text": "If the data about a user is incorrect, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=211"
  },
  {
    "text": "the user should be able to update it.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=213"
  },
  {
    "text": "Users can also object to how their data is used.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=216"
  },
  {
    "text": "Examples include objecting to direct marketing, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=219"
  },
  {
    "text": "or objecting to processing a user's data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=222"
  },
  {
    "text": "for scientific research.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=224"
  },
  {
    "text": "Finally, a user should have access to human intervention ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=226"
  },
  {
    "text": "if automated decision making may legally or materially ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=230"
  },
  {
    "text": "impact the user.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=233"
  },
  {
    "text": "Now, that's quite a list.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=235"
  },
  {
    "text": "Today, we're going to focus on those rights ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=237"
  },
  {
    "text": "that are broadly applicable to developers using CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=239"
  },
  {
    "text": "This will not be a comprehensive talk about GDPR compliance.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=243"
  },
  {
    "text": "Instead, we'll focus on how to use new and existing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=247"
  },
  {
    "text": "CloudKit APIs to fulfill user requests ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=250"
  },
  {
    "text": "related to GDPR or other regulations.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=253"
  },
  {
    "text": "Let's first review some of the concepts inside of CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=257"
  },
  {
    "text": "At the highest level is a CloudKit container.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=261"
  },
  {
    "text": "You can have multiple applications interact ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=263"
  },
  {
    "text": "with the same CloudKit container.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=266"
  },
  {
    "text": "Inside of a CloudKit container, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=268"
  },
  {
    "text": "there are three types of databases.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=270"
  },
  {
    "text": "A private database, a shared database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=273"
  },
  {
    "text": "and a public database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=275"
  },
  {
    "text": "There is one public database per container.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=278"
  },
  {
    "text": "By default, all users can read and write data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=280"
  },
  {
    "text": "in the public database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=283"
  },
  {
    "text": "Every user has their own private and shared database ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=286"
  },
  {
    "text": "in a container.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=289"
  },
  {
    "text": "Data in the private database belongs to that user.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=290"
  },
  {
    "text": "If your application supports sharing, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=294"
  },
  {
    "text": "when a user accepts a sharing invitation, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=297"
  },
  {
    "text": "data becomes visible in their shared database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=299"
  },
  {
    "text": "This is a reference back to the owner's private database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=303"
  },
  {
    "text": "where the actual data resides.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=306"
  },
  {
    "text": "Inside of a given database, you can have multiple zones.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=309"
  },
  {
    "text": "In a private database and a public database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=312"
  },
  {
    "text": "there is always a default zone.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=315"
  },
  {
    "text": "And in a private database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=318"
  },
  {
    "text": "you can create multiple custom zones.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=319"
  },
  {
    "text": "In the shared database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=322"
  },
  {
    "text": "zones show up as you accept a sharing invitation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=323"
  },
  {
    "text": "Inside of a zone are records.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=327"
  },
  {
    "text": "This is where you store the actual data.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=330"
  },
  {
    "text": "To summarize the conceptual hierarchy of CloudKit, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=333"
  },
  {
    "text": "you first have a container.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=336"
  },
  {
    "text": "Then, there are three different types of databases.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=338"
  },
  {
    "text": "In a database, you can have one or more zones, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=341"
  },
  {
    "text": "depending on the type of database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=344"
  },
  {
    "text": "Finally, records are where the data is stored.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=346"
  },
  {
    "text": "Now that we've reviewed those core CloudKit concepts, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=350"
  },
  {
    "text": "we're ready to focus on the individual GDPR rights.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=353"
  },
  {
    "text": "We'll look at access and portability together.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=357"
  },
  {
    "text": "To fulfill these rights, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=360"
  },
  {
    "text": "you'll need to fetch data from CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=361"
  },
  {
    "text": "For deletion, you'll need to delete data from CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=364"
  },
  {
    "text": "And for restriction, you will apply a restriction ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=368"
  },
  {
    "text": "to an account in your CloudKit contianer.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=371"
  },
  {
    "text": "For access and portability requests, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=375"
  },
  {
    "text": "you should provide visibility into the data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=377"
  },
  {
    "text": "that is saved inside of CloudKit for the user.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=379"
  },
  {
    "text": "You should also provide a way to export the user's data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=383"
  },
  {
    "text": "in a standard format.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=386"
  },
  {
    "text": "If you are exporting an image, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=387"
  },
  {
    "text": "it would make sense to use a JPEG file format.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=389"
  },
  {
    "text": "For general structured data, use either JSON or CSV, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=392"
  },
  {
    "text": "depending on the type and amount of data.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=396"
  },
  {
    "text": "You've just exported data.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=399"
  },
  {
    "text": "While there's no requirement to import data, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=400"
  },
  {
    "text": "you may gain some users if you do.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=403"
  },
  {
    "text": "If you have already synced all of the data locally, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=407"
  },
  {
    "text": "you can just fulfill the GDPR access or portability request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=409"
  },
  {
    "text": "from the data you've saved locally.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=413"
  },
  {
    "text": "In case you haven't, you'll need to fetch the data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=416"
  },
  {
    "text": "from the CloudKit server.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=419"
  },
  {
    "text": "So how do you fetch all of the data from CloudKit? ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=421"
  },
  {
    "text": "Inside of the CloudKit hierarchy, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=425"
  },
  {
    "text": "for every container, for every database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=427"
  },
  {
    "text": "you should fetch all zones, and then query for all records.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=430"
  },
  {
    "text": "Let's review some of the code for how you would do that.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=434"
  },
  {
    "text": "First, let's set up our container ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=438"
  },
  {
    "text": "and database variables.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=440"
  },
  {
    "text": "In this case, we'll focus on the private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=442"
  },
  {
    "text": "Next, we'll fetch all of the zones inside of the database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=447"
  },
  {
    "text": "We'll iterate through all of those zones ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=451"
  },
  {
    "text": "and set up a query.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=453"
  },
  {
    "text": "You'll notice that this query is only for a single record type, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=456"
  },
  {
    "text": "so you may need to run multiple queries.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=459"
  },
  {
    "text": "You could loop through all of the record types that you have, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=462"
  },
  {
    "text": "or enumerate them individually.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=465"
  },
  {
    "text": "We'll pass an NSPredicate to the query that is always true, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=468"
  },
  {
    "text": "so that we get all of the records ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=472"
  },
  {
    "text": "of a given record type.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=473"
  },
  {
    "text": "Then we'll actually perform the query in the database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=475"
  },
  {
    "text": "Finally, once the query returns, you should display the records, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=479"
  },
  {
    "text": "or save them for export.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=483"
  },
  {
    "text": "I just showed you code to query for all of the records ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=486"
  },
  {
    "text": "in the private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=488"
  },
  {
    "text": "Shared databases and public databases are more complex.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=490"
  },
  {
    "text": "For a participant, a shared database is a partial view ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=495"
  },
  {
    "text": "into the owner's private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=498"
  },
  {
    "text": "Remember that the data belongs to the owner, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=501"
  },
  {
    "text": "so you should only return the data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=504"
  },
  {
    "text": "if it relates to the participant.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=506"
  },
  {
    "text": "The same is true of the public database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=509"
  },
  {
    "text": "By default, any user can read or write data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=512"
  },
  {
    "text": "into the public database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=514"
  },
  {
    "text": "Again, you should only return data that relates to the user ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=516"
  },
  {
    "text": "making the GDPR request.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=520"
  },
  {
    "text": "Deletion is forever.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=523"
  },
  {
    "text": "You should make sure that the user ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=525"
  },
  {
    "text": "really wants to delete their data en masse.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=526"
  },
  {
    "text": "You may want to offer a restriction as an alternative.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=529"
  },
  {
    "text": "If the user confirms that they want to delete their data, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=533"
  },
  {
    "text": "you'll need to delete all of the user's data from CloudKit.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=536"
  },
  {
    "text": "Let's look at the code for that now.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=540"
  },
  {
    "text": "Once again, we'll set up the container ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=543"
  },
  {
    "text": "and database variables.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=545"
  },
  {
    "text": "We'll focus on the private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=547"
  },
  {
    "text": "Again, we'll fetch all of the zones inside of the database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=550"
  },
  {
    "text": "Now, we're going to pull the zoneID ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=554"
  },
  {
    "text": "from the individual zones and use them ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=557"
  },
  {
    "text": "to create a deletion operation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=559"
  },
  {
    "text": "This deletion operation passes in the record zoneIDs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=562"
  },
  {
    "text": "that you want to delete.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=566"
  },
  {
    "text": "Finally, we perform the deletion operation against the database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=568"
  },
  {
    "text": "We just saw code to delete all of the zones ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=573"
  },
  {
    "text": "inside of the private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=575"
  },
  {
    "text": "Once again, if your application supports sharing, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=577"
  },
  {
    "text": "be selective, but this time be selective in what you delete.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=580"
  },
  {
    "text": "Deleting records in the shared database deletes them ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=585"
  },
  {
    "text": "for the owner and all other participants in the share.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=587"
  },
  {
    "text": "If there is data that should be expunged in this way, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=591"
  },
  {
    "text": "perform the record deletions before deleting the zones.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=595"
  },
  {
    "text": "Once that's complete, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=598"
  },
  {
    "text": "delete all of the zones in the user's shared database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=599"
  },
  {
    "text": "In contrast to deleting individual records, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=603"
  },
  {
    "text": "this will not delete the data for the owner, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=606"
  },
  {
    "text": "or the other participants in the share.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=608"
  },
  {
    "text": "In fact, a zone deletion in the shared database ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=611"
  },
  {
    "text": "changes the user from being a participant in the share ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=614"
  },
  {
    "text": "to being in an invited state.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=618"
  },
  {
    "text": "This means that they no longer see the zones ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=621"
  },
  {
    "text": "in the shared database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=623"
  },
  {
    "text": "Finally, in the public database, you'll need to review the data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=625"
  },
  {
    "text": "that you're storing related to a given user ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=629"
  },
  {
    "text": "and determine which data is appropriate to delete.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=631"
  },
  {
    "text": "Finally, let's talk about restriction.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=636"
  },
  {
    "text": "In effect, this is a way to pause or un-pause processing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=638"
  },
  {
    "text": "on a user's data.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=642"
  },
  {
    "text": "Under GDPR, you may need to pause processing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=643"
  },
  {
    "text": "when the user invokes another right.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=646"
  },
  {
    "text": "Or in some cases, the user may request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=649"
  },
  {
    "text": "that you restrict their data rather than delete it.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=652"
  },
  {
    "text": "We've exposed two new web service APIs that you can use ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=656"
  },
  {
    "text": "to restrict or un-restrict an account.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=659"
  },
  {
    "text": "You can invoke these web service APIs from any version of iOS, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=661"
  },
  {
    "text": "provided you have the appropriate credentials.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=666"
  },
  {
    "text": "Let's talk through the code to restrict a user now.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=668"
  },
  {
    "text": "First, you'll need to generate an API token ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=673"
  },
  {
    "text": "in the CloudKit dashboard.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=675"
  },
  {
    "text": "Once you have the API token, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=677"
  },
  {
    "text": "you can create a fetchAuthorization operation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=679"
  },
  {
    "text": "The fetchAuthorization API was first released in iOS 9.2.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=683"
  },
  {
    "text": "With both the apiToken and the webToken, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=688"
  },
  {
    "text": "you have everything you need ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=691"
  },
  {
    "text": "to make the web service restrict call.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=693"
  },
  {
    "text": "We've wrapped that in a restrict helper function, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=695"
  },
  {
    "text": "and we'll take a look at that now.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=698"
  },
  {
    "text": "First, you'll need to URL encode the webToken.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=701"
  },
  {
    "text": "Create the full web service URL by combining a baseURL, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=705"
  },
  {
    "text": "apiPath, and query parameters.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=709"
  },
  {
    "text": "Once you've done that, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=712"
  },
  {
    "text": "you should actually send the request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=713"
  },
  {
    "text": "as an HTTP post to the CloudKit server.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=715"
  },
  {
    "text": "We won't go through the code for that now, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=719"
  },
  {
    "text": "but you can find it in our linked documentation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=721"
  },
  {
    "text": "Once you restrict a user, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=724"
  },
  {
    "text": "any operation against that container will result in ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=726"
  },
  {
    "text": "a managedAccountRestricted error.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=729"
  },
  {
    "text": "You will also see this error if the user has ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=731"
  },
  {
    "text": "restricted their iCloud account through Apple.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=733"
  },
  {
    "text": "Apple will stop processing the user's data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=736"
  },
  {
    "text": "and will return this error for any CloudKit request, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=738"
  },
  {
    "text": "so be sure to handle this error in your code.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=742"
  },
  {
    "text": "To review, for access and portability, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=746"
  },
  {
    "text": "return all data inside of the user's private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=749"
  },
  {
    "text": "For shared databases and the public databases, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=753"
  },
  {
    "text": "be discerning when determining ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=755"
  },
  {
    "text": "which data to return to the user.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=757"
  },
  {
    "text": "To respond to a user deletion request, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=760"
  },
  {
    "text": "you can delete all of the data ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=762"
  },
  {
    "text": "inside of user's private database.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=764"
  },
  {
    "text": "You can also delete shared zones, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=767"
  },
  {
    "text": "which removes the user as a participant.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=769"
  },
  {
    "text": "For the public database, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=772"
  },
  {
    "text": "be discerning when determing which data to delete.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=774"
  },
  {
    "text": "Finally, we introduced new web service APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=777"
  },
  {
    "text": "to restrict or un-restrict accounts.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=780"
  },
  {
    "text": "You will see a managedAccountRestricted error ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=783"
  },
  {
    "text": "if you restrict the user, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=786"
  },
  {
    "text": "or if the user has requested that Apple restrict processing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=788"
  },
  {
    "text": "across their iCloud account.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=792"
  },
  {
    "text": "With these tools, we know that you can build great privacy ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=794"
  },
  {
    "text": "into your apps.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=797"
  },
  {
    "text": "For more information, please visit developer.apple.com, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=799"
  },
  {
    "text": "and feel free to email cloudkit@apple.com ",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=803"
  },
  {
    "text": "with any questions\nor feedback you may have.",
    "link": "https://developer.apple.com/videos/play/tech-talks-703/?time=806"
  }
]