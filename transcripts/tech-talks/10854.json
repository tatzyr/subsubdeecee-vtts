[
  {
    "text": "Hi. I'm Jeri Mason. I'm a software engineer on the HomePod team. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1"
  },
  {
    "text": "And I'm going to walk you through bringing your media service into the home ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=5"
  },
  {
    "text": "with SiriKit Media Intents, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=8"
  },
  {
    "text": "now powered by Cloud Extensions.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=10"
  },
  {
    "text": "Let's start with everything you need to start developing.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=13"
  },
  {
    "text": "First, we'll cover some important prerequisites ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=17"
  },
  {
    "text": "for developing a service effectively: ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=19"
  },
  {
    "text": "how to configure a test home, how to set up your HomePod for testing, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=22"
  },
  {
    "text": "how to set up your iOS device for development ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=27"
  },
  {
    "text": "and, finally, adopting the MediaSetup framework in your app ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=31"
  },
  {
    "text": "for onboarding your service into a home.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=35"
  },
  {
    "text": "Once you've taken these steps, you're well on your way ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=38"
  },
  {
    "text": "to creating an awesome playback experience on HomePod ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=40"
  },
  {
    "text": "for the people who love your content.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=43"
  },
  {
    "text": "Let's dive into the prerequisites. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=46"
  },
  {
    "text": "To support SiriKit Media Intents on HomePod, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=48"
  },
  {
    "text": "your service must already support Media Intents in your iOS app. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=51"
  },
  {
    "text": "You'll need to apply for the program on developer.apple.com/siri. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=55"
  },
  {
    "text": "After you apply, you'll receive more details ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=60"
  },
  {
    "text": "about accessing the Cloud Extension API specification, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=63"
  },
  {
    "text": "which your service must implement. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=67"
  },
  {
    "text": "Then you can register your service with us to get entitlements and profiles ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=69"
  },
  {
    "text": "to begin development. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=73"
  },
  {
    "text": "And finally, before a HomePod will be able to reach out to your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=74"
  },
  {
    "text": "via the Cloud Extension APIs, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=78"
  },
  {
    "text": "you must implement an OAuth flow and a Configuration Web Service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=80"
  },
  {
    "text": "defined in our specification.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=84"
  },
  {
    "text": "Let's talk more about registration. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=87"
  },
  {
    "text": "To register your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=89"
  },
  {
    "text": "you'll need to provide your service name, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=91"
  },
  {
    "text": "a public signing key that you create to verify the service on devices, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=93"
  },
  {
    "text": "a static URL to retrieve an icon for your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=98"
  },
  {
    "text": "from iOS devices in the home ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=101"
  },
  {
    "text": "and a list of bundle IDs of apps which are using the service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=103"
  },
  {
    "text": "This information will be used to create a development profile ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=107"
  },
  {
    "text": "you can install on your test and development devices. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=110"
  },
  {
    "text": "Only devices with the profile will be able to test your service.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=113"
  },
  {
    "text": "It should come as no surprise, since the Cloud Extension APIs use Web technology, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=118"
  },
  {
    "text": "we have adopted authentication using an OAuth 2.0 endpoint. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=123"
  },
  {
    "text": "But since your app takes the role of a trusted client, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=127"
  },
  {
    "text": "a service that implements client credentials flow is required. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=130"
  },
  {
    "text": "A unique ClientID and ClientSecret is required ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=133"
  },
  {
    "text": "for each service account that is added to a home. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=136"
  },
  {
    "text": "Even though it's uncommon for this flow, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=139"
  },
  {
    "text": "the issuing of renewal tokens is recommended, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=141"
  },
  {
    "text": "so as to avoid a common reuse of these credentials ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=144"
  },
  {
    "text": "provided directly to the Auth service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=147"
  },
  {
    "text": "This is because without a renewal token flow, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=150"
  },
  {
    "text": "the ClientID and ClientSecret could be long-lived. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=152"
  },
  {
    "text": "As long as someone is using your service from a home, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=155"
  },
  {
    "text": "either a renewal token or the original authentication ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=157"
  },
  {
    "text": "must be supported. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=160"
  },
  {
    "text": "Your iOS app must be able to supply these credentials ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=161"
  },
  {
    "text": "by requesting them from your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=165"
  },
  {
    "text": "and providing them to iOS media setup APIs.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=167"
  },
  {
    "text": "HomePods reach out to your service to resolve intents. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=171"
  },
  {
    "text": "On iOS, the details of what intents you support ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=174"
  },
  {
    "text": "are part of your app's bundle. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=177"
  },
  {
    "text": "In Cloud Extension, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=179"
  },
  {
    "text": "you must implement one or more configuration resource endpoints ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=181"
  },
  {
    "text": "which identify supported endpoints and what URLs you use to reach them. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=184"
  },
  {
    "text": "There's a lot of flexibility here. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=188"
  },
  {
    "text": "You can have multiple static URLs or implement an endpoint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=190"
  },
  {
    "text": "that creates them dynamically, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=194"
  },
  {
    "text": "all of which is useful for development and staging test configurations. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=196"
  },
  {
    "text": "Your endpoint can even check a request authorization header, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=200"
  },
  {
    "text": "identifying the account retrieving the configuration. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=203"
  },
  {
    "text": "The body of the configuration is encoded ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=206"
  },
  {
    "text": "using JavaScript Object Signing and Encryption standards, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=209"
  },
  {
    "text": "and it must be properly signed for the device to accept it. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=212"
  },
  {
    "text": "However you serve the resource, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=215"
  },
  {
    "text": "it must provide standard HTTP cache control headers ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=217"
  },
  {
    "text": "so the clients do not have to retrieve it often. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=221"
  },
  {
    "text": "Every time your app adds your service to a home, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=224"
  },
  {
    "text": "it provides the URL for this resource as well as the client credentials.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=227"
  },
  {
    "text": "With these prerequisites met, let's talk about configuring a test home.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=231"
  },
  {
    "text": "While you're developing and testing your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=237"
  },
  {
    "text": "having a dedicated test home in the Apple Home app ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=240"
  },
  {
    "text": "is strongly recommended. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=242"
  },
  {
    "text": "That way, you won't affect any HomeKit homes you may use personally, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=244"
  },
  {
    "text": "and you only have to manage the configuration ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=248"
  },
  {
    "text": "of the devices in your test home. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=250"
  },
  {
    "text": "You'll also want to have multiple test iCloud accounts ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=253"
  },
  {
    "text": "so you can test your service with different accounts in the same home. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=256"
  },
  {
    "text": "And naturally, you want to make sure that you're using the same accounts ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=259"
  },
  {
    "text": "on the HomePod and your iOS test devices.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=262"
  },
  {
    "text": "Creating a new home in the Home app is easy. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=265"
  },
  {
    "text": "First, tap Home Settings, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=268"
  },
  {
    "text": "add a home, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=271"
  },
  {
    "text": "type in the name of the home.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=272"
  },
  {
    "text": "Now you can add people who are your other test users.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=277"
  },
  {
    "text": "Okay. Now that you've got your test home set up, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=284"
  },
  {
    "text": "you'll need to add a HomePod to it and then set it up.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=287"
  },
  {
    "text": "You'll usually want to install the latest tvOS Developer Beta release ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=290"
  },
  {
    "text": "on your HomePod ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=294"
  },
  {
    "text": "or a release Apple currently advises for development. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=296"
  },
  {
    "text": "It's important to know that you cannot use a regular tvOS release ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=299"
  },
  {
    "text": "until you're ready to submit your app. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=303"
  },
  {
    "text": "Until then, you'll also need to install a development profile provided by Apple ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=305"
  },
  {
    "text": "for your service in the Home app on iOS. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=309"
  },
  {
    "text": "Be sure to repeat this process for each device you plan to test in your home. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=312"
  },
  {
    "text": "When you update to a new version of tvOS, you may have to reinstall the profile.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=317"
  },
  {
    "text": "To install a profile on a HomePod, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=322"
  },
  {
    "text": "first make sure your test home is selected in the Home app.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=324"
  },
  {
    "text": "Open the profile on an iOS device. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=329"
  },
  {
    "text": "Select HomePod as the device type to install.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=332"
  },
  {
    "text": "Tap Install, enter your passcode, consent to the agreements ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=336"
  },
  {
    "text": "and tap Install to complete installation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=341"
  },
  {
    "text": "You can then choose which HomePod in your test home ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=345"
  },
  {
    "text": "to install the profile to. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=348"
  },
  {
    "text": "That's it.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=349"
  },
  {
    "text": "You'll need to set up your iOS devices for testing and development as well.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=351"
  },
  {
    "text": "You'll need to be using a developer beta on your iOS device. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=356"
  },
  {
    "text": "Usually, you'll want the version that was released at the same time as tvOS, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=360"
  },
  {
    "text": "but check with Apple for the latest recommended version.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=364"
  },
  {
    "text": "Like the HomePod, you'll need to install your development profile. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=367"
  },
  {
    "text": "Tap on the mobile config bundle in an e-mail or iMessage attachment, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=371"
  },
  {
    "text": "choose to install it on your iOS device ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=375"
  },
  {
    "text": "and follow the typical flow for accepting and installing profiles in Settings.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=377"
  },
  {
    "text": "It's a good idea to check that your iOS device and your HomePod devices ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=383"
  },
  {
    "text": "are running the expected releases at this point.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=387"
  },
  {
    "text": "You can repeat this setup for any test devices you may need. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=390"
  },
  {
    "text": "They can be iPhone or iPad devices.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=393"
  },
  {
    "text": "With your devices configured, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=397"
  },
  {
    "text": "you can now adopt the MediaSetup framework in your app. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=399"
  },
  {
    "text": "This is what, ultimately, will allow people to set up your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=402"
  },
  {
    "text": "for use in their home.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=405"
  },
  {
    "text": "To use MediaSetup, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=408"
  },
  {
    "text": "you'll need to implement functionality in your app ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=409"
  },
  {
    "text": "to retrieve or create OAuth material, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=412"
  },
  {
    "text": "choose a Configuration Resource URL ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=415"
  },
  {
    "text": "appropriate for the account being onboarded, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=417"
  },
  {
    "text": "and then you'll have to add the Entitlement you received ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=420"
  },
  {
    "text": "after registering your service with Apple. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=422"
  },
  {
    "text": "Otherwise, you won't be able to use the framework.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=424"
  },
  {
    "text": "Make sure to add a prominent, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=427"
  },
  {
    "text": "discoverable onboarding presentation context in your app ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=429"
  },
  {
    "text": "to trigger the account installation flow using MSSetupSession. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=432"
  },
  {
    "text": "People will be guided through the home account setup process. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=437"
  },
  {
    "text": "The setup process will use your OAuth service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=440"
  },
  {
    "text": "to retrieve API tokens ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=443"
  },
  {
    "text": "and verify your Configuration Resource URL is properly signed and parsable. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=444"
  },
  {
    "text": "So all the prerequisites I mentioned earlier must be met ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=449"
  },
  {
    "text": "before a successful setup will complete.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=453"
  },
  {
    "text": "You can get more details at developer.apple.com.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=455"
  },
  {
    "text": "Now that your development and test environments are ready, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=460"
  },
  {
    "text": "a HomePod in your test home can reach out to your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=463"
  },
  {
    "text": "Let's go over the system architecture of handling intents in the cloud.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=466"
  },
  {
    "text": "On iPhones, iPads or Apple TV, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=470"
  },
  {
    "text": "when you ask Siri to play media in your iOS app, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=472"
  },
  {
    "text": "you either handle intents directly ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=475"
  },
  {
    "text": "or via an extension in your app bundle. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=478"
  },
  {
    "text": "Typically, when someone asks Siri to play content from your app, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=480"
  },
  {
    "text": "Siri processes this request, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=483"
  },
  {
    "text": "identifies your app bundle as the target of the intent ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=486"
  },
  {
    "text": "and loads your app extension, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=489"
  },
  {
    "text": "which implements the intent resolution. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=491"
  },
  {
    "text": "Your extension can communicate with your services, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=494"
  },
  {
    "text": "and the handling of the intent will trigger launching of your app ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=496"
  },
  {
    "text": "to begin playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=499"
  },
  {
    "text": "or just signal it to handle changes. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=500"
  },
  {
    "text": "With Cloud Extension, the process of resolving those intents ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=503"
  },
  {
    "text": "moves from your extension implementation on device ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=506"
  },
  {
    "text": "to an API on your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=509"
  },
  {
    "text": "as the HomePod directly reaches out ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=511"
  },
  {
    "text": "to your Cloud Extension Intent endpoints instead. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=512"
  },
  {
    "text": "The Cloud Extension API is a Web API specification ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=516"
  },
  {
    "text": "designed for Intent handling. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=519"
  },
  {
    "text": "It uses OpenAPI schemas to define objects ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=521"
  },
  {
    "text": "that closely follow the SiriKit Intent APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=524"
  },
  {
    "text": "you're already familiar with on iOS. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=527"
  },
  {
    "text": "The configuration URLs I discussed as we were getting started ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=531"
  },
  {
    "text": "are also part of the specification, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=534"
  },
  {
    "text": "and their content is defined in it. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=536"
  },
  {
    "text": "Each SiriKit Media Intent type has a protocol endpoint configuration, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=539"
  },
  {
    "text": "and we can reach out to different URLs as necessary for your implementation.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=543"
  },
  {
    "text": "The protocols supported are: ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=548"
  },
  {
    "text": "play media, add media and update media affinity.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=550"
  },
  {
    "text": "You may notice the search protocol is not provided on a HomePod ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=555"
  },
  {
    "text": "because there's no context to display the results on HomePod, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=558"
  },
  {
    "text": "unlike on iOS devices. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=561"
  },
  {
    "text": "Let's look at what happens when I tell Siri to play content.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=563"
  },
  {
    "text": "When I tell Siri, \"Play 'Strange' by Celeste,\" ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=566"
  },
  {
    "text": "this triggers the PlayMediaIntentHandling flow.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=570"
  },
  {
    "text": "The HomePod starts resolving a PlayMediaIntent ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=573"
  },
  {
    "text": "with a media search object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=576"
  },
  {
    "text": "It's serialized in JSON and sent to your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=578"
  },
  {
    "text": "Once you match the media search to something appropriate in your catalog, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=582"
  },
  {
    "text": "it'll create a response object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=585"
  },
  {
    "text": "The media item has an identifier, type ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=588"
  },
  {
    "text": "and additional metadata that Siri may use to formulate dialogue ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=591"
  },
  {
    "text": "to tell the user, \"Now playing 'Strange' by Celeste.\" ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=594"
  },
  {
    "text": "Additionally, this protocol has a handle method ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=598"
  },
  {
    "text": "that is called after resolving other fields on the intent. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=601"
  },
  {
    "text": "If the fields on the intent are already acceptable, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=604"
  },
  {
    "text": "there's no reason to delay returning the final handle method. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=607"
  },
  {
    "text": "So include it in your response to the initial request. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=610"
  },
  {
    "text": "Not doing so causes extra round trips to your service unnecessarily ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=613"
  },
  {
    "text": "and slows down the intent response time. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=617"
  },
  {
    "text": "Inside a handle response, you can include an object called UserActivity, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=620"
  },
  {
    "text": "which contains a persistentIdentifier and userInfo ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=624"
  },
  {
    "text": "that will be returned to your service when the HomePod starts playing your content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=628"
  },
  {
    "text": "Your service replies with these results ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=632"
  },
  {
    "text": "and may begin to form a queue of content to play based on the request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=633"
  },
  {
    "text": "as the HomePod processes these results and starts a playback session.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=638"
  },
  {
    "text": "Now, when media is playing from your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=642"
  },
  {
    "text": "let's consider what happens when I tell Siri, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=644"
  },
  {
    "text": "\"Add this to my library.\" ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=647"
  },
  {
    "text": "The AddMediaIntentHandling flow starts ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=649"
  },
  {
    "text": "with resolving media items, as before, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=652"
  },
  {
    "text": "except now that Siri knows what's currently playing from your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=654"
  },
  {
    "text": "an identifier for the currently playing content ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=658"
  },
  {
    "text": "is also part of the media search parameters. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=660"
  },
  {
    "text": "As before, your service must identify the content playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=663"
  },
  {
    "text": "and add it to the library of the account used to make the request. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=666"
  },
  {
    "text": "You'll then create an object to represent the ResolveMediaItem ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=670"
  },
  {
    "text": "and bundle together the handle method result ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=673"
  },
  {
    "text": "that indicates this operation was successful.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=676"
  },
  {
    "text": "Then you'll return that response to the HomePod, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=679"
  },
  {
    "text": "where Siri will confirm the result.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=682"
  },
  {
    "text": "And finally, when I tell Siri, \"I like this!\" ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=685"
  },
  {
    "text": "the UpdateMediaAffinityIntentHandling starts, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=687"
  },
  {
    "text": "again with resolving media items as before, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=691"
  },
  {
    "text": "and your service will identify the content, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=693"
  },
  {
    "text": "create a ResolveMediaItem result, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=696"
  },
  {
    "text": "register this affinity against the taste profile ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=698"
  },
  {
    "text": "the account used to authenticate the request, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=701"
  },
  {
    "text": "and like the previous examples, include the handle method result. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=704"
  },
  {
    "text": "These context-specific requests will only include a content identifier ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=707"
  },
  {
    "text": "if your service is the service playing on the HomePod when the request is made. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=712"
  },
  {
    "text": "Also, don't forget that listeners can just say ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=716"
  },
  {
    "text": "that they want to add something that's not currently playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=719"
  },
  {
    "text": "to their library. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=722"
  },
  {
    "text": "In this case, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=723"
  },
  {
    "text": "you'll be provided with media names and artist names to resolve. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=724"
  },
  {
    "text": "This is a less common use case though.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=728"
  },
  {
    "text": "Let's see a basic play media request and response ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=731"
  },
  {
    "text": "as it looks in the protocol as JSON.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=734"
  },
  {
    "text": "If I ask my HomePod the most basic request, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=738"
  },
  {
    "text": "to play music on your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=740"
  },
  {
    "text": "every request to the intent endpoints on your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=742"
  },
  {
    "text": "will provide a session description before the first item to resolve. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=745"
  },
  {
    "text": "Most objects in the specification include the Cloud Extension version number ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=749"
  },
  {
    "text": "of the object being presented. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=753"
  },
  {
    "text": "Your service should support older versions of these objects when possible. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=755"
  },
  {
    "text": "Newer versions also should be backward compatible ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=759"
  },
  {
    "text": "up to a new major version number.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=761"
  },
  {
    "text": "The intent resolution session has an identifier, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=764"
  },
  {
    "text": "which is also carried in a header on HTTPS requests. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=767"
  },
  {
    "text": "It will remain the same during resolution of the intent interaction, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=771"
  },
  {
    "text": "and if multiple requests are made to resolve this intent, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=774"
  },
  {
    "text": "this identifier will be consistent between them.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=777"
  },
  {
    "text": "Two time stamps are provided-- the UTC time when the request was prepared ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=780"
  },
  {
    "text": "and a deadline time after which the client will time out the request. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=785"
  },
  {
    "text": "If the deadline is missed, Siri will explain ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=789"
  },
  {
    "text": "the service cannot resolve the intent. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=792"
  },
  {
    "text": "Providing a timely response is important. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=794"
  },
  {
    "text": "Time-outs happen after ten seconds, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=797"
  },
  {
    "text": "so consider how you can break up the work of returning intent results ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=800"
  },
  {
    "text": "and preparing content for playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=803"
  },
  {
    "text": "so that your service can take advantage of the time between requests ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=806"
  },
  {
    "text": "from the HomePod. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=808"
  },
  {
    "text": "These constraints and player context objects ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=810"
  },
  {
    "text": "will be discussed in more depth later. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=812"
  },
  {
    "text": "They provide important information about what's happening on the HomePod ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=814"
  },
  {
    "text": "when the request was made.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=818"
  },
  {
    "text": "Most requests start with a resolveMediaItems method on the protocol. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=820"
  },
  {
    "text": "The most important part of this request is in the parameter and intent object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=824"
  },
  {
    "text": "This is a PlayMediaIntent, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=829"
  },
  {
    "text": "and all PlayMediaIntent objects have a mediaSearch ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=831"
  },
  {
    "text": "that defines attributes of media parsed by Siri from speech. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=834"
  },
  {
    "text": "Other parameters of the intent include information ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=839"
  },
  {
    "text": "about whether I asked to play the content shuffled or repeating, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=841"
  },
  {
    "text": "or to resume playing the content, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=845"
  },
  {
    "text": "or whether I said to play something next or later instead of now. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=846"
  },
  {
    "text": "This object should appear familiar to you ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=850"
  },
  {
    "text": "if you've already handled PlayMediaIntents on iOS. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=853"
  },
  {
    "text": "The response you return from this request should look familiar too, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=856"
  },
  {
    "text": "but there are a few new twists. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=860"
  },
  {
    "text": "Inside an array of results, you provide the method name, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=862"
  },
  {
    "text": "a result object, in this case a resolutionResult array with one item, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=866"
  },
  {
    "text": "the resolutionResult class appropriate for this method, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=871"
  },
  {
    "text": "which is, in this case, a success property. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=874"
  },
  {
    "text": "And as you can see, this resolvedMediaItem represents Your Favorites, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=878"
  },
  {
    "text": "a station based on my taste profile.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=882"
  },
  {
    "text": "Here's something new for Cloud Extension. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=885"
  },
  {
    "text": "Each method you process should return a metrics object ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=887"
  },
  {
    "text": "that describes how long in seconds it took for your service to provide results. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=889"
  },
  {
    "text": "Apple may use this data in aggregate ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=893"
  },
  {
    "text": "to roughly determine the experience of listeners ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=895"
  },
  {
    "text": "and better evaluate when delays are caused by network connectivity. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=898"
  },
  {
    "text": "You can see the next result item is peeking around the break here-- ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=902"
  },
  {
    "text": "the handle method for this protocol. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=905"
  },
  {
    "text": "The result of a handle method is a response object ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=907"
  },
  {
    "text": "appropriate for that intent, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=910"
  },
  {
    "text": "which has a status code ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=912"
  },
  {
    "text": "and then a description of a UserActivity object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=913"
  },
  {
    "text": "Think of user activities as a memento representing the intent result.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=916"
  },
  {
    "text": "For playing MediaIntent results, the UserActivity is used ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=921"
  },
  {
    "text": "when starting or modifying playback of your content, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=924"
  },
  {
    "text": "whereas on iOS devices, the UserActivity object ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=928"
  },
  {
    "text": "is made available to your app when it's launched. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=930"
  },
  {
    "text": "On HomePod, your service defines the listening experience ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=933"
  },
  {
    "text": "with another Cloud Extension API for media cube playback.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=936"
  },
  {
    "text": "Up to this point, intent handling should have been super familiar ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=941"
  },
  {
    "text": "if you've implemented SiriKit Media Intents on iOS previously. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=944"
  },
  {
    "text": "Playing media from your cloud service is the driving feature of Cloud Extension. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=948"
  },
  {
    "text": "And in this part, I'll provide you the concepts and specifics ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=952"
  },
  {
    "text": "to implement media queues in the cloud.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=956"
  },
  {
    "text": "Let's review again what happens when a person asks Siri ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=960"
  },
  {
    "text": "to play media on a HomePod. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=962"
  },
  {
    "text": "The request is processed by Siri, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=964"
  },
  {
    "text": "and our Cloud Media Service extension is chosen to handle it ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=967"
  },
  {
    "text": "on behalf of your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=970"
  },
  {
    "text": "The HomePod uses the Cloud Extension APIs implemented by your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=972"
  },
  {
    "text": "to resolve an intent. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=976"
  },
  {
    "text": "Once we have resolved the intent, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=978"
  },
  {
    "text": "a Cloud Media Player component will contact your service's queue endpoints, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=980"
  },
  {
    "text": "and it's those queue endpoints which determine what content to play. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=984"
  },
  {
    "text": "In most services, a content distribution service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=988"
  },
  {
    "text": "often provides the actual audio files to play. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=990"
  },
  {
    "text": "You might notice that there are two HomePods depicted here. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=993"
  },
  {
    "text": "In certain situations, the HomePod that resolves the intent ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=996"
  },
  {
    "text": "may not be the same HomePod that is playing your content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=999"
  },
  {
    "text": "If a family has several HomePods, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1003"
  },
  {
    "text": "the HomePod closest to someone in the living room ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1005"
  },
  {
    "text": "might respond to their request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1008"
  },
  {
    "text": "even if your service had already been playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1009"
  },
  {
    "text": "to multiple locations in the house ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1011"
  },
  {
    "text": "and that session had started in the kitchen.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1013"
  },
  {
    "text": "Let's see how your service provides content via queues. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1017"
  },
  {
    "text": "I'm gonna walk you through some high-level concepts of media queues, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1020"
  },
  {
    "text": "including various idioms and use cases for different listening experiences. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1024"
  },
  {
    "text": "And then dive into details of managing queues and their lifetime.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1029"
  },
  {
    "text": "And finally, I'll explain how your service defines playback controls on HomePod. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1033"
  },
  {
    "text": "Okay, let's explore what it means to provide a queue from your service.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1038"
  },
  {
    "text": "All listening experiences supported by Cloud Extension ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1043"
  },
  {
    "text": "are defined by playing a Queue of Content items. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1045"
  },
  {
    "text": "Queues are created or modified ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1049"
  },
  {
    "text": "by submitting User Activity objects resulting from intent resolution ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1051"
  },
  {
    "text": "to your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1054"
  },
  {
    "text": "Your service returns a Queue of Content items ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1056"
  },
  {
    "text": "all at once or, more likely, in segments. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1058"
  },
  {
    "text": "Let's look at some use cases and how to conceptualize them as a queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1061"
  },
  {
    "text": "Internet radio content often starts with a promotion track, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1066"
  },
  {
    "text": "then many songs, quite often an advertisement, more songs, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1069"
  },
  {
    "text": "and then it continues indefinitely ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1073"
  },
  {
    "text": "until a listener stops playback. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1075"
  },
  {
    "text": "On-demand music requests can resolve to a single album ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1078"
  },
  {
    "text": "or other collection like a playlist ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1081"
  },
  {
    "text": "and be constrained to a finite queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1083"
  },
  {
    "text": "And live streaming content will often have a single content item ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1086"
  },
  {
    "text": "which forms a minimal queue response ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1089"
  },
  {
    "text": "that has one piece of content referencing the live stream source.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1091"
  },
  {
    "text": "Content items in a queue can be described with an identifier, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1095"
  },
  {
    "text": "a URL and various descriptive attributes ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1098"
  },
  {
    "text": "like the name of the content, the artist and so on. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1101"
  },
  {
    "text": "Content selection can take any number of algorithmic forms in your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1104"
  },
  {
    "text": "from a rigid album track order ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1109"
  },
  {
    "text": "to a completely dynamic selection.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1111"
  },
  {
    "text": "Queues are intended to support all these use cases. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1115"
  },
  {
    "text": "Now let's talk about the various ways ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1118"
  },
  {
    "text": "you can represent your sequence of content items in a queue idiomatically.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1119"
  },
  {
    "text": "The idioms I'll be describing are variations on using a queue ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1125"
  },
  {
    "text": "broken into segments for different purposes. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1128"
  },
  {
    "text": "So here we have our content conceptually realized over time ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1130"
  },
  {
    "text": "described by objects. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1134"
  },
  {
    "text": "Say these four pieces of content are the complete listening experience ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1135"
  },
  {
    "text": "you want to represent as the result of an intent resolution. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1138"
  },
  {
    "text": "You can package them into a queue object which has its own identifier ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1142"
  },
  {
    "text": "and a simple array of all these content items. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1146"
  },
  {
    "text": "That's a pretty basic queue object.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1149"
  },
  {
    "text": "This is the static content idiom ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1151"
  },
  {
    "text": "where a queue contains a finite, nonchanging list of content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1153"
  },
  {
    "text": "It may fit into one queue segment or it might not, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1157"
  },
  {
    "text": "but conceptually, it is a rigid list of content items ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1159"
  },
  {
    "text": "that could be played in order. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1162"
  },
  {
    "text": "Use cases for this idiom include the on-demand music request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1164"
  },
  {
    "text": "for an album or a playlist, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1167"
  },
  {
    "text": "or the live stream use case, where the queue is a simple wrapper ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1170"
  },
  {
    "text": "for one piece of content that streams indefinitely.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1172"
  },
  {
    "text": "Your service can have more complicated queues, however. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1176"
  },
  {
    "text": "Queues can be split into segments, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1180"
  },
  {
    "text": "and they internally link to the next content and previous content items ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1181"
  },
  {
    "text": "via URL references. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1185"
  },
  {
    "text": "The HomePod will retrieve these segments as your service defines them, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1187"
  },
  {
    "text": "and any particular segment can be dynamically generated ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1190"
  },
  {
    "text": "and return different results ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1193"
  },
  {
    "text": "as the listening session moves to the new segment, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1195"
  },
  {
    "text": "either by transitioning naturally ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1198"
  },
  {
    "text": "or by skipping forward or backwards through your content items. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1200"
  },
  {
    "text": "This particular example might fit a use case ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1204"
  },
  {
    "text": "where a service provides an advertisement inside a set of fixed content segments. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1206"
  },
  {
    "text": "And each time the player encounters Queue segment B, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1210"
  },
  {
    "text": "a different advertisement might play. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1213"
  },
  {
    "text": "This means your service queue content is retrieved dynamically, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1216"
  },
  {
    "text": "so your service will experience more requests for each queue segment ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1218"
  },
  {
    "text": "than as if it is entered.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1221"
  },
  {
    "text": "Your service may want to have the most discrete control ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1224"
  },
  {
    "text": "over content and playback options. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1227"
  },
  {
    "text": "And in the fully dynamic idiom, every queue segment contains one content item, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1228"
  },
  {
    "text": "and a new content for the queue can be retrieved dynamically ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1233"
  },
  {
    "text": "as the listener proceeds through it. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1236"
  },
  {
    "text": "This is a popular idiom for Internet radio use cases ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1238"
  },
  {
    "text": "because the queue is typically of indefinite size. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1240"
  },
  {
    "text": "And also because the queue content itself is a function of listening behavior. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1243"
  },
  {
    "text": "Skipping tracks and providing content affinity through Siri intents ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1247"
  },
  {
    "text": "may change the taste profile associated with the account, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1250"
  },
  {
    "text": "and therefore, upcoming content items may be selected differently. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1254"
  },
  {
    "text": "Naturally, this is also the idiom that represents ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1258"
  },
  {
    "text": "the most request processing on your service.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1260"
  },
  {
    "text": "Since these idioms are different ways of using the same queue architecture, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1264"
  },
  {
    "text": "your service can provide queues ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1268"
  },
  {
    "text": "using any combination of these idioms, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1270"
  },
  {
    "text": "and you can even choose alternate idioms ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1272"
  },
  {
    "text": "to implement for a particular kind of request. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1274"
  },
  {
    "text": "They're useful for considering trade-offs in complexity and capability.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1277"
  },
  {
    "text": "Enough theory. Let's talk about how your service creates and manages these queues.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1282"
  },
  {
    "text": "When a PlayMediaIntentHandling request returns from your intent endpoint, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1287"
  },
  {
    "text": "your service should start creating your representation of a queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1292"
  },
  {
    "text": "because shortly afterward, a request on your queue play media endpoint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1295"
  },
  {
    "text": "will be made to retrieve the initial or complete queue segment.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1298"
  },
  {
    "text": "Each segment can link to a next and previous segment as your service desires, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1302"
  },
  {
    "text": "providing a set of content that is potentially endless or circular. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1306"
  },
  {
    "text": "Usually, a newly retrieved queue starts playing from the first content item. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1310"
  },
  {
    "text": "To support resuming playback from a prior session, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1314"
  },
  {
    "text": "a playPointer object can be provided in the initial queue segment, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1317"
  },
  {
    "text": "and playback begins from the content item indicated ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1322"
  },
  {
    "text": "at a time offset you provide. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1325"
  },
  {
    "text": "To support smooth, gap-less playback, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1327"
  },
  {
    "text": "as a listening point is near the end of the last content item ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1329"
  },
  {
    "text": "in the queue segment, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1332"
  },
  {
    "text": "the next segment will be retrieved and appended ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1334"
  },
  {
    "text": "at a configurable preroll interval.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1336"
  },
  {
    "text": "Let's take a look at actual JSON objects ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1340"
  },
  {
    "text": "exchanged with your service after handling a PlayMusicIntent successfully. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1343"
  },
  {
    "text": "Like all requests, we begin with the client's version. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1348"
  },
  {
    "text": "There may be a nonhomogeneous set of devices in the home, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1351"
  },
  {
    "text": "so the version supported by the device playing your content ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1355"
  },
  {
    "text": "may actually be older or newer than the one that resolved the intent. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1358"
  },
  {
    "text": "The identifier for PlayMedia request inherits the identifier ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1362"
  },
  {
    "text": "used in the intent resolution. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1365"
  },
  {
    "text": "If for some reason the playback has to restart though, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1368"
  },
  {
    "text": "this identifier might be a new, unique identifier. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1370"
  },
  {
    "text": "You should not rely on this for linking your intent results with a queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1374"
  },
  {
    "text": "where the user activity is much more appropriate, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1378"
  },
  {
    "text": "though these identifiers may be useful for debugging. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1380"
  },
  {
    "text": "A constraints object defines certain limitations ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1383"
  },
  {
    "text": "for playback on the device. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1386"
  },
  {
    "text": "You may remember it's provided on the intent endpoints as well, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1388"
  },
  {
    "text": "and I'll go into more detail about these later. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1391"
  },
  {
    "text": "Finally, if your intent resolution returned a UserActivity object, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1393"
  },
  {
    "text": "that object is included to provide context ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1397"
  },
  {
    "text": "for how your queue endpoint should prepare content items ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1400"
  },
  {
    "text": "for this session. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1402"
  },
  {
    "text": "Your service responds to the request with a queue object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1404"
  },
  {
    "text": "It has an identifier that will be presented later in reporting ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1407"
  },
  {
    "text": "and for context and intents ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1411"
  },
  {
    "text": "and typically will remain the same ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1413"
  },
  {
    "text": "between different segments of the same queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1415"
  },
  {
    "text": "You can provide an array of content items to play through, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1417"
  },
  {
    "text": "though in this small example, only one item is provided. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1421"
  },
  {
    "text": "There are attributes describing each content item, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1424"
  },
  {
    "text": "an identifier for each item, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1427"
  },
  {
    "text": "which must be unique to this queue, if not your entire catalog, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1429"
  },
  {
    "text": "and a URL to the body of the content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1432"
  },
  {
    "text": "Here's where the previous and next content links are described for the segment. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1436"
  },
  {
    "text": "The body of the response from these URLs is another queue segment definition ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1440"
  },
  {
    "text": "much like this one. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1444"
  },
  {
    "text": "Finally, by specifying a preroll of five seconds, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1446"
  },
  {
    "text": "approximately five seconds before the end of playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1448"
  },
  {
    "text": "of the last content item in the array, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1451"
  },
  {
    "text": "the next content URL will be retrieved ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1453"
  },
  {
    "text": "to extend the queue content forward. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1456"
  },
  {
    "text": "That's all a HomePod needs to start playback of your content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1458"
  },
  {
    "text": "Now, what if someone asks Siri to play a different track next ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1462"
  },
  {
    "text": "while already listening to your queue? ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1465"
  },
  {
    "text": "This is indicated in the PlayMediaIntentHandling protocol ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1468"
  },
  {
    "text": "by resolving the playback queue location to next. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1470"
  },
  {
    "text": "If the HomePod is playing the second content item in this example queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1474"
  },
  {
    "text": "you probably don't want to provide a whole new queue result. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1478"
  },
  {
    "text": "In this case, you want to literally insert one or more content items ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1481"
  },
  {
    "text": "inside this queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1484"
  },
  {
    "text": "You do this by providing a queue segment from your PlayMedia endpoint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1486"
  },
  {
    "text": "that has the same queue identifier as what is currently playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1490"
  },
  {
    "text": "and an insertPointer object ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1493"
  },
  {
    "text": "as to where the content carried in the segment ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1496"
  },
  {
    "text": "should be inserted into the current queue segment. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1498"
  },
  {
    "text": "If no specific content identifier is provided for the insertion point, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1502"
  },
  {
    "text": "the items are also inserted after the currently playing item. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1506"
  },
  {
    "text": "This behavior lessens the impact of race conditions ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1510"
  },
  {
    "text": "as the playing content in transition ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1513"
  },
  {
    "text": "between resolving the intent and updating the queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1515"
  },
  {
    "text": "Using this technique is recommended ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1519"
  },
  {
    "text": "even if your service uses the fully dynamic queue idiom. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1521"
  },
  {
    "text": "Finally, let's cover some nuances of queue management.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1525"
  },
  {
    "text": "While it will result in the largest number of requests on your service endpoints, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1530"
  },
  {
    "text": "the fully dynamic idiom features the most flexible way ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1534"
  },
  {
    "text": "of providing content for most media services ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1538"
  },
  {
    "text": "and is conceptually easier to manage ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1541"
  },
  {
    "text": "if your content is not completely static in nature. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1543"
  },
  {
    "text": "Despite the queue protocol being flexible enough ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1547"
  },
  {
    "text": "to provide any set of content when navigating a queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1549"
  },
  {
    "text": "it is best to maintain consistency in your queue history ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1553"
  },
  {
    "text": "if you allow listeners to navigate backwards in the queue.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1556"
  },
  {
    "text": "To implement repeat and shuffling behavior, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1560"
  },
  {
    "text": "your service must identify these options from the intent handling ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1562"
  },
  {
    "text": "and provide queue content in a shuffled order ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1566"
  },
  {
    "text": "or repeat indefinitely by techniques such as a next content URL ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1568"
  },
  {
    "text": "that leads to previously played items in the queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1573"
  },
  {
    "text": "These behaviors are impossible to perform without full knowledge of the queue extent ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1576"
  },
  {
    "text": "so the HomePod does not even attempt to support them natively.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1580"
  },
  {
    "text": "Next and previous content URLs can be templated ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1584"
  },
  {
    "text": "so a small amount of context can be provided to your implementation ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1587"
  },
  {
    "text": "such as the last content item in the queue segment ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1591"
  },
  {
    "text": "or currently playing activity queue or content identifiers. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1594"
  },
  {
    "text": "If your service implements the queue update user activity endpoint, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1598"
  },
  {
    "text": "you can even update playing queues via reporting events. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1602"
  },
  {
    "text": "I'll talk about reporting shortly.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1606"
  },
  {
    "text": "I hope you have a good grasp of the rich set of queue management tools ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1608"
  },
  {
    "text": "your service can use ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1612"
  },
  {
    "text": "to provide flexible and timely content retrieval and updates.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1613"
  },
  {
    "text": "Finally, in this section, I'll expand on controlling playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1618"
  },
  {
    "text": "and defining how listeners interact with your service.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1621"
  },
  {
    "text": "Not every kind of queue is the same, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1626"
  },
  {
    "text": "and not all content in a queue can be treated the same. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1628"
  },
  {
    "text": "For example, the Internet radio use case typically supports only forward motion ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1631"
  },
  {
    "text": "through the queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1636"
  },
  {
    "text": "Additionally, when an advertisement is playing, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1637"
  },
  {
    "text": "you may not want to support skipping that content at all. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1640"
  },
  {
    "text": "Skipping ahead in radio station queues may be limited by many variables-- ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1643"
  },
  {
    "text": "premium subscriptions, freemium models, other more esoteric limitations. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1647"
  },
  {
    "text": "The fully dynamic idiom is often the only way to support these requirements.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1652"
  },
  {
    "text": "Moving between different content in a queue ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1656"
  },
  {
    "text": "may be limited arbitrarily. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1658"
  },
  {
    "text": "Let's talk about how you define this interaction. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1661"
  },
  {
    "text": "Cloud Extension queue APIs let your service define interaction ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1664"
  },
  {
    "text": "with PlayMediaControl objects you provide in the queue object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1668"
  },
  {
    "text": "Each PlayMediaControl object can choose a predefined scheme ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1672"
  },
  {
    "text": "which supports several common use cases. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1676"
  },
  {
    "text": "This set of defined interactions can be specified on each content item ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1679"
  },
  {
    "text": "with a control attribute.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1682"
  },
  {
    "text": "Let's look at an example control definition ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1685"
  },
  {
    "text": "which might be appropriate for an on-demand service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1687"
  },
  {
    "text": "with advertisements interspersed with songs. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1690"
  },
  {
    "text": "You include these definitions inside a controls attribute ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1694"
  },
  {
    "text": "for every queue object. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1696"
  },
  {
    "text": "In this example, there are two definitions-- ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1698"
  },
  {
    "text": "the required default definition, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1701"
  },
  {
    "text": "which is used when any content item does not specify a control, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1703"
  },
  {
    "text": "and an ad definition ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1707"
  },
  {
    "text": "that is specified on all content items that are advertisements. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1709"
  },
  {
    "text": "All control definitions have a prototype scheme. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1713"
  },
  {
    "text": "By default, the content items in the queue are going to be onDemand scheme, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1716"
  },
  {
    "text": "and for the ad content, the advertisement scheme. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1720"
  },
  {
    "text": "The scheme modifies the Siri dialogue ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1723"
  },
  {
    "text": "when a user asks to move to the next content item. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1725"
  },
  {
    "text": "Siri may then reply that skipping advertisements is not permitted. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1728"
  },
  {
    "text": "The scheme also defaults all navigation commands to be disabled, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1732"
  },
  {
    "text": "though you can selectively enable them again. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1737"
  },
  {
    "text": "An example of enabling commands is also provided here, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1739"
  },
  {
    "text": "where the dislikeTrack and likeTrack commands, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1743"
  },
  {
    "text": "normally disabled by default, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1745"
  },
  {
    "text": "are being enabled by your on-demand content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1747"
  },
  {
    "text": "You can see how, with a small set of control definitions ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1750"
  },
  {
    "text": "linked to items in your queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1753"
  },
  {
    "text": "you can substantially customize interactions with your content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1754"
  },
  {
    "text": "Finally, the control definitions also allow specifying options ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1758"
  },
  {
    "text": "for user activity reporting, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1761"
  },
  {
    "text": "which is how your service receives optional command events, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1763"
  },
  {
    "text": "navigation information ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1767"
  },
  {
    "text": "and play status of your content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1768"
  },
  {
    "text": "These are all topics I'm about to cover next.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1771"
  },
  {
    "text": "So far, you've seen how a HomePod reaches out to your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1774"
  },
  {
    "text": "to resolve intents and manage a queue of content to play. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1777"
  },
  {
    "text": "Now I'll talk about how your service is made aware of playback events ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1781"
  },
  {
    "text": "and can contextualize requests over time, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1784"
  },
  {
    "text": "starting with how listening activity can be reported to your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1788"
  },
  {
    "text": "how playback context is provided ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1792"
  },
  {
    "text": "when already playing any queue from your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1795"
  },
  {
    "text": "and, finally, how your service must respect certain playback constraints.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1799"
  },
  {
    "text": "So let's start with reporting. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1803"
  },
  {
    "text": "Listener activity is reported using the media queue Update Activity endpoint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1806"
  },
  {
    "text": "in the Cloud Extension API. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1810"
  },
  {
    "text": "This endpoint is technically optional, but most services implement it ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1813"
  },
  {
    "text": "to get status reports from the HomePod as people listen to content.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1816"
  },
  {
    "text": "Your service receives reports for transitions and media control events ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1820"
  },
  {
    "text": "such as skips, pausing, continuing playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1824"
  },
  {
    "text": "and scrubbing in a track. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1827"
  },
  {
    "text": "Your queue content can be affected by these reports, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1830"
  },
  {
    "text": "especially if you've implemented a partially or fully dynamic queue idiom. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1832"
  },
  {
    "text": "Your service can even return new queue segments as a response. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1836"
  },
  {
    "text": "Since update activity requests are made asynchronously ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1840"
  },
  {
    "text": "from content retrieval for your queue, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1843"
  },
  {
    "text": "returning a new queue on the report of a track skip ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1846"
  },
  {
    "text": "may not present your queue content cleanly ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1849"
  },
  {
    "text": "and might fight the normal transition logic, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1852"
  },
  {
    "text": "some audible jump in playback would likely occur.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1855"
  },
  {
    "text": "Use queue responses from reporting only to completely change the playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1858"
  },
  {
    "text": "or insert new content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1862"
  },
  {
    "text": "Use content URL templating to get more context ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1864"
  },
  {
    "text": "of why a queue segment was retrieved.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1867"
  },
  {
    "text": "Let's look at an example request made to the update activity endpoint.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1870"
  },
  {
    "text": "In this example, I asked Siri to skip to the next track. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1875"
  },
  {
    "text": "These simple interactions are not intents but media controls. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1878"
  },
  {
    "text": "In JSON, the report looks like this. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1882"
  },
  {
    "text": "As you can see, the type of report being made ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1885"
  },
  {
    "text": "is tagged as a skip_next. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1887"
  },
  {
    "text": "The full set of reporting types is defined in the specification ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1890"
  },
  {
    "text": "and includes natural transitions between tracks, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1893"
  },
  {
    "text": "scrubbing within a track ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1897"
  },
  {
    "text": "and when a new queue replaces the existing queue. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1898"
  },
  {
    "text": "The nowPlaying context is provided, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1902"
  },
  {
    "text": "including the activity, queue and contentIdentifiers ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1903"
  },
  {
    "text": "and an offset into the content that has currently been played. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1906"
  },
  {
    "text": "For transitions, a previously playing context is also provided. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1910"
  },
  {
    "text": "It represents the identifiers associated with the last content being played ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1914"
  },
  {
    "text": "and the offset inside the content when playback transitioned. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1918"
  },
  {
    "text": "You might use this to update your listener's taste profile ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1922"
  },
  {
    "text": "if they skipped quickly. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1925"
  },
  {
    "text": "But in this case, I listened to a good portion of that song, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1926"
  },
  {
    "text": "as you can tell in the offsetInMillis value. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1929"
  },
  {
    "text": "So your service may assume I probably liked it, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1932"
  },
  {
    "text": "at least enough not to lower its relative rating. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1934"
  },
  {
    "text": "And like other endpoints in the queue API, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1937"
  },
  {
    "text": "the user activity object is presented in full ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1940"
  },
  {
    "text": "in case the user info data is useful for your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1942"
  },
  {
    "text": "to recover state and quickly process this information. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1945"
  },
  {
    "text": "There are more advanced capabilities your service can use as well. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1949"
  },
  {
    "text": "For example, you can request playback interval reports as content is playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1952"
  },
  {
    "text": "to know that a certain point has been reached ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1956"
  },
  {
    "text": "or each time a particular repeating interval has elapsed. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1958"
  },
  {
    "text": "You can enable and receive reporting of certain MPRemoteCommandCenter commands ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1962"
  },
  {
    "text": "when iOS devices control playback on the HomePod. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1966"
  },
  {
    "text": "Note that the remote commands for likeTrack and dislikeTrack ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1970"
  },
  {
    "text": "are not the same as update media affinity intent handling. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1973"
  },
  {
    "text": "They're not voice intents, but simple taps from an iOS device ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1977"
  },
  {
    "text": "anywhere in the house. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1980"
  },
  {
    "text": "While I discussed returning new queues previously, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1982"
  },
  {
    "text": "you can also update User Activity objects during playback ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1985"
  },
  {
    "text": "by returning an updated version of the object.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1988"
  },
  {
    "text": "Here is an example we saw earlier of custom control schemes ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1991"
  },
  {
    "text": "which include activity definitions. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1995"
  },
  {
    "text": "The default control includes a playElapsedInterval of 60 seconds, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=1997"
  },
  {
    "text": "which means that a report is generated every 60 seconds ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2001"
  },
  {
    "text": "as content items that have no control attribute are played. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2003"
  },
  {
    "text": "But for items with a control attribute of ad, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2007"
  },
  {
    "text": "as soon as five seconds of the content have elapsed, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2009"
  },
  {
    "text": "a report is generated, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2012"
  },
  {
    "text": "and then another report is generated every ten seconds. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2013"
  },
  {
    "text": "There are several limits on reporting intervals defined in the specification.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2016"
  },
  {
    "text": "Reporting provides your service a lot of data, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2022"
  },
  {
    "text": "but tracking that context in your service may be expensive ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2025"
  },
  {
    "text": "as millions of listeners process intents. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2028"
  },
  {
    "text": "A session context can be provided to your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2031"
  },
  {
    "text": "to help bridge the queue playback and intent handling endpoints context.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2033"
  },
  {
    "text": "The session context is only available ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2039"
  },
  {
    "text": "if the HomePod is currently playing media from your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2041"
  },
  {
    "text": "When I tell Siri I like a particular piece of content, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2045"
  },
  {
    "text": "your intent service endpoint receives a playerContext object, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2047"
  },
  {
    "text": "much like how the nowPlaying object discussed in the reporting section ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2051"
  },
  {
    "text": "is sent on every report. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2055"
  },
  {
    "text": "Player context includes Content, Queue ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2058"
  },
  {
    "text": "and User Activity persistentIdentifier values. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2060"
  },
  {
    "text": "These encompass three levels of definition I have introduced previously-- ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2064"
  },
  {
    "text": "the Activity persistentIdentifier, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2067"
  },
  {
    "text": "which defines a potentially long-lived listening session, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2069"
  },
  {
    "text": "the Queue, which defines the current listener's experience ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2072"
  },
  {
    "text": "and the particular content which is now playing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2076"
  },
  {
    "text": "at the time of the intent resolution. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2078"
  },
  {
    "text": "This item is also carried in the intent media search object, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2081"
  },
  {
    "text": "and you may be familiar with using it on iOS devices already. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2084"
  },
  {
    "text": "Consider whether session context is enough information for your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2088"
  },
  {
    "text": "to avoid the need of implementing the update activity endpoint at all ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2091"
  },
  {
    "text": "and handle more complex reporting events. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2095"
  },
  {
    "text": "In this example, request for UpdateMediaAffinityIntentHandling, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2098"
  },
  {
    "text": "the HomePod was already playing a queue from your service, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2101"
  },
  {
    "text": "so a playerContext object is provided to the intent endpoint. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2104"
  },
  {
    "text": "Inside the session object, you will find playerContext ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2108"
  },
  {
    "text": "or a null value if your service is not currently playing.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2111"
  },
  {
    "text": "If your service's taste profiles are explicitly driven ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2116"
  },
  {
    "text": "only by media affinity and play media requests, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2119"
  },
  {
    "text": "player context may handle all of your requirements ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2122"
  },
  {
    "text": "without implementing full reporting.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2124"
  },
  {
    "text": "But before your service uses taste profile information from these tools, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2127"
  },
  {
    "text": "it also must honor constraints on usage ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2131"
  },
  {
    "text": "sent with every request. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2133"
  },
  {
    "text": "In a home, there is a different kind of contextual awareness ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2135"
  },
  {
    "text": "your service must know about and honor. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2139"
  },
  {
    "text": "Each HomePod can be configured with certain options ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2141"
  },
  {
    "text": "that form constraints on your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2144"
  },
  {
    "text": "For example, a HomePod in a child's room ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2146"
  },
  {
    "text": "might have an option to exclude explicit content from results. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2149"
  },
  {
    "text": "Whenever a request is made on this HomePod, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2153"
  },
  {
    "text": "it should not return explicit content. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2156"
  },
  {
    "text": "But a request to a HomePod in a bedroom that does not have the setting enabled ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2158"
  },
  {
    "text": "should be allowed to return explicit content.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2162"
  },
  {
    "text": "Constraints are not optional. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2166"
  },
  {
    "text": "Your service must follow the implications of the constraints presented. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2167"
  },
  {
    "text": "When a guest in my home asks to play some kind of content, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2171"
  },
  {
    "text": "they can make requests on your service ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2174"
  },
  {
    "text": "and they temporarily use my account, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2176"
  },
  {
    "text": "but this interaction should not affect my taste profile. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2179"
  },
  {
    "text": "Since Siri has a pretty good idea what I sound like, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2182"
  },
  {
    "text": "we detect that the request was not made by me ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2185"
  },
  {
    "text": "and tell your service not to use this request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2188"
  },
  {
    "text": "to change my taste profile. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2190"
  },
  {
    "text": "The constraints values must only further constrain ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2192"
  },
  {
    "text": "existing limits of your service's account settings.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2195"
  },
  {
    "text": "If your service has account-specific controls for similar restrictions, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2199"
  },
  {
    "text": "these should be combined to provide what listeners expect from your service.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2203"
  },
  {
    "text": "Here's one more example of an intent request ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2207"
  },
  {
    "text": "that starts with a session object and constraints definitions. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2210"
  },
  {
    "text": "They are small objects, but have a significant impact ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2213"
  },
  {
    "text": "to how your service interacts in the home environment.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2216"
  },
  {
    "text": "updateUserTasteProfile is a Boolean constraint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2220"
  },
  {
    "text": "that indicates whether or not the resolving of this intent ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2222"
  },
  {
    "text": "is to be used for tracking likes, dislikes, play counts ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2225"
  },
  {
    "text": "and any visible listening history your service associated with my account. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2228"
  },
  {
    "text": "When it is false, your service cannot assume that the account used ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2233"
  },
  {
    "text": "is that of the person controlling or initiating the playback. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2236"
  },
  {
    "text": "It can also be false because this HomePod may have been configured ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2240"
  },
  {
    "text": "to never contribute to my account's taste profile, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2243"
  },
  {
    "text": "even when recognizing my voice. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2246"
  },
  {
    "text": "Imagine I had a HomePod in my family room, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2248"
  },
  {
    "text": "and I regularly ask it to play music on behalf of small children. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2251"
  },
  {
    "text": "If I did not have a way to set this option, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2255"
  },
  {
    "text": "my favorite music station may be quite more eclectic than I like. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2257"
  },
  {
    "text": "allowExplicitContent is another Boolean constraint ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2262"
  },
  {
    "text": "that reflects settings per HomePod and Home app. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2265"
  },
  {
    "text": "And your service must consider it for filtering explicit content ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2267"
  },
  {
    "text": "in results from intents. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2271"
  },
  {
    "text": "In fact, if a particular intent request cannot be fulfilled ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2272"
  },
  {
    "text": "because of lack of any nonexplicit content that matches the search, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2276"
  },
  {
    "text": "specific error results for resolvedMediaItem methods ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2281"
  },
  {
    "text": "are provided in SiriKit Media Intents.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2284"
  },
  {
    "text": "Finally, even hardware has constraints. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2287"
  },
  {
    "text": "Queue segments can only be a finite size, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2290"
  },
  {
    "text": "and that value is dynamic per device. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2292"
  },
  {
    "text": "If your queue is larger than this value, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2294"
  },
  {
    "text": "you must implement a segmented queue idiom to adhere to this limit. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2296"
  },
  {
    "text": "The minimum size is a hundred content items per segment.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2300"
  },
  {
    "text": "I've covered a lot today, and it may take you a while to digest it all. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2304"
  },
  {
    "text": "Once you have access, I encourage you to further explore the specification. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2308"
  },
  {
    "text": "It goes into much greater detail about all the endpoints I covered today. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2312"
  },
  {
    "text": "The specification has an open API definition ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2317"
  },
  {
    "text": "for the service endpoints you need to implement, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2319"
  },
  {
    "text": "and it is complete enough to generate basic data model parsing ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2322"
  },
  {
    "text": "and verification code ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2325"
  },
  {
    "text": "as you develop your service. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2327"
  },
  {
    "text": "That's super useful. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2328"
  },
  {
    "text": "Cloud Extension API definitions track changes in iOS SiriKit Media APIs ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2330"
  },
  {
    "text": "with each new release. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2334"
  },
  {
    "text": "With only a few exceptions, almost everything available ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2336"
  },
  {
    "text": "through SiriKit Media APIs on device ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2338"
  },
  {
    "text": "is available through Cloud Extension APIs. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2340"
  },
  {
    "text": "And the queue APIs provide powerful playback definition, control ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2343"
  },
  {
    "text": "and reporting directly to your services. ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2347"
  },
  {
    "text": "Thank you for your interest in SiriKit Media Intents, ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2350"
  },
  {
    "text": "and keep up-to-date on future SiriKit Media API changes ",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2353"
  },
  {
    "text": "at developer.apple.com/siri.",
    "link": "https://developer.apple.com/videos/play/tech-talks-10854/?time=2357"
  }
]