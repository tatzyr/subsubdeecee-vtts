[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=0"
  },
  {
    "text": "David: Hi. My name is David Findlay. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=10"
  },
  {
    "text": "I'm a machine learning engineer on the Create ML team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=13"
  },
  {
    "text": "We've been working on some great improvements ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=15"
  },
  {
    "text": "to the Create ML app and frameworks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=17"
  },
  {
    "text": "I'm excited to take you on a tour of what's new. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=19"
  },
  {
    "text": "Training a large-scale model from scratch can take thousands of hours, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=22"
  },
  {
    "text": "millions of annotated files, and expert domain knowledge. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=25"
  },
  {
    "text": "Our goal is to give you the tools to build great apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=28"
  },
  {
    "text": "that use machine learning without all of the overhead. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=30"
  },
  {
    "text": "We've gone through the process of creating state-of-the-art models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=33"
  },
  {
    "text": "that power many features, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=36"
  },
  {
    "text": "like the Search experience in the Photos app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=37"
  },
  {
    "text": "and Custom Sound Recognition in Accessibility. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=39"
  },
  {
    "text": "Create ML gives you access to our latest technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=42"
  },
  {
    "text": "so you can build your own custom machine learning experiences, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=45"
  },
  {
    "text": "without the hassle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=47"
  },
  {
    "text": "I'll start by going through improvements that we've made to Create ML. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=49"
  },
  {
    "text": "Then I'll introduce a brand-new way of building machine learning models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=53"
  },
  {
    "text": "to understand scenes with multiple labels. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=56"
  },
  {
    "text": "And lastly, I'll talk about new Augmentation APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=59"
  },
  {
    "text": "that we designed to help you improve the quality of your model ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=61"
  },
  {
    "text": "when you're limited on training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=64"
  },
  {
    "text": "Let's get started with Text Classification improvements. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=66"
  },
  {
    "text": "A text classifier is a machine learning task ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=69"
  },
  {
    "text": "designed to recognize patterns in natural language text. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=71"
  },
  {
    "text": "To train such a model, all you need to do ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=75"
  },
  {
    "text": "is provide it with a table of text and label pairs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=77"
  },
  {
    "text": "In this example, I have sports, entertainment, and nature labels.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=80"
  },
  {
    "text": "You can choose the transfer-learning algorithm ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=86"
  },
  {
    "text": "that uses a pre-trained embedding model as a feature extractor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=88"
  },
  {
    "text": "This year, we designed a new embedding model ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=91"
  },
  {
    "text": "and trained it on billions of labeled text examples. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=94"
  },
  {
    "text": "It's a bidirectional encoder representations from transformers model, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=97"
  },
  {
    "text": "or BERT for short. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=101"
  },
  {
    "text": "You can find the new option in the Create ML app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=103"
  },
  {
    "text": "in the model parameters section of the Settings tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=105"
  },
  {
    "text": "The BERT embedding model is multilingual, which means your training data ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=108"
  },
  {
    "text": "can now contain more than just one language. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=112"
  },
  {
    "text": "On top of supporting multilingual text classifiers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=115"
  },
  {
    "text": "BERT can also boost the accuracy of your monolingual text classifiers.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=118"
  },
  {
    "text": "You can leverage BERT on iOS 17, iPadOS 17, and macOS Sonoma. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=122"
  },
  {
    "text": "We have a whole video that covers all of the details. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=127"
  },
  {
    "text": "Make sure to watch \"Explore Natural Language ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=130"
  },
  {
    "text": "multilingual models\" to find out more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=132"
  },
  {
    "text": "Next, I want to talk about how we use transfer-learning ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=136"
  },
  {
    "text": "in the image classification task. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=138"
  },
  {
    "text": "The image classifier in Create ML is designed to help you build models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=141"
  },
  {
    "text": "to answer the question, what is the best label ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=144"
  },
  {
    "text": "to describe the contents of my image? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=146"
  },
  {
    "text": "Similar to the text classifier, the image classifier leverages ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=149"
  },
  {
    "text": "a pre-trained model to extract relevant information from images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=152"
  },
  {
    "text": "The latest version of the Apple Neural Scene Analyzer is now available to you ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=156"
  },
  {
    "text": "for building state-of-the-art models with very little training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=159"
  },
  {
    "text": "Image understanding models in the OS continue to evolve ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=163"
  },
  {
    "text": "to give you the best possible experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=166"
  },
  {
    "text": "You can find out more by checking out our article ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=168"
  },
  {
    "text": "on the machine learning research website. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=170"
  },
  {
    "text": "In the Create ML app, you'll notice a new feature extractor option ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=173"
  },
  {
    "text": "in the model parameters section of the Settings tab.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=176"
  },
  {
    "text": "The new feature extractor has a smaller output embedding size ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=180"
  },
  {
    "text": "when compared to our previous version. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=183"
  },
  {
    "text": "On top of general improvements, this can boost the accuracy ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=185"
  },
  {
    "text": "of your classifier, lead to faster training time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=188"
  },
  {
    "text": "and reduce the memory needed to store the extracted features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=191"
  },
  {
    "text": "Now that I've covered improvements in Create ML, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=194"
  },
  {
    "text": "I want to talk about the new multi-label image classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=197"
  },
  {
    "text": "Before I get there, recall that single-label image classification ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=199"
  },
  {
    "text": "is designed to predict the best label describing the contents of an image. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=203"
  },
  {
    "text": "For example, you might describe this image as dog or maybe outdoors. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=207"
  },
  {
    "text": "But you need to pick one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=212"
  },
  {
    "text": "If you're interested in objects, then you can use ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=214"
  },
  {
    "text": "the object detector to locate objects within a scene. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=216"
  },
  {
    "text": "For example, I've drawn a bounding box around the dog ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=220"
  },
  {
    "text": "and another one around the ball. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=222"
  },
  {
    "text": "Now, this is great, but I'm also interested ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=224"
  },
  {
    "text": "in the scene that the objects are in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=227"
  },
  {
    "text": "I can't really draw a bounding box to represent ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=228"
  },
  {
    "text": "that the dog is in a park or outdoors. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=231"
  },
  {
    "text": "That's where the new multi-label image classifier comes in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=233"
  },
  {
    "text": "It allows you to predict a set of objects, attributes, or labels for your images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=236"
  },
  {
    "text": "For example this image contains a dog, toy, grass, and park. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=241"
  },
  {
    "text": "Let's go build one using Create ML. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=247"
  },
  {
    "text": "As usual, the first thing I'll need to do is collect some training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=249"
  },
  {
    "text": "I decided to have a bit of fun and build a classifier that detects ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=253"
  },
  {
    "text": "multiple succulent plants in different scenes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=257"
  },
  {
    "text": "For example, here I have an image of Haworthia, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=260"
  },
  {
    "text": "Jade, and Aloe in pots on a window sill. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=263"
  },
  {
    "text": "In the next image, I have a person holding a cactus in a pot. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=267"
  },
  {
    "text": "While collecting training images, it's also okay to include some images ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=271"
  },
  {
    "text": "that only have a single label, like a photo of just aloe. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=275"
  },
  {
    "text": "You'll need to organize your annotations in a JSON file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=279"
  },
  {
    "text": "All you need to do is annotate each file with a set of annotations.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=283"
  },
  {
    "text": "Now, let me give you a demo of building a model in the Create ML app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=288"
  },
  {
    "text": "In the Create ML app, I'll select the new multi-label image classifier template.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=293"
  },
  {
    "text": "And create a project named Succulent Classifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=302"
  },
  {
    "text": "This takes me to the Settings tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=313"
  },
  {
    "text": "To start, I'll drag in my training data, which gives me a summary ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=316"
  },
  {
    "text": "of the number of classes and training images.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=319"
  },
  {
    "text": "I also have the option to drag in validation data, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=326"
  },
  {
    "text": "but I'll choose to randomly split the training data for now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=329"
  },
  {
    "text": "I'll use the default number of iterations and also leave out augmentations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=333"
  },
  {
    "text": "I'm done setting up my model, so I'll go ahead and click Train.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=337"
  },
  {
    "text": "This model takes only a few minutes to train on my Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=345"
  },
  {
    "text": "Right away, the model starts extracting features ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=349"
  },
  {
    "text": "using the new feature extractor that I introduced earlier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=351"
  },
  {
    "text": "Once that's finished, the app starts to train a classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=354"
  },
  {
    "text": "During the training process, the app measures the quality of my model ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=358"
  },
  {
    "text": "by computing a mean-average precision score, or MAP for short. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=361"
  },
  {
    "text": "In general, I want to maximize the MAP score ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=366"
  },
  {
    "text": "because that means my model has both a higher precision ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=369"
  },
  {
    "text": "and a higher recall on average for all of the labels in my dataset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=371"
  },
  {
    "text": "My model finished training and converged early at 74 iterations, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=375"
  },
  {
    "text": "with an MAP score of 97% on the training set ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=379"
  },
  {
    "text": "and 93% on the validation set. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=381"
  },
  {
    "text": "The next step is to evaluate my model on test data.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=384"
  },
  {
    "text": "I'll drag a folder in from my desktop and click the Test button.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=390"
  },
  {
    "text": "The test data should contain the same set of class labels ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=395"
  },
  {
    "text": "that I used to train my model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=397"
  },
  {
    "text": "The app calculated a few high-level statistics, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=400"
  },
  {
    "text": "like the MAP Score and which class labels have ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=403"
  },
  {
    "text": "the highest and lowest precision and recall. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=405"
  },
  {
    "text": "Let's focus on the Metrics tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=408"
  },
  {
    "text": "The app calculates metrics for each class label, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=411"
  },
  {
    "text": "like False Positives, False Negatives, Precision, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=413"
  },
  {
    "text": "Recall, and Confidence Threshold. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=417"
  },
  {
    "text": "When making predictions with my model, a prediction is correct ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=420"
  },
  {
    "text": "if the confidence is above the threshold for a given class label. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=423"
  },
  {
    "text": "Let's explore the images that the model predicted ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=426"
  },
  {
    "text": "above the confidence threshold for aloe. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=429"
  },
  {
    "text": "Now I'll click on an example.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=433"
  },
  {
    "text": "The model predicted that this image contains aloe with a 90% confidence, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=437"
  },
  {
    "text": "which is above the aloe confidence threshold of 40%. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=441"
  },
  {
    "text": "For other labels, the model predicted a confidence ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=445"
  },
  {
    "text": "below their respective thresholds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=448"
  },
  {
    "text": "In other words, the model did not predict them. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=449"
  },
  {
    "text": "Next, I want to explore images that my model did not predict aloe ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=452"
  },
  {
    "text": "but are labeled as aloe. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=456"
  },
  {
    "text": "I can do that by selecting the False Negatives result type.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=458"
  },
  {
    "text": "This image is interesting. Let's explore further. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=463"
  },
  {
    "text": "Here, the aloe is behind the barrel cactus and the moon cactus, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=467"
  },
  {
    "text": "so the model has a hard time predicting aloe. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=470"
  },
  {
    "text": "But the good news is that the model predicts two other labels correctly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=473"
  },
  {
    "text": "Next, I'll head over to the Preview tab.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=477"
  },
  {
    "text": "This is where I can preview my model predictions ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=481"
  },
  {
    "text": "on images that I haven't labeled yet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=483"
  },
  {
    "text": "I have a succulent arrangement that I planted myself ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=486"
  },
  {
    "text": "that I think would be fun to try out.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=488"
  },
  {
    "text": "Nailed it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=492"
  },
  {
    "text": "My model correctly predicted my moon cactus, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=493"
  },
  {
    "text": "bunny ears cactus, and barrel cactus in my kitchen. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=495"
  },
  {
    "text": "I'm pretty happy with the quality of my model, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=498"
  },
  {
    "text": "but I'll definitely continue experimenting to understand my model's limitations ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=501"
  },
  {
    "text": "as well as adding more succulents and scenes to my dataset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=504"
  },
  {
    "text": "For now, let's move on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=508"
  },
  {
    "text": "From the Output tab, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=511"
  },
  {
    "text": "I can save the model that I trained to disk.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=513"
  },
  {
    "text": "Let's go through some code that you'll need to write to create predictions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=518"
  },
  {
    "text": "The first step is to create a Vision model from the compiled Core ML model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=522"
  },
  {
    "text": "Then using the vision framework, I'll create an image request handler ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=526"
  },
  {
    "text": "with a source image and then perform a request.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=529"
  },
  {
    "text": "Lastly, I can retrieve the classification observations ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=534"
  },
  {
    "text": "and filter them using a precision and recall value that I'm interested in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=537"
  },
  {
    "text": "To find out more about how to choose a precision and recall value ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=541"
  },
  {
    "text": "that work for your use case, make sure to watch the video ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=544"
  },
  {
    "text": "from WWDC 2019, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=546"
  },
  {
    "text": "\"Understanding Images in Vision Framework.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=548"
  },
  {
    "text": "Before I move on, I want to take a moment and mention that, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=551"
  },
  {
    "text": "similar to our image classifier and multi-label image classifier, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=555"
  },
  {
    "text": "we've enhanced the evaluation tab ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=558"
  },
  {
    "text": "with an explore option for object detection. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=560"
  },
  {
    "text": "Make sure to check it out. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=562"
  },
  {
    "text": "I want to shift your focus to my last topic, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=564"
  },
  {
    "text": "training machine learning models on limited data using augmentations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=567"
  },
  {
    "text": "To get a model that generalizes well, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=571"
  },
  {
    "text": "the images in your training set should have a variety of characteristics ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=573"
  },
  {
    "text": "like different lighting conditions, orientations, and backgrounds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=576"
  },
  {
    "text": "But capturing and labeling training images in different situations ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=579"
  },
  {
    "text": "can be time-consuming. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=583"
  },
  {
    "text": "Data augmentation is a technique that generates new training examples ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=584"
  },
  {
    "text": "from your existing ones by applying transformations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=587"
  },
  {
    "text": "In the case of images, the transformations can be ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=591"
  },
  {
    "text": "horizontal or vertical flipping, cropping, or contrast, just to name a few. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=593"
  },
  {
    "text": "In this example, I start with an image of a succulent ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=598"
  },
  {
    "text": "and generate four variations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=601"
  },
  {
    "text": "And transformations can be combined, like flipping and increasing the contrast. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=603"
  },
  {
    "text": "Augmentations can boost the quality of your model, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=608"
  },
  {
    "text": "especially when you have a small training data set. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=610"
  },
  {
    "text": "You can use them to improve your model's generalization ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=613"
  },
  {
    "text": "because it prevents your model from learning attributes ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=616"
  },
  {
    "text": "like the exact location of an object in a scene. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=618"
  },
  {
    "text": "However, it's important to consider that training is usually slower ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=621"
  },
  {
    "text": "because feature extraction happens at each training iteration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=624"
  },
  {
    "text": "If you haven't already, make sure to watch our videos ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=628"
  },
  {
    "text": "from WWDC 2022, where we introduced Create ML Components. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=630"
  },
  {
    "text": "We designed the framework to help you build custom machine learning models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=635"
  },
  {
    "text": "using components like transformers and estimators. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=638"
  },
  {
    "text": "This year, we added new Augmentation APIs that you can use ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=641"
  },
  {
    "text": "to design your own custom augmentation pipelines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=644"
  },
  {
    "text": "If you have experience with SwiftUI, this may be familiar to you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=647"
  },
  {
    "text": "The first step is to create an augmenter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=651"
  },
  {
    "text": "Similar to SwiftUI, the augmenter uses result builders. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=653"
  },
  {
    "text": "In the body of the augmenter, you can add transformations to augment your data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=658"
  },
  {
    "text": "Since the augmenter is generic, your data can be labeled images, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=663"
  },
  {
    "text": "labeled sounds, or even something else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=666"
  },
  {
    "text": "The important part is that the input and output types ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=669"
  },
  {
    "text": "of each transformation need to match. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=672"
  },
  {
    "text": "For example, taking an image and producing an image. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=674"
  },
  {
    "text": "I want to augment my images by flipping them horizontally ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=678"
  },
  {
    "text": "with a 50% probability. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=681"
  },
  {
    "text": "I'll start by adding ApplyRandomly to the Augmenter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=683"
  },
  {
    "text": "This applies a transformation with a given probability. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=686"
  },
  {
    "text": "Then I'll add a horizontal flipping transformer to its body. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=689"
  },
  {
    "text": "Okay, now that I have my augmenter, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=694"
  },
  {
    "text": "I can use it to create augmentations ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=696"
  },
  {
    "text": "by calling the applied method. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=698"
  },
  {
    "text": "When you design augmentations, it's important to carefully consider ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=701"
  },
  {
    "text": "the nature of your data.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=704"
  },
  {
    "text": "It's unlikely that you'll encounter an upside down succulent. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=706"
  },
  {
    "text": "So it doesn't make sense to apply a vertical flip augmentation in this case. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=709"
  },
  {
    "text": "Or imagine for a moment that you wanted to classify traffic signs instead. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=714"
  },
  {
    "text": "When you apply a flip augmentation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=718"
  },
  {
    "text": "the label may no longer correctly describe your image. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=719"
  },
  {
    "text": "So remember to consider the nature of your data ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=722"
  },
  {
    "text": "before designing a custom augmentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=725"
  },
  {
    "text": "All right, the next step is to add more transformations to the augmenter.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=727"
  },
  {
    "text": "This time, I'll randomly rotate my images ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=733"
  },
  {
    "text": "using the UniformRandomFloatingPointParameter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=735"
  },
  {
    "text": "This generates a random angle each time that I apply the augmentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=738"
  },
  {
    "text": "And lastly, I'll randomly crop the images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=742"
  },
  {
    "text": "Note that each transformation in the augmenter is applied in sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=746"
  },
  {
    "text": "So first, my image is randomly flipped. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=750"
  },
  {
    "text": "The result is randomly rotated and then randomly cropped. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=753"
  },
  {
    "text": "I've only scratched the surface of what you can do with the Augmenter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=757"
  },
  {
    "text": "Here are some of the components that we provide to get you started. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=761"
  },
  {
    "text": "But what if you want to go even further? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=765"
  },
  {
    "text": "Let's go through an example of how you can build custom transformations ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=767"
  },
  {
    "text": "and use them to augment your images.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=771"
  },
  {
    "text": "In order to build a robust classifier, it's important to capture ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=774"
  },
  {
    "text": "your training images in different scenes and environments. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=777"
  },
  {
    "text": "In this example, I'll create a custom augmentation ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=780"
  },
  {
    "text": "that places a succulent in a random location in a random scene.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=783"
  },
  {
    "text": "I'll start by defining a RandomImageBackground. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=787"
  },
  {
    "text": "It conforms to a new protocol, RandomTransformer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=790"
  },
  {
    "text": "which is similar to a transformer but takes a random number generator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=794"
  },
  {
    "text": "Since I want my augmentations to place succulents randomly ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=798"
  },
  {
    "text": "with different background scenes, I'll create an initializer ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=801"
  },
  {
    "text": "that takes background images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=804"
  },
  {
    "text": "To conform to the RandomTransformer protocol, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=807"
  },
  {
    "text": "I'll need to implement the applied method. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=809"
  },
  {
    "text": "When applying my augmentation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=811"
  },
  {
    "text": "the first step is to randomly select a background. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=813"
  },
  {
    "text": "Then, I'll choose a random location in the background image ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=817"
  },
  {
    "text": "where I'd like to place my input image, taking care not to crop it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=820"
  },
  {
    "text": "Next, I'll translate my input image to the random location. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=824"
  },
  {
    "text": "And finally, I'll place the input image over the randomly selected background. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=828"
  },
  {
    "text": "I'll add my new custom augmentation to the end so that the flipping, rotating, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=833"
  },
  {
    "text": "and cropping happen before I place the succulent in different backgrounds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=838"
  },
  {
    "text": "And this is my final augmenter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=842"
  },
  {
    "text": "Using my augmenter, I can generate ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=844"
  },
  {
    "text": "some really interesting images for training a classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=846"
  },
  {
    "text": "That's the next step. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=850"
  },
  {
    "text": "When using augmentations it makes more sense ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=851"
  },
  {
    "text": "to train progressively using the update method. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=854"
  },
  {
    "text": "With that in mind, let's go through an example ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=857"
  },
  {
    "text": "of training using augmentations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=859"
  },
  {
    "text": "And I won't hold back: I'll also incorporate batching, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=861"
  },
  {
    "text": "randomization, and early stopping. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=864"
  },
  {
    "text": "I'll start by creating an empty image classifier model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=866"
  },
  {
    "text": "Then I'll create a training loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=871"
  },
  {
    "text": "In the training loop, the first step is to shuffle and augment my training images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=873"
  },
  {
    "text": "You'll want to shuffle before augmenting ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=877"
  },
  {
    "text": "so that on each iteration, the batches contain different images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=879"
  },
  {
    "text": "The result of the augmenter is an async sequence, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=884"
  },
  {
    "text": "which means that transformations happen lazily. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=886"
  },
  {
    "text": "Using the batches method, I can group the async sequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=890"
  },
  {
    "text": "of augmentations into groups. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=893"
  },
  {
    "text": "In this case, I've used a batch size of 16. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=896"
  },
  {
    "text": "Finally, I'll update my model with each batch of augmented images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=900"
  },
  {
    "text": "This is why using the update method is a good choice ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=904"
  },
  {
    "text": "when doing data augmentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=907"
  },
  {
    "text": "On each iteration, you get a new set of images. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=908"
  },
  {
    "text": "Depending on your augmenter, the update method is unlikely ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=912"
  },
  {
    "text": "to encounter the exact same image more than once. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=915"
  },
  {
    "text": "This encourages the model to generalize instead of memorize.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=918"
  },
  {
    "text": "I selected 100 iterations, but ideally you should stop training ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=922"
  },
  {
    "text": "when the validation accuracy stops improving. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=925"
  },
  {
    "text": "In this example, the training accuracy continues to improve, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=928"
  },
  {
    "text": "but notice that the validation accuracy starts to decrease after a few iterations.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=932"
  },
  {
    "text": "This means that the model is memorizing the training data, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=937"
  },
  {
    "text": "making it less generalizable to new data ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=940"
  },
  {
    "text": "and performing worse on validation and test data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=942"
  },
  {
    "text": "Continuing training after this is detrimental. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=945"
  },
  {
    "text": "As a final example, I'll add early stopping to the training loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=948"
  },
  {
    "text": "After the update step, you can compute validation metrics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=952"
  },
  {
    "text": "I'm using validation accuracy to stop training early, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=956"
  },
  {
    "text": "which works for classifier models. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=958"
  },
  {
    "text": "But that is really up to you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=961"
  },
  {
    "text": "You can use validation loss ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=963"
  },
  {
    "text": "or even design your own metric to assess the quality of your model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=964"
  },
  {
    "text": "Then, I'll break out of the training loop ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=968"
  },
  {
    "text": "when the accuracy hasn't improved for the last five iterations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=970"
  },
  {
    "text": "And that concludes my augmented image classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=974"
  },
  {
    "text": "In this video, I introduced new state-of-the-art models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=977"
  },
  {
    "text": "shipped in the OS that you can use to build ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=980"
  },
  {
    "text": "great machine learning experiences in your apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=982"
  },
  {
    "text": "Then I gave an example of how you can build models ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=986"
  },
  {
    "text": "for understanding scenes using our new multi-label image classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=988"
  },
  {
    "text": "Finally, I went into detail about how you can build ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=992"
  },
  {
    "text": "your own custom augmentations to improve your model quality. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=995"
  },
  {
    "text": "And that's a wrap. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=999"
  },
  {
    "text": "It's time for you to enhance your apps with Create ML.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10044/?time=1000"
  }
]