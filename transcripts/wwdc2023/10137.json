[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=0"
  },
  {
    "text": "Rasmus: Hi, I'm Rasmus. I'm an engineer ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=10"
  },
  {
    "text": "on the Camera Algorithms team working with Computational Video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=12"
  },
  {
    "text": "I'm already excited about Cinematic mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=16"
  },
  {
    "text": "And now I'm even more excited about showing ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=18"
  },
  {
    "text": "how you can integrate the magic of Cinematic mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=21"
  },
  {
    "text": "in your very own app using the new Cinematic API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=24"
  },
  {
    "text": "In this presentation, I'll walk through the necessary steps ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=29"
  },
  {
    "text": "using the new API to build a sample app which does playback and edit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=32"
  },
  {
    "text": "realizing the awesome capabilities of Cinematic mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=37"
  },
  {
    "text": "But before I start talking about integration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=41"
  },
  {
    "text": "let me first show you what Cinematic mode is, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=44"
  },
  {
    "text": "how you can capture it, and what you can do with it post-capture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=47"
  },
  {
    "text": "We introduced Cinematic mode in iPhone 13, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=51"
  },
  {
    "text": "and it really is a tiny film crew right in your pocket. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=53"
  },
  {
    "text": "It brings you a camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=57"
  },
  {
    "text": "with beautiful shallow depth of field and natural focus falloff, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=59"
  },
  {
    "text": "a director, who directs the attention and narrative by changing the focus, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=64"
  },
  {
    "text": "and a focus puller, who anticipates keyframes ahead of time ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=68"
  },
  {
    "text": "and creates smooth transitions between focus points. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=72"
  },
  {
    "text": "So how do you capture Cinematic mode? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=76"
  },
  {
    "text": "It's captured right in the Camera app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=77"
  },
  {
    "text": "on any device in the iPhone 13 & 14 lineup, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=80"
  },
  {
    "text": "and it gives you a rendering preview as you record. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=83"
  },
  {
    "text": "This makes it super accessible, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=87"
  },
  {
    "text": "whether you're an aspiring indie filmmaker ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=89"
  },
  {
    "text": "or just like to add a magic touch to your camping trip videos. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=92"
  },
  {
    "text": "And while I did dream of becoming a filmmaker, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=96"
  },
  {
    "text": "I do love to capture Cinematic mode of my own family. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=99"
  },
  {
    "text": "But the magic doesn't stop here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=102"
  },
  {
    "text": "There's more to Cinematic mode than meets the eye. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=104"
  },
  {
    "text": "It allows you to make some pretty amazing nondestructive edits post-capture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=107"
  },
  {
    "text": "You can change the aperture, and thereby the amount of bokeh. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=112"
  },
  {
    "text": "And you can redirect the focus and narrative ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=116"
  },
  {
    "text": "using alternative detections. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=118"
  },
  {
    "text": "This shows the post-capture editing in Photos, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=121"
  },
  {
    "text": "but editing can also be done in apps like iMovie, Final Cut Pro, and Motion. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=124"
  },
  {
    "text": "And now with the introduction of the Cinematic API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=130"
  },
  {
    "text": "you can use Cinematic mode videos for playback and edit ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=134"
  },
  {
    "text": "in your own amazing app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=137"
  },
  {
    "text": "The Cinematic API is widely available on new macOS Sonoma, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=140"
  },
  {
    "text": "iOS 17, iPadOS 17, and tvOS 17. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=145"
  },
  {
    "text": "So this is really exciting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=149"
  },
  {
    "text": "First I'll start with some fundamentals ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=151"
  },
  {
    "text": "about the special Cinematic mode assets and dataflow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=154"
  },
  {
    "text": "Then I will go through the specific steps to get and play a Cinematic mode asset ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=157"
  },
  {
    "text": "with simple playback adjustments, like changing the aperture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=162"
  },
  {
    "text": "And then how to do nondestructive edits driving the focus in Cinematic mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=166"
  },
  {
    "text": "and how to save and load these edit changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=172"
  },
  {
    "text": "I will go through some of the new Cinematic API calls ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=176"
  },
  {
    "text": "and also provide a sample code app which can be used as a detailed reference. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=179"
  },
  {
    "text": "But as promised, let me start by explaining ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=184"
  },
  {
    "text": "some fundamentals about Cinematic mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=187"
  },
  {
    "text": "Cinematic mode actually consists of two files ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=189"
  },
  {
    "text": "and a dataflow from one to the other. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=192"
  },
  {
    "text": "First there’s the rendered asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=195"
  },
  {
    "text": "This is a baked file with the Cinematic mode effect applied, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=197"
  },
  {
    "text": "and it can be exported, shared, and played as a regular QuickTime movie. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=201"
  },
  {
    "text": "And then there’s the special Cinematic mode asset, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=206"
  },
  {
    "text": "which has all the information needed to create the rendered asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=209"
  },
  {
    "text": "It allows you to do nondestructive post-capture edits, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=213"
  },
  {
    "text": "such as change the aperture and refocus to your narrative. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=216"
  },
  {
    "text": "Let’s start by taking a look at the rendered asset, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=220"
  },
  {
    "text": "and break down a shot with a little Cinematography 101.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=223"
  },
  {
    "text": "Opening shot: we enter what’s clearly an important game of street handball, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=228"
  },
  {
    "text": "and by focusing on the main subject, we really feel the tension ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=233"
  },
  {
    "text": "as he gets ready to make a big play. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=236"
  },
  {
    "text": "He checks his team player. He’s also ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=239"
  },
  {
    "text": "Racking focus to him emphasizes just how ready he is. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=242"
  },
  {
    "text": "We rack focus back to our main subject. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=246"
  },
  {
    "text": "This is it; you could cut through the tension with a knife.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=249"
  },
  {
    "text": "He makes the play and totally ruins it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=254"
  },
  {
    "text": "setting up some comic relief. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=256"
  },
  {
    "text": "Now let’s change the narrative to be about the team player ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=259"
  },
  {
    "text": "by focusing on him early in the shot, and instead of going back and forth, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=262"
  },
  {
    "text": "we keep him in focus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=266"
  },
  {
    "text": "I’ll be the voice of his thoughts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=268"
  },
  {
    "text": "“I love you, buddy, but you always take forever.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=269"
  },
  {
    "text": "\"Yes, I’m ready, but I have low expectations.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=273"
  },
  {
    "text": "\"What a waste of time. Bravo.” ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=278"
  },
  {
    "text": "So this was shot on iPhone 13, showcasing the cinematography tools for storytelling ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=280"
  },
  {
    "text": "provided by Cinematic mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=285"
  },
  {
    "text": "And to produce this rendered asset, there’s the special Cinematic mode asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=287"
  },
  {
    "text": "To support nondestructive post-capture edits, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=291"
  },
  {
    "text": "a Cinematic mode asset actually has multiple tracks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=294"
  },
  {
    "text": "First is the video track, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=298"
  },
  {
    "text": "which is the original QuickTime movie as captured. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=299"
  },
  {
    "text": "It can be HDR/SDR, 1080p at 30 frames per second, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=303"
  },
  {
    "text": "and on iPhone 14, even 4K at 24, 25, and 30 frames per second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=308"
  },
  {
    "text": "This track can be played as a regular video, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=314"
  },
  {
    "text": "but it lacks the aesthetics and storytelling ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=317"
  },
  {
    "text": "compared to the rendered asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=319"
  },
  {
    "text": "There’s no suspense and no comic relief, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=321"
  },
  {
    "text": "and we're just watching some people play a game in the back alley. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=324"
  },
  {
    "text": "The second track contains disparity, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=328"
  },
  {
    "text": "which is the pixel shift seen from two cameras looking at the same scene. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=330"
  },
  {
    "text": "Close objects are more shifted than objects further away. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=335"
  },
  {
    "text": "You can test this yourself closing one eye and then the other, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=338"
  },
  {
    "text": "and see how objects shift at different distances. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=342"
  },
  {
    "text": "Disparity is used for focus and rendering the shallow depth of field. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=345"
  },
  {
    "text": "The disparity map is at a lower resolution than the video track. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=350"
  },
  {
    "text": "The track, shown as a colorization, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=355"
  },
  {
    "text": "contains relative and not absolute disparity, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=356"
  },
  {
    "text": "which means it can only be used relative to other samples in the same map, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=360"
  },
  {
    "text": "such as rendering relative to a focus disparity ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=365"
  },
  {
    "text": "or transitioning between two focus disparities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=368"
  },
  {
    "text": "For insights about relative disparity and great depth puns, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=373"
  },
  {
    "text": "I highly recommend WWDC17, \"Capturing Depth in iPhone Photography.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=376"
  },
  {
    "text": "The third track contains important metadata for rendering and editing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=382"
  },
  {
    "text": "The track consists of two things. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=387"
  },
  {
    "text": "First, the rendering attributes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=389"
  },
  {
    "text": "which hold focus disparity and aperture as an f-number. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=392"
  },
  {
    "text": "These drive the rendering. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=396"
  },
  {
    "text": "The focus, shown as an overlay, is decided by the Cinematic engine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=398"
  },
  {
    "text": "while the aperture is chosen by the user. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=403"
  },
  {
    "text": "And then there’s the Cinematic script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=406"
  },
  {
    "text": "which holds all the automatic scene detections.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=409"
  },
  {
    "text": "This scene shows face, head and torso, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=412"
  },
  {
    "text": "which are grouped by an ID linking them together over time when possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=416"
  },
  {
    "text": "The script also holds the focus decisions, deciding which detection to keep in focus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=422"
  },
  {
    "text": "The focus decisions can be changed post-capture to follow other detections ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=428"
  },
  {
    "text": "and thereby changing the narrative and rendering. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=433"
  },
  {
    "text": "This is the dataflow from the Cinematic mode asset ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=436"
  },
  {
    "text": "to the rendered asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=439"
  },
  {
    "text": "As just covered, the Cinematic mode asset holds all the information needed ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=441"
  },
  {
    "text": "for rendering and post-capture focus and aperture changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=445"
  },
  {
    "text": "Following is the optional editing, where changes are nondestructive ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=450"
  },
  {
    "text": "and can always be reverted back to the original. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=454"
  },
  {
    "text": "If no editing is done, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=457"
  },
  {
    "text": "the Cinematic engine controls the focus disparity automatically, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=459"
  },
  {
    "text": "and the aperture set by the user at capture time remains unchanged. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=464"
  },
  {
    "text": "With a focus disparity and aperture, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=469"
  },
  {
    "text": "the rendering applies the shallow depth of field ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=471"
  },
  {
    "text": "with accurate focus falloff using the disparity map. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=474"
  },
  {
    "text": "And finally, we get the rendered asset with the effect applied, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=478"
  },
  {
    "text": "which is a regular, shareable QuickTime movie. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=481"
  },
  {
    "text": "With a better understanding of Cinematic mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=485"
  },
  {
    "text": "it’s time to start building the playback app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=487"
  },
  {
    "text": "But first we need to get hold of a Cinematic mode asset, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=490"
  },
  {
    "text": "so let’s look at the code to get it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=494"
  },
  {
    "text": "It’s quite easy to pick a Cinematic mode asset from Photos library.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=496"
  },
  {
    "text": "Just use a Photos picker and filter for Cinematic videos. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=501"
  },
  {
    "text": "The picker will get a local identifier for the selected file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=505"
  },
  {
    "text": "As a non-code related side note, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=509"
  },
  {
    "text": "if you don’t already have a Cinematic mode asset, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=512"
  },
  {
    "text": "it can be AirDropped between different user devices ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=515"
  },
  {
    "text": "with the All Photos Data option ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=517"
  },
  {
    "text": "to include both the rendered asset and the Cinematic mode asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=519"
  },
  {
    "text": "Let’s get back to coding. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=523"
  },
  {
    "text": "Using the asset identifier from the pick, I can now fetch a photos asset ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=525"
  },
  {
    "text": "with information about the Cinematic mode asset before I request it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=530"
  },
  {
    "text": "I need to make sure to set request options to get the original version ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=535"
  },
  {
    "text": "and allow for network access in case the asset is on iCloud, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=539"
  },
  {
    "text": "and then finally request the Cinematic mode asset as an AVAsset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=544"
  },
  {
    "text": "And now to the exciting part. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=549"
  },
  {
    "text": "We have gotten the Cinematic mode asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=550"
  },
  {
    "text": "Let’s integrate playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=552"
  },
  {
    "text": "A rendered asset can be played back ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=554"
  },
  {
    "text": "using AVPlayer and AVPlayerItem as a regular movie, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=556"
  },
  {
    "text": "and so can the movie track inside the Cinematic mode asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=560"
  },
  {
    "text": "But to realize the potential of Cinematic mode assets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=564"
  },
  {
    "text": "we need to add a custom video compositor, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=568"
  },
  {
    "text": "which can handle multiple tracks, user changes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=571"
  },
  {
    "text": "and finally, call the Cinematic renderer to compose the output. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=574"
  },
  {
    "text": "This custom compositor can also be used for thumbnails and offline export, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=578"
  },
  {
    "text": "but let’s focus on using it for playback and editing of Cinematic mode assets. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=583"
  },
  {
    "text": "I will only go into details specific to the Cinematic API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=589"
  },
  {
    "text": "so for additional insights on custom video compositor classes and HDR, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=593"
  },
  {
    "text": "I recommend WWDC20, \"Edit and Play Back HDR Video with AVFoundation.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=598"
  },
  {
    "text": "Let’s start using the Cinematic API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=605"
  },
  {
    "text": "The Cinematic API uses the prefix CN, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=608"
  },
  {
    "text": "so you might be able to spot the three API calls needed ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=612"
  },
  {
    "text": "to set up the rendering session which will render the shallow depth of field. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=615"
  },
  {
    "text": "The first call gets the rendering attributes from the Cinematic asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=620"
  },
  {
    "text": "The second sets up a rendering session with these attributes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=624"
  },
  {
    "text": "The rendering session uses the GPU, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=628"
  },
  {
    "text": "so I need to provide a metal command queue. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=630"
  },
  {
    "text": "And the last call sets the rendering quality to export. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=634"
  },
  {
    "text": "Quality can be set to different enums like preview and export ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=638"
  },
  {
    "text": "depending on your performance and quality constraints. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=641"
  },
  {
    "text": "In these and following code snippets, I have removed good practice error checks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=644"
  },
  {
    "text": "like guard let else error, just to focus on the core code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=648"
  },
  {
    "text": "The custom compositor needs a composition, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=653"
  },
  {
    "text": "which includes the Cinematic asset info needed to render the output. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=657"
  },
  {
    "text": "In a typical case, you would need multiple steps to add the multiple tracks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=661"
  },
  {
    "text": "but fortunately, we provide an easy way to do this in just one step. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=666"
  },
  {
    "text": "You can add all the tracks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=670"
  },
  {
    "text": "from the asset info to the composition, directly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=672"
  },
  {
    "text": "The Cinematic composition info is just like the Cinematic asset info, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=676"
  },
  {
    "text": "but points to composition tracks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=680"
  },
  {
    "text": "Then I get the Cinematic script from the Cinematic asset. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=683"
  },
  {
    "text": "The Cinematic script holds all the detections and focus decisions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=687"
  },
  {
    "text": "And I will go into more detail about this later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=692"
  },
  {
    "text": "For the custom compositor, I set up instruction with rendering session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=695"
  },
  {
    "text": "composition with asset tracks, Cinematic script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=699"
  },
  {
    "text": "and aperture as an f-number. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=702"
  },
  {
    "text": "This custom instruction describes how to compose the rendered Cinematic content.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=705"
  },
  {
    "text": "To play the video, I’ll need a video composition, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=711"
  },
  {
    "text": "to which I’ll add track IDs from the Cinematic composition, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=714"
  },
  {
    "text": "add a sample custom compositor, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=718"
  },
  {
    "text": "which is where the renderer is called to compose the effect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=721"
  },
  {
    "text": "and add the composition instruction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=724"
  },
  {
    "text": "Let’s take a closer look at what goes on in the custom compositor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=726"
  },
  {
    "text": "There are a few key things specific to the Cinematic API ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=730"
  },
  {
    "text": "inside the startRequest function in the custom compositor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=734"
  },
  {
    "text": "Using the track IDs from the Cinematic composition, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=737"
  },
  {
    "text": "I get the source buffers for the current frame ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=741"
  },
  {
    "text": "from the original video track, the disparity track, the metadata track, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=745"
  },
  {
    "text": "and finally I create a buffer for the rendered output. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=751"
  },
  {
    "text": "These buffers allow us to make edits and new renders. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=754"
  },
  {
    "text": "From the metadata buffer, I can get the rendering frame attributes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=758"
  },
  {
    "text": "which drive the rendering. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=762"
  },
  {
    "text": "The metadata is an opaque structure, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=764"
  },
  {
    "text": "so I’ll use CNRenderingSession and get the frame attributes directly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=766"
  },
  {
    "text": "With the frame attributes, I can now make optional playback changes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=772"
  },
  {
    "text": "in this case by changing the aperture f-number according to the instruction, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=776"
  },
  {
    "text": "which holds aperture changes from a UI element. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=780"
  },
  {
    "text": "Focus disparity can be changed in a similar fashion, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=784"
  },
  {
    "text": "but I’ll get back to making scene-driven changes using detections later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=787"
  },
  {
    "text": "At this point, we're really, really close to achieve playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=791"
  },
  {
    "text": "I just need to get a command buffer on the rendering command queue, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=795"
  },
  {
    "text": "such that the composed output can be rendered on the GPU. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=799"
  },
  {
    "text": "Encode the rendering using the updated frame attributes ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=803"
  },
  {
    "text": "and the image and disparity buffers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=807"
  },
  {
    "text": "Add a completion handler for the output buffer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=810"
  },
  {
    "text": "which will be passed to the video composition. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=813"
  },
  {
    "text": "And finally commit the command buffer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=816"
  },
  {
    "text": "Now let’s try out playback in the sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=818"
  },
  {
    "text": "I can now select a Cinematic mode asset from Photos library.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=822"
  },
  {
    "text": "And when I play back the asset, the effect is applied in real time.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=827"
  },
  {
    "text": "I can scrub back and forth and make changes to aperture, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=833"
  },
  {
    "text": "which changes the amount of bokeh.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=838"
  },
  {
    "text": "Stopping down minimizes the effect.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=844"
  },
  {
    "text": "Opening up increases it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=849"
  },
  {
    "text": "Maybe this is too much.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=851"
  },
  {
    "text": "I think this looks good.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=855"
  },
  {
    "text": "The app is already pretty cool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=857"
  },
  {
    "text": "but it will get even cooler in the upcoming edit section. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=859"
  },
  {
    "text": "And to remind you, as a reference, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=862"
  },
  {
    "text": "code for each part is available in the sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=864"
  },
  {
    "text": "I will now move on to extend the playback app and custom video compositor ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=867"
  },
  {
    "text": "to do more advanced and nondestructive edits ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=872"
  },
  {
    "text": "by changing the Cinematic script and thereby the focus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=874"
  },
  {
    "text": "But let’s revisit the Photos app editing environment for Cinematic mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=878"
  },
  {
    "text": "and look specifically at the focus, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=883"
  },
  {
    "text": "which is automatically driven during capture ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=885"
  },
  {
    "text": "by detecting objects and deciding where and on what to focus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=888"
  },
  {
    "text": "These detections and decisions are all in the Cinematic script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=893"
  },
  {
    "text": "and the script can be changed to your narrative. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=897"
  },
  {
    "text": "The focus detection is shown as a yellow square, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=900"
  },
  {
    "text": "and below the timeline, we have keyframes and focus decision changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=904"
  },
  {
    "text": "To better understand how this works, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=909"
  },
  {
    "text": "let’s break down the Cinematic script structure with a simple example. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=911"
  },
  {
    "text": "Let’s start with just two Cinematic script frames in a short sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=915"
  },
  {
    "text": "Each hold all detections for a given point in time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=920"
  },
  {
    "text": "and in this case just two detections. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=923"
  },
  {
    "text": "The detections are tracked over time with a group ID, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=926"
  },
  {
    "text": "which groups face, head, and torso together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=930"
  },
  {
    "text": "In addition, cats, dogs, and balls are detected and tracked, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=934"
  },
  {
    "text": "but here we just have the face of Actor 1 and Actor 2. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=938"
  },
  {
    "text": "An automatic base decision puts focus on Actor 1 in the first frame, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=943"
  },
  {
    "text": "and focus will follow this track until a new decision. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=947"
  },
  {
    "text": "Even after Actor 3 enters the scene ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=952"
  },
  {
    "text": "and introduces a new face and detection track, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=954"
  },
  {
    "text": "the focus remains on Actor 1. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=958"
  },
  {
    "text": "In frame 5, an automatic keyframe event changes the decision and focus to Actor 2. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=961"
  },
  {
    "text": "And after just four frames, Actor 3 does a disheartened exit ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=969"
  },
  {
    "text": "without ever getting the focused attention she deserves. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=973"
  },
  {
    "text": "Focus remains on Actor 2 for the rest of the sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=976"
  },
  {
    "text": "These automatic base decisions are decided on a range of parameters ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=981"
  },
  {
    "text": "like who faces the camera, who looks away, who’s closer, and what’s interesting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=985"
  },
  {
    "text": "And while we do our best to create a good narrative, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=992"
  },
  {
    "text": "you might have another one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=994"
  },
  {
    "text": "Luckily, decisions can be changed, and actually in two ways. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=996"
  },
  {
    "text": "The first one is to add a weak user decision. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=999"
  },
  {
    "text": "This brings Actor 3 into focus as she enters the scene. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1004"
  },
  {
    "text": "However, a weak decision only follows a track ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1008"
  },
  {
    "text": "until the next base or user decision, which happens in frame 5, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1011"
  },
  {
    "text": "where a base decision changes focus to Actor 2 for the remaining frames. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1015"
  },
  {
    "text": "So if we wanted focus to stay on Actor 3, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1021"
  },
  {
    "text": "we could add another weak decision in frame 5, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1024"
  },
  {
    "text": "or we could use something stronger. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1027"
  },
  {
    "text": "Yes, you might have guessed it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1029"
  },
  {
    "text": "a strong user decision. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1031"
  },
  {
    "text": "A strong decision will keep focus on a subject ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1033"
  },
  {
    "text": "until the next user decision to focus elsewhere ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1036"
  },
  {
    "text": "or the end of the detection track. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1039"
  },
  {
    "text": "Adding a strong decision brings Actor 3 into focus ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1042"
  },
  {
    "text": "and overrides the following base decision. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1045"
  },
  {
    "text": "After the detection track of Actor 3 ends, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1048"
  },
  {
    "text": "the focus falls back to the base decision, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1052"
  },
  {
    "text": "which is to focus on Actor 2. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1055"
  },
  {
    "text": "The decision hierarchy works as follows: ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1058"
  },
  {
    "text": "user decisions on top of base decisions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1061"
  },
  {
    "text": "user decisions apply when possible, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1064"
  },
  {
    "text": "base decisions fill the gaps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1066"
  },
  {
    "text": "So as done in this example, a user can change just parts of the script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1069"
  },
  {
    "text": "And while both decisions revert to a base decision when a detection track ends, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1074"
  },
  {
    "text": "a strong decision holds it’s focus track as long as possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1079"
  },
  {
    "text": "Before moving to change the script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1084"
  },
  {
    "text": "let’s get a script frame and draw the detection boxes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1086"
  },
  {
    "text": "First I need to grab the frame time from the video composition request, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1089"
  },
  {
    "text": "and then get the Cinematic script frame for that current point in time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1095"
  },
  {
    "text": "This script frame holds all detections, including the focus detection. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1100"
  },
  {
    "text": "Now it’s easy to draw the detection boxes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1104"
  },
  {
    "text": "By iterating all the detections in a script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1108"
  },
  {
    "text": "I can get each detection rectangle and draw it to a texture ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1111"
  },
  {
    "text": "attached to a renderEncoder using a draw command. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1115"
  },
  {
    "text": "In this example, the detections are drawn in white. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1119"
  },
  {
    "text": "And to emphasize what’s currently the focusDetection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1122"
  },
  {
    "text": "let’s draw that in another color. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1126"
  },
  {
    "text": "I get the focus detection directly from the Cinematic script frame, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1128"
  },
  {
    "text": "get its corresponding rectangle, and to make it stand out, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1133"
  },
  {
    "text": "I draw the focus rectangle in yellow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1136"
  },
  {
    "text": "Let’s try the playback app with the added detection overlay. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1141"
  },
  {
    "text": "I can now enable the new detection overlay to draw the detections.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1144"
  },
  {
    "text": "This scene shows face, head, and torso in white ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1150"
  },
  {
    "text": "and the focus detection in yellow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1154"
  },
  {
    "text": "You can customize the overlay to only show a specific subset of detections ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1157"
  },
  {
    "text": "if that makes sense for your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1162"
  },
  {
    "text": "When I start playback, notice how the focus and rendering follows ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1164"
  },
  {
    "text": "the yellow focus detections through the movie ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1168"
  },
  {
    "text": "while alternative detections just show in white. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1170"
  },
  {
    "text": "Let me show you how to use these alternative detections ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1174"
  },
  {
    "text": "to change the focus.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1178"
  },
  {
    "text": "Once we know how to draw the detection boxes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1180"
  },
  {
    "text": "actually changing the script with a UI tapping point is very similar. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1183"
  },
  {
    "text": "Again I’ll iterate over all detections, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1187"
  },
  {
    "text": "and if the tapping point is inside a detection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1190"
  },
  {
    "text": "I’ll get it’s corresponding detectionID and create a new decision. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1193"
  },
  {
    "text": "The decision strength can be set in the UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1199"
  },
  {
    "text": "In the sample app, weak is set with a single tap and strong with a double tap, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1202"
  },
  {
    "text": "but the UI is really up to you.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1207"
  },
  {
    "text": "Then finally I add this new user decision to the Cinematic script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1211"
  },
  {
    "text": "and the script has changed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1215"
  },
  {
    "text": "So let me talk about how the updated script drives the focus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1218"
  },
  {
    "text": "Let’s consider this a normal clip length and look at three decisions ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1221"
  },
  {
    "text": "and their corresponding focus detection tracks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1225"
  },
  {
    "text": "Let’s arrange the focus tracks according to time and distance in a 2D plot. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1229"
  },
  {
    "text": "Because the Cinematic engine knows the whole updated script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1234"
  },
  {
    "text": "it can make smooth focus transitions ahead of time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1238"
  },
  {
    "text": "It looks something like this, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1242"
  },
  {
    "text": "where a focus rack starts ahead of time ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1245"
  },
  {
    "text": "to reach focus at the beginning of each keyframe. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1247"
  },
  {
    "text": "It’s pretty magical, and it works like a focus puller, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1250"
  },
  {
    "text": "who can direct attention and rack focus ahead of time by knowing the set markers.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1253"
  },
  {
    "text": "The racked focus disparity can be accessed ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1260"
  },
  {
    "text": "directly from a frame in the updated Cinematic script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1262"
  },
  {
    "text": "I have already shown how to extract a script frame, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1267"
  },
  {
    "text": "and changing the frame attributes for focus is similar ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1270"
  },
  {
    "text": "to changing the aperture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1274"
  },
  {
    "text": "Once I have a script frame from the updated script, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1276"
  },
  {
    "text": "I can update the frame attributes for focus disparity directly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1279"
  },
  {
    "text": "This will pass focus with smooth transitions ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1283"
  },
  {
    "text": "according to the updated script to the renderer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1286"
  },
  {
    "text": "Let’s try out tapping to change the script and focus in the sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1289"
  },
  {
    "text": "Going from playback mode to edit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1294"
  },
  {
    "text": "I can now update the Cinematic script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1298"
  },
  {
    "text": "I can change focus decisions by either single-tapping ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1301"
  },
  {
    "text": "to get a weak decision, shown as a yellow dashed box, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1304"
  },
  {
    "text": "or by double-tapping to get a strong decision and a solid yellow box. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1308"
  },
  {
    "text": "You can see how the focus and rendering changes according to my user input ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1313"
  },
  {
    "text": "when I tab on different players. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1317"
  },
  {
    "text": "I think this is super cool. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1320"
  },
  {
    "text": "Scrub, scrub. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1322"
  },
  {
    "text": "Tap, tap, tap. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1325"
  },
  {
    "text": "Change the aperture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1328"
  },
  {
    "text": "Scrub, tap, tap, double-tap.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1330"
  },
  {
    "text": "And now that I have completed editing, how can I save these edit changes? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1335"
  },
  {
    "text": "The script changes can be saved in a separate data file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1339"
  },
  {
    "text": "and saving the changes separately means the original remains unchanged. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1342"
  },
  {
    "text": "And changes can always be reverted back to the original. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1347"
  },
  {
    "text": "So I get the script changes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1350"
  },
  {
    "text": "get the changes as a compact binary representation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1354"
  },
  {
    "text": "and write the changes to a data file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1358"
  },
  {
    "text": "The Cinematic API handles the data representation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1361"
  },
  {
    "text": "And you will need to store this data in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1365"
  },
  {
    "text": "so it can be reloaded to your needs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1368"
  },
  {
    "text": "Loading script changes is done in three equally easy steps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1370"
  },
  {
    "text": "I get the binary data from the data file, unpack the script changes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1376"
  },
  {
    "text": "and reload the changes into the Cinematic script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1380"
  },
  {
    "text": "Changes can also be loaded simultaneously with the original script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1384"
  },
  {
    "text": "So that’s how we can edit and render ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1389"
  },
  {
    "text": "and save and load the Cinematic script changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1391"
  },
  {
    "text": "As mentioned earlier, the custom video compositor can be used ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1394"
  },
  {
    "text": "to export rendered videos. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1398"
  },
  {
    "text": "And these can be rendered right back into Photos library. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1401"
  },
  {
    "text": "This is covered in detail in the sample code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1405"
  },
  {
    "text": "The API also includes a tracker, CNObjectTracker, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1409"
  },
  {
    "text": "which can be used for objects without automatic detections. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1414"
  },
  {
    "text": "The sample code covers how the tracker can be engaged ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1418"
  },
  {
    "text": "by tapping on an object without a detection. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1422"
  },
  {
    "text": "And the tracker will provide a detection track ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1425"
  },
  {
    "text": "and can be added to the script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1428"
  },
  {
    "text": "And now to some more advanced possibilities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1430"
  },
  {
    "text": "You can also add custom tracking by providing your own tracker ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1433"
  },
  {
    "text": "and add your own custom detection track to the script. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1437"
  },
  {
    "text": "And you can make custom changes to the rendering attributes per frame, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1441"
  },
  {
    "text": "allowing for custom transitions and aperture changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1445"
  },
  {
    "text": "I’m personally super excited about what you can all do ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1450"
  },
  {
    "text": "with Cinematic mode and the new API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1452"
  },
  {
    "text": "And whether it’s a simple app or a complex editor, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1455"
  },
  {
    "text": "I’m sure you can come up with ideas we haven’t even thought of. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1458"
  },
  {
    "text": "This was an introduction to the new Cinematic API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1462"
  },
  {
    "text": "which allows you to integrate Cinematic mode video assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1465"
  },
  {
    "text": "for playback with playback adjustments, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1468"
  },
  {
    "text": "change the Cinematic script and focus ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1472"
  },
  {
    "text": "to make nondestructive edits and new renders, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1474"
  },
  {
    "text": "and save and load these script changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1477"
  },
  {
    "text": "Please check out this and more in the included sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1479"
  },
  {
    "text": "Thank you for your focus, and happy coding. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1482"
  },
  {
    "text": "♪ ♪",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10137/?time=1486"
  }
]