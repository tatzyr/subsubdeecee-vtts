[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=0"
  },
  {
    "text": "Shawn: Hi, I am Shawn. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=10"
  },
  {
    "text": "I am an engineer on the Internet Technologies team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=12"
  },
  {
    "text": "Today, we are going to talk about reducing network delays in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=15"
  },
  {
    "text": "with L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=20"
  },
  {
    "text": "L4S stands for Low Latency, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=23"
  },
  {
    "text": "Low Loss, and Scalable throughput. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=27"
  },
  {
    "text": "It is an incredible technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=30"
  },
  {
    "text": "that dramatically improves the performance of apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=33"
  },
  {
    "text": "where network latency can impact the user experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=37"
  },
  {
    "text": "To name just a few benefits, it can help your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=41"
  },
  {
    "text": "reduce content load time, improve video quality, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=45"
  },
  {
    "text": "and bring more responsive collaboration between users.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=49"
  },
  {
    "text": "Today, we'll first explore how L4S works ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=54"
  },
  {
    "text": "and how it reduces network delays. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=58"
  },
  {
    "text": "Then, we will go over how to prepare your app for L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=61"
  },
  {
    "text": "and how to turn on L4S on your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=66"
  },
  {
    "text": "Finally, we will talk about the steps you can take ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=70"
  },
  {
    "text": "to configure an L4S network and test your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=73"
  },
  {
    "text": "First, let's explore the benefits of L4S and how it works.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=77"
  },
  {
    "text": "A busy network can be especially challenging ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=84"
  },
  {
    "text": "for apps that depend on features like real-time audio and video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=87"
  },
  {
    "text": "When the network is used by many devices at once, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=92"
  },
  {
    "text": "it can often cause high latency and packet loss ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=96"
  },
  {
    "text": "in these types of apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=100"
  },
  {
    "text": "For example, you might have experienced delays ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=103"
  },
  {
    "text": "or video stalls during a video call ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=106"
  },
  {
    "text": "when someone else using the same network is watching a movie ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=108"
  },
  {
    "text": "or downloading a video game. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=112"
  },
  {
    "text": "To show you how much L4S can help in such a difficult situation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=114"
  },
  {
    "text": "we have made a sample app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=119"
  },
  {
    "text": "that makes video calls between two devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=121"
  },
  {
    "text": "I will show you two video calls with my sample app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=125"
  },
  {
    "text": "made at different times, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=128"
  },
  {
    "text": "one without L4S and the other with L4S turned on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=130"
  },
  {
    "text": "For both these calls, I used the same constrained network ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=136"
  },
  {
    "text": "with low bandwidth. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=140"
  },
  {
    "text": "In addition, there are also multiple other devices ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=142"
  },
  {
    "text": "actively using the same network at the same time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=146"
  },
  {
    "text": "Let's see this in action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=150"
  },
  {
    "text": "You will notice a remarkable difference in video quality between the two calls. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=153"
  },
  {
    "text": "The legacy one shows occasional video stalls and delays, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=159"
  },
  {
    "text": "especially during motion. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=163"
  },
  {
    "text": "However, with L4S, the video is smooth and responsive, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=165"
  },
  {
    "text": "without any significant delays. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=170"
  },
  {
    "text": "Now let's analyze the video calls we have just witnessed ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=173"
  },
  {
    "text": "to understand what was happening. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=177"
  },
  {
    "text": "In this demo, L4S allowed our app to achieve ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=180"
  },
  {
    "text": "significant improvements across all key networking metrics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=184"
  },
  {
    "text": "First, let's look at the distribution of round trip time of packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=190"
  },
  {
    "text": "during these video calls. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=195"
  },
  {
    "text": "A shorter round trip time indicates a lower ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=198"
  },
  {
    "text": "and better latency on the network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=201"
  },
  {
    "text": "For an interactive app like this, the tail latency is extremely important, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=204"
  },
  {
    "text": "as it shows the worst case that a user experiences. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=210"
  },
  {
    "text": "Our test network has a minimum round trip time ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=215"
  },
  {
    "text": "of 20 milliseconds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=218"
  },
  {
    "text": "However, without L4S, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=220"
  },
  {
    "text": "packets experienced a round trip time of up to 45 milliseconds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=223"
  },
  {
    "text": "But with L4S turned on, even the worst-case latency ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=229"
  },
  {
    "text": "was cut by 50% ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=233"
  },
  {
    "text": "and reduced to less than 25 milliseconds.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=236"
  },
  {
    "text": "Next, let's look at packet loss. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=241"
  },
  {
    "text": "A lower packet loss represents ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=245"
  },
  {
    "text": "a more reliable connection between devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=247"
  },
  {
    "text": "With the legacy one, packet loss rate reached over 40%. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=251"
  },
  {
    "text": "But with L4S, packet loss in our video call was nearly eliminated. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=256"
  },
  {
    "text": "That means much fewer frame drops or stalls due to loss of data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=262"
  },
  {
    "text": "The improved latency and packet loss rate translated directly ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=268"
  },
  {
    "text": "into better rendering metrics of our video call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=272"
  },
  {
    "text": "First, let's look at the video stall percentage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=276"
  },
  {
    "text": "A lower stall percentage means fewer freezes during a video call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=280"
  },
  {
    "text": "Without L4S, we experienced video stalls ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=285"
  },
  {
    "text": "in our app from time to time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=288"
  },
  {
    "text": "But with L4S, video stalls were almost completely eliminated.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=292"
  },
  {
    "text": "Next, let's look at received video frame rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=299"
  },
  {
    "text": "A higher and more consistent received video frame rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=304"
  },
  {
    "text": "means a richer and smoother video call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=307"
  },
  {
    "text": "With L4S, received video frame rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=311"
  },
  {
    "text": "was above 25 frames per second for most of the time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=315"
  },
  {
    "text": "However, the legacy one sometimes dropped to as low as 0 frame per second, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=320"
  },
  {
    "text": "which means a complete video stall. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=326"
  },
  {
    "text": "Altogether, these improvements give a much better user experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=330"
  },
  {
    "text": "even in a constrained network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=335"
  },
  {
    "text": "You can bring these same improvements to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=337"
  },
  {
    "text": "by adopting L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=341"
  },
  {
    "text": "Now, let's take a look at how L4S works.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=344"
  },
  {
    "text": "We see such remarkable improvements, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=349"
  },
  {
    "text": "because L4S reduces queueing and packet loss. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=352"
  },
  {
    "text": "Let's first take a look at how a queue builds up in a network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=357"
  },
  {
    "text": "When a packet is sent from your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=362"
  },
  {
    "text": "it is routed through different network hops ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=365"
  },
  {
    "text": "before reaching your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=368"
  },
  {
    "text": "This set of hops your packet traverses is called a network path.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=370"
  },
  {
    "text": "On a path through a network, you can only deliver data end-to-end ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=377"
  },
  {
    "text": "at the rate that is supported by the slowest hop, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=381"
  },
  {
    "text": "which is called the bottleneck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=385"
  },
  {
    "text": "For many people, this is their internet service provider connection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=388"
  },
  {
    "text": "and the highest rate it can handle packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=392"
  },
  {
    "text": "determines the maximum throughput supported on the path. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=395"
  },
  {
    "text": "If the sender exceeds the maximum throughput, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=399"
  },
  {
    "text": "a queue will form at the bottleneck, causing delays for subsequent packets. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=402"
  },
  {
    "text": "Without L4S, the queue will continue to grow ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=408"
  },
  {
    "text": "until the queue cannot accommodate any more packets. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=411"
  },
  {
    "text": "When that happens, packets are dropped, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=415"
  },
  {
    "text": "harming both latency and throughput. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=418"
  },
  {
    "text": "L4S solves this problem through a collaboration ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=422"
  },
  {
    "text": "between the client, the server, and the bottleneck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=426"
  },
  {
    "text": "With L4S, a client or server sending packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=430"
  },
  {
    "text": "needs to signal that they will cooperate to manage network congestion.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=434"
  },
  {
    "text": "To do this, an L4S-capable sender will use a technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=440"
  },
  {
    "text": "called Explicit Congestion Notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=444"
  },
  {
    "text": "also known as ECN. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=448"
  },
  {
    "text": "When transmitting a packet, the sender indicates support for L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=452"
  },
  {
    "text": "by using the ECN bits in the packet's IP header. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=456"
  },
  {
    "text": "When an L4S hop receives these packets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=460"
  },
  {
    "text": "it will apply L4S queue management to them.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=463"
  },
  {
    "text": "When a queue starts to build up at the bottleneck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=469"
  },
  {
    "text": "L4S queue management will indicate that there is congestion ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=472"
  },
  {
    "text": "by setting a different ECN label on the packets. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=476"
  },
  {
    "text": "This label indicates that the network has experienced congestion ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=481"
  },
  {
    "text": "before forwarding them to the next hop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=485"
  },
  {
    "text": "Upon receiving these packets, the receiver counts the number of packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=489"
  },
  {
    "text": "marked with the congestion label and reports the number ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=493"
  },
  {
    "text": "back to the sender. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=497"
  },
  {
    "text": "When the sender receives this number, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=500"
  },
  {
    "text": "it uses this feedback to understand the congestion on the network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=502"
  },
  {
    "text": "The sender then adjusts its sending rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=506"
  },
  {
    "text": "according to the level of congestion at the bottleneck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=509"
  },
  {
    "text": "so that it does not exceed the maximum throughput. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=512"
  },
  {
    "text": "With an adjusted sending rate, the sender can avoid ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=516"
  },
  {
    "text": "building a large queue of packets at the bottleneck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=520"
  },
  {
    "text": "This allows L4S to maximize its throughput ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=523"
  },
  {
    "text": "and achieve low end-to-end latency at the same time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=526"
  },
  {
    "text": "Now, let's explore what you need to do ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=532"
  },
  {
    "text": "to enable this collaboration to deliver these benefits to your users. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=535"
  },
  {
    "text": "First, let's discuss how you can prepare your app for L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=540"
  },
  {
    "text": "Using networking APIs in URLSession and Network framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=546"
  },
  {
    "text": "is the best way to adopt L4S in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=551"
  },
  {
    "text": "If your app uses HTTP/3 or QUIC within these frameworks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=556"
  },
  {
    "text": "L4S support is automatically built in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=561"
  },
  {
    "text": "You don't have to make any code changes to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=564"
  },
  {
    "text": "Alternatively, if your app uses HTTP/2 or TCP, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=569"
  },
  {
    "text": "iOS 17 and macOS Sonoma have built-in L4S support ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=574"
  },
  {
    "text": "for downloads on these protocols. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=579"
  },
  {
    "text": "These are the best ways to add L4S support to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=582"
  },
  {
    "text": "because they do not require any code changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=586"
  },
  {
    "text": "However, if your app uses a custom protocol, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=592"
  },
  {
    "text": "there are a few things you'll need to implement ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=596"
  },
  {
    "text": "in order to support L4S in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=598"
  },
  {
    "text": "RFC 9330 is a good starting point ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=603"
  },
  {
    "text": "to learn about L4S requirements. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=606"
  },
  {
    "text": "You will need to implement a few new behaviors. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=609"
  },
  {
    "text": "For example, your protocol needs to understand ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=612"
  },
  {
    "text": "L4S congestion feedback from the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=614"
  },
  {
    "text": "and adjust its sending rate accordingly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=617"
  },
  {
    "text": "To do that, you need to implement a scalable congestion control algorithm. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=621"
  },
  {
    "text": "Then, you need to make sure your app sends L4S traffic ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=626"
  },
  {
    "text": "only when the network lets ECN bits pass through. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=630"
  },
  {
    "text": "To do that, implement an ECN validation mechanism ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=634"
  },
  {
    "text": "that checks for any network issues that may be interfering with ECN, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=638"
  },
  {
    "text": "such as ECN bleaching. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=643"
  },
  {
    "text": "When acting as a receiver, your protocol also needs to have ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=646"
  },
  {
    "text": "a relay mechanism to echo back the network's ECN feedback to the sender. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=650"
  },
  {
    "text": "If your implementation is based on Network framework, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=656"
  },
  {
    "text": "you can use the ECN property on your packet metadata ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=660"
  },
  {
    "text": "to send and receive ECN flags for your custom protocol. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=663"
  },
  {
    "text": "If you are using sockets, you can use the set socket option ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=668"
  },
  {
    "text": "or send and receive message system calls to send and receive ECN flags.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=672"
  },
  {
    "text": "Now we have covered how to prepare your app for L4S, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=679"
  },
  {
    "text": "let's explore how to set up your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=684"
  },
  {
    "text": "If your app uses QUIC, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=688"
  },
  {
    "text": "your server's implementation of QUIC also needs to support L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=690"
  },
  {
    "text": "and ECN markings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=694"
  },
  {
    "text": "There are numerous QUIC implementations available on the server side. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=696"
  },
  {
    "text": "Ask your server provider about how to enable ECN and L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=701"
  },
  {
    "text": "If they do not support sending L4S traffic yet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=706"
  },
  {
    "text": "you can still enable ECN to receive L4S traffic on your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=709"
  },
  {
    "text": "Now is a great time to encourage them to fully support L4S.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=714"
  },
  {
    "text": "If your app is using TCP, you will need to add L4S support ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=721"
  },
  {
    "text": "to your server's TCP implementation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=725"
  },
  {
    "text": "For Linux based server, follow instructions on this GitHub page ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=728"
  },
  {
    "text": "to add support to your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=732"
  },
  {
    "text": "You can also find more details from the article ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=734"
  },
  {
    "text": "in the related items for this video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=737"
  },
  {
    "text": "For all other server platforms, please consult your server provider, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=741"
  },
  {
    "text": "as there may be additional configurations or changes required ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=745"
  },
  {
    "text": "in order to support L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=749"
  },
  {
    "text": "Now that we have covered how your app and server can be set up for L4S, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=751"
  },
  {
    "text": "let's explore how to set up an L4S network to test your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=757"
  },
  {
    "text": "First, let's review what makes a network L4S-capable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=763"
  },
  {
    "text": "The network must not block ECN markings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=768"
  },
  {
    "text": "ECN markings are used to communicate information ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=772"
  },
  {
    "text": "about the network between the sender, the bottleneck, and the receiver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=775"
  },
  {
    "text": "If your network interferes with ECN markings, L4S will not work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=781"
  },
  {
    "text": "The documentation has steps you can follow, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=787"
  },
  {
    "text": "along with additional tools, that you can use to verify ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=789"
  },
  {
    "text": "if your network is ECN compatible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=793"
  },
  {
    "text": "Next, the network bottleneck must support L4S queue management. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=797"
  },
  {
    "text": "This is essential to being able to see the benefits of L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=803"
  },
  {
    "text": "Once you have verified that your network is ECN compatible, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=808"
  },
  {
    "text": "you just need to add L4S queue management to the bottleneck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=812"
  },
  {
    "text": "To set up a test network that supports L4S queue management, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=816"
  },
  {
    "text": "the best way is to use Internet Sharing.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=821"
  },
  {
    "text": "In macOS Sonoma, Internet Sharing supports L4S queue management. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=825"
  },
  {
    "text": "When a device joins the network created by a Mac with Internet Sharing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=831"
  },
  {
    "text": "the Mac itself becomes an additional network hop ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=835"
  },
  {
    "text": "between the device and the server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=838"
  },
  {
    "text": "If you configure the Mac to be the bottleneck on the network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=842"
  },
  {
    "text": "it will apply L4S queue management to traffic going through it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=845"
  },
  {
    "text": "allowing you to build a complete L4S network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=851"
  },
  {
    "text": "To enable Internet Sharing in macOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=855"
  },
  {
    "text": "navigate to the Internet Sharing pane in System Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=858"
  },
  {
    "text": "Click the disclosure button to choose the interface to share ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=862"
  },
  {
    "text": "and the interface to which your test device will connect.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=866"
  },
  {
    "text": "To make the Mac act as a bottleneck on this network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=872"
  },
  {
    "text": "you need to throttle its bandwidth. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=876"
  },
  {
    "text": "Use this ifconfig command in Terminal with the interface you are sharing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=878"
  },
  {
    "text": "as well as the interface your device will connect to. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=884"
  },
  {
    "text": "Replace the interface name in this command ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=889"
  },
  {
    "text": "with the name of the interfaces you are using, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=892"
  },
  {
    "text": "for example, en1. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=895"
  },
  {
    "text": "Then, join the network on your test device ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=898"
  },
  {
    "text": "and test your app to see the benefits of L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=901"
  },
  {
    "text": "To reverse the bandwidth throttling on the Mac, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=906"
  },
  {
    "text": "you can either reboot or run the same ifconfig command ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=909"
  },
  {
    "text": "but change the bandwidth to 0 instead of 10 megabits per second.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=913"
  },
  {
    "text": "In iOS 17 and macOS Sonoma, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=920"
  },
  {
    "text": "L4S will be progressively rolled out to a random set of users. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=923"
  },
  {
    "text": "To ensure your test device has L4S turned on, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=928"
  },
  {
    "text": "navigate to Developer Settings and turn on L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=931"
  },
  {
    "text": "In macOS, you can enable L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=936"
  },
  {
    "text": "by running this defaults write command before testing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=938"
  },
  {
    "text": "If your network or server does not support L4S, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=943"
  },
  {
    "text": "TCP and QUIC will continue to work in the legacy mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=947"
  },
  {
    "text": "However, you should turn L4S on ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=951"
  },
  {
    "text": "and test your application to identify any issues. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=953"
  },
  {
    "text": "Provide feedback using the Feedback Assistant ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=958"
  },
  {
    "text": "if any issues arise. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=961"
  },
  {
    "text": "The documentation also provides helpful information ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=964"
  },
  {
    "text": "about debugging and testing L4S in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=967"
  },
  {
    "text": "I am so excited that apps and networks are now able to support ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=971"
  },
  {
    "text": "reduced latency and reduced packet loss with L4S.",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=976"
  },
  {
    "text": "Test your app in iOS 17 and macOS Sonoma today ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=981"
  },
  {
    "text": "on networks that support L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=986"
  },
  {
    "text": "as well as on networks that do not. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=988"
  },
  {
    "text": "Work with your server or CDN provider to enable support for L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=992"
  },
  {
    "text": "on your app's servers, if they haven't already done so. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=997"
  },
  {
    "text": "Use the Feedback Assistant to report any issues you encounter ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=1002"
  },
  {
    "text": "with L4S turned on in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=1007"
  },
  {
    "text": "Thanks for watching. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=1009"
  },
  {
    "text": "I am looking forward to building even better apps with you using L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=1011"
  },
  {
    "text": "♪ ♪",
    "link": "https://developer.apple.com/videos/play/wwdc2023/10004/?time=1016"
  }
]