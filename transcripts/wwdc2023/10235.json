[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=0"
  },
  {
    "text": "Julian: Hi, welcome to \"What's new in voice processing.” ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=10"
  },
  {
    "text": "I'm Julian from the Core Audio team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=14"
  },
  {
    "text": "Voice over IP applications have become more essential than ever, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=16"
  },
  {
    "text": "to help people stay connected with their colleagues, friends, and family. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=21"
  },
  {
    "text": "The audio quality in voice chat plays a critical role ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=25"
  },
  {
    "text": "in delivering a great user experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=29"
  },
  {
    "text": "It's important yet challenging to implement the audio processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=31"
  },
  {
    "text": "that sounds great under all circumstances. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=36"
  },
  {
    "text": "That's why Apple offers the voice processing APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=39"
  },
  {
    "text": "so that everyone can always enjoy the best possible audio experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=42"
  },
  {
    "text": "when they chat in your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=46"
  },
  {
    "text": "no matter what kind of acoustic environment they are in, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=48"
  },
  {
    "text": "which Apple product they are using, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=51"
  },
  {
    "text": "and what audio accessory is being connected to. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=53"
  },
  {
    "text": "Apple's voice processing APIs are widely used by many apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=56"
  },
  {
    "text": "including our own FaceTime and Phone app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=60"
  },
  {
    "text": "It provides best-in-class audio signal processing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=63"
  },
  {
    "text": "including echo cancellation, noise suppression, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=66"
  },
  {
    "text": "automatic gain control, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=69"
  },
  {
    "text": "among others to enhance the voice chat audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=71"
  },
  {
    "text": "Its performance is tuned by acoustic engineers for each Apple product model ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=74"
  },
  {
    "text": "in conjunction with each type of audio device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=79"
  },
  {
    "text": "to account for their unique acoustic characteristics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=81"
  },
  {
    "text": "Choosing Apple's voice processing APIs also grants users full control ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=85"
  },
  {
    "text": "over the mic mode settings for your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=90"
  },
  {
    "text": "including Standard, Voice Isolation, and Wide Spectrum. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=92"
  },
  {
    "text": "We highly recommend using Apple's voice processing APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=97"
  },
  {
    "text": "for your Voice over IP applications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=100"
  },
  {
    "text": "Apple's voice processing APIs are available in two options. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=103"
  },
  {
    "text": "The first option is an I/O audio unit called AUVoiceIO, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=107"
  },
  {
    "text": "also known as AUVoiceProcessingIO. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=112"
  },
  {
    "text": "This option is for apps that need to interact with I/O audio unit directly.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=116"
  },
  {
    "text": "The second option is AVAudioEngine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=122"
  },
  {
    "text": "more specifically by enabling AVAudioEngine's \"voice processing\" mode.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=126"
  },
  {
    "text": "AVAudioEngine is higher-level API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=133"
  },
  {
    "text": "It's generally easier to use ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=137"
  },
  {
    "text": "and it reduces the amount of code you have to write when working with audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=139"
  },
  {
    "text": "Both options provide the same voice processing capabilities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=143"
  },
  {
    "text": "Now, what's new? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=148"
  },
  {
    "text": "We are making the voice processing APIs available on tvOS for the very first time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=150"
  },
  {
    "text": "For more details on that, please check out session ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=155"
  },
  {
    "text": "\"Discover Continuity Camera for tvOS\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=158"
  },
  {
    "text": "We are also adding a couple of new APIs to AUVoiceIO and AVAudioEngine ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=162"
  },
  {
    "text": "to provide you more controls over voice processing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=167"
  },
  {
    "text": "and to help you implement new features.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=170"
  },
  {
    "text": "The first API is to help you control the ducking behavior of other audio-- ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=175"
  },
  {
    "text": "and I'll explain what that means in a minute. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=180"
  },
  {
    "text": "The second API is to help you implement a muted talker detection feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=184"
  },
  {
    "text": "for your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=188"
  },
  {
    "text": "In this session, I'm going to focus on the details of these two new APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=190"
  },
  {
    "text": "The first API I'd like to talk about is \"Other audio ducking.” ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=196"
  },
  {
    "text": "Before we dive into this API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=200"
  },
  {
    "text": "let me first explain what other audio is and why ducking matters. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=202"
  },
  {
    "text": "When you use Apple's voice processing API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=207"
  },
  {
    "text": "let's take a look at what's happening to the playback audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=210"
  },
  {
    "text": "Your app is providing a voice chat audio stream ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=213"
  },
  {
    "text": "processed with Apple's voice processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=216"
  },
  {
    "text": "and played to the output device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=219"
  },
  {
    "text": "However, there could be other audio streams playing at the same time.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=221"
  },
  {
    "text": "For example, your app could be playing another audio stream ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=226"
  },
  {
    "text": "that is not rendered through the voice processing API.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=230"
  },
  {
    "text": "There also could be other apps playing audio at the same time as your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=235"
  },
  {
    "text": "All the audio streams other than the voice audio stream from your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=240"
  },
  {
    "text": "are considered as \"other audio\" by Apple's voice processing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=243"
  },
  {
    "text": "and your voice audio gets mixed in with other audio ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=247"
  },
  {
    "text": "before getting played to the output device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=250"
  },
  {
    "text": "For voice chat apps, typically the primary focus ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=253"
  },
  {
    "text": "of the playback audio is the voice chat audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=256"
  },
  {
    "text": "That's why we duck the volume level of other audio, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=259"
  },
  {
    "text": "in order improve the intelligibility of the voice audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=262"
  },
  {
    "text": "In the past, we applied a fixed amount of ducking to other audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=266"
  },
  {
    "text": "This has worked well for most apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=271"
  },
  {
    "text": "and if your app is happy with the current ducking behavior, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=274"
  },
  {
    "text": "then you don't need to do anything. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=276"
  },
  {
    "text": "However, we realize that some apps would like to have more controls ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=279"
  },
  {
    "text": "over the ducking behavior, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=283"
  },
  {
    "text": "and this API will help you accomplish that.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=284"
  },
  {
    "text": "Let's examine this API for AUVoiceIO first, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=288"
  },
  {
    "text": "and we'll get to AVAudioEngine later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=292"
  },
  {
    "text": "For AUVoiceIO, this is the struct of other audio ducking configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=295"
  },
  {
    "text": "It provides controls of two independent aspects of ducking-- ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=300"
  },
  {
    "text": "the style of ducking; that is, mEnableAdvancedDucking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=305"
  },
  {
    "text": "and the amount of ducking, that is mDuckingLevel. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=310"
  },
  {
    "text": "For mEnableAdvancedDucking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=315"
  },
  {
    "text": "by default, this is disabled. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=317"
  },
  {
    "text": "Once enabled, it will adjust the ducking level dynamically ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=319"
  },
  {
    "text": "based on the presence of voice activity from either side of the chat participants. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=323"
  },
  {
    "text": "In other words, it applies more ducking when user from either side is talking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=329"
  },
  {
    "text": "and it reduces ducking when neither side is talking. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=334"
  },
  {
    "text": "This is very similar to the ducking in FaceTime SharePlay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=337"
  },
  {
    "text": "where media playback volume is high when neither party in FaceTime is talking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=340"
  },
  {
    "text": "but as soon as someone starts talking, the media playback volume is reduced.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=345"
  },
  {
    "text": "Next, mDuckingLevel. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=351"
  },
  {
    "text": "There are four levels of controls: ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=354"
  },
  {
    "text": "default (Default), minimum (Min), medium (Mid), and maximum (Max). ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=356"
  },
  {
    "text": "The default (Default) ducking level applies the same amount of ducking we've been applying, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=361"
  },
  {
    "text": "and this will continue to be our default setting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=366"
  },
  {
    "text": "The minimum (Min) ducking level minimizes the amount of ducking we apply. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=369"
  },
  {
    "text": "In other words, this is the setting to use ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=373"
  },
  {
    "text": "if you want other audio volume to be as loud as possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=376"
  },
  {
    "text": "Vice versa, the maximum (Max) ducking level maximizes the amount of ducking we apply. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=381"
  },
  {
    "text": "Generally speaking, choosing a higher ducking level ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=387"
  },
  {
    "text": "helps improve the intelligibility of the voice chat.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=390"
  },
  {
    "text": "The two controls can be used independently. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=395"
  },
  {
    "text": "When used in combination, it gives you the full flexibility ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=398"
  },
  {
    "text": "of controlling the ducking behavior.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=401"
  },
  {
    "text": "Now that we've covered what the ducking configuration does, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=405"
  },
  {
    "text": "you can create one that's suitable for your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=408"
  },
  {
    "text": "For example, here I'm going to enable the advanced ducking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=412"
  },
  {
    "text": "and select the ducking level to be minimum.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=416"
  },
  {
    "text": "Then I'll set this ducking configuration to AUVoiceIO, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=421"
  },
  {
    "text": "via kAUVoiceIOProperty_ OtherAudioDuckingConfiguration.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=425"
  },
  {
    "text": "For AVAudioEngine clients, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=433"
  },
  {
    "text": "the API looks very similar. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=436"
  },
  {
    "text": "Here is the struct definition of other audio ducking configuration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=439"
  },
  {
    "text": "and this is the enum definition of ducking level.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=444"
  },
  {
    "text": "To use this API with AVAudioEngine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=451"
  },
  {
    "text": "you'd first enable voice processing on the input node of the engine ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=455"
  },
  {
    "text": "then set up the ducking configuration.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=462"
  },
  {
    "text": "And finally, set the configuration on the input node. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=467"
  },
  {
    "text": "Next, let's talk about another API that helps you implement ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=472"
  },
  {
    "text": "a very useful feature in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=476"
  },
  {
    "text": "Have you ever been in the situation in an online meeting where ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=478"
  },
  {
    "text": "you thought you were chatting with colleagues or friends, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=481"
  },
  {
    "text": "but moments later, you realized you were muted ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=484"
  },
  {
    "text": "and no one actually heard your brilliant points or funny stories? ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=487"
  },
  {
    "text": "Yes, awkward. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=492"
  },
  {
    "text": "It's quite useful to provide a muted talker detection feature in your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=494"
  },
  {
    "text": "like what FaceTime is doing here.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=499"
  },
  {
    "text": "That's why we are providing an API for you ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=503"
  },
  {
    "text": "to detect the presence of a muted talker. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=506"
  },
  {
    "text": "It was first introduced in iOS 15, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=509"
  },
  {
    "text": "and now we are making it available to macOS 14 ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=512"
  },
  {
    "text": "and tvOS 17. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=516"
  },
  {
    "text": "Here is the high-level overview of how to use this API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=518"
  },
  {
    "text": "First, you'd need to provide a listener block to AUVoiceIO or AVAudioEngine ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=523"
  },
  {
    "text": "to receive the notification when muted talker is detected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=529"
  },
  {
    "text": "The listener block you provide is invoked whenever the muted talker starts talking ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=533"
  },
  {
    "text": "or stops talking ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=537"
  },
  {
    "text": "then implement your handling code for such notification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=539"
  },
  {
    "text": "For example, you may want to prompt the user to unmute themselves ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=543"
  },
  {
    "text": "if the notification indicates the user starts talking while muted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=547"
  },
  {
    "text": "Last but not least, it's required to implement mute ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=552"
  },
  {
    "text": "via the mute API of AUVoiceIO or AVAudioEngine.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=555"
  },
  {
    "text": "Let me walk you through some code examples with AUVoiceIO. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=562"
  },
  {
    "text": "We'll get to the AVAudioEngine example later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=565"
  },
  {
    "text": "First, prepare a listener block that handles the notification.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=568"
  },
  {
    "text": "The block has a parameter of type AUVoiceIOSpeechActivityEvent, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=574"
  },
  {
    "text": "which can be one of two values-- ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=581"
  },
  {
    "text": "SpeechActivityHasStarted ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=583"
  },
  {
    "text": "or SpeechActivityHasEnded.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=585"
  },
  {
    "text": "The listener block will be invoked ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=590"
  },
  {
    "text": "whenever the speech activity event changes during mute.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=591"
  },
  {
    "text": "Inside the block, this is where you implement ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=597"
  },
  {
    "text": "how you want to handle this event, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=600"
  },
  {
    "text": "For example, when SpeechActivityHasStarted event is received, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=602"
  },
  {
    "text": "you might want to prompt the user to unmute themselves. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=607"
  },
  {
    "text": "Once you have this listener block ready, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=611"
  },
  {
    "text": "register the block with AUVoiceIO ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=613"
  },
  {
    "text": "via kAUVoiceIOProperty_MutedSpeechActivityEventListener.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=616"
  },
  {
    "text": "When user mutes, implement the mute ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=624"
  },
  {
    "text": "via mute API kAUVoiceIOProperty_MuteOutput.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=626"
  },
  {
    "text": "Your listener block is getting invoked only if A, the user is muted, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=634"
  },
  {
    "text": "and B, when the speech activity state changes.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=639"
  },
  {
    "text": "Continuous presence of or lack of speech activity ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=644"
  },
  {
    "text": "will not cause redundant notification.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=648"
  },
  {
    "text": "For AVAudioEngine clients, the implementation is very similar. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=653"
  },
  {
    "text": "After you enable voice processing on the input node of the engine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=657"
  },
  {
    "text": "prepare a listener block where you handle the notification.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=661"
  },
  {
    "text": "Then register the listener block with the input node.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=666"
  },
  {
    "text": "When user mutes, use AVAudioEngine's voice processing mute API to mute.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=673"
  },
  {
    "text": "Now, we've covered implementing a muted talker detection feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=679"
  },
  {
    "text": "with AUVoiceIO and AVAudioEngine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=683"
  },
  {
    "text": "For those of you who are not ready yet to adopt Apple's voice processing APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=687"
  },
  {
    "text": "we are providing an alternative to help you implement this feature.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=691"
  },
  {
    "text": "This alternative is only available on macOS ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=697"
  },
  {
    "text": "via the CoreAudio HAL APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=701"
  },
  {
    "text": "that is, Hardware Abstraction Layer APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=703"
  },
  {
    "text": "There are two new HAL properties to help you detect voice activity ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=707"
  },
  {
    "text": "when used in combination. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=712"
  },
  {
    "text": "First, enable voice activity detection on the input device ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=715"
  },
  {
    "text": "via kAudioDevicePropertyVoiceActivityDetectionEnable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=720"
  },
  {
    "text": "Then register an HAL property listener ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=726"
  },
  {
    "text": "on kAudioDevicePropertyVoiceActivityDetectionState. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=729"
  },
  {
    "text": "This HAL property listener is invoked whenever there is a change ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=734"
  },
  {
    "text": "in the voice activity state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=738"
  },
  {
    "text": "When your app is notified by the property listener, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=741"
  },
  {
    "text": "query the property to get its current value.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=744"
  },
  {
    "text": "Now let me walk you through this with some code example.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=750"
  },
  {
    "text": "To enable voice activity detection on the input device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=755"
  },
  {
    "text": "first construct the HAL property address.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=760"
  },
  {
    "text": "Then set the property onto the input device to enable it.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=766"
  },
  {
    "text": "Next, to register a listener on the voice activity detection state property, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=772"
  },
  {
    "text": "construct the HAL property address, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=778"
  },
  {
    "text": "then supply your property listener.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=780"
  },
  {
    "text": "Here the \"listener_callback\" is the name of your listener function.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=785"
  },
  {
    "text": "This is an example of how to implement the property listener.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=792"
  },
  {
    "text": "The listener conforms to this function signature.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=798"
  },
  {
    "text": "In this example, we assume that this listener ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=802"
  },
  {
    "text": "is only registered for one HAL property, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=805"
  },
  {
    "text": "which means when it's invoked, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=809"
  },
  {
    "text": "there is no ambiguity as to which HAL property has changed.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=811"
  },
  {
    "text": "If you register the same listener for notification ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=817"
  },
  {
    "text": "of more than one HAL properties, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=820"
  },
  {
    "text": "then you must first go through the array of inAddresses ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=822"
  },
  {
    "text": "to see what exactly has changed.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=826"
  },
  {
    "text": "In handling this notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=831"
  },
  {
    "text": "query the VoiceActivityDetectionState property to get its current value ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=834"
  },
  {
    "text": "then implement your own logics in handling that value.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=841"
  },
  {
    "text": "There are some important details about these voice activity detection HAL APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=846"
  },
  {
    "text": "First of all, it's detecting voice activity ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=853"
  },
  {
    "text": "from echo-cancelled microphone input ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=855"
  },
  {
    "text": "so it's ideal for voice chat applications.",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=859"
  },
  {
    "text": "Secondly, this detection works regardless of process mute state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=864"
  },
  {
    "text": "In order to implement a muted talker detection feature with it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=869"
  },
  {
    "text": "it's up to your app to implement the additional logic ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=873"
  },
  {
    "text": "that combines the voice activity state with the mute state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=876"
  },
  {
    "text": "For HAL API clients to implement mute ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=881"
  },
  {
    "text": "we highly recommend using HAL's process mute API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=884"
  },
  {
    "text": "It suppresses the recording indicator light in the menu bar, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=888"
  },
  {
    "text": "and gives user confidence that their privacy is protected under mute. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=893"
  },
  {
    "text": "Let's do a recap on what talked about today. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=898"
  },
  {
    "text": "We discussed about Apple's voice processing APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=901"
  },
  {
    "text": "and why we recommend it for voice over IP applications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=904"
  },
  {
    "text": "We talked about ducking of other audio, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=908"
  },
  {
    "text": "and the API to control the ducking behavior ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=911"
  },
  {
    "text": "with code examples of how to use it with AUVoiceIO and AVAudioEngine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=914"
  },
  {
    "text": "We also talked about how to implement muted talker detection ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=920"
  },
  {
    "text": "with code examples of AUVoiceIO and AVAudioEngine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=924"
  },
  {
    "text": "And for clients who have not adopted Apple's voice processing APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=928"
  },
  {
    "text": "we also showed an alternative option ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=932"
  },
  {
    "text": "to do it on macOS with Core Audio HAL APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=935"
  },
  {
    "text": "We are looking forward to great apps you'll build ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=939"
  },
  {
    "text": "with Apple's voice processing APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=941"
  },
  {
    "text": "Thanks for watching! ",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=944"
  },
  {
    "text": "♪ ♪",
    "link": "https://developer.apple.com/videos/play/wwdc2023-10235/?time=945"
  }
]