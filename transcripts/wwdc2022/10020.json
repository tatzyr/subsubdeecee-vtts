[
  {
    "text": "♪ instrumental hip hop music ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=0"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=3"
  },
  {
    "text": "Hi, my name is David Findlay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=9"
  },
  {
    "text": "and I'm an engineer on the Create ML team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=11"
  },
  {
    "text": "This session is all about Create ML Components, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=14"
  },
  {
    "text": "a powerful new way to build your own machine learning tasks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=16"
  },
  {
    "text": "My colleague Alejandro gave an introduction in the session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=20"
  },
  {
    "text": "\"Get to know Create ML Components.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=23"
  },
  {
    "text": "He explores deconstructing Create ML tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=25"
  },
  {
    "text": "into components and revealed how easy it is ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=27"
  },
  {
    "text": "to build custom models. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=29"
  },
  {
    "text": "Transformers and estimators are the main building blocks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=31"
  },
  {
    "text": "that you can compose together to build custom models ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=35"
  },
  {
    "text": "like image regression. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=37"
  },
  {
    "text": "In this session, I want to go way beyond the basics ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=40"
  },
  {
    "text": "and demonstrate what's possible with Create ML Components. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=43"
  },
  {
    "text": "Let's go over the agenda; there's lots to cover. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=46"
  },
  {
    "text": "I'll start by talking about video data and go into detail ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=49"
  },
  {
    "text": "about new components designed to handle values over time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=53"
  },
  {
    "text": "Then I'll put those concepts to work ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=57"
  },
  {
    "text": "and build a human action repetition counter ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=58"
  },
  {
    "text": "using only transformers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=61"
  },
  {
    "text": "Finally, I'll move on to training ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=63"
  },
  {
    "text": "a custom sound classifier model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=65"
  },
  {
    "text": "I'll discuss incremental fitting which allows you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=67"
  },
  {
    "text": "to update your model with batches, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=69"
  },
  {
    "text": "stop training early, and checkpoint your model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=71"
  },
  {
    "text": "There's so much opportunity with this level of flexibility. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=73"
  },
  {
    "text": "I can't wait to dive in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=77"
  },
  {
    "text": "Let's get started. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=79"
  },
  {
    "text": "At WWDC 2020, we introduced Action Classification ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=81"
  },
  {
    "text": "in Create ML, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=84"
  },
  {
    "text": "which allows you to classify actions from videos. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=86"
  },
  {
    "text": "And we demonstrated how you can create a fitness classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=88"
  },
  {
    "text": "to recognize a person's workout routines, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=91"
  },
  {
    "text": "such as jumping jacks, lunges, and squats. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=94"
  },
  {
    "text": "For example, you can use the action classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=97"
  },
  {
    "text": "to recognize the action in this video as a jumping jack. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=100"
  },
  {
    "text": "But what if you wanted to count your jumping jacks? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=104"
  },
  {
    "text": "The first thing you need to consider ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=107"
  },
  {
    "text": "is that a jumping jack spans consecutive frames, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=109"
  },
  {
    "text": "and you'll need a way to handle values over time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=112"
  },
  {
    "text": "Thankfully, Swift's AsyncSequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=115"
  },
  {
    "text": "makes this really easy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=117"
  },
  {
    "text": "If you're unfamiliar with async sequences, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=119"
  },
  {
    "text": "you should check out the session \"Meet AsyncSequence”. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=121"
  },
  {
    "text": "With Create ML Components, you can read your video ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=126"
  },
  {
    "text": "as an async sequence of frames, using the video reader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=129"
  },
  {
    "text": "And AsyncSequence provides a way of iterating over the frames ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=133"
  },
  {
    "text": "as they are received from the video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=136"
  },
  {
    "text": "For example, I can easily transform ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=139"
  },
  {
    "text": "each video frame asynchronously using the map method. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=142"
  },
  {
    "text": "This is useful when you want to process frames one at a time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=146"
  },
  {
    "text": "But what if you wanted to process ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=150"
  },
  {
    "text": "multiple frames at a time? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=152"
  },
  {
    "text": "That's where temporal transformers come in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=154"
  },
  {
    "text": "For example, you may want to downsample frames ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=156"
  },
  {
    "text": "to speed-up an action in a video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=159"
  },
  {
    "text": "You can use a downsampler for that ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=162"
  },
  {
    "text": "which takes an async sequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=164"
  },
  {
    "text": "and returns a downsampled async sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=165"
  },
  {
    "text": "Or you may want to group frames into windows, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=168"
  },
  {
    "text": "which is important for counting action repetitions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=171"
  },
  {
    "text": "That's where you can use a sliding window transformer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=174"
  },
  {
    "text": "You can specify a window length, which is how many frames ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=178"
  },
  {
    "text": "you want to group in a window, and a stride, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=180"
  },
  {
    "text": "which is how you control the sliding interval. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=183"
  },
  {
    "text": "The input is, again, an async sequence, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=186"
  },
  {
    "text": "and the output in this case is a windowed async sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=189"
  },
  {
    "text": "Generally speaking, a temporal transformer ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=195"
  },
  {
    "text": "provides a way to process an async sequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=197"
  },
  {
    "text": "into a new async sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=200"
  },
  {
    "text": "So let's put these concepts to work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=202"
  },
  {
    "text": "I don't know about you, but when I'm working out, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=205"
  },
  {
    "text": "I always lose count of my reps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=207"
  },
  {
    "text": "So I decided to shake things up a bit ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=210"
  },
  {
    "text": "and build an action repetition counter ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=212"
  },
  {
    "text": "with Create ML Components. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=214"
  },
  {
    "text": "In this example, I'll go over how to compose transformers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=216"
  },
  {
    "text": "and temporal transformers together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=219"
  },
  {
    "text": "Let's start with pose extraction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=222"
  },
  {
    "text": "I can extract poses using the human body pose extractor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=225"
  },
  {
    "text": "The input is an image ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=229"
  },
  {
    "text": "and the output is an array of human body poses. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=230"
  },
  {
    "text": "Behind the scenes, we leverage the Vision framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=234"
  },
  {
    "text": "to extract the poses. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=236"
  },
  {
    "text": "Note that images can contain multiple people, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=239"
  },
  {
    "text": "which is common for group workouts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=242"
  },
  {
    "text": "That's why the output is an array of poses. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=245"
  },
  {
    "text": "But I'm only interested in counting action repetitions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=248"
  },
  {
    "text": "for one person at a time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=251"
  },
  {
    "text": "So I'll compose the human body pose extractor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=253"
  },
  {
    "text": "with a pose selector. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=256"
  },
  {
    "text": "A pose selector takes an array of poses ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=259"
  },
  {
    "text": "as well as a selection strategy and returns a single pose. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=262"
  },
  {
    "text": "There's a few selection strategies to choose from, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=266"
  },
  {
    "text": "but for this example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=269"
  },
  {
    "text": "I'll use the rightMostJointLocation strategy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=270"
  },
  {
    "text": "The next step is to group the poses into windows. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=273"
  },
  {
    "text": "I'll append a sliding window transformer for that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=278"
  },
  {
    "text": "And I'll use a window length and stride of 90, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=282"
  },
  {
    "text": "which will generate nonoverlapping windows ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=284"
  },
  {
    "text": "of 90 poses. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=287"
  },
  {
    "text": "Recall that a sliding window transformer is temporal, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=289"
  },
  {
    "text": "which makes the whole task temporal, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=292"
  },
  {
    "text": "and the expected input is now an async sequence of frames. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=295"
  },
  {
    "text": "Finally, I'll append a human body action counter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=300"
  },
  {
    "text": "This temporal transformer ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=305"
  },
  {
    "text": "consumes a windowed async sequence of poses ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=306"
  },
  {
    "text": "and returns a cumulative count of the action repetitions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=310"
  },
  {
    "text": "so far. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=313"
  },
  {
    "text": "By now, you may have noticed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=314"
  },
  {
    "text": "that the count is a floating-point number. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=315"
  },
  {
    "text": "And that's because the task counts partial actions too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=318"
  },
  {
    "text": "It's that easy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=321"
  },
  {
    "text": "Now I can count my reps in my workout videos ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=323"
  },
  {
    "text": "and make sure I'm not cheating. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=325"
  },
  {
    "text": "But it would be even better to count repetitions live ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=327"
  },
  {
    "text": "in an app, so that I can keep track of my current workouts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=331"
  },
  {
    "text": "Let me show you how you can do that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=335"
  },
  {
    "text": "First, I'll use the readCamera method ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=338"
  },
  {
    "text": "which takes a camera configuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=340"
  },
  {
    "text": "and returns an async sequence of camera frames. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=342"
  },
  {
    "text": "Next, I'll adjust the stride parameter to 15 frames ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=345"
  },
  {
    "text": "so that I get an updated count more often. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=349"
  },
  {
    "text": "If my camera captures frames at a rate of 30 frames per second, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=352"
  },
  {
    "text": "then I get counts every half second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=355"
  },
  {
    "text": "Now I can workout and not worry about missing a rep. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=358"
  },
  {
    "text": "So far, I've explored temporal components ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=363"
  },
  {
    "text": "for transforming async sequences. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=366"
  },
  {
    "text": "Next, I want to focus on training custom models ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=368"
  },
  {
    "text": "that rely on temporal data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=371"
  },
  {
    "text": "In 2019, we demonstrated how you can train a sound classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=374"
  },
  {
    "text": "in Create ML. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=378"
  },
  {
    "text": "Then in 2021, we introduced enhancements ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=379"
  },
  {
    "text": "to sound classification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=382"
  },
  {
    "text": "I want to go even further ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=384"
  },
  {
    "text": "and train a custom sound classifier incrementally. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=386"
  },
  {
    "text": "The MLSoundClassifier in the Create ML framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=390"
  },
  {
    "text": "is still the easiest way ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=393"
  },
  {
    "text": "to train a custom sound classifier model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=394"
  },
  {
    "text": "But when you need more customizability and control, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=396"
  },
  {
    "text": "you can use the components under the hood. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=399"
  },
  {
    "text": "In its simplest form, the sound classifier has two components: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=402"
  },
  {
    "text": "an Audio Feature Print feature extractor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=406"
  },
  {
    "text": "and a classifier of your choice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=409"
  },
  {
    "text": "AudioFeaturePrint is a temporal transformer ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=411"
  },
  {
    "text": "that extracts audio features from an async sequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=414"
  },
  {
    "text": "of audio buffers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=416"
  },
  {
    "text": "Similar to a sliding window transformer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=419"
  },
  {
    "text": "AudioFeaturePrint windows the async sequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=421"
  },
  {
    "text": "then extracts features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=424"
  },
  {
    "text": "There are a few classifiers to choose from, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=427"
  },
  {
    "text": "but for this example, I'll use a logistic regression classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=429"
  },
  {
    "text": "and then compose it together with the feature extractor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=434"
  },
  {
    "text": "to build a custom sound classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=436"
  },
  {
    "text": "The next step is to fit the custom sound classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=440"
  },
  {
    "text": "to labeled training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=443"
  },
  {
    "text": "For more information about collecting training data, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=445"
  },
  {
    "text": "the \"Get to know Create ML Components\" session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=447"
  },
  {
    "text": "is a good place to start. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=450"
  },
  {
    "text": "So far, I've covered the happy path. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=452"
  },
  {
    "text": "But building machine learning models ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=454"
  },
  {
    "text": "can be an iterative process. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=456"
  },
  {
    "text": "For example, you may discover and collect new training data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=459"
  },
  {
    "text": "over time and want to refresh your model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=463"
  },
  {
    "text": "It's possible that you can improve the model quality. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=466"
  },
  {
    "text": "But retraining your model from scratch is time-consuming. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=469"
  },
  {
    "text": "That's because you need to redo feature extraction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=473"
  },
  {
    "text": "for all of your previous data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=475"
  },
  {
    "text": "Let me give you an example of how you can save time ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=478"
  },
  {
    "text": "when training your models with newly discovered data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=480"
  },
  {
    "text": "The key is to preprocess your training data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=484"
  },
  {
    "text": "separately from fitting your model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=486"
  },
  {
    "text": "In this example, I can extract audio features separately ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=489"
  },
  {
    "text": "from the classifier fitting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=492"
  },
  {
    "text": "And this works in general too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=495"
  },
  {
    "text": "Whenever you have a series of transformers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=497"
  },
  {
    "text": "followed by an estimator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=499"
  },
  {
    "text": "you can preprocess the input through the transformers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=501"
  },
  {
    "text": "leading up to the estimator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=504"
  },
  {
    "text": "All you need to do is call the preprocess method ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=506"
  },
  {
    "text": "and then fit the model on the preprocessed features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=510"
  },
  {
    "text": "I find this convenient because I didn't need to change ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=513"
  },
  {
    "text": "the sound classifier composition. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=515"
  },
  {
    "text": "Now that I have the features extracted separately, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=518"
  },
  {
    "text": "I have the flexibility to only extract audio features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=521"
  },
  {
    "text": "for the new data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=524"
  },
  {
    "text": "As you discover new training data for your model, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=526"
  },
  {
    "text": "you can easily preprocess this data separately. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=529"
  },
  {
    "text": "And then append the supplemental features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=531"
  },
  {
    "text": "to the previously extracted ones. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=534"
  },
  {
    "text": "This is just the first example ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=536"
  },
  {
    "text": "of where preprocessing can save you time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=538"
  },
  {
    "text": "Let's go back to the model-building lifecycle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=541"
  },
  {
    "text": "You may need to tune your estimator parameters ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=544"
  },
  {
    "text": "until you're satisfied with your model's quality. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=546"
  },
  {
    "text": "By separating the feature extraction from the fitting, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=549"
  },
  {
    "text": "you can extract your features only once ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=552"
  },
  {
    "text": "and then fit your model with different estimator parameters. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=554"
  },
  {
    "text": "Let's go over an example ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=558"
  },
  {
    "text": "of changing the classifier parameters ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=559"
  },
  {
    "text": "without redoing feature extraction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=561"
  },
  {
    "text": "Assuming that I've already extracted features, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=564"
  },
  {
    "text": "I'll modify the classifier's L2 penalty parameter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=566"
  },
  {
    "text": "And then I'll need to append the new classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=570"
  },
  {
    "text": "to the old feature extractor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=573"
  },
  {
    "text": "It's important not to change the feature extractor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=575"
  },
  {
    "text": "when tuning your estimator, because that would invalidate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=577"
  },
  {
    "text": "the previously extracted features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=580"
  },
  {
    "text": "Let's move on to incrementally fitting your model with batches. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=583"
  },
  {
    "text": "Machine learning models in general ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=587"
  },
  {
    "text": "benefit from large amounts of training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=589"
  },
  {
    "text": "However, your app may have limited memory constraints. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=591"
  },
  {
    "text": "So what do you do? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=595"
  },
  {
    "text": "You can use Create ML Components to train a model ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=596"
  },
  {
    "text": "by loading only a batch of data into memory at a time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=599"
  },
  {
    "text": "The first thing I need to do is replace the classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=602"
  },
  {
    "text": "with an updatable classifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=605"
  },
  {
    "text": "In order to train a custom model with batches, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=607"
  },
  {
    "text": "your classifier needs to be updatable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=610"
  },
  {
    "text": "For example, the fully connected neural network classifier, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=612"
  },
  {
    "text": "which I can easily use ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=616"
  },
  {
    "text": "instead of the logistic regression classifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=617"
  },
  {
    "text": "which is not updatable.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=620"
  },
  {
    "text": "All right, now I'll write a training loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=625"
  },
  {
    "text": "I'll start by creating a default initialized model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=628"
  },
  {
    "text": "You won't be able to make predictions yet; ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=632"
  },
  {
    "text": "that's because this is just the starting point for training. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=634"
  },
  {
    "text": "Then I'll extract the audio features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=637"
  },
  {
    "text": "before the training starts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=639"
  },
  {
    "text": "This is an important step ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=641"
  },
  {
    "text": "because I don't want to extract features every iteration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=643"
  },
  {
    "text": "The next step is to define the training loop ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=646"
  },
  {
    "text": "and specify the number of iterations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=649"
  },
  {
    "text": "you'd like to train for. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=651"
  },
  {
    "text": "Before I continue, I'll import the algorithm's Swift package. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=653"
  },
  {
    "text": "I'll need it for creating batches of training data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=657"
  },
  {
    "text": "Make sure to check out the session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=661"
  },
  {
    "text": "\"Meet the Swift Algorithms and Collections packages\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=662"
  },
  {
    "text": "from WWDC 2021 to learn more.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=665"
  },
  {
    "text": "Within the training loop is where the batching happens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=670"
  },
  {
    "text": "I'll use the chunks method to group the features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=673"
  },
  {
    "text": "into batches for training. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=675"
  },
  {
    "text": "The chunk size is the number of features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=678"
  },
  {
    "text": "that are loaded into memory at once. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=680"
  },
  {
    "text": "Then, I can update the model by iterating over the batches ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=683"
  },
  {
    "text": "and calling the update method.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=686"
  },
  {
    "text": "When you train your model incrementally, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=691"
  },
  {
    "text": "you can unlock a few more training techniques. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=693"
  },
  {
    "text": "For example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=695"
  },
  {
    "text": "in this training graph, after about 10 iterations, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=696"
  },
  {
    "text": "the model accuracy plateaus at 95 percent. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=699"
  },
  {
    "text": "At this point, the model has converged ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=702"
  },
  {
    "text": "and you can stop early. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=705"
  },
  {
    "text": "Let's implement early stopping in the training loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=706"
  },
  {
    "text": "The first thing I need to do is make predictions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=710"
  },
  {
    "text": "for my validation set. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=712"
  },
  {
    "text": "I'm using the mapFeatures method here ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=714"
  },
  {
    "text": "because I need to pair the validation predictions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=716"
  },
  {
    "text": "with its annotations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=718"
  },
  {
    "text": "The next step is to measure the quality of the model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=721"
  },
  {
    "text": "I'll use the built-in metrics for now, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=724"
  },
  {
    "text": "but there's nothing stopping you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=726"
  },
  {
    "text": "from implementing your own custom metrics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=728"
  },
  {
    "text": "And finally, I'll stop training ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=730"
  },
  {
    "text": "when my model has reached an accuracy of 95 percent. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=732"
  },
  {
    "text": "Outside of the training loop, I'll write the model out to disk ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=736"
  },
  {
    "text": "so that I can use it later to make predictions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=739"
  },
  {
    "text": "In addition to stopping early, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=742"
  },
  {
    "text": "I'd like to talk about model checkpointing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=744"
  },
  {
    "text": "You can save your model's progress during training ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=748"
  },
  {
    "text": "rather than waiting until the end. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=750"
  },
  {
    "text": "And you can even use checkpointing ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=753"
  },
  {
    "text": "in order to resume training, which is convenient ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=754"
  },
  {
    "text": "especially when your model takes a long time to train. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=757"
  },
  {
    "text": "All you need to do is write out your model in the training loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=761"
  },
  {
    "text": "We recommend doing this every few iterations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=765"
  },
  {
    "text": "by defining a checkpoint interval. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=767"
  },
  {
    "text": "It's that easy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=769"
  },
  {
    "text": "In this session, I introduced temporal components, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=771"
  },
  {
    "text": "a new way to build machine learning tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=774"
  },
  {
    "text": "with temporal data like audio and video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=776"
  },
  {
    "text": "I composed temporal components together ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=780"
  },
  {
    "text": "to make a human action repetition counter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=782"
  },
  {
    "text": "And finally, I talked about incremental fitting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=785"
  },
  {
    "text": "This will unlock new possibilities for you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=788"
  },
  {
    "text": "to build machine learning into your apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=790"
  },
  {
    "text": "Thanks for joining me and enjoy the rest of WWDC. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=793"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10020/?time=796"
  }
]