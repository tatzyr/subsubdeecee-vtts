[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=0"
  },
  {
    "text": "Benjamin Poulain: Hi everyone, and welcome to our session about virtualization. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=9"
  },
  {
    "text": "This is what we are going to do together today. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=14"
  },
  {
    "text": "We'll see how you can run macOS and Linux inside virtual machines, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=17"
  },
  {
    "text": "on Apple silicon. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=22"
  },
  {
    "text": "By the end of this session, you will be able to do the same on your own Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=24"
  },
  {
    "text": "This may seem a little ambitious, but stick with us, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=28"
  },
  {
    "text": "and we'll do it together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=31"
  },
  {
    "text": "Here is our agenda for today. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=33"
  },
  {
    "text": "We will start with an overview of virtualization technologies, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=35"
  },
  {
    "text": "and we'll see how to use Virtualization framework to build virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=38"
  },
  {
    "text": "Then we'll do a deep dive into macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=43"
  },
  {
    "text": "We'll see how we can set up a virtual Mac and install macOS into it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=47"
  },
  {
    "text": "And finally, we'll do a second deep dive, this time into Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=51"
  },
  {
    "text": "We'll see how to run full Linux distributions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=56"
  },
  {
    "text": "and some cool new features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=58"
  },
  {
    "text": "Let’s get started with the overview. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=61"
  },
  {
    "text": "We'll first look into the stack that enables virtualization. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=63"
  },
  {
    "text": "It all starts with hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=68"
  },
  {
    "text": "Apple silicon has special hardware that enables the virtualization ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=70"
  },
  {
    "text": "of CPUs and memory. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=74"
  },
  {
    "text": "This means you can run multiple operating systems on top of a single SoC. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=76"
  },
  {
    "text": "Next, we need software to take advantage of this hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=80"
  },
  {
    "text": "And this is built right into the macOS kernel. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=84"
  },
  {
    "text": "You no longer need to write kernel extensions, or KEXTs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=87"
  },
  {
    "text": "It's all built in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=90"
  },
  {
    "text": "To use those capabilities from your application, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=93"
  },
  {
    "text": "you can use Hypervisor framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=95"
  },
  {
    "text": "Hypervisor framework is a low-level API that lets you virtualize CPUs and memory. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=97"
  },
  {
    "text": "But, because it's a low-level framework, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=103"
  },
  {
    "text": "you need to write every single detail of the virtual environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=106"
  },
  {
    "text": "Oftentimes, we want to run full operating systems. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=110"
  },
  {
    "text": "For this, there is a higher-level API, which is Virtualization framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=113"
  },
  {
    "text": "Virtualization framework enables the creation of virtual machines ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=118"
  },
  {
    "text": "running macOS on Apple silicon or Linux on both Apple silicon and Intel. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=122"
  },
  {
    "text": "Today, our session will focus on Virtualization framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=128"
  },
  {
    "text": "When using Virtualization framework, we'll deal with two kinds of objects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=131"
  },
  {
    "text": "The first kind are configuration objects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=134"
  },
  {
    "text": "They define all the properties of our virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=137"
  },
  {
    "text": "The second kind are virtual machine objects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=140"
  },
  {
    "text": "Those objects abstract virtual machines and how to interact with them. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=142"
  },
  {
    "text": "We'll start with looking at the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=147"
  },
  {
    "text": "The configuration defines the hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=151"
  },
  {
    "text": "Creating a configuration is like configuring a Mac on the Apple Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=154"
  },
  {
    "text": "We define how many CPUs we want, how much memory, what kind of devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=158"
  },
  {
    "text": "We can start from a simple configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=162"
  },
  {
    "text": "We can add a display, and we get to see the content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=165"
  },
  {
    "text": "We can add a keyboard, and we can type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=167"
  },
  {
    "text": "We can add a trackpad, and we can interact with the UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=170"
  },
  {
    "text": "Configuring a virtual machine is just like that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=173"
  },
  {
    "text": "But since we are dealing with virtual machines, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=177"
  },
  {
    "text": "we'll do this in code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=179"
  },
  {
    "text": "Let’s see how we can write the configuration in Swift. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=181"
  },
  {
    "text": "Defining the hardware is very simple. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=185"
  },
  {
    "text": "We start with an object of type VZVirtualMachineConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=187"
  },
  {
    "text": "This is the root object of all configurations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=192"
  },
  {
    "text": "Next, we define how many CPUs our machine should have. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=195"
  },
  {
    "text": "Here we give four CPUs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=199"
  },
  {
    "text": "Then, we set how much memory we want. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=202"
  },
  {
    "text": "In this case, we give four gigabytes of memory. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=204"
  },
  {
    "text": "Finally, we define the devices our machine will have. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=208"
  },
  {
    "text": "In this example, we set a single storage device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=211"
  },
  {
    "text": "the disk to boot from, and a pointing device, like a mouse. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=214"
  },
  {
    "text": "There are many devices available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=218"
  },
  {
    "text": "The ones you set up depend on the problem you want to solve. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=220"
  },
  {
    "text": "Now we've seen the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=224"
  },
  {
    "text": "It starts with VZVirtualMachineConfiguration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=226"
  },
  {
    "text": "on which we add the CPUs, the memory, and the devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=228"
  },
  {
    "text": "Next, we'll look into the virtual machine objects.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=233"
  },
  {
    "text": "After we have configured our Mac, we get it by the mail. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=238"
  },
  {
    "text": "It's time to unbox it and start it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=240"
  },
  {
    "text": "But since we are dealing with virtual machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=243"
  },
  {
    "text": "we need to do that in code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=246"
  },
  {
    "text": "Let’s see how we can do it in Swift. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=248"
  },
  {
    "text": "First, we'll create an instance of VZVirtualMachine ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=251"
  },
  {
    "text": "from our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=254"
  },
  {
    "text": "A VZVirtualMachine abstracts an instance of the virtual hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=256"
  },
  {
    "text": "Now that we have the virtual machine, we can operate on it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=260"
  },
  {
    "text": "For example, in this case, we call start() to start it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=263"
  },
  {
    "text": "We'll often want to interact with our virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=267"
  },
  {
    "text": "For this, we have other objects to help us. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=270"
  },
  {
    "text": "For example, if we want to show our virtual display, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=273"
  },
  {
    "text": "we can use an object of type VZVirtualMachineView. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=276"
  },
  {
    "text": "We start by creating a view. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=279"
  },
  {
    "text": "Then we set our virtual machine as the virtualMachine property on the view, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=281"
  },
  {
    "text": "and it's ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=285"
  },
  {
    "text": "Now we can use this VZVirtualMachineView object like any NSView. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=287"
  },
  {
    "text": "We can integrate it in our app to see the content of the virtual machine.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=291"
  },
  {
    "text": "To wrap up, we've seen the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=296"
  },
  {
    "text": "The configuration starts with VZVirtualMachineConfiguration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=300"
  },
  {
    "text": "from which we define the CPUs, memory, and our devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=303"
  },
  {
    "text": "From the configuration, we will create a virtual machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=308"
  },
  {
    "text": "and we will use virtual machine objects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=310"
  },
  {
    "text": "We've seen VZVirtualMachine to abstract the VM itself, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=313"
  },
  {
    "text": "VZVirtualMachineView to display content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=317"
  },
  {
    "text": "and there are other objects that can help us use the VM. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=320"
  },
  {
    "text": "We have seen that the configuration gives a lot of flexibility ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=323"
  },
  {
    "text": "in how we define virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=326"
  },
  {
    "text": "Unfortunately, there are too many features to cover in one session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=329"
  },
  {
    "text": "In this session, we will look into some of the core capabilities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=333"
  },
  {
    "text": "For everything else, we have documentation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=337"
  },
  {
    "text": "and I invite you to check it out. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=339"
  },
  {
    "text": "In the overview, we just saw how to build virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=342"
  },
  {
    "text": "Now it is time to look into how we can run a full operating system in them. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=346"
  },
  {
    "text": "And we will start with macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=350"
  },
  {
    "text": "Virtualization framework supports macOS on Apple silicon. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=352"
  },
  {
    "text": "When we built Virtualization framework on Apple silicon, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=356"
  },
  {
    "text": "we've developed macOS and Virtualization framework together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=359"
  },
  {
    "text": "What this gives us is incredible efficiency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=363"
  },
  {
    "text": "when running macOS inside virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=365"
  },
  {
    "text": "Here is what we are going to see: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=368"
  },
  {
    "text": "First, we will look into what we need ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=371"
  },
  {
    "text": "to turn a virtual machine into a virtual Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=373"
  },
  {
    "text": "Then we'll look into the steps to install macOS on our virtual Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=376"
  },
  {
    "text": "Next, we'll see some of the special devices we have for macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=380"
  },
  {
    "text": "And finally, we will look into a very important use case, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=385"
  },
  {
    "text": "which is sharing files between the host system and the virtual Mac.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=388"
  },
  {
    "text": "Let’s start with the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=394"
  },
  {
    "text": "We have seen before how to build a generic virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=396"
  },
  {
    "text": "Now we want to add the special properties that will make a virtual machine a Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=400"
  },
  {
    "text": "So how do we make a virtual Mac? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=405"
  },
  {
    "text": "First, we will define a special platform. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=409"
  },
  {
    "text": "A platform is an object that holds all the properties ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=411"
  },
  {
    "text": "of a particular type of virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=415"
  },
  {
    "text": "There are three properties that are unique to the virtual Mac hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=417"
  },
  {
    "text": "First, we have the hardware model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=422"
  },
  {
    "text": "The hardware model specifies which version of the virtual Mac we want. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=424"
  },
  {
    "text": "Second, there is the auxiliary storage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=429"
  },
  {
    "text": "The auxiliary storage is a form of non-volatile memory used by the system. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=431"
  },
  {
    "text": "And third, there is the machine identifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=436"
  },
  {
    "text": "The machine identifier is a unique number representing the machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=439"
  },
  {
    "text": "just like a physical Mac has a unique serial number. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=442"
  },
  {
    "text": "Once we have the platform, we have all the pieces to describe the hardware, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=446"
  },
  {
    "text": "but we need one more piece, which is a way to boot macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=449"
  },
  {
    "text": "For this, we will use a special boot loader, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=454"
  },
  {
    "text": "the macOS boot loader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=456"
  },
  {
    "text": "Let’s see how to do all of this in Swift. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=459"
  },
  {
    "text": "We start from the same base as before. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=463"
  },
  {
    "text": "This code is what we have seen in the overview. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=464"
  },
  {
    "text": "Then we create a VZMacPlatformConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=468"
  },
  {
    "text": "This is our platform object for virtual Macs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=472"
  },
  {
    "text": "We need a hardware model for this Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=476"
  },
  {
    "text": "Here we use one we previously saved. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=478"
  },
  {
    "text": "In virtual machines, the auxiliary storage is backed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=481"
  },
  {
    "text": "by a file on the local filesystem. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=483"
  },
  {
    "text": "Here, we initialize our auxiliary storage from a file URL. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=486"
  },
  {
    "text": "For the unique identifier, we initialize a VZMacMachineIdentifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=489"
  },
  {
    "text": "from one we previously saved. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=493"
  },
  {
    "text": "For a new install, we can also create a new identifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=495"
  },
  {
    "text": "We have set all three properties. Our platform is ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=499"
  },
  {
    "text": "All we have to do is set it on the configuration object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=503"
  },
  {
    "text": "This gives us the hardware. Next we need a way to boot it.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=507"
  },
  {
    "text": "To do that, we set up the boot loader with VZMacBootLoader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=511"
  },
  {
    "text": "Now our machine is ready to boot. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=516"
  },
  {
    "text": "What we have done so far is define the virtual Mac and how to start it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=518"
  },
  {
    "text": "But we still need to get software on it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=523"
  },
  {
    "text": "which brings us to the installation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=525"
  },
  {
    "text": "Installing macOS is done in three steps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=528"
  },
  {
    "text": "First, we need to download a restore image with the version ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=531"
  },
  {
    "text": "of macOS we want to install. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=534"
  },
  {
    "text": "Then we need to create a configuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=536"
  },
  {
    "text": "that is compatible with that version of macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=538"
  },
  {
    "text": "And finally, we’ll install our restore image ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=541"
  },
  {
    "text": "in the compatible virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=544"
  },
  {
    "text": "So first, we need to download a restore image. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=547"
  },
  {
    "text": "You can download restore images from the developer website, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=550"
  },
  {
    "text": "but Virtualization can also help us. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=552"
  },
  {
    "text": "You can call VZMacOSRestoreImage.latestSupported ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=556"
  },
  {
    "text": "to get a restore image object for the latest stable version of macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=559"
  },
  {
    "text": "This object has a URL property that we can use to download the file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=565"
  },
  {
    "text": "Then we want to create a virtual machine that is compatible ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=569"
  },
  {
    "text": "with the version of macOS we downloaded. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=572"
  },
  {
    "text": "Virtualization can also help us here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=575"
  },
  {
    "text": "We can ask the restore image object for the configuration requirements. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=577"
  },
  {
    "text": "If the restore image can be run on the current system, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=582"
  },
  {
    "text": "we get an object listing the requirements. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=585"
  },
  {
    "text": "From the requirements, we can obtain the hardware model needed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=587"
  },
  {
    "text": "needed to run this version of macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=590"
  },
  {
    "text": "We have seen previously how to restore a hardware model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=593"
  },
  {
    "text": "This is how we obtain a new one.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=595"
  },
  {
    "text": "The requirements also contain two useful properties. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=599"
  },
  {
    "text": "The object can tell us how many CPUs and how much memory is required ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=603"
  },
  {
    "text": "to run this version of macOS.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=607"
  },
  {
    "text": "Finally, we are ready to start installation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=611"
  },
  {
    "text": "We start by creating a new virtual machine from our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=614"
  },
  {
    "text": "Then we create an installer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=618"
  },
  {
    "text": "The installer takes two arguments, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=620"
  },
  {
    "text": "the compatible virtual machine we created ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=622"
  },
  {
    "text": "and the path to the restore image we downloaded. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=625"
  },
  {
    "text": "Now we can just call install(), and voilà, we are ready to run macOS.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=628"
  },
  {
    "text": "Now that we can set up a virtual Mac and install macOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=633"
  },
  {
    "text": "let’s see some of the special devices for the Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=637"
  },
  {
    "text": "A first cool capability is GPU acceleration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=641"
  },
  {
    "text": "We have built a graphic device that exposes the GPU capabilities ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=644"
  },
  {
    "text": "to the virtual Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=648"
  },
  {
    "text": "This means you can run Metal in the virtual machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=650"
  },
  {
    "text": "and get great graphics performance in macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=653"
  },
  {
    "text": "Let’s see how to set it up.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=656"
  },
  {
    "text": "We start by creating the graphics device configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=659"
  },
  {
    "text": "Here, we will use the VZMacGraphicsDeviceConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=662"
  },
  {
    "text": "Next, we want to give it a display. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=666"
  },
  {
    "text": "We set up the display by defining its size and pixel density. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=668"
  },
  {
    "text": "Now our device configuration is ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=673"
  },
  {
    "text": "As usual, we set it on the main configuration object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=675"
  },
  {
    "text": "We set it as the graphics device for our virtual machine.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=678"
  },
  {
    "text": "Next, we have a new device for interacting with the Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=683"
  },
  {
    "text": "In macOS Ventura, we are adding the Mac trackpad support ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=686"
  },
  {
    "text": "to the virtual Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=689"
  },
  {
    "text": "With the new trackpad, it is possible to use gestures ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=691"
  },
  {
    "text": "like rotation, pinch to zoom, and so on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=694"
  },
  {
    "text": "This new device uses new drivers in macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=697"
  },
  {
    "text": "So to use it, you will need macOS 13 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=700"
  },
  {
    "text": "both on the host system and in the virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=702"
  },
  {
    "text": "Let’s see how to set it up. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=705"
  },
  {
    "text": "It’s very easy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=708"
  },
  {
    "text": "We create a new object of type VZMacTrackpadConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=710"
  },
  {
    "text": "Then we set it as the pointing device on the virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=714"
  },
  {
    "text": "Now when we’ll use the view with our virtual Mac, we can use gestures. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=718"
  },
  {
    "text": "Finally, let’s look into a common use case for many of us, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=723"
  },
  {
    "text": "sharing files between the host system and the virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=726"
  },
  {
    "text": "In macOS 12, we introduced the Virtio file-system device ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=731"
  },
  {
    "text": "to share files on Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=734"
  },
  {
    "text": "In macOS Ventura, we are adding support for macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=736"
  },
  {
    "text": "You can now pick folders that you want to share with the virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=740"
  },
  {
    "text": "Any change you make from the host system is instantly reflected ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=743"
  },
  {
    "text": "within the virtual machine and vice versa. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=747"
  },
  {
    "text": "Let’s see how to set it up. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=749"
  },
  {
    "text": "First, we create a VZShareDirectory with a directory we want to share. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=752"
  },
  {
    "text": "Then we create a share object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=757"
  },
  {
    "text": "Here we'll use VZSingleDirectoryShare to share a single directory. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=759"
  },
  {
    "text": "You can also share multiple directories by using VZMultipleDirectoryShare. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=763"
  },
  {
    "text": "Now that we have the share, we need to create a device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=768"
  },
  {
    "text": "But we will start we something special. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=771"
  },
  {
    "text": "File system devices are identified by a tag. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=774"
  },
  {
    "text": "In macOS Ventura, we have added a special tag ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=776"
  },
  {
    "text": "to tell the virtual machine to automount this device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=779"
  },
  {
    "text": "Here, we take this special tag, macOSGuestAutomountTag. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=783"
  },
  {
    "text": "Then we create the device and use our special tag. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=787"
  },
  {
    "text": "We set the share from the single directory we configured. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=791"
  },
  {
    "text": "And finally, we add the device to the configuration as usual. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=795"
  },
  {
    "text": "Finally, let’s look at everything together in a demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=799"
  },
  {
    "text": "We start from a basic configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=803"
  },
  {
    "text": "We have a VZVirtualMachineConfiguration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=806"
  },
  {
    "text": "with just CPU, memory, a keyboard, and a disk. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=808"
  },
  {
    "text": "We want a virtual Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=813"
  },
  {
    "text": "To do that, we need to start by setting up the platform. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=815"
  },
  {
    "text": "We'll use createMacPlatform that is defined above to do that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=819"
  },
  {
    "text": "The second piece of a virtual Mac is the boot loader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=823"
  },
  {
    "text": "We need a boot loader that knows how to boot macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=826"
  },
  {
    "text": "To get that, we set the platform's boot loader ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=830"
  },
  {
    "text": "to VZMacOSBootLoader(). ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=832"
  },
  {
    "text": "Next, we want to set up the devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=835"
  },
  {
    "text": "We want accelerated graphics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=838"
  },
  {
    "text": "To get it, we will set up a VZMacGraphicsConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=840"
  },
  {
    "text": "We create the object, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=844"
  },
  {
    "text": "define the display size and pixel density, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=846"
  },
  {
    "text": "and we add it to the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=849"
  },
  {
    "text": "Next, we want to use the new trackpad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=852"
  },
  {
    "text": "All we need to do is set the pointing device ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=854"
  },
  {
    "text": "to VZMacTrackpadConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=857"
  },
  {
    "text": "That's it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=859"
  },
  {
    "text": "Now, we could start the VM, but let's add the cherry on top. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=860"
  },
  {
    "text": "We have seen how we can share directories. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=864"
  },
  {
    "text": "Let's do it here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=867"
  },
  {
    "text": "We start by creating the filesystem device configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=869"
  },
  {
    "text": "Here, notice we use the special tag to automount it into macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=872"
  },
  {
    "text": "Then we define our share. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=877"
  },
  {
    "text": "Here we use a single directory share from a path on the file system. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=878"
  },
  {
    "text": "Here, we will share this project we are editing right now.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=882"
  },
  {
    "text": "We add the device to our configuration, and we are done.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=887"
  },
  {
    "text": "Everything is ready. We launch our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=891"
  },
  {
    "text": "Since we configured the Mac graphics device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=895"
  },
  {
    "text": "the VZVirtualMachineView can show the content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=897"
  },
  {
    "text": "This is what you see here in the window. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=901"
  },
  {
    "text": "And here it is. We have configured macOS from scratch. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=904"
  },
  {
    "text": "We can see the shared directory and the project we were editing right now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=908"
  },
  {
    "text": "Finally, we will turn our eyes onto Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=911"
  },
  {
    "text": "Virtualization framework has supported Linux ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=914"
  },
  {
    "text": "since the very beginning in macOS Big Sur. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=917"
  },
  {
    "text": "In macOS Ventura, we have added some pretty cool new features, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=920"
  },
  {
    "text": "and we want to share some of them with you.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=923"
  },
  {
    "text": "First, we will see how we can install full Linux distributions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=926"
  },
  {
    "text": "completely unmodified, in virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=929"
  },
  {
    "text": "Then we will look at a new device we are adding to show UI from Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=933"
  },
  {
    "text": "And finally, we will look at how we can take advantage of Rosetta 2 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=937"
  },
  {
    "text": "to run Linux binaries in virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=941"
  },
  {
    "text": "Let’s start with installation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=944"
  },
  {
    "text": "If we wanted to install Linux on a physical machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=947"
  },
  {
    "text": "we'd start by downloading an ISO file with the installer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=949"
  },
  {
    "text": "Then we'd erase a flash drive with the ISO. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=952"
  },
  {
    "text": "And finally, we'd plug the drive in the computer and boot from it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=955"
  },
  {
    "text": "When dealing with virtual machines, we will go through the same flow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=959"
  },
  {
    "text": "But instead of using a physical USB drive, we will use a virtual one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=963"
  },
  {
    "text": "Let’s see how it works. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=967"
  },
  {
    "text": "We start by creating an URL from the path to the ISO file we downloaded. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=970"
  },
  {
    "text": "Then we create a disk image attachment from the file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=974"
  },
  {
    "text": "A disk image attachment represents a piece of storage that we can attach to a device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=978"
  },
  {
    "text": "Next, we configure a virtual storage device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=984"
  },
  {
    "text": "In this case, we want USB storage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=988"
  },
  {
    "text": "so we use VZUSBMassStorageDeviceConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=990"
  },
  {
    "text": "Finally, as always, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=995"
  },
  {
    "text": "we add our device in the main configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=997"
  },
  {
    "text": "Here, the USB device appears next to another storage device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=999"
  },
  {
    "text": "the main disk on which we will install Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1002"
  },
  {
    "text": "Now we have a USB drive, but we need a way to boot from it.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1005"
  },
  {
    "text": "In macOS Ventura, we have added support for EFI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1010"
  },
  {
    "text": "EFI is an industry standard for booting both ARM and Intel hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1014"
  },
  {
    "text": "We are bringing the same support to virtual machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1018"
  },
  {
    "text": "EFI has a boot discovery mechanism. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1022"
  },
  {
    "text": "What this will allow is discovering the installer on our USB drive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1025"
  },
  {
    "text": "EFI looks at each drive for one that can be booted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1029"
  },
  {
    "text": "It will find the installer and start from there. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1033"
  },
  {
    "text": "The installer itself will tell EFI what drive to use next. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1036"
  },
  {
    "text": "After the installation, EFI can then start the Linux distribution. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1039"
  },
  {
    "text": "Let’s see how to set up EFI in code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1043"
  },
  {
    "text": "First, we create a boot loader of type VZEFIBootLoader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1046"
  },
  {
    "text": "EFI requires non-volatile memory to store information between boots. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1051"
  },
  {
    "text": "This is called the EFI variable store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1055"
  },
  {
    "text": "With virtual machines, we can back such storage ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1058"
  },
  {
    "text": "by a file on the filesystem. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1060"
  },
  {
    "text": "Here, we create a new variable store from scratch. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1062"
  },
  {
    "text": "Now EFI is ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1066"
  },
  {
    "text": "We just need to set it as the boot loader on the configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1067"
  },
  {
    "text": "Next, we will look into a new capability for Linux VMs, graphics. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1071"
  },
  {
    "text": "In macOS Ventura, we have added support for Virtio GPU 2D. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1077"
  },
  {
    "text": "Virtio GPU 2D is a paravirtualized device that allows Linux ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1081"
  },
  {
    "text": "to provide surfaces to the host macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1085"
  },
  {
    "text": "Linux renders the content, gives the rendered frame ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1088"
  },
  {
    "text": "to Virtualization framework, which can then display it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1091"
  },
  {
    "text": "You can now show this content in your app with VZVirtualMachineView ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1094"
  },
  {
    "text": "just like on macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1098"
  },
  {
    "text": "Let’s see how to set it up.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1101"
  },
  {
    "text": "Setting up the device is similar to what we did for macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1104"
  },
  {
    "text": "We start by creating a VZVirtioGraphicsDeviceConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1108"
  },
  {
    "text": "We need to define the size of our virtual display. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1112"
  },
  {
    "text": "In Virtio terminology, a virtual display is a \"scanout.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1116"
  },
  {
    "text": "So we create one scanout with the size of the display. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1119"
  },
  {
    "text": "Finally, we set the new device as the graphics device ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1124"
  },
  {
    "text": "of our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1128"
  },
  {
    "text": "Now our VM is ready to display content with VZVirtualMachineView. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1129"
  },
  {
    "text": "Next, let’s see everything together in a demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1134"
  },
  {
    "text": "We start from where we left off. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1138"
  },
  {
    "text": "Let's delete the code that is specific to the Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1140"
  },
  {
    "text": "Then let's change the disk we are booting from. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1143"
  },
  {
    "text": "We'll swap the path from our Mac drive to our Linux drive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1145"
  },
  {
    "text": "Next, we need a boot loader. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1149"
  },
  {
    "text": "We set up EFI with VZEFIBootLoader.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1152"
  },
  {
    "text": "We first create the EFI boot loader object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1156"
  },
  {
    "text": "Then we load the variable store from its file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1159"
  },
  {
    "text": "And finally, we set EFI as the boot loader on our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1162"
  },
  {
    "text": "Now we can boot, but it'd be nice to show the UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1167"
  },
  {
    "text": "Let's add Virtio GPU to our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1171"
  },
  {
    "text": "We simply create a graphics device ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1175"
  },
  {
    "text": "of type VZVirtioGraphicsDeviceConfiguration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1176"
  },
  {
    "text": "Then we define a scanout with the size of the virtual display. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1180"
  },
  {
    "text": "And we set the Virtio GPU as a graphics device on our configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1183"
  },
  {
    "text": "The last touch is getting the mouse to work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1189"
  },
  {
    "text": "We just use a virtual USB screen coordinate pointer device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1193"
  },
  {
    "text": "and we'll have a mouse in Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1196"
  },
  {
    "text": "That's it. We can run the project. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1198"
  },
  {
    "text": "EFI looks at the disk and finds it bootable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1201"
  },
  {
    "text": "Then Linux shows the content of the UI through the Virtio GPU device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1204"
  },
  {
    "text": "And we can use the mouse to interact with Linux. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1210"
  },
  {
    "text": "Last but not least, we'll see how we can take advantage ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1212"
  },
  {
    "text": "of the Rosetta 2 technology inside Linux.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1216"
  },
  {
    "text": "For many of us, we love developing services on our Mac, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1220"
  },
  {
    "text": "but once our work is ready, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1223"
  },
  {
    "text": "the binaries we create may need to run on x86 servers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1225"
  },
  {
    "text": "x86 instruction emulation has been great for this, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1229"
  },
  {
    "text": "but we can do better. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1232"
  },
  {
    "text": "In macOS Ventura, we are bringing the power ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1235"
  },
  {
    "text": "of Rosetta 2 to Linux binaries.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1237"
  },
  {
    "text": "What Rosetta 2 does is translate the Linux x86-64 binaries ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1240"
  },
  {
    "text": "inside your virtual machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1244"
  },
  {
    "text": "This means you can run your favorite ARM Linux distribution, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1246"
  },
  {
    "text": "and its x86-64 apps can run with Rosetta. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1249"
  },
  {
    "text": "And it's fast. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1253"
  },
  {
    "text": "It's the same technology we have been using on the Mac, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1254"
  },
  {
    "text": "which means we have incredible performance. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1257"
  },
  {
    "text": "Let’s see how to use it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1260"
  },
  {
    "text": "First, we need to give Linux access to Rosetta. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1263"
  },
  {
    "text": "To do this, we use the same file sharing technology we have seen on macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1267"
  },
  {
    "text": "Instead of sharing a folder, we use a special kind of object, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1271"
  },
  {
    "text": "a VZLinuxRosettaDirectoryShare. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1275"
  },
  {
    "text": "Then we create a sharing device and set up Rosetta directory share. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1278"
  },
  {
    "text": "Finally, we set up our device on the configuration as usual. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1284"
  },
  {
    "text": "Now our virtual machine is ready to use Rosetta. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1288"
  },
  {
    "text": "Next, let’s see how Linux can take advantage of it.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1292"
  },
  {
    "text": "In Linux, we start by mounting the shared directory in the file system. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1296"
  },
  {
    "text": "What we see from Linux is a Rosetta binary that can translate applications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1301"
  },
  {
    "text": "Then we can use update-binfmts to tell the system to use Rosetta ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1306"
  },
  {
    "text": "to handle any x86-64 binary. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1310"
  },
  {
    "text": "Don’t worry about remembering this command. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1313"
  },
  {
    "text": "It's all in the documentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1315"
  },
  {
    "text": "Now Linux is ready. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1318"
  },
  {
    "text": "Every x86-64 binary launched will be translated by Rosetta.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1320"
  },
  {
    "text": "Before we end our Linux section, let’s see everything together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1327"
  },
  {
    "text": "Here, we have a full Linux distribution installed from scratch. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1331"
  },
  {
    "text": "We can show its UI with Virtio GPU 2D. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1335"
  },
  {
    "text": "From within the VM, we run a PHP server with Rosetta. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1338"
  },
  {
    "text": "And we can just connect to it from macOS host.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1342"
  },
  {
    "text": "We've seen that creating virtual machines has never been simpler. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1347"
  },
  {
    "text": "With Virtualization framework, you can get virtual machines running ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1351"
  },
  {
    "text": "with just a few lines of code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1354"
  },
  {
    "text": "We have also seen that virtual machines are ridiculously fast on macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1357"
  },
  {
    "text": "To learn more about Virtualization, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1362"
  },
  {
    "text": "I invite you to check out the code samples and documentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1363"
  },
  {
    "text": "And on behalf of the team, we cannot wait ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1367"
  },
  {
    "text": "to see what you will do next with this technology. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1369"
  },
  {
    "text": "",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10002/?time=1371"
  }
]