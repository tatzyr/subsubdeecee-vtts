[
  {
    "text": "♪ Mellow instrumental hip-hop music ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=0"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=3"
  },
  {
    "text": "Welcome to \"Efficiency awaits: Background Tasks in SwiftUI.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=9"
  },
  {
    "text": "I'm John Gallagher, an engineer on the watchOS Frameworks team.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=13"
  },
  {
    "text": "In this talk, we'll learn about a new SwiftUI API ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=17"
  },
  {
    "text": "for handling background tasks using Swift Concurrency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=20"
  },
  {
    "text": "and in a consistent way across all of Apple's platforms.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=22"
  },
  {
    "text": "We'll begin by describing a sample app called Stormy, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=26"
  },
  {
    "text": "an app for taking photos of the sky on stormy days ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=29"
  },
  {
    "text": "which makes use of background tasks.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=32"
  },
  {
    "text": "Then, we'll dive into how the app uses background tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=36"
  },
  {
    "text": "and how background tasks work under the hood.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=39"
  },
  {
    "text": "Next, we'll learn how to handle those background tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=44"
  },
  {
    "text": "using a new API in SwiftUI.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=48"
  },
  {
    "text": "And finally, we'll review how the API uses Swift Concurrency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=52"
  },
  {
    "text": "to make handling background tasks easier than ever.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=57"
  },
  {
    "text": "The new API is shared across watchOS, iOS, tvOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=63"
  },
  {
    "text": "Mac Catalyst, and Widgets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=67"
  },
  {
    "text": "including iOS apps running on the Mac, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=69"
  },
  {
    "text": "which means the concepts and patterns you learn ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=71"
  },
  {
    "text": "handling background tasks for one platform ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=73"
  },
  {
    "text": "can apply to work you do on others.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=75"
  },
  {
    "text": "Utilizing Swift Concurrency, the new API reduces the need ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=79"
  },
  {
    "text": "for deeply nested completion handlers and callbacks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=82"
  },
  {
    "text": "as well as much of the mutable state ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=85"
  },
  {
    "text": "which was frequently a side effect.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=86"
  },
  {
    "text": "Swift Concurrency's native task cancellation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=89"
  },
  {
    "text": "helps applications gracefully complete tasks in a timely way ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=92"
  },
  {
    "text": "to avoid being quit in the background by the system.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=95"
  },
  {
    "text": "For people who like to keep their head in the clouds, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=100"
  },
  {
    "text": "we're going to build an app called Stormy ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=102"
  },
  {
    "text": "that will remind users to take photos of the sky ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=104"
  },
  {
    "text": "when it's stormy outside.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=106"
  },
  {
    "text": "The app will show a notification at noon on stormy days ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=109"
  },
  {
    "text": "requesting that the user takes a picture of the sky.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=111"
  },
  {
    "text": "When the user taps the notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=116"
  },
  {
    "text": "they'll take a photo of the sky to upload to their profile ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=118"
  },
  {
    "text": "for future admiration.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=121"
  },
  {
    "text": "We're going to upload this photo in the background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=123"
  },
  {
    "text": "The app will send another notification ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=127"
  },
  {
    "text": "when the upload has finished.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=129"
  },
  {
    "text": "Let's dive in to how background tasks can let us do this.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=131"
  },
  {
    "text": "In this diagram, we'll examine at a high level ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=135"
  },
  {
    "text": "how the notification will only get sent ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=138"
  },
  {
    "text": "on stormy days utilizing background tasks.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=140"
  },
  {
    "text": "We'll represent foreground application runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=143"
  },
  {
    "text": "with the bar on the left, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=146"
  },
  {
    "text": "background application runtime with the bar in the middle, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=148"
  },
  {
    "text": "and the system is represented on the right.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=152"
  },
  {
    "text": "When our app is first launched to the foreground by the user, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=156"
  },
  {
    "text": "we can take our first opportunity ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=160"
  },
  {
    "text": "to schedule a background app refresh task for noon.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=161"
  },
  {
    "text": "Then, when the user leaves our app and the app is suspended, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=166"
  },
  {
    "text": "the system will know to wake our application again ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=170"
  },
  {
    "text": "in the background at the time we scheduled.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=173"
  },
  {
    "text": "We scheduled our task for noon, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=177"
  },
  {
    "text": "so that's when system will wake the app in the background ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=179"
  },
  {
    "text": "and send a background app refresh task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=182"
  },
  {
    "text": "With this background runtime, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=187"
  },
  {
    "text": "we need to figure out whether it is stormy outside, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=188"
  },
  {
    "text": "and if it is, send a notification to the user.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=191"
  },
  {
    "text": "To start, we'll make a network request to a weather service ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=196"
  },
  {
    "text": "to check the current weather.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=199"
  },
  {
    "text": "With the URLSession scheduled for background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=202"
  },
  {
    "text": "the application can suspend ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=205"
  },
  {
    "text": "and wait for the network request to complete.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=206"
  },
  {
    "text": "When the background network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=210"
  },
  {
    "text": "for weather data completes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=212"
  },
  {
    "text": "our application will be given background runtime again ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=213"
  },
  {
    "text": "with a new URLSession background task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=216"
  },
  {
    "text": "With the results of the weather data request in hand, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=221"
  },
  {
    "text": "our application knows whether it is stormy outside ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=224"
  },
  {
    "text": "and can choose whether to send a notification ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=227"
  },
  {
    "text": "prompting the user to take a photo of the sky.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=230"
  },
  {
    "text": "Now that our work for that URLSession task is done, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=235"
  },
  {
    "text": "the system can once again suspend the application.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=238"
  },
  {
    "text": "Let's dive into the details of a single background task ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=242"
  },
  {
    "text": "and see how it works.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=246"
  },
  {
    "text": "To do that, we're going to take a closer look at the lifecycle ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=247"
  },
  {
    "text": "of a single app refresh background task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=251"
  },
  {
    "text": "Let's zoom in here a little bit.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=254"
  },
  {
    "text": "First, the system will wake our application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=259"
  },
  {
    "text": "and send it an app refresh background task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=261"
  },
  {
    "text": "Then, still in the background, we make a network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=265"
  },
  {
    "text": "to check whether it is stormy outside.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=269"
  },
  {
    "text": "Ideally, our network request completes ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=272"
  },
  {
    "text": "within the allotted background runtime our application has ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=275"
  },
  {
    "text": "for app refresh.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=278"
  },
  {
    "text": "When we get the network response, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=281"
  },
  {
    "text": "we'd like to post the notification immediately.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=283"
  },
  {
    "text": "With the notification posted, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=287"
  },
  {
    "text": "we've completed everything we needed to do during app refresh ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=288"
  },
  {
    "text": "and the system can suspend the application again.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=292"
  },
  {
    "text": "But what about when our network request for weather data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=296"
  },
  {
    "text": "doesn't complete in time? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=299"
  },
  {
    "text": "If an app is running low on background runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=302"
  },
  {
    "text": "for the current task, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=304"
  },
  {
    "text": "the system signals the app that the time is running low, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=306"
  },
  {
    "text": "giving us a chance to handle this situation gracefully.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=308"
  },
  {
    "text": "If applications do not signal that they've completed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=313"
  },
  {
    "text": "their background work before runtime expires, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=315"
  },
  {
    "text": "the application may be quit by the system and throttled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=318"
  },
  {
    "text": "for future background task requests.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=320"
  },
  {
    "text": "In this case, we should make sure that our network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=324"
  },
  {
    "text": "is a background network request, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=327"
  },
  {
    "text": "which will allow us to complete our app refresh task immediately ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=329"
  },
  {
    "text": "and get woken again ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=333"
  },
  {
    "text": "for additional background runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=334"
  },
  {
    "text": "when the network request completes.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=336"
  },
  {
    "text": "With our background URLSession scheduled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=339"
  },
  {
    "text": "the system can suspend the application again.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=342"
  },
  {
    "text": "Now, let's dive into how the BackgroundTask API in SwiftUI ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=345"
  },
  {
    "text": "can help us build Stormy.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=349"
  },
  {
    "text": "To begin, we'll need a basic application.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=352"
  },
  {
    "text": "Then, we'll write a function to schedule background app refresh ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=356"
  },
  {
    "text": "for noon tomorrow.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=360"
  },
  {
    "text": "First, we create a date representing noon tomorrow.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=362"
  },
  {
    "text": "Then, we create a background app refresh request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=367"
  },
  {
    "text": "with an earliest begin date of noon tomorrow ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=370"
  },
  {
    "text": "and submit it to the scheduler.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=373"
  },
  {
    "text": "This is what tells the system to wake our application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=375"
  },
  {
    "text": "tomorrow at noon.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=378"
  },
  {
    "text": "We'll want to call this function ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=381"
  },
  {
    "text": "when the user first opens the application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=382"
  },
  {
    "text": "and requests daily storm notifications at noon.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=385"
  },
  {
    "text": "We can register a handler corresponding ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=389"
  },
  {
    "text": "to the background task we scheduled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=391"
  },
  {
    "text": "by using the new background task scene modifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=392"
  },
  {
    "text": "When the app receives a background task, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=398"
  },
  {
    "text": "any blocks registered with this modifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=400"
  },
  {
    "text": "that match the background task received are run.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=402"
  },
  {
    "text": "In this case, we used the appRefresh task type ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=406"
  },
  {
    "text": "which can be scheduled in advance ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=410"
  },
  {
    "text": "to provide our application with a limited amount of runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=411"
  },
  {
    "text": "in the background at a desired date.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=414"
  },
  {
    "text": "Using the same identifier for the request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=417"
  },
  {
    "text": "and the handler in the background task modifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=419"
  },
  {
    "text": "lets the system identify which handler to call ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=422"
  },
  {
    "text": "when the corresponding task is received by your application.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=425"
  },
  {
    "text": "In order for us to be sure that ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=430"
  },
  {
    "text": "we are scheduled again for tomorrow, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=432"
  },
  {
    "text": "we'll start our background task by calling ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=434"
  },
  {
    "text": "the scheduleAppRefresh function we just wrote ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=436"
  },
  {
    "text": "to schedule background runtime again for tomorrow at noon.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=439"
  },
  {
    "text": "Now that our background runtime at noon is recurring, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=444"
  },
  {
    "text": "we make our network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=448"
  },
  {
    "text": "to check whether it is stormy outside ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=449"
  },
  {
    "text": "and wait for the result using the await Swift keyword.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=451"
  },
  {
    "text": "Then, if our network request has returned ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=456"
  },
  {
    "text": "and it is indeed stormy outside, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=458"
  },
  {
    "text": "we await sending the notification to the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=460"
  },
  {
    "text": "prompting them to upload a photo of the sky.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=463"
  },
  {
    "text": "When the body of our closure returns, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=466"
  },
  {
    "text": "the underlying background task ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=468"
  },
  {
    "text": "assigned to our application by the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=470"
  },
  {
    "text": "is implicitly marked as complete, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=472"
  },
  {
    "text": "and the system can suspend our application again.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=474"
  },
  {
    "text": "Here, using Swift Concurrency has let do potentially ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=478"
  },
  {
    "text": "long-running operations in our background task ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=481"
  },
  {
    "text": "without the need for an explicit callback ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=484"
  },
  {
    "text": "for when the work has completed.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=486"
  },
  {
    "text": "Many APIs across Apple Platforms, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=488"
  },
  {
    "text": "such as adding a notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=491"
  },
  {
    "text": "already support Swift Concurrency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=492"
  },
  {
    "text": "for asynchronous operations.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=494"
  },
  {
    "text": "Here, the notifyForPhoto async function ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=496"
  },
  {
    "text": "can be implemented in a straightforward way ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=499"
  },
  {
    "text": "using the asynchronous addNotification method ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=502"
  },
  {
    "text": "found on UserNotificationCenter.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=504"
  },
  {
    "text": "Let's dive in to how Swift Concurrency and async/await ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=509"
  },
  {
    "text": "do some heavy lifting for us ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=512"
  },
  {
    "text": "and make it easier than ever to handle background tasks.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=514"
  },
  {
    "text": "Let's write the asynchronous isStormy function ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=518"
  },
  {
    "text": "that we've been referencing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=521"
  },
  {
    "text": "This async function is going to need to make a network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=523"
  },
  {
    "text": "checking the weather outside.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=526"
  },
  {
    "text": "To start, we'll get the shared URLSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=529"
  },
  {
    "text": "and instantiate a request for weather data.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=532"
  },
  {
    "text": "URLSession has adopted Swift Concurrency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=536"
  },
  {
    "text": "and has a method for downloading data from the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=539"
  },
  {
    "text": "that can be awaited from async contexts.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=541"
  },
  {
    "text": "With the network response in hand, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=546"
  },
  {
    "text": "we can read the weather data and return our result.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=548"
  },
  {
    "text": "But what about when our application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=552"
  },
  {
    "text": "can't complete the network request ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=554"
  },
  {
    "text": "before our runtime expires? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=556"
  },
  {
    "text": "Recall that in this case, we wanted to make sure that ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=559"
  },
  {
    "text": "we had set up our URLSession as a background session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=563"
  },
  {
    "text": "and to ensure that it will send launch events to our application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=567"
  },
  {
    "text": "using a URLSession background task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=570"
  },
  {
    "text": "Back to our code.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=574"
  },
  {
    "text": "We had used the shared URLSession.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=577"
  },
  {
    "text": "Instead, we should create a URLSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=581"
  },
  {
    "text": "from a background configuration with ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=584"
  },
  {
    "text": "the sessionSendsLaunchEvents property set to true.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=586"
  },
  {
    "text": "This tells the system that some network requests should run ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=591"
  },
  {
    "text": "even when the app is suspended and to then wake the app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=594"
  },
  {
    "text": "for a URLSession background task when that request completes.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=598"
  },
  {
    "text": "Note that this is especially important on watchOS ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=602"
  },
  {
    "text": "as all network requests made by apps running in the background ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=606"
  },
  {
    "text": "on watchOS must be requested through background URLSessions.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=609"
  },
  {
    "text": "We're not quite done though.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=616"
  },
  {
    "text": "Recall that when our background task runtime is expiring, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=618"
  },
  {
    "text": "the system will cancel the async task ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=622"
  },
  {
    "text": "that is running the closure provided ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=624"
  },
  {
    "text": "to the background task modifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=626"
  },
  {
    "text": "This means that the network request made here ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=628"
  },
  {
    "text": "will also be cancelled when our background runtime is expiring.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=632"
  },
  {
    "text": "To respond to and handle that cancellation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=638"
  },
  {
    "text": "we can use the withTaskCancellationHandler ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=641"
  },
  {
    "text": "function built in to Swift Concurrency.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=643"
  },
  {
    "text": "Instead of awaiting the result directly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=647"
  },
  {
    "text": "we place our download into a withTaskCancellationHandler call ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=649"
  },
  {
    "text": "and await this as well.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=654"
  },
  {
    "text": "The first block passed to withTaskCancellationHandler ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=657"
  },
  {
    "text": "is the async procedure we'd like to run and await.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=660"
  },
  {
    "text": "The second onCancel trailing closure is code that will run ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=663"
  },
  {
    "text": "when the task is cancelled.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=667"
  },
  {
    "text": "Here, when the immediate network request is cancelled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=670"
  },
  {
    "text": "due to our runtime expiring, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=673"
  },
  {
    "text": "we promote the network request to a background download task, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=675"
  },
  {
    "text": "on which we can call resume, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=679"
  },
  {
    "text": "triggering the background download that will persist ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=680"
  },
  {
    "text": "even when our app is suspended.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=683"
  },
  {
    "text": "This code is not making the underlying network request twice ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=686"
  },
  {
    "text": "as we're using the same URLSession to back both, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=690"
  },
  {
    "text": "and URLSession will deduplicate any in-process requests ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=693"
  },
  {
    "text": "under the hood.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=696"
  },
  {
    "text": "Finally, we need to ensure that our application is set up ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=701"
  },
  {
    "text": "to handle a launch from a background URLSession.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=704"
  },
  {
    "text": "We can use the background task modifier again, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=708"
  },
  {
    "text": "but this time with the URLSession task type.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=711"
  },
  {
    "text": "By using the same identifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=714"
  },
  {
    "text": "for the background URLSession configuration we made earlier, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=716"
  },
  {
    "text": "we can ensure this block is only called ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=719"
  },
  {
    "text": "when that specific URLSession produces a background task.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=722"
  },
  {
    "text": "We've taken a dive into the new unified SwiftUI API ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=728"
  },
  {
    "text": "for handling background tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=732"
  },
  {
    "text": "and discovered how Swift Concurrency makes it easier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=733"
  },
  {
    "text": "than ever for us to manage task completion and expiration.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=736"
  },
  {
    "text": "For more information about Swift Concurrency, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=740"
  },
  {
    "text": "check out the \"Meet Async/await in Swift\" talk ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=743"
  },
  {
    "text": "from WWDC 2021.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=745"
  },
  {
    "text": "And to learn more about concurrency in SwiftUI, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=749"
  },
  {
    "text": "we recommend \"Discover Concurrency in SwiftUI,\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=751"
  },
  {
    "text": "also from WWDC 2021.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=754"
  },
  {
    "text": "Thanks for watching ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=757"
  },
  {
    "text": "\"Efficiency awaits: Background Tasks in SwiftUI.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=758"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10142/?time=761"
  }
]