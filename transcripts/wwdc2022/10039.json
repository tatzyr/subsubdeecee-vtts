[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=0"
  },
  {
    "text": "Greg: Hi, I'm Greg. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=9"
  },
  {
    "text": "Welcome to what's new in StoreKit Testing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=11"
  },
  {
    "text": "In this session, Peter and I will highlight some great new features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=13"
  },
  {
    "text": "available for testing in-app purchases in StoreKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=17"
  },
  {
    "text": "We'll begin by taking a look at some of the ways you can use Xcode 14 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=20"
  },
  {
    "text": "to streamline your in-app purchase testing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=25"
  },
  {
    "text": "Next, we'll take a look at some brand-new capabilities you can take advantage of ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=27"
  },
  {
    "text": "to cover even more corner cases in your in-app subscription implementations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=32"
  },
  {
    "text": "And finally, Peter will show new enhancements ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=37"
  },
  {
    "text": "to the sandbox testing environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=39"
  },
  {
    "text": "We'll be working with Food Truck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=42"
  },
  {
    "text": "an app to provide powerful capabilities to food truck operators who sell donuts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=44"
  },
  {
    "text": "I already integrated with StoreKit to offer the full version ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=49"
  },
  {
    "text": "of the Food Truck sales history feature, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=52"
  },
  {
    "text": "and a subscription for an enhanced version of the Social Feed service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=54"
  },
  {
    "text": "Throughout the session we'll use StoreKit Testing in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=58"
  },
  {
    "text": "to test the in-app purchase functionality of our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=61"
  },
  {
    "text": "Back at WWDC 2020, we introduced StoreKit Testing in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=64"
  },
  {
    "text": "allowing you to start testing your in-app purchases directly in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=68"
  },
  {
    "text": "This year, with Xcode 14, we're excited to share some updates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=72"
  },
  {
    "text": "to the testing life cycle of a StoreKit app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=76"
  },
  {
    "text": "Just like before, you can create a StoreKit Configuration File in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=80"
  },
  {
    "text": "and start testing your in-app purchase implementation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=84"
  },
  {
    "text": "without setting up an app in App Store Connect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=86"
  },
  {
    "text": "When you're ready to configure your app in App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=90"
  },
  {
    "text": "we're introducing a brand-new feature in Xcode 14 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=93"
  },
  {
    "text": "to allow you to use the same in-app purchase products ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=96"
  },
  {
    "text": "that you've entered in App Store Connect with StoreKit Testing in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=98"
  },
  {
    "text": "If you already have an app on the store, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=102"
  },
  {
    "text": "you can start using StoreKit Testing in Xcode right now, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=104"
  },
  {
    "text": "without needing to set up a StoreKit Configuration File from scratch. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=107"
  },
  {
    "text": "This convenient feature enables you to configure your in-app purchases once, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=110"
  },
  {
    "text": "and use the same configuration locally in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=114"
  },
  {
    "text": "inside your unit tests, in the Sandbox environment, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=118"
  },
  {
    "text": "and when you're ready for release, on the App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=121"
  },
  {
    "text": "It's easy to sync your products in App Store Connect with Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=125"
  },
  {
    "text": "First, you configure your products in App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=128"
  },
  {
    "text": "like this Social Feed+ subscription, for example. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=131"
  },
  {
    "text": "Then, you create a synced configuration file in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=134"
  },
  {
    "text": "which will load the product data into Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=138"
  },
  {
    "text": "If you want to make a change, for example updating the US English title, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=141"
  },
  {
    "text": "you can make the change in App Store Connect ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=145"
  },
  {
    "text": "and sync your Configuration in Xcode again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=147"
  },
  {
    "text": "You can also convert a configuration you've synced ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=150"
  },
  {
    "text": "into a local, editable file to make on the fly changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=153"
  },
  {
    "text": "Converting a synced configuration to a local configuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=156"
  },
  {
    "text": "is a one-way operation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=159"
  },
  {
    "text": "to sync again you'll need to create a new configuration file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=161"
  },
  {
    "text": "I've already gotten started by setting up a subscription group for Social Feed+, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=165"
  },
  {
    "text": "an enhanced version of the Social Feed service the Food Truck app offers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=169"
  },
  {
    "text": "Let's jump into Xcode and take a look at how to use these products ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=173"
  },
  {
    "text": "with StoreKit Testing in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=176"
  },
  {
    "text": "I have the Food Truck project open on my Mac. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=179"
  },
  {
    "text": "To get started we'll create a new StoreKit Configuration File ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=181"
  },
  {
    "text": "by going to the File Menu, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=184"
  },
  {
    "text": "making a new file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=188"
  },
  {
    "text": "filtering by StoreKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=190"
  },
  {
    "text": "and clicking next.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=192"
  },
  {
    "text": "In Xcode 14, when we create a new configuration file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=197"
  },
  {
    "text": "we get this checkbox to enable keeping the file in sync ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=201"
  },
  {
    "text": "with an app in App Store Connect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=204"
  },
  {
    "text": "To create a local file, fill in a name and leave the box unchecked. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=206"
  },
  {
    "text": "To set up syncing, we just have to check the box, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=212"
  },
  {
    "text": "and confirm that the correct team and app are selected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=216"
  },
  {
    "text": "If desired, we could choose a different team and app using the picker menus. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=220"
  },
  {
    "text": "We click next, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=225"
  },
  {
    "text": "and choose somewhere to save our file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=227"
  },
  {
    "text": "As soon as we save the file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=231"
  },
  {
    "text": "the in-app purchase metadata begins syncing from App Store Connect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=233"
  },
  {
    "text": "While the data is downloading, we can keep working on our app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=236"
  },
  {
    "text": "and keep track of its progress in the Activity Bar. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=239"
  },
  {
    "text": "When the sync is finished, you'll notice this file looks different ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=242"
  },
  {
    "text": "than a typical StoreKit Configuration File. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=245"
  },
  {
    "text": "That's because the synced file is in a read-only state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=249"
  },
  {
    "text": "We can see all the data in Xcode at a glance, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=253"
  },
  {
    "text": "but to make changes we have to open App Store Connect.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=256"
  },
  {
    "text": "I have the Social Feed+ monthly product up in Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=261"
  },
  {
    "text": "Let's update the English title for this product by adding a suffix ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=265"
  },
  {
    "text": "to help differentiate the product from the yearly plan.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=269"
  },
  {
    "text": "Now that this is updated, let's save ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=277"
  },
  {
    "text": "and go back to Xcode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=281"
  },
  {
    "text": "To have this change reflect in our configuration file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=285"
  },
  {
    "text": "we just have to press this sync button in the bottom left corner.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=288"
  },
  {
    "text": "Once the sync is complete, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=296"
  },
  {
    "text": "we can see the change reflected in Xcode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=298"
  },
  {
    "text": "Even though the synced file is read-only, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=303"
  },
  {
    "text": "we can still copy over data to a local file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=306"
  },
  {
    "text": "to make quick changes inside of Xcode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=309"
  },
  {
    "text": "In addition to copying items from the configuration file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=321"
  },
  {
    "text": "we can also convert an entire synced file to a local, editable file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=324"
  },
  {
    "text": "All we need to do is open our synced file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=329"
  },
  {
    "text": "go to the editor menu, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=334"
  },
  {
    "text": "and click on \"Convert to Local StoreKit Configuration\".",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=337"
  },
  {
    "text": "Keep in mind, you can't undo this operation after converting the file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=343"
  },
  {
    "text": "To sync with the app again, you'll need to create a new StoreKit Configuration File. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=347"
  },
  {
    "text": "I want to keep this file in sync with App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=352"
  },
  {
    "text": "so let's cancel out of this alert. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=355"
  },
  {
    "text": "Now that we have our file synced, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=359"
  },
  {
    "text": "let's configure our testing environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=361"
  },
  {
    "text": "To get started, we'll open the scheme editor.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=364"
  },
  {
    "text": "Select the run action, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=371"
  },
  {
    "text": "and select options.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=373"
  },
  {
    "text": "In the options, we can switch between different StoreKit environments ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=378"
  },
  {
    "text": "from the picker menu. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=381"
  },
  {
    "text": "If we choose \"None\" we'll connect to Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=383"
  },
  {
    "text": "and if we choose \"Food Truck\" we'll connect to the Xcode environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=386"
  },
  {
    "text": "It's that easy to switch between environments ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=390"
  },
  {
    "text": "depending on our current testing needs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=392"
  },
  {
    "text": "and both environments will now be using the exact same product ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=395"
  },
  {
    "text": "and subscription metadata. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=398"
  },
  {
    "text": "Let's pick our synced configuration file for now.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=401"
  },
  {
    "text": "We've now set up StoreKit in Xcode, so let's get to testing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=407"
  },
  {
    "text": "Since we're using a SwiftUI app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=411"
  },
  {
    "text": "we can preview our subscription store right in Xcode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=412"
  },
  {
    "text": "Starting in Xcode 14, products from StoreKit configuration files ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=420"
  },
  {
    "text": "will load right into SwiftUI previews. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=424"
  },
  {
    "text": "This makes it super easy to build and test great looking store user interfaces, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=427"
  },
  {
    "text": "using real in-app purchase data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=431"
  },
  {
    "text": "Let's try to add some detail to the product options ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=434"
  },
  {
    "text": "by including a subtitle for our products. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=437"
  },
  {
    "text": "We'll just add a Text view containing the product's localized description.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=441"
  },
  {
    "text": "And watch the preview update immediately ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=449"
  },
  {
    "text": "with the description we set up in App Store Connect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=451"
  },
  {
    "text": "I think this is looking a lot better now.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=454"
  },
  {
    "text": "Now that our UI is in good shape, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=458"
  },
  {
    "text": "let's run the app on an iPhone ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=460"
  },
  {
    "text": "and start some functional testing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=462"
  },
  {
    "text": "In Xcode 14, there are some powerful new tools ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=476"
  },
  {
    "text": "in the StoreKit Transaction Manager. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=479"
  },
  {
    "text": "With our app running, we can open the transaction manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=481"
  },
  {
    "text": "by pressing the purchases icon in the debug bar.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=484"
  },
  {
    "text": "On the right there's a new transaction inspector ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=490"
  },
  {
    "text": "that allows us to visualize ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=493"
  },
  {
    "text": "all of the under the hood details about a transaction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=495"
  },
  {
    "text": "This tool can be useful to understand the state of an in-app transaction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=498"
  },
  {
    "text": "For example, we can see the date this subscription to Social Feed+ expired, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=502"
  },
  {
    "text": "and information about its upcoming renewals. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=507"
  },
  {
    "text": "We can also jump to the configuration file for a product, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=512"
  },
  {
    "text": "subscription group, or subscription offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=515"
  },
  {
    "text": "We just have to click the jump button next to this subscription group.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=518"
  },
  {
    "text": "And we're brought straight to Social Feed+ in our configuration file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=525"
  },
  {
    "text": "This inspector will help us out later in the session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=533"
  },
  {
    "text": "as we look at more advanced test cases.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=536"
  },
  {
    "text": "We can also filter our transactions now, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=540"
  },
  {
    "text": "which is really useful for navigating the list of transactions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=543"
  },
  {
    "text": "with all of these Social Feed+ renewals. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=546"
  },
  {
    "text": "In our app you'll notice we have access to the annual sales history feature.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=550"
  },
  {
    "text": "We have all of these subscription renewals, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=557"
  },
  {
    "text": "which makes it difficult to tell which transaction entitled us to the feature. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=559"
  },
  {
    "text": "We can easily find the transaction for the product ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=565"
  },
  {
    "text": "by beginning to type out its ID...",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=567"
  },
  {
    "text": "And selecting the product ID filter from the auto-complete menu.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=572"
  },
  {
    "text": "We can also filter by purchase date, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=580"
  },
  {
    "text": "so we can focus on just the purchases we're making now.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=583"
  },
  {
    "text": "Since our subscription to Social Feed+ is expired, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=592"
  },
  {
    "text": "let's go into the app and subscribe again.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=595"
  },
  {
    "text": "Now that we've confirmed the subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=606"
  },
  {
    "text": "we can see just the new transaction appear.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=608"
  },
  {
    "text": "We just looked at some ways to enhance your in-app purchase testing in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=613"
  },
  {
    "text": "by syncing products and subscriptions from App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=617"
  },
  {
    "text": "using your StoreKit Configurations with SwiftUI Previews, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=620"
  },
  {
    "text": "and taking advantage of the new tools in the Transaction Manager. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=624"
  },
  {
    "text": "Now, we're going to continue testing Food Truck's in-app purchase functionality ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=628"
  },
  {
    "text": "by using some new capabilities in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=632"
  },
  {
    "text": "to cover advanced subscription cases. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=635"
  },
  {
    "text": "First, we'll look at testing refund requests, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=638"
  },
  {
    "text": "allowing people to request refunds for their purchases in Food Truck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=641"
  },
  {
    "text": "Next, we'll test offer codes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=646"
  },
  {
    "text": "to offer promotions to Social Feed+ subscribers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=648"
  },
  {
    "text": "then we'll look at handling price increases ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=651"
  },
  {
    "text": "in Food Truck's user interface, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=654"
  },
  {
    "text": "and last, reducing Social Feed+ involuntary churn ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=656"
  },
  {
    "text": "by supporting billing retry and grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=660"
  },
  {
    "text": "To begin testing refund requests, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=664"
  },
  {
    "text": "we'll navigate to this support view in our app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=666"
  },
  {
    "text": "which allows us to choose a recent transaction to refund. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=669"
  },
  {
    "text": "The code for this is simple. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=674"
  },
  {
    "text": "I just added a refundRequestSheet view modifier to our view, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=676"
  },
  {
    "text": "and when we press the refund button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=680"
  },
  {
    "text": "we'll flip the isPresented Binding to true. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=682"
  },
  {
    "text": "Now, let's see this in action.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=685"
  },
  {
    "text": "When the Binding is true, the refund request sheet appears above our view. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=689"
  },
  {
    "text": "When testing in the Xcode environment, the issue we select corresponds 1:1 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=694"
  },
  {
    "text": "with a RevocationReason in the StoreKit API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=699"
  },
  {
    "text": "Let's pick \"Developer Issue\" and press \"Request Refund\".",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=703"
  },
  {
    "text": "In the App Store, refund requests will take some time to process, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=709"
  },
  {
    "text": "but when testing with Xcode or Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=713"
  },
  {
    "text": "refund requests will immediately refund the transaction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=715"
  },
  {
    "text": "In the transaction manager, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=720"
  },
  {
    "text": "we can look at the inspector for this updated transaction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=723"
  },
  {
    "text": "to see the revocation reason we just selected, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=726"
  },
  {
    "text": "and the revocation date.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=729"
  },
  {
    "text": "You can also test refunds by just clicking the refund button ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=733"
  },
  {
    "text": "in the transaction manager. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=737"
  },
  {
    "text": "The refund request API helps us provide great customer support ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=739"
  },
  {
    "text": "for people who use Food Truck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=743"
  },
  {
    "text": "Now that we looked at how to test refund requests in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=745"
  },
  {
    "text": "let's look at some ways you can use StoreKit to handle refunded transactions.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=748"
  },
  {
    "text": "After refunding a transaction, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=753"
  },
  {
    "text": "an updated Transaction value will emit from the Transaction.updates sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=755"
  },
  {
    "text": "We can use the revocationDate and revocationReason properties ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=761"
  },
  {
    "text": "to detect these refunded transactions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=764"
  },
  {
    "text": "It's easy to test the two revocation reason cases ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=767"
  },
  {
    "text": "by selecting the corresponding option in the refund request sheet in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=770"
  },
  {
    "text": "That's how you test the refund request sheet in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=775"
  },
  {
    "text": "This works on iOS and macOS ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=778"
  },
  {
    "text": "when using either the Xcode environment or Sandbox. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=780"
  },
  {
    "text": "For testing with Xcode, you'll need your iPhone or iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=784"
  },
  {
    "text": "to run iOS or iPadOS 15.2 or later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=787"
  },
  {
    "text": "To test with Xcode on your Mac, you'll need macOS 12.1 or later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=791"
  },
  {
    "text": "Now, let's take a look at testing subscription offer codes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=795"
  },
  {
    "text": "For this, we'll be using our local StoreKit Configuration file. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=799"
  },
  {
    "text": "To make a new offer for codes, we select a subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=804"
  },
  {
    "text": "and press the \"+\" under the offer codes table. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=807"
  },
  {
    "text": "We then can configure our offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=812"
  },
  {
    "text": "We'll name this \"Free month\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=814"
  },
  {
    "text": "and make it a free offer for one month.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=818"
  },
  {
    "text": "Just like in App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=822"
  },
  {
    "text": "we select which customers are eligible, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=824"
  },
  {
    "text": "and whether the introductory offer can be redeemed with this offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=827"
  },
  {
    "text": "Let's leave the default settings for now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=831"
  },
  {
    "text": "Now that our code is configured, we'll press \"Done\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=834"
  },
  {
    "text": "Of course, if you're syncing with App Store Connect ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=838"
  },
  {
    "text": "your configured offers will show up in this table automatically.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=841"
  },
  {
    "text": "Now that our offer is configured, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=846"
  },
  {
    "text": "let's navigate to the store view in the app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=848"
  },
  {
    "text": "I've added this button near the bottom of the view ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=852"
  },
  {
    "text": "for redeeming a subscription offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=854"
  },
  {
    "text": "If we open the store view's implementation in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=858"
  },
  {
    "text": "implementing offer codes is as effortless as adding an offerCodeRedemption modifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=861"
  },
  {
    "text": "to our view, and flipping the isPresented Binding ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=866"
  },
  {
    "text": "to true when someone taps the button. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=870"
  },
  {
    "text": "Let's see how this works.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=873"
  },
  {
    "text": "When we press the button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=877"
  },
  {
    "text": "the redeem sheet appears above our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=879"
  },
  {
    "text": "In the App Store, people can type in offer codes ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=882"
  },
  {
    "text": "that you generate in App Store Connect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=884"
  },
  {
    "text": "but in Xcode the testing experience is much more streamlined. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=886"
  },
  {
    "text": "We have a list of all the offers for codes in our configuration file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=891"
  },
  {
    "text": "grouped by the subscription they unlock. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=894"
  },
  {
    "text": "To redeem, let's tap the offer we just created, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=897"
  },
  {
    "text": "and press the redeem button. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=901"
  },
  {
    "text": "The payment sheet appears, and we can see the offer for codes ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=903"
  },
  {
    "text": "will start right after the pay as you go introductory offer.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=906"
  },
  {
    "text": "After subscribing, we'll get a confirmation screen, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=917"
  },
  {
    "text": "and we can now close the sheet ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=920"
  },
  {
    "text": "and verify our app unlocks access to Social Feed+.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=922"
  },
  {
    "text": "If we look at the inspector for this new transaction, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=930"
  },
  {
    "text": "we can see the introductory offer is currently applied. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=933"
  },
  {
    "text": "Since the offer is pay as you go, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=937"
  },
  {
    "text": "the renewals section shows ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=938"
  },
  {
    "text": "we'll get two more renewals of the introductory offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=940"
  },
  {
    "text": "After that, the free month code we just redeemed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=943"
  },
  {
    "text": "Then, the standard subscription will renew indefinitely. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=947"
  },
  {
    "text": "The inspector makes it very clear what's happening ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=951"
  },
  {
    "text": "to the state of our subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=954"
  },
  {
    "text": "even with complicated scenarios like multiple offers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=956"
  },
  {
    "text": "We just looked at how to configure offer codes in our local StoreKit configuration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=960"
  },
  {
    "text": "and how to test redeeming them on iPhone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=965"
  },
  {
    "text": "Offer codes are a great way to offer flexible promotions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=968"
  },
  {
    "text": "to our future and existing subscribers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=971"
  },
  {
    "text": "and now it's easier than ever to get started ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=973"
  },
  {
    "text": "using offer codes in Food Truck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=976"
  },
  {
    "text": "Now, let's take a look at how to handle these offers using StoreKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=978"
  },
  {
    "text": "After redeeming the code, both the Transaction.updates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=982"
  },
  {
    "text": "and Status.updates sequences will emit new values. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=986"
  },
  {
    "text": "We can check the offerType property on the transaction value ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=990"
  },
  {
    "text": "to see if there is an offer applied to the current transaction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=994"
  },
  {
    "text": "In the case we just looked at the value of offerType will be introductory, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=998"
  },
  {
    "text": "because we allowed the subscriber to redeem the introductory offer ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1003"
  },
  {
    "text": "with the offer for codes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1006"
  },
  {
    "text": "On the renewalInfo value, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1009"
  },
  {
    "text": "we can check the offerType property ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1011"
  },
  {
    "text": "to see what kind of offer will be present in the next renewal. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1012"
  },
  {
    "text": "In the case we just looked at, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1017"
  },
  {
    "text": "we can expect the initial value to be introductory ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1018"
  },
  {
    "text": "since we used a pay as you go offer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1021"
  },
  {
    "text": "After two subscription periods we'll see the value switch to code, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1024"
  },
  {
    "text": "as we have a code offer stacked. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1028"
  },
  {
    "text": "When offerType is code, we can use the offerID property ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1031"
  },
  {
    "text": "to get the reference name of the applied offer for codes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1035"
  },
  {
    "text": "That's how you test offers for codes in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1039"
  },
  {
    "text": "You can configure offers for codes starting in Xcode 13.3, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1043"
  },
  {
    "text": "and test them on iPhones and iPads running iOS 15.4 or later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1047"
  },
  {
    "text": "Now that we've verified offers for codes work in Food Truck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1052"
  },
  {
    "text": "let's test how our app handles a price increase for Social Feed+. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1055"
  },
  {
    "text": "Testing a price increase is really simple in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1060"
  },
  {
    "text": "To get started, we'll increase the price for the monthly social feed subscription.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1063"
  },
  {
    "text": "This step is optional. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1070"
  },
  {
    "text": "You can leave the price the same ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1072"
  },
  {
    "text": "and still simulate a price increase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1074"
  },
  {
    "text": "Back to the transaction manager, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1076"
  },
  {
    "text": "all we need to do is select the latest transaction for a subscription ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1080"
  },
  {
    "text": "and press \"Request Price Increase Consent\" in the toolbar.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1084"
  },
  {
    "text": "We can see in the transaction manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1090"
  },
  {
    "text": "our transaction is now in a \"Price Increase Pending\" state, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1092"
  },
  {
    "text": "and if we look at the device we'll notice a sheet appeared above our app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1096"
  },
  {
    "text": "asking to consent to the price increase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1100"
  },
  {
    "text": "This sheet will appear on its own without adding any code, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1104"
  },
  {
    "text": "but we took advantage of the new Messages API to customize its behavior.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1107"
  },
  {
    "text": "Let's take a look at how we integrated with the Messages API in the code.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1113"
  },
  {
    "text": "We have a for loop iterating the messages sequence here, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1128"
  },
  {
    "text": "and if we get a message like price increase, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1132"
  },
  {
    "text": "make sure we don't have a sensitive view presented, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1135"
  },
  {
    "text": "like the donut editor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1138"
  },
  {
    "text": "Otherwise, we'll use the DisplayMessageAction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1140"
  },
  {
    "text": "to display the message. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1143"
  },
  {
    "text": "If the donut editor is presented, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1146"
  },
  {
    "text": "we'll hold on to the Message value ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1148"
  },
  {
    "text": "and display it after the donut editing is finished.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1150"
  },
  {
    "text": "Let's get back to testing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1154"
  },
  {
    "text": "In the App Store, existing subscribers may get multiple price increase messages ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1159"
  },
  {
    "text": "at different times until they make a decision ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1164"
  },
  {
    "text": "to cancel or consent to the price increase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1167"
  },
  {
    "text": "In Xcode, we have full control of when these messages come. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1169"
  },
  {
    "text": "Each time we press the button in the transaction manager, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1173"
  },
  {
    "text": "we'll get a message again, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1176"
  },
  {
    "text": "even if the transaction is already in a price increase state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1178"
  },
  {
    "text": "Now we can test if our deferral logic actually works. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1183"
  },
  {
    "text": "So I'll open the donut editor...",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1188"
  },
  {
    "text": "And send a message to open the sheet again.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1194"
  },
  {
    "text": "The sheet doesn't appear yet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1202"
  },
  {
    "text": "but if we leave the donut editor, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1204"
  },
  {
    "text": "the sheet appears as expected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1208"
  },
  {
    "text": "While we could accept the price increase, or cancel the subscription in the sheet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1210"
  },
  {
    "text": "in reality, users might respond to the price increase ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1215"
  },
  {
    "text": "via an external source, like an email. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1218"
  },
  {
    "text": "To simulate this, we can use the approve and decline buttons ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1221"
  },
  {
    "text": "in the transaction manager. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1226"
  },
  {
    "text": "Since the donut editing experience was so great, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1229"
  },
  {
    "text": "I'll consent to the new price by pressing Approve in the transaction manager. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1231"
  },
  {
    "text": "Using StoreKit in Xcode makes testing a complicated corner case ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1238"
  },
  {
    "text": "like a price increase very smooth. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1242"
  },
  {
    "text": "Now that we looked at how to simulate a price increase, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1245"
  },
  {
    "text": "let's look at how we can use StoreKit to handle price increases in our app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1247"
  },
  {
    "text": "When testing the price increase status, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1253"
  },
  {
    "text": "the status updates sequence will emit new values with every state change. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1255"
  },
  {
    "text": "We can detect these updates in our app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1260"
  },
  {
    "text": "by checking the priceIncreaseStatus property on the RenewalInfo value. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1262"
  },
  {
    "text": "If a customer cancels their subscription due to a price increase, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1267"
  },
  {
    "text": "we'll be able to detect this ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1271"
  },
  {
    "text": "by checking for didNotConsentToPriceIncrease ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1273"
  },
  {
    "text": "in the expirationReason property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1276"
  },
  {
    "text": "We can also write unit tests around testing price increase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1279"
  },
  {
    "text": "To start, disabling dialogs will allow us to test ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1283"
  },
  {
    "text": "without actually showing the price increase UI above our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1287"
  },
  {
    "text": "After purchasing the subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1291"
  },
  {
    "text": "we can use the requestPriceIncreaseConsentForTransaction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1293"
  },
  {
    "text": "API to start the process, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1297"
  },
  {
    "text": "passing in the ID of the latest transaction for the subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1299"
  },
  {
    "text": "To verify a test transaction is pending a price increase, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1304"
  },
  {
    "text": "we'll check the isPendingPriceIncreaseConsent property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1307"
  },
  {
    "text": "Finally, depending on what we're testing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1312"
  },
  {
    "text": "we can call consentToPriceIncreaseForTransaction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1315"
  },
  {
    "text": "or declinePriceIncreaseForTransaction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1318"
  },
  {
    "text": "to see how our app responds to finished price increase cases. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1322"
  },
  {
    "text": "That's all for testing price increase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1326"
  },
  {
    "text": "Price increase is testable with Xcode 13.3 on all platforms. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1329"
  },
  {
    "text": "Note that the price increase message is only testable on iOS 15.4 or later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1334"
  },
  {
    "text": "Finally, let's take a look at subscription billing retry and grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1340"
  },
  {
    "text": "Billing retry is a state where an error occurred ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1346"
  },
  {
    "text": "when trying to renew a subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1349"
  },
  {
    "text": "like an expired credit card. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1350"
  },
  {
    "text": "In the App Store, during billing retry ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1353"
  },
  {
    "text": "the App Store will attempt to fix the issue and recover the subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1355"
  },
  {
    "text": "You can optionally enable a grace period, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1361"
  },
  {
    "text": "which allows people to keep using their subscription for a limited time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1363"
  },
  {
    "text": "at the beginning of the billing retry state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1367"
  },
  {
    "text": "Let me demonstrate how to simulate this when testing in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1370"
  },
  {
    "text": "To simulate billing issues on a subscription renewal, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1374"
  },
  {
    "text": "we open the \"Editor\" menu on the StoreKit Configuration we're testing with ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1377"
  },
  {
    "text": "and enable \"Billing Retry on Renewal\".",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1381"
  },
  {
    "text": "I want Food Truck to support a billing grace period, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1388"
  },
  {
    "text": "so let's enable \"Billing Grace Period\" in the menu as well.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1391"
  },
  {
    "text": "We'll speed up the subscription rate too, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1397"
  },
  {
    "text": "so we can watch how the state changes.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1400"
  },
  {
    "text": "Let's first subscribe to Social Feed+.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1408"
  },
  {
    "text": "Now, let's wait for it to be time for a renewal.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1424"
  },
  {
    "text": "When the transaction expires, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1431"
  },
  {
    "text": "notice we first enter the billing grace period state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1433"
  },
  {
    "text": "We can look at the transaction inspector and see the time each state will end.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1437"
  },
  {
    "text": "The billing grace period just expired, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1444"
  },
  {
    "text": "and now we're in the standard billing retry state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1446"
  },
  {
    "text": "At any time we can use the \"Resolve Issue For Transaction\" button ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1449"
  },
  {
    "text": "to simulate fixing the billing error. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1454"
  },
  {
    "text": "Let's test resolving the issue.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1457"
  },
  {
    "text": "Now that the issue is resolved, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1462"
  },
  {
    "text": "we get a new transaction.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1464"
  },
  {
    "text": "So long as we have \"Billing retry on renewal\" enabled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1470"
  },
  {
    "text": "each new transaction will continue to enter billing retry, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1473"
  },
  {
    "text": "so we can repeat this test as many times as we'd like. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1477"
  },
  {
    "text": "Handling Billing Retry and Grace Period properly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1481"
  },
  {
    "text": "is key to retaining subscribers by reducing involuntary churn. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1484"
  },
  {
    "text": "We just looked at how straightforward it is to simulate these states with Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1488"
  },
  {
    "text": "so now let's go over how to handle them using StoreKit.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1492"
  },
  {
    "text": "As the billing retry and grace period states change, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1496"
  },
  {
    "text": "the status updates sequence will emit a new value. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1500"
  },
  {
    "text": "Since we offer a billing grace period in Food Truck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1504"
  },
  {
    "text": "we need to make sure to give subscribers access to Social Feed+ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1507"
  },
  {
    "text": "while they're in the grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1511"
  },
  {
    "text": "We can see how long the subscriber's grace period should be ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1513"
  },
  {
    "text": "using the gracePeriodExpirationDate property on the renewal info. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1516"
  },
  {
    "text": "To check for billing retry, we just have to check isInBillingRetry.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1521"
  },
  {
    "text": "We can also detect either of these states easily with the state property of Status. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1527"
  },
  {
    "text": "If we see a customer is in either of these states, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1533"
  },
  {
    "text": "we can direct them to a deep link to the App Store to fix the billing issue. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1536"
  },
  {
    "text": "If you're using any current entitlement API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1541"
  },
  {
    "text": "you'll receive transactions for expired subscriptions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1544"
  },
  {
    "text": "while they're in the grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1547"
  },
  {
    "text": "We can also control billing retry and grace period in our unit tests ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1550"
  },
  {
    "text": "by setting billingGracePeriodIsEnabled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1554"
  },
  {
    "text": "and shouldEnterBillingRetryOnRenewal on our StoreKit test session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1557"
  },
  {
    "text": "After our app notices a subscription enter billing retry, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1563"
  },
  {
    "text": "the test transaction's hasPurchaseIssue property will be true. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1567"
  },
  {
    "text": "After waiting for various status updates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1572"
  },
  {
    "text": "and asserting our app updates as expected, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1574"
  },
  {
    "text": "we can use the resolve issue for transaction method ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1577"
  },
  {
    "text": "to simulate the App Store recovering the subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1580"
  },
  {
    "text": "Billing retry and grace period are testable in Xcode 13.3 or later ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1584"
  },
  {
    "text": "on all platforms. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1588"
  },
  {
    "text": "Later in the session, Peter will go more into detail ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1590"
  },
  {
    "text": "on how to test these states in Sandbox on iOS and iPadOS 16.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1593"
  },
  {
    "text": "We covered advanced test cases from requesting refunds ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1599"
  },
  {
    "text": "to handling billing retry and grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1602"
  },
  {
    "text": "For more details on how to use the new StoreKit APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1605"
  },
  {
    "text": "to support some of these cases, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1608"
  },
  {
    "text": "check out \"What's new with in-app purchase.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1610"
  },
  {
    "text": "This was just a quick overview of what's new for StoreKit Testing ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1615"
  },
  {
    "text": "in Xcode this year, but we didn't cover everything. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1617"
  },
  {
    "text": "There are new subscription renewal rates, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1621"
  },
  {
    "text": "you can test the StoreKit 2 in-app manage subscriptions sheet in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1624"
  },
  {
    "text": "and you can write unit tests for your SKAdNetwork implementations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1629"
  },
  {
    "text": "using StoreKitTest. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1633"
  },
  {
    "text": "Check out \"What's new in SKAdNetwork\" to learn more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1635"
  },
  {
    "text": "Now Peter will walk you through what's new ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1639"
  },
  {
    "text": "in the Sandbox testing environment this year. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1642"
  },
  {
    "text": "Peter: Thanks, Greg. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1645"
  },
  {
    "text": "Hi, I'm Peter, an App Store server engineer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1646"
  },
  {
    "text": "We saw how new features with StoreKit Testing in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1649"
  },
  {
    "text": "can help you test more complex in-app purchase implementations.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1653"
  },
  {
    "text": "We're constantly listening to your feedback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1657"
  },
  {
    "text": "and we know many of you rely on the App Store Sandbox environment ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1659"
  },
  {
    "text": "to test your in-app purchases and server implementations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1663"
  },
  {
    "text": "I'm excited to share some new enhancements we're making in Sandbox ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1666"
  },
  {
    "text": "so you can more easily test your app and server in an online test environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1670"
  },
  {
    "text": "We'll be introducing enhancements to Sandbox Apple ID creation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1675"
  },
  {
    "text": "the App Store Connect API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1679"
  },
  {
    "text": "and billing failure simulation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1681"
  },
  {
    "text": "To use the sandbox environment, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1684"
  },
  {
    "text": "we first need to set up a Sandbox Apple ID in App Store Connect.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1686"
  },
  {
    "text": "You'll notice we moved the Sandbox tester list ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1691"
  },
  {
    "text": "to the navigation bar on the Users and Access page. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1693"
  },
  {
    "text": "Here, we can create a new tester with the Plus button. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1698"
  },
  {
    "text": "We streamlined the creation process by removing several fields ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1702"
  },
  {
    "text": "from the new tester window. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1705"
  },
  {
    "text": "We're now only asking for the minimum amount of info, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1707"
  },
  {
    "text": "so you can move forward with creating your account ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1710"
  },
  {
    "text": "without unnecessary information. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1712"
  },
  {
    "text": "You can also use a \"plus symbol\" in your email address, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1715"
  },
  {
    "text": "so you don't need to create a brand-new email address for each tester. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1718"
  },
  {
    "text": "We know creating strong passwords can be tedious, and we made this easier too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1723"
  },
  {
    "text": "We've also added in-line suggestions for helping make your password more secure.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1727"
  },
  {
    "text": "We hope streamlined Apple ID creation form, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1733"
  },
  {
    "text": "and better password complexity hints, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1735"
  },
  {
    "text": "will help you spend less time setting up accounts ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1737"
  },
  {
    "text": "and more time developing your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1740"
  },
  {
    "text": "App Store Connect is the central location ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1743"
  },
  {
    "text": "where you create and manage Sandbox Apple IDs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1745"
  },
  {
    "text": "as well as manage your app content and organization. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1748"
  },
  {
    "text": "Over the last few years, we've been adding features to Sandbox ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1751"
  },
  {
    "text": "that you've been asking for, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1755"
  },
  {
    "text": "like changing Sandbox account region and clearing purchase history. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1756"
  },
  {
    "text": "Many of these features are accessible in App Store Connect ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1760"
  },
  {
    "text": "or on-device in the Sandbox Manage Subscriptions page. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1763"
  },
  {
    "text": "Later this year, we will be bringing several of these Sandbox features ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1767"
  },
  {
    "text": "to the App Store Connect API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1771"
  },
  {
    "text": "including querying for a list of Sandbox Apple IDs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1772"
  },
  {
    "text": "clearing purchase history, and setting interrupted purchase state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1776"
  },
  {
    "text": "This will enable faster testing with your sandbox accounts ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1780"
  },
  {
    "text": "and help you setup automation clients for commonly-used testing tools. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1783"
  },
  {
    "text": "Finally, I'm happy to announce support for billing failure simulation in Sandbox. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1787"
  },
  {
    "text": "In 2018, we announced Billing Retry and Grace Period ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1793"
  },
  {
    "text": "for auto-renewing subscriptions, to help you reduce involuntary churn. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1796"
  },
  {
    "text": "Since launching in 2019, Billing Grace Period has allowed you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1801"
  },
  {
    "text": "to recover 300 million days of paid service to your customers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1805"
  },
  {
    "text": "This results in incremental revenue for your business ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1809"
  },
  {
    "text": "while your customers experience no interruption in service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1812"
  },
  {
    "text": "While many of you are already handling billing failure cases in production, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1816"
  },
  {
    "text": "we want to provide more testing scenarios in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1820"
  },
  {
    "text": "so you can test and handle billing failures ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1823"
  },
  {
    "text": "before your app is published on the App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1825"
  },
  {
    "text": "You'll be able to use a new Sandbox Account Settings page ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1828"
  },
  {
    "text": "to enable billing failure simulation for your account, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1832"
  },
  {
    "text": "test foreground and background subscription failures ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1835"
  },
  {
    "text": "in the context of your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1838"
  },
  {
    "text": "and verify subscription status with verifyReceipt, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1840"
  },
  {
    "text": "App Store Server API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1843"
  },
  {
    "text": "and App Store Server Notifications V2 in Sandbox. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1844"
  },
  {
    "text": "For more info on Billing Retry and reducing involuntary churn, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1848"
  },
  {
    "text": "I recommend the 2018 WWDC session, \"Engineering Subscriptions\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1852"
  },
  {
    "text": "This year, we're introducing a switch in the new Sandbox Account Settings ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1857"
  },
  {
    "text": "to simulate a failed in-app purchase attempt. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1861"
  },
  {
    "text": "This is also the new home for the Sandbox subscriptions page. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1864"
  },
  {
    "text": "With billing failure simulation enabled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1868"
  },
  {
    "text": "foreground in-app purchases will fail. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1870"
  },
  {
    "text": "This behavior matches the behavior ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1872"
  },
  {
    "text": "when your customer's payment method is declined. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1874"
  },
  {
    "text": "Billing failure simulation also ensures that auto-renewing subscription states ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1877"
  },
  {
    "text": "match those for billing failures in production. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1882"
  },
  {
    "text": "This means you can test in-app messaging for your customers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1885"
  },
  {
    "text": "who are having billing problems. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1888"
  },
  {
    "text": "These subscription states will be reflected ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1890"
  },
  {
    "text": "in your in-app purchase receipts, verified with V2 Notifications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1892"
  },
  {
    "text": "Let's review the subscription lifecycle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1897"
  },
  {
    "text": "When you purchase an auto-renewing subscription in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1899"
  },
  {
    "text": "you already receive V2 Notifications, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1903"
  },
  {
    "text": "like SUBSCRIBED, and DID_RENEW. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1905"
  },
  {
    "text": "When you test failed in-app purchase attempts for an account ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1908"
  },
  {
    "text": "with an active subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1911"
  },
  {
    "text": "the next renewal will fall into billing retry state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1912"
  },
  {
    "text": "You'll now receive billing retry notifications in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1915"
  },
  {
    "text": "like DID_FAIL_TO_RENEW. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1919"
  },
  {
    "text": "If you disable billing failure simulation before we stop trying to recover ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1921"
  },
  {
    "text": "the renewal of your subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1925"
  },
  {
    "text": "the next renewal attempt will be successful, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1927"
  },
  {
    "text": "and you will receive a DID_RENEW notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1930"
  },
  {
    "text": "with subtype BILLING_RECOVERY. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1932"
  },
  {
    "text": "If we reach the limit for retry attempts, and billing failure simulation is enabled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1935"
  },
  {
    "text": "the subscription will expire and you will receive EXPIRED, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1940"
  },
  {
    "text": "with subtype BILLING_RETRY. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1943"
  },
  {
    "text": "If you're already using Grace Period in production, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1946"
  },
  {
    "text": "and V2 Notifications in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1948"
  },
  {
    "text": "you can expect to receive the DID_FAIL_TO_RENEW notification ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1951"
  },
  {
    "text": "with subtype GRACE_PERIOD. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1955"
  },
  {
    "text": "Here's an example subscription in billing retry state, with Grace Period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1957"
  },
  {
    "text": "You will receive DID_FAIL_TO_RENEW notifications ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1961"
  },
  {
    "text": "with subtype GRACE_PERIOD, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1964"
  },
  {
    "text": "as well as GRACE_PERIOD_EXPIRED, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1966"
  },
  {
    "text": "if billing failure simulation is still enabled at the end of the grace period. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1968"
  },
  {
    "text": "When verifying subscription information with App Store Server API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1973"
  },
  {
    "text": "you can verify subscription state by decoding the payload ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1977"
  },
  {
    "text": "of signedRenewalInfo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1980"
  },
  {
    "text": "Here, we see the expirationIntent and billing retry fields are populated. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1983"
  },
  {
    "text": "When calling /verifyReceipt with a receipt for subscriptions in billing retry state, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1989"
  },
  {
    "text": "you will see that the is_in_billing_retry_period flag ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1994"
  },
  {
    "text": "is set to 1. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1997"
  },
  {
    "text": "Also, when using grace period, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=1999"
  },
  {
    "text": "you can now expect grace period expiration date fields to be populated.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2001"
  },
  {
    "text": "Once you've completed testing a billing failure in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2006"
  },
  {
    "text": "you can disable the switch in Sandbox Account Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2009"
  },
  {
    "text": "We hope this new testability helps you build ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2012"
  },
  {
    "text": "the best possible experience for your customers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2015"
  },
  {
    "text": "Today we discussed several new testing capabilities you can use ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2018"
  },
  {
    "text": "to streamline testing your app's in-app purchase functionality. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2021"
  },
  {
    "text": "By syncing your configuration in App Store Connect with Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2026"
  },
  {
    "text": "you can use the same in-app purchase configuration when testing locally ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2029"
  },
  {
    "text": "or with the Sandbox environment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2034"
  },
  {
    "text": "New capabilities like offer code and refund testing in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2036"
  },
  {
    "text": "will help you verify complex StoreKit implementations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2040"
  },
  {
    "text": "And, subscription management testability will enable you to evolve your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2043"
  },
  {
    "text": "to ensure a great customer experience, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2048"
  },
  {
    "text": "even if their service is interrupted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2050"
  },
  {
    "text": "For details on how a billing failure impacts subscription receipts, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2052"
  },
  {
    "text": "plus, App Store Server Notifications V2 in Sandbox, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2056"
  },
  {
    "text": "I recommend the WWDC 21 session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2060"
  },
  {
    "text": "\"Manage in-app purchases on your server.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2063"
  },
  {
    "text": "Also, to hear about what's new in App Store Server API ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2066"
  },
  {
    "text": "and V2 Notifications, check out \"What's new with in-app purchase.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2069"
  },
  {
    "text": "We look forward to hearing your feedback about these new features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2074"
  },
  {
    "text": "Thank you for joining.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10039/?time=2077"
  }
]