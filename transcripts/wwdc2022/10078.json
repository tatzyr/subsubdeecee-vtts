[
  {
    "text": "♪ Mellow instrumental hip-hip music ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=0"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=3"
  },
  {
    "text": "Hi, I am Vidhi Goel, and in this video, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=10"
  },
  {
    "text": "I will talk about how to reduce networking delays in your apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=14"
  },
  {
    "text": "and make them more responsive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=19"
  },
  {
    "text": "First, I will explain why reducing latency is crucial ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=21"
  },
  {
    "text": "in making your apps responsive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=25"
  },
  {
    "text": "Next, I will go over a list ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=29"
  },
  {
    "text": "of things that you can do in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=31"
  },
  {
    "text": "and on your server to get rid of unnecessary delays. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=34"
  },
  {
    "text": "Finally, I will show what you can do to reduce delays ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=40"
  },
  {
    "text": "in the network itself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=44"
  },
  {
    "text": "Network latency is the time it takes for data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=47"
  },
  {
    "text": "to get from one endpoint to another. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=51"
  },
  {
    "text": "It determines how quickly content can be delivered ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=55"
  },
  {
    "text": "to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=58"
  },
  {
    "text": "All apps that use networking can be affected ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=61"
  },
  {
    "text": "by slow network transactions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=64"
  },
  {
    "text": "that result in a poor app experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=66"
  },
  {
    "text": "For example, video calls can sometimes freeze ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=71"
  },
  {
    "text": "or become laggy, which can interrupt meetings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=75"
  },
  {
    "text": "To address this, people often call up ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=80"
  },
  {
    "text": "their service provider to upgrade their bandwidth, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=83"
  },
  {
    "text": "and yet, the problem still exists. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=87"
  },
  {
    "text": "To get to the root cause of this problem, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=91"
  },
  {
    "text": "you need to understand how your app's packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=94"
  },
  {
    "text": "travel in a network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=98"
  },
  {
    "text": "When your app or framework requests data from a server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=100"
  },
  {
    "text": "packets are sent out by the networking stack. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=104"
  },
  {
    "text": "It is often assumed that the packets go directly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=108"
  },
  {
    "text": "to the server with no delays in the network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=112"
  },
  {
    "text": "But, in reality, the slowest link of the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=116"
  },
  {
    "text": "usually has a large queue of packets to process. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=119"
  },
  {
    "text": "So, the packet from your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=125"
  },
  {
    "text": "actually waits behind this large queue ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=127"
  },
  {
    "text": "until the packets ahead of it are processed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=130"
  },
  {
    "text": "This queuing at the slowest link increases the duration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=136"
  },
  {
    "text": "of each round trip between your app and your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=139"
  },
  {
    "text": "This problem is aggravated when it takes multiple round trips ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=144"
  },
  {
    "text": "to get the first response for your app's request. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=149"
  },
  {
    "text": "For example, the time to get the first response packet ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=154"
  },
  {
    "text": "when using TLS 1.2 over TCP ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=159"
  },
  {
    "text": "is the duration of each round trip ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=163"
  },
  {
    "text": "multiplied by four trips. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=166"
  },
  {
    "text": "Given that each round-trip time is already inflated ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=170"
  },
  {
    "text": "by queuing in the network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=174"
  },
  {
    "text": "the resulting total time is simply too long. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=176"
  },
  {
    "text": "There are two factors that multiply together ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=182"
  },
  {
    "text": "to determine your app's responsiveness: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=185"
  },
  {
    "text": "the duration of each round trip and the number of round trips. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=189"
  },
  {
    "text": "Reducing these will lower your app's latency, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=195"
  },
  {
    "text": "and increase your app's responsiveness. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=198"
  },
  {
    "text": "There was a study examining the impact ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=204"
  },
  {
    "text": "of increasing bandwidth versus decreasing latency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=206"
  },
  {
    "text": "on page load time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=210"
  },
  {
    "text": "In the first test, latency is kept fixed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=213"
  },
  {
    "text": "and bandwidth is increased incrementally from 1 to 10Mbps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=217"
  },
  {
    "text": "At first, increasing the bandwidth from 1 to 2Mbps ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=224"
  },
  {
    "text": "reduces page load time by almost 40 percent, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=229"
  },
  {
    "text": "which is great. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=233"
  },
  {
    "text": "But after 4Mbps, each incremental increase ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=236"
  },
  {
    "text": "results in almost no improvement in the page load time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=241"
  },
  {
    "text": "This is why apps can be slow even after upgrading ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=247"
  },
  {
    "text": "to Gigabit Internet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=251"
  },
  {
    "text": "On the other hand, the results for the latency test show ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=254"
  },
  {
    "text": "that for every 20 millisecond decrease in latency, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=259"
  },
  {
    "text": "there is a linear improvement in page load time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=264"
  },
  {
    "text": "And these results apply to all network activity ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=268"
  },
  {
    "text": "in your apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=273"
  },
  {
    "text": "Now, I will go over a few simple actions you can take ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=275"
  },
  {
    "text": "to reduce latency and make your app more responsive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=280"
  },
  {
    "text": "You can reduce your app's latency significantly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=285"
  },
  {
    "text": "by adopting modern protocols ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=288"
  },
  {
    "text": "such as IPv6, TLS 1.3 and HTTP/3. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=290"
  },
  {
    "text": "And all you need to do is use URLSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=297"
  },
  {
    "text": "and Network.framework APIs in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=301"
  },
  {
    "text": "and these protocols will be used automatically ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=304"
  },
  {
    "text": "once they are enabled on your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=307"
  },
  {
    "text": "Since its rollout, we have seen a constant increase ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=312"
  },
  {
    "text": "in HTTP/3 usage, and within just a year, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=317"
  },
  {
    "text": "20 percent of web traffic already uses HTTP/3, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=322"
  },
  {
    "text": "and it continues to grow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=328"
  },
  {
    "text": "Comparing Safari traffic for different HTTP versions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=332"
  },
  {
    "text": "HTTP/3 is the fastest of them all. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=337"
  },
  {
    "text": "HTTP/3 requests take a little over half the time ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=342"
  },
  {
    "text": "as compared to HTTP/1, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=347"
  },
  {
    "text": "when looking at median request completion time ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=350"
  },
  {
    "text": "as a multiple of round-trip time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=353"
  },
  {
    "text": "This means your app's requests will complete much faster. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=357"
  },
  {
    "text": "When a device moves from Wi-Fi to cellular, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=363"
  },
  {
    "text": "it takes time to reestablish new connections ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=367"
  },
  {
    "text": "and that can make your application stall. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=371"
  },
  {
    "text": "Using connection migration eliminates those stalls. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=375"
  },
  {
    "text": "To opt in, set the multipathServiceType property ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=380"
  },
  {
    "text": "to .handover on your URLSession configuration, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=384"
  },
  {
    "text": "or on your NWParameters. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=388"
  },
  {
    "text": "Enable this option and make sure it works with your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=392"
  },
  {
    "text": "If you design your own protocol that uses UDP directly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=399"
  },
  {
    "text": "iOS 16 and macOS Ventura introduce a better way ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=404"
  },
  {
    "text": "to send datagrams. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=409"
  },
  {
    "text": "QUIC datagrams provide many benefits over plain UDP, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=412"
  },
  {
    "text": "the most important being that QUIC datagrams ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=417"
  },
  {
    "text": "react to congestion in the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=420"
  },
  {
    "text": "which keeps the round-trip time low and reduces packet loss. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=423"
  },
  {
    "text": "To opt in on the client, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=427"
  },
  {
    "text": "set isDatagram to true on your QUIC options ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=430"
  },
  {
    "text": "and set the maximum datagram frame size you want to use. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=433"
  },
  {
    "text": "After creating the datagram flow, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=439"
  },
  {
    "text": "you can send and receive on it just like any other QUIC stream. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=442"
  },
  {
    "text": "Now you know what to do in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=447"
  },
  {
    "text": "to reduce latency. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=450"
  },
  {
    "text": "Next, I will explain how servers impact ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=452"
  },
  {
    "text": "your app's responsiveness. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=456"
  },
  {
    "text": "Despite often running on top-of-the-line hardware, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=459"
  },
  {
    "text": "it is possible that your server actually becomes the reason ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=462"
  },
  {
    "text": "for slowness in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=466"
  },
  {
    "text": "We introduced the network quality tool in macOS Monterey, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=469"
  },
  {
    "text": "and you can use this tool ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=474"
  },
  {
    "text": "to measure buffer bloat in your service provider's network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=476"
  },
  {
    "text": "as well as on your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=480"
  },
  {
    "text": "You need to configure your server to act as a destination ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=483"
  },
  {
    "text": "for the network quality tool. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=486"
  },
  {
    "text": "Once you have done that, run the networkQuality tool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=489"
  },
  {
    "text": "first against Apple's default server ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=494"
  },
  {
    "text": "and then against your own configured server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=497"
  },
  {
    "text": "If the tool scores well using the default server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=502"
  },
  {
    "text": "but not so well when talking to your own server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=506"
  },
  {
    "text": "there may be room to improve the responsiveness ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=510"
  },
  {
    "text": "of your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=513"
  },
  {
    "text": "Now, I will show you an example where we used this technique ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=515"
  },
  {
    "text": "to improve something that all of you are doing right now -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=520"
  },
  {
    "text": "streaming video.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=525"
  },
  {
    "text": "You may have had the experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=530"
  },
  {
    "text": "where you skip ahead to a different place in a video ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=532"
  },
  {
    "text": "and you end up waiting a long time while it rebuffers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=535"
  },
  {
    "text": "So, we investigated the reason for this slowness ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=541"
  },
  {
    "text": "in random access. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=545"
  },
  {
    "text": "We used the network quality tool ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=548"
  },
  {
    "text": "to test the behavior of a streaming server ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=550"
  },
  {
    "text": "and we found that the responsiveness score was poor. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=553"
  },
  {
    "text": "On the right side, I streamed a WWDC video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=558"
  },
  {
    "text": "Then, I skipped ahead in the video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=563"
  },
  {
    "text": "The screen didn't display anything ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=566"
  },
  {
    "text": "while the video rebuffered. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=568"
  },
  {
    "text": "After a few seconds, the video showed up. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=572"
  },
  {
    "text": "With the help of detailed output ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=576"
  },
  {
    "text": "from the network quality tool on macOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=578"
  },
  {
    "text": "we found that there was huge queuing at the server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=581"
  },
  {
    "text": "So we took a look at the server configuration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=586"
  },
  {
    "text": "Specifically we looked at TCP, TLS, and HTTP buffer sizes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=592"
  },
  {
    "text": "which were configured to 4MB, 256KB, and 4MB, respectively. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=598"
  },
  {
    "text": "The buffers were huge because RAM is plentiful. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=609"
  },
  {
    "text": "But just because some buffering is good, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=614"
  },
  {
    "text": "doesn't always mean that more buffering is better. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=617"
  },
  {
    "text": "Our responsiveness measurements highlighted this exact issue -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=622"
  },
  {
    "text": "a newly generated packet was queued behind stale data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=627"
  },
  {
    "text": "in these large buffers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=632"
  },
  {
    "text": "and this created a lot of additional delay ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=634"
  },
  {
    "text": "in delivering the most recent packet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=637"
  },
  {
    "text": "So, we reduced the buffer size to 256KB for HTTP, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=641"
  },
  {
    "text": "16KB for TLS, and 128KB for TCP.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=647"
  },
  {
    "text": "This is the config file for Apache Traffic Server ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=657"
  },
  {
    "text": "which shows the options that were configured. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=661"
  },
  {
    "text": "TCP not-sent low-water mark was set to 128KB ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=665"
  },
  {
    "text": "along with other options that were enabled to lower buffering. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=670"
  },
  {
    "text": "For TLS, we enabled dynamic record sizes ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=676"
  },
  {
    "text": "and for HTTP/2, we reduced the low-water mark ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=681"
  },
  {
    "text": "and buffer block size. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=686"
  },
  {
    "text": "We recommend using these configurations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=688"
  },
  {
    "text": "for your Apache Traffic Server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=691"
  },
  {
    "text": "and if you are using a different web server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=694"
  },
  {
    "text": "look for its equivalent options. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=698"
  },
  {
    "text": "After making these changes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=701"
  },
  {
    "text": "we ran the network quality tool again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=703"
  },
  {
    "text": "And this time we got a high RPM score! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=707"
  },
  {
    "text": "On the right, I streamed the same video, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=712"
  },
  {
    "text": "but this time when I skipped ahead, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=716"
  },
  {
    "text": "the video resumed instantly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=718"
  },
  {
    "text": "By getting rid of unnecessary queuing at the server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=723"
  },
  {
    "text": "we made random access much more responsive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=727"
  },
  {
    "text": "Regardless of how your app uses networking, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=731"
  },
  {
    "text": "these changes on your server can make your app more responsive ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=735"
  },
  {
    "text": "and deliver a better user experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=740"
  },
  {
    "text": "That's how to improve your app and update your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=744"
  },
  {
    "text": "There is a third factor that affects responsiveness greatly; ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=749"
  },
  {
    "text": "the network itself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=754"
  },
  {
    "text": "Apple introduced the network quality tool in iOS 15 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=757"
  },
  {
    "text": "and macOS Monterey. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=761"
  },
  {
    "text": "Since then, others have used the same methodology ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=764"
  },
  {
    "text": "to develop network quality tests. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=768"
  },
  {
    "text": "Waveform has launched a Bufferbloat test. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=772"
  },
  {
    "text": "There's an open source implementation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=776"
  },
  {
    "text": "of the responsiveness test, written in Go. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=779"
  },
  {
    "text": "And Ookla has added a responsiveness measurement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=783"
  },
  {
    "text": "to their Speedtest app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=787"
  },
  {
    "text": "Ookla's app shows round trip time in milliseconds, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=791"
  },
  {
    "text": "and if you divide 60,000 by that number, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=795"
  },
  {
    "text": "you get the number of round trips per minute, or RPM. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=798"
  },
  {
    "text": "You can use these tools to measure ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=804"
  },
  {
    "text": "how well your own network is performing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=806"
  },
  {
    "text": "The best way to understand delays in a network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=810"
  },
  {
    "text": "is with a delay-sensitive application. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=814"
  },
  {
    "text": "So, I will show you my screen sharing experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=817"
  },
  {
    "text": "to a remote machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=821"
  },
  {
    "text": "I set up network conditions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=823"
  },
  {
    "text": "to mimic a representative access network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=825"
  },
  {
    "text": "with traffic from other devices sharing that network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=828"
  },
  {
    "text": "Here, I logged on to my remote machine using Screen Sharing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=834"
  },
  {
    "text": "I clicked on different Finder menus ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=841"
  },
  {
    "text": "but the display of each menu was very sluggish. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=844"
  },
  {
    "text": "To check how much this interaction was delayed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=849"
  },
  {
    "text": "I launched an app that displays time on my local machine, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=852"
  },
  {
    "text": "and I launched the same app on my remote machine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=856"
  },
  {
    "text": "Even though time on these computers is synchronized, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=861"
  },
  {
    "text": "my remote screen didn't update regularly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=865"
  },
  {
    "text": "and showed time delayed by a few seconds. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=869"
  },
  {
    "text": "The reason for this delayed update ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=874"
  },
  {
    "text": "was the presence of a large queue ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=877"
  },
  {
    "text": "at the slowest link of the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=879"
  },
  {
    "text": "and packets from the Screen Sharing app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=882"
  },
  {
    "text": "were stuck in this large queue.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=885"
  },
  {
    "text": "To solve this queuing issue, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=890"
  },
  {
    "text": "Apple is working with the networking community ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=893"
  },
  {
    "text": "on a new technology called L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=896"
  },
  {
    "text": "It is available as a beta in iOS 16 and macOS Ventura. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=899"
  },
  {
    "text": "L4S reduces queuing delay significantly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=906"
  },
  {
    "text": "and also achieves zero congestion loss. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=910"
  },
  {
    "text": "To keep a consistently short queue, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=914"
  },
  {
    "text": "the network explicitly signals congestion ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=917"
  },
  {
    "text": "instead of dropping packets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=920"
  },
  {
    "text": "and the sender adjusts its sending rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=922"
  },
  {
    "text": "based on the congestion feedback from the network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=925"
  },
  {
    "text": "This makes it possible to keep very low queuing in the network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=929"
  },
  {
    "text": "without any packet loss, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=934"
  },
  {
    "text": "and that will make your app highly responsive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=937"
  },
  {
    "text": "Now, let's look at how L4S improved Screen Sharing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=941"
  },
  {
    "text": "Here, I used the same machines and the same network ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=948"
  },
  {
    "text": "except this time, I enabled L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=952"
  },
  {
    "text": "When I clicked on different Finder menus, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=957"
  },
  {
    "text": "they opened immediately. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=960"
  },
  {
    "text": "I launched the Time app on both the machines. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=962"
  },
  {
    "text": "And now, time on both the remote screen ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=966"
  },
  {
    "text": "and the local machine is almost perfectly in sync. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=969"
  },
  {
    "text": "This technology is not just for screen sharing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=976"
  },
  {
    "text": "L4S improves all of today's apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=981"
  },
  {
    "text": "and opens the door for future apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=985"
  },
  {
    "text": "that wouldn't even be possible today. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=988"
  },
  {
    "text": "This chart plots the observed average round trip time ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=991"
  },
  {
    "text": "of packets from the Screen Sharing app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=996"
  },
  {
    "text": "which was running concurrently with traffic ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=999"
  },
  {
    "text": "from other devices sharing the same network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1001"
  },
  {
    "text": "Comparing classic queuing versus L4S ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1006"
  },
  {
    "text": "shows that there is a massive reduction ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1009"
  },
  {
    "text": "in round trip time with L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1012"
  },
  {
    "text": "This is the primary reason for the dramatic improvement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1016"
  },
  {
    "text": "in my screen-sharing experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1020"
  },
  {
    "text": "Test your app that uses HTTP/3 or QUIC with L4S. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1025"
  },
  {
    "text": "You can enable L4S in iOS 16 inside Developer settings ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1031"
  },
  {
    "text": "or on macOS Ventura via a defaults write. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1036"
  },
  {
    "text": "To test using a Linux server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1042"
  },
  {
    "text": "your QUIC implementation needs to support accurate ECN ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1045"
  },
  {
    "text": "and a scalable congestion control algorithm. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1050"
  },
  {
    "text": "To ensure that you are ready ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1054"
  },
  {
    "text": "when L4S-capable networks are deployed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1056"
  },
  {
    "text": "test your app for compatibility with L4S, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1060"
  },
  {
    "text": "and provide feedback with any issues you might encounter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1064"
  },
  {
    "text": "Now you know that reducing latency is crucial ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1070"
  },
  {
    "text": "to improve your app's responsiveness. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1074"
  },
  {
    "text": "So, adopt HTTP/3 and QUIC, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1078"
  },
  {
    "text": "to reduce the number of round trips ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1082"
  },
  {
    "text": "and for faster delivery of content to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1084"
  },
  {
    "text": "Eliminate unnecessary queuing on your server ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1089"
  },
  {
    "text": "to provide a more responsive interaction. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1093"
  },
  {
    "text": "Test your app's compatibility with L4S by enabling it ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1097"
  },
  {
    "text": "in Developer settings and provide feedback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1101"
  },
  {
    "text": "And finally, talk to your server provider ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1105"
  },
  {
    "text": "about enabling L4S support. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1109"
  },
  {
    "text": "Thanks for watching! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1112"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10078/?time=1114"
  }
]