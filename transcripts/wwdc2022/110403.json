[
  {
    "text": "♪ Mellow instrumental hip-hop music ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=0"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=3"
  },
  {
    "text": "Hi! My name is Jared, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=9"
  },
  {
    "text": "and I'm a software engineer here at Apple.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=11"
  },
  {
    "text": "Today I'd like to talk you about a new framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=13"
  },
  {
    "text": "we are introducing this year to iOS, iPadOS, and macOS.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=15"
  },
  {
    "text": "This new framework is called Background Assets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=19"
  },
  {
    "text": "and we believe it will greatly enrich the user experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=21"
  },
  {
    "text": "of the apps that we all know and love, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=23"
  },
  {
    "text": "and more importantly, that you develop.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=25"
  },
  {
    "text": "To get started, I'll be introducing you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=27"
  },
  {
    "text": "to the new Background Assets framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=29"
  },
  {
    "text": "Afterwards, I'll show you how to adopt the new framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=32"
  },
  {
    "text": "into your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=34"
  },
  {
    "text": "This will be followed by a quick overview of the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=36"
  },
  {
    "text": "and what new capabilities it provides.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=38"
  },
  {
    "text": "Then we'll finish with some best practices ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=41"
  },
  {
    "text": "and everything we've learned.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=43"
  },
  {
    "text": "Before we begin, let's talk about ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=45"
  },
  {
    "text": "what we're trying to solve here.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=47"
  },
  {
    "text": "The truth is, waiting is not fun.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=48"
  },
  {
    "text": "Anytime we find ourselves asking those that use our software ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=50"
  },
  {
    "text": "to wait, we're increasing frustration and taking away ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=53"
  },
  {
    "text": "from the experience we want our apps to provide.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=55"
  },
  {
    "text": "For instance, how often have you found yourself ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=58"
  },
  {
    "text": "browsing endlessly through the App Store ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=60"
  },
  {
    "text": "looking for that perfect app? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=62"
  },
  {
    "text": "You finally find it, and oh does it look so perfect! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=63"
  },
  {
    "text": "You then tap that GET button.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=66"
  },
  {
    "text": "With every moment, your level of excitement increases.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=68"
  },
  {
    "text": "Then you shortly realize that depending ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=72"
  },
  {
    "text": "on your network connection or the size of the app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=73"
  },
  {
    "text": "you may find yourself having to wait as the app downloads.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=75"
  },
  {
    "text": "Then after a few seconds of waiting, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=79"
  },
  {
    "text": "you find yourself putting your phone down, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=80"
  },
  {
    "text": "grabbing a cup of coffee, reading your favorite book ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=82"
  },
  {
    "text": "about the benefits of practicing mindfulness ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=86"
  },
  {
    "text": "and mastering patience.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=88"
  },
  {
    "text": "Then a few hours pass, and you finally pick up your phone.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=91"
  },
  {
    "text": "Your excitement levels rise as you're ready to dive into ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=95"
  },
  {
    "text": "the perfect app that you've been waiting to use all day.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=97"
  },
  {
    "text": "Just to launch the app and be immediately greeted with this: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=101"
  },
  {
    "text": "more downloading.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=104"
  },
  {
    "text": "It's confusing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=105"
  },
  {
    "text": "You've been away from your phone all day.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=106"
  },
  {
    "text": "Why is this app now making you wait even longer? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=108"
  },
  {
    "text": "Couldn't this app have downloaded this content ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=111"
  },
  {
    "text": "automatically after the app was installed? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=112"
  },
  {
    "text": "For anyone on a slower internet connection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=115"
  },
  {
    "text": "this might frustrate them to close and remove the app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=117"
  },
  {
    "text": "The truth is, this is not the experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=120"
  },
  {
    "text": "any of us want to have.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=122"
  },
  {
    "text": "We know this isn't your fault, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=123"
  },
  {
    "text": "and we believe we can make this experience so much better! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=124"
  },
  {
    "text": "This is why we're proud to introduce to you this year, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=127"
  },
  {
    "text": "Background Assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=129"
  },
  {
    "text": "This framework was developed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=131"
  },
  {
    "text": "to help you enrich the user experience of your apps.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=132"
  },
  {
    "text": "So that the moment your app is launched, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=135"
  },
  {
    "text": "it is providing a phenomenal first impression! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=137"
  },
  {
    "text": "Background Assets is designed to be flexible ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=139"
  },
  {
    "text": "with your existing workflows.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=141"
  },
  {
    "text": "A lot of you have already developed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=143"
  },
  {
    "text": "complex asset management systems, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=144"
  },
  {
    "text": "and we wanted this new framework to easily fit into the solutions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=146"
  },
  {
    "text": "that you have already developed.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=149"
  },
  {
    "text": "We also know that you want to be able to push updated content ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=151"
  },
  {
    "text": "to your apps without having to require an additional submission ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=154"
  },
  {
    "text": "to the App Store.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=157"
  },
  {
    "text": "It's not uncommon for games or other apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=158"
  },
  {
    "text": "to need additional content after the app has already shipped.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=160"
  },
  {
    "text": "Think updated art textures or a bug fix in game-level data.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=163"
  },
  {
    "text": "Background Assets provides you with the ability to schedule ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=167"
  },
  {
    "text": "and update your assets outside of your app's lifecycle.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=169"
  },
  {
    "text": "We believe it's important that assets are present ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=172"
  },
  {
    "text": "before first app launch, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=174"
  },
  {
    "text": "or whenever the app is updated overnight.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=176"
  },
  {
    "text": "So we've worked to create a mechanism to help ensure ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=178"
  },
  {
    "text": "that your content is present by the time your app is launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=180"
  },
  {
    "text": "And finally, the easier a framework is to adopt, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=183"
  },
  {
    "text": "the more we can encourage you to use it in your apps.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=186"
  },
  {
    "text": "We want Background Assets to be used in any place ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=188"
  },
  {
    "text": "where large assets need to be predownloaded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=191"
  },
  {
    "text": "That way, we can minimize the time your app is waiting ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=193"
  },
  {
    "text": "and showing a progress bar before its content is available.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=196"
  },
  {
    "text": "So you may be wondering, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=200"
  },
  {
    "text": "how is this new framework helping you solve this problem? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=201"
  },
  {
    "text": "Well, in order to be as extensible as possible, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=203"
  },
  {
    "text": "we've created a new app extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=206"
  },
  {
    "text": "for downloading content in the background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=208"
  },
  {
    "text": "This new extension is built on top of the powerful ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=210"
  },
  {
    "text": "app extension technology that other extensions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=212"
  },
  {
    "text": "on our platforms use.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=214"
  },
  {
    "text": "This provides an opportunity to run code ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=216"
  },
  {
    "text": "outside of the app's lifecycle.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=218"
  },
  {
    "text": "For instance, the extension will run whenever the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=220"
  },
  {
    "text": "first installs your app but has yet to launch it.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=222"
  },
  {
    "text": "The extension will also run whenever the app is updated ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=225"
  },
  {
    "text": "automatically in the background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=227"
  },
  {
    "text": "This helps to ensure that your content can be scheduled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=229"
  },
  {
    "text": "and downloaded before the user opens the application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=231"
  },
  {
    "text": "after it has been updated.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=234"
  },
  {
    "text": "Finally, the extension will run periodically in the background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=236"
  },
  {
    "text": "allowing you to check for updated assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=239"
  },
  {
    "text": "and schedule them periodically over time.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=241"
  },
  {
    "text": "Though it is important to note, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=243"
  },
  {
    "text": "that extension runtime is short-lived, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=244"
  },
  {
    "text": "so all work will need to be scheduled by your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=246"
  },
  {
    "text": "with haste.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=249"
  },
  {
    "text": "If downloads are not scheduled quickly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=250"
  },
  {
    "text": "the system may terminate the extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=252"
  },
  {
    "text": "It's also important to be aware that the frequency ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=254"
  },
  {
    "text": "of the extension's ability to run periodically ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=256"
  },
  {
    "text": "will back off based on app usage.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=258"
  },
  {
    "text": "If your app isn't being used very much, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=260"
  },
  {
    "text": "then the extension will receive less frequent runtime.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=262"
  },
  {
    "text": "So that's an overview of the new Background Assets framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=265"
  },
  {
    "text": "It provides you with the tools you need to ensure that ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=267"
  },
  {
    "text": "your assets are available by the time your app is launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=269"
  },
  {
    "text": "This is done with an extension that runs ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=272"
  },
  {
    "text": "whenever your app is installed or updated, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=274"
  },
  {
    "text": "but before the user has launched your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=276"
  },
  {
    "text": "Now, let's take a look at adopting ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=278"
  },
  {
    "text": "the Background Assets framework into your project ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=279"
  },
  {
    "text": "and getting started! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=281"
  },
  {
    "text": "The download manager within the framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=283"
  },
  {
    "text": "is the primary vehicle used to communicate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=284"
  },
  {
    "text": "with the Background Assets system service.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=286"
  },
  {
    "text": "The manager is a singleton object ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=289"
  },
  {
    "text": "that can be used throughout your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=290"
  },
  {
    "text": "Using the manager, you can schedule the download ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=292"
  },
  {
    "text": "of your assets in either the foreground or background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=294"
  },
  {
    "text": "You can also retrieve downloads that are currently in flight, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=297"
  },
  {
    "text": "which might have started before your application ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=299"
  },
  {
    "text": "was ever launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=301"
  },
  {
    "text": "Downloads can also be canceled.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=303"
  },
  {
    "text": "This is useful if they were already scheduled ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=304"
  },
  {
    "text": "or are in the middle of being downloaded and you no longer ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=306"
  },
  {
    "text": "need that asset that you originally requested.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=308"
  },
  {
    "text": "We've also introduced a synchronization mechanism ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=310"
  },
  {
    "text": "for managing exclusive access ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=313"
  },
  {
    "text": "between your app and the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=314"
  },
  {
    "text": "so that both the extension and application do not end up ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=317"
  },
  {
    "text": "scheduling or modifying existing downloads at the same time.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=319"
  },
  {
    "text": "I have an example to show you, but for now, more on this later! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=324"
  },
  {
    "text": "Let's take a look at just how easy it is to start using ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=327"
  },
  {
    "text": "Background Assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=329"
  },
  {
    "text": "I'm going to begin by walking you through ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=331"
  },
  {
    "text": "some of the basics of the API.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=332"
  },
  {
    "text": "I'll then follow that up later by showing you how to tie ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=334"
  },
  {
    "text": "all of this together into an app extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=336"
  },
  {
    "text": "To get started, you'll import the Background Assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=339"
  },
  {
    "text": "framework module.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=341"
  },
  {
    "text": "Then, it's as easy as defining a URL that points ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=343"
  },
  {
    "text": "to the location of where your remote asset is located.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=345"
  },
  {
    "text": "We then follow that up by defining an app group container ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=348"
  },
  {
    "text": "that your extension and app are both members of.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=350"
  },
  {
    "text": "Having your app and extension in the same group ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=353"
  },
  {
    "text": "allows them to manage your assets during the download ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=355"
  },
  {
    "text": "and after completion.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=357"
  },
  {
    "text": "If you're not already familiar with app groups, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=359"
  },
  {
    "text": "you can easily add one from the Signing & Capability section ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=361"
  },
  {
    "text": "of Xcode 14.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=363"
  },
  {
    "text": "They're a powerful feature that allows two or more applications ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=365"
  },
  {
    "text": "to access the same resources, or in this case, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=368"
  },
  {
    "text": "your app and its extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=370"
  },
  {
    "text": "The next thing to do is create your download object.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=372"
  },
  {
    "text": "The Background Assets framework is designed to support ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=375"
  },
  {
    "text": "multiple different types of download objects.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=377"
  },
  {
    "text": "However, in this example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=379"
  },
  {
    "text": "we'll be focusing on the most common one: BAURLDownload.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=381"
  },
  {
    "text": "Immediately, you'll notice that the initializer takes in the URL ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=385"
  },
  {
    "text": "and the app group identifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=388"
  },
  {
    "text": "This information tells the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=390"
  },
  {
    "text": "both what we're downloading ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=392"
  },
  {
    "text": "and where the resulting file will end up.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=393"
  },
  {
    "text": "It also takes an identifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=395"
  },
  {
    "text": "You'll use this identifier to track your download ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=397"
  },
  {
    "text": "across multiple launches of your app, and within the extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=399"
  },
  {
    "text": "The engine will not allow more than one download ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=403"
  },
  {
    "text": "to be scheduled with the same identifier.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=406"
  },
  {
    "text": "Therefore, you should make these identifiers unique.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=408"
  },
  {
    "text": "Next, we'll grab a reference to the BADownloaderManager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=411"
  },
  {
    "text": "shared object.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=414"
  },
  {
    "text": "The download manager is your single interface ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=416"
  },
  {
    "text": "into Background Assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=417"
  },
  {
    "text": "It's what allows you to observe, cancel, and schedule downloads.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=419"
  },
  {
    "text": "We'll then pass it a weak reference to a delegate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=423"
  },
  {
    "text": "that conforms to the BADownloadManagerDelegate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=425"
  },
  {
    "text": "protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=427"
  },
  {
    "text": "I'll go more into this protocol shortly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=428"
  },
  {
    "text": "but the most important part to know now is that it receives ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=430"
  },
  {
    "text": "messages about downloads that have been scheduled.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=432"
  },
  {
    "text": "The only thing left to do is to ask the download manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=435"
  },
  {
    "text": "to schedule the download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=437"
  },
  {
    "text": "If for any reason the download cannot be scheduled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=439"
  },
  {
    "text": "then an error is thrown.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=441"
  },
  {
    "text": "In addition to scheduling downloads in the background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=442"
  },
  {
    "text": "we also provide API for doing foreground downloads.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=444"
  },
  {
    "text": "Running in the foreground ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=447"
  },
  {
    "text": "not only gives you increased priority, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=448"
  },
  {
    "text": "but it also enables your download to begin immediately.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=450"
  },
  {
    "text": "This is similar to using the default session configuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=454"
  },
  {
    "text": "within URLSession.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=456"
  },
  {
    "text": "We provide this API so that your app can promote ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=458"
  },
  {
    "text": "any downloads scheduled by your extension in the background ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=460"
  },
  {
    "text": "to the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=462"
  },
  {
    "text": "One thing to keep in mind: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=463"
  },
  {
    "text": "performing a foreground download is not available ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=465"
  },
  {
    "text": "from within the extension; ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=467"
  },
  {
    "text": "it can only be initiated from the app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=468"
  },
  {
    "text": "Since extensions never present UI, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=471"
  },
  {
    "text": "and the user doesn't notice that they are running, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=473"
  },
  {
    "text": "extensions may only schedule downloads in the background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=475"
  },
  {
    "text": "If your app would like to promote ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=478"
  },
  {
    "text": "existing background downloads to the foreground, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=479"
  },
  {
    "text": "this can easily be accomplished by fetching the list ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=481"
  },
  {
    "text": "of currently active downloads from the manager.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=483"
  },
  {
    "text": "The list that is returned contains all downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=486"
  },
  {
    "text": "the are currently scheduled, which may include downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=488"
  },
  {
    "text": "in flight or queued up in the scheduler.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=490"
  },
  {
    "text": "Next, your app can begin the promotion process ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=492"
  },
  {
    "text": "by calling startForegroundDownload.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=494"
  },
  {
    "text": "If a download is already in the foreground, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=497"
  },
  {
    "text": "calling this method will effectively do nothing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=499"
  },
  {
    "text": "However, if the download was backgrounded, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=502"
  },
  {
    "text": "it will first be paused, then resumed in the foreground ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=504"
  },
  {
    "text": "without requiring any content that was already downloaded ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=507"
  },
  {
    "text": "up until this point to be redownloaded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=509"
  },
  {
    "text": "Together, this provides an effective ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=511"
  },
  {
    "text": "and simple illustration for how easy it is ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=513"
  },
  {
    "text": "to use Background Assets to promote downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=515"
  },
  {
    "text": "scheduled in the background to the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=517"
  },
  {
    "text": "It really is as simple as that! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=519"
  },
  {
    "text": "The download manager is your primary interface that is used ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=521"
  },
  {
    "text": "to schedule and monitor background downloads.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=523"
  },
  {
    "text": "As these download objects are processed by the system, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=526"
  },
  {
    "text": "you'll receive messages in your delegate object.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=528"
  },
  {
    "text": "Let's walk through the delegate now.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=531"
  },
  {
    "text": "The delegate receives messages for all downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=532"
  },
  {
    "text": "that have been scheduled by either the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=534"
  },
  {
    "text": "or your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=536"
  },
  {
    "text": "If there are numerous downloads that were scheduled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=538"
  },
  {
    "text": "callbacks will be received for all of them.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=540"
  },
  {
    "text": "This is where you use the download object's ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=542"
  },
  {
    "text": "unique identifier to distinguish between them.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=544"
  },
  {
    "text": "Your app will begin to receive callbacks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=547"
  },
  {
    "text": "the moment the delegate is established ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=548"
  },
  {
    "text": "on BADownloadManager.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=550"
  },
  {
    "text": "Callbacks are not enqueued by the system.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=552"
  },
  {
    "text": "If your app does not handle one of the delegate methods ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=554"
  },
  {
    "text": "or your delegate is not established, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=556"
  },
  {
    "text": "then your extension will wake to process the message.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=558"
  },
  {
    "text": "This means that you should fully expect your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=561"
  },
  {
    "text": "to be sent messages if you have not established a delegate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=563"
  },
  {
    "text": "onto BADownloadManager within your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=566"
  },
  {
    "text": "If your app is currently in the foreground ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=569"
  },
  {
    "text": "being presented to the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=570"
  },
  {
    "text": "and its delegate has been established, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=572"
  },
  {
    "text": "then callbacks will be sent to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=573"
  },
  {
    "text": "and the extension will not be woken.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=575"
  },
  {
    "text": "The extension will only wake ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=577"
  },
  {
    "text": "if your app does not handle its delegate callback.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=578"
  },
  {
    "text": "If a download finishes, or fails, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=581"
  },
  {
    "text": "and the app does not process this message, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=583"
  },
  {
    "text": "then the extension will wake.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=585"
  },
  {
    "text": "Keep in mind, the extension is not woken ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=586"
  },
  {
    "text": "for all types of callbacks.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=589"
  },
  {
    "text": "Only callbacks that share common interfaces ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=590"
  },
  {
    "text": "between BADownloadManagerDelegate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=592"
  },
  {
    "text": "and the BADownloaderExtension protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=594"
  },
  {
    "text": "A download succeeding or failing is an example ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=597"
  },
  {
    "text": "of a common interface between the delegate and the protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=599"
  },
  {
    "text": "Although your app extension has its own entry points ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=602"
  },
  {
    "text": "that cause it to wake, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=604"
  },
  {
    "text": "if the extension is currently running, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=606"
  },
  {
    "text": "it can use BADownloadManager and establish a delegate.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=608"
  },
  {
    "text": "This will allow both the app and extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=611"
  },
  {
    "text": "to receive duplicate messages to their delegates.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=613"
  },
  {
    "text": "Keep in mind that extensions do not wake ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=616"
  },
  {
    "text": "to process delegate messages.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=617"
  },
  {
    "text": "They only wake at extension entry points defined in the ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=619"
  },
  {
    "text": "BADownloaderExtension protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=622"
  },
  {
    "text": "Let's take a look at the protocol ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=624"
  },
  {
    "text": "for the download manager's delegate.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=625"
  },
  {
    "text": "The first function is for receiving messages ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=627"
  },
  {
    "text": "whenever a download starts.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=629"
  },
  {
    "text": "This is useful for tracking when the device has finally chosen ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=631"
  },
  {
    "text": "to schedule a specific download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=633"
  },
  {
    "text": "You may also be notified if a download pauses.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=635"
  },
  {
    "text": "An example of a pause occurring would be ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=638"
  },
  {
    "text": "if the extension starts a download in the background ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=640"
  },
  {
    "text": "and then your app asks us to promote it to the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=642"
  },
  {
    "text": "During this promotion there will be a small window ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=645"
  },
  {
    "text": "where the download pauses before it is resumed.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=647"
  },
  {
    "text": "The download manager also allows you to monitor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=650"
  },
  {
    "text": "active progress of your download as it is being downloaded ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=652"
  },
  {
    "text": "in the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=655"
  },
  {
    "text": "We also provide a mechanism to answer a challenge request, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=656"
  },
  {
    "text": "which is useful for validating the authenticity of a connection ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=659"
  },
  {
    "text": "or for providing credentials to authorize a connection.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=662"
  },
  {
    "text": "The most important functions are for dealing with a failed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=664"
  },
  {
    "text": "or finished download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=666"
  },
  {
    "text": "If a download fails, you may need to reschedule it ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=668"
  },
  {
    "text": "or determine the cause.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=670"
  },
  {
    "text": "For a successful download, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=672"
  },
  {
    "text": "the system has placed the file in a location ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=673"
  },
  {
    "text": "that is managed by the operating system.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=675"
  },
  {
    "text": "If the device ends up low on space, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=677"
  },
  {
    "text": "then the system will delete the file for you.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=679"
  },
  {
    "text": "We strongly recommend that you leave the file at the location ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=681"
  },
  {
    "text": "that the system has provided.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=684"
  },
  {
    "text": "Only move the file if you absolutely must ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=686"
  },
  {
    "text": "and please do not duplicate it ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=688"
  },
  {
    "text": "unless you delete the originating file afterwards.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=690"
  },
  {
    "text": "As a reminder, the protocol for the download manager's delegate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=693"
  },
  {
    "text": "is for receiving messages related to downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=696"
  },
  {
    "text": "that your app or extension has scheduled.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=698"
  },
  {
    "text": "It is not the entry point for your extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=700"
  },
  {
    "text": "which brings us to our next topic.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=702"
  },
  {
    "text": "Now we'll be taking a look at the most exciting part ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=704"
  },
  {
    "text": "of Background Assets, the extension! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=707"
  },
  {
    "text": "The extension enables you to schedule the downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=709"
  },
  {
    "text": "of your assets before the user has launched your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=711"
  },
  {
    "text": "This enables you to ensure that your assets are in place ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=714"
  },
  {
    "text": "and ready to go in order to provide ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=716"
  },
  {
    "text": "the best possible experience in your app with minimal wait time.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=718"
  },
  {
    "text": "As discussed earlier, we're introducing a new app extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=721"
  },
  {
    "text": "This extension can be created from within Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=725"
  },
  {
    "text": "inside of your existing project.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=727"
  },
  {
    "text": "As a quick reminder, the extension runs ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=729"
  },
  {
    "text": "whenever your app is installed or updated.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=731"
  },
  {
    "text": "Giving you the flexibility to make sure changes to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=733"
  },
  {
    "text": "always has its latest assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=736"
  },
  {
    "text": "The extension also runs periodically ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=738"
  },
  {
    "text": "based on how often a user uses your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=740"
  },
  {
    "text": "If someone uses your app everyday, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=742"
  },
  {
    "text": "then the system learns this behavior ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=744"
  },
  {
    "text": "and your extension will run more frequently.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=745"
  },
  {
    "text": "However, if the app is never launched, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=748"
  },
  {
    "text": "then the frequency of this periodic check will subside.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=750"
  },
  {
    "text": "The new extension also has a short lifecycle ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=753"
  },
  {
    "text": "and a tight sandbox to ensure that its usage is limited ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=755"
  },
  {
    "text": "to just downloading assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=758"
  },
  {
    "text": "You are encouraged to make quick decisions in the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=760"
  },
  {
    "text": "and to limit the extension to the Background Assets framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=762"
  },
  {
    "text": "Before we start navigating through the extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=765"
  },
  {
    "text": "there are a couple of configurations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=767"
  },
  {
    "text": "that you need to make before the extension can launch.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=768"
  },
  {
    "text": "These changes are also a requirement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=771"
  },
  {
    "text": "for your app to be approved for distribution on the App Store.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=773"
  },
  {
    "text": "In your app's information property list, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=776"
  },
  {
    "text": "you'll need to define a couple of additional keys.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=778"
  },
  {
    "text": "These keys should not be placed in the extension's Info.plist, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=781"
  },
  {
    "text": "only the app's.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=783"
  },
  {
    "text": "The first key is BAInitialDownloadRestrictions.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=785"
  },
  {
    "text": "This is a dictionary where you will be specifying restrictions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=788"
  },
  {
    "text": "that will be placed upon your extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=790"
  },
  {
    "text": "These restrictions are reviewed by App Review, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=792"
  },
  {
    "text": "so try to be as accurate as possible.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=794"
  },
  {
    "text": "Now, let's dig into each individual key ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=797"
  },
  {
    "text": "inside the dictionary.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=799"
  },
  {
    "text": "The first restriction is the download allowance.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=801"
  },
  {
    "text": "This is represented in bytes and is the maximum download size ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=803"
  },
  {
    "text": "you're requesting to make within the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=806"
  },
  {
    "text": "during an initial app install.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=808"
  },
  {
    "text": "This size pertains to the sum of all files combined ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=810"
  },
  {
    "text": "that you are requesting to download, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=813"
  },
  {
    "text": "not the size of each individual file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=814"
  },
  {
    "text": "The next item is the domain AllowList, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=817"
  },
  {
    "text": "which takes an array of domains represented as strings.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=818"
  },
  {
    "text": "The domain AllowList supports prefix wildcards and takes in ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=821"
  },
  {
    "text": "a list of host names that your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=824"
  },
  {
    "text": "is permitted to download from.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=826"
  },
  {
    "text": "It's important to note ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=828"
  },
  {
    "text": "that the keys in the BAInitialDownloadRestrictions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=829"
  },
  {
    "text": "such as the DownloadAllowance and AllowList are only enforced ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=831"
  },
  {
    "text": "after first app install.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=835"
  },
  {
    "text": "Whenever your app is launched, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=837"
  },
  {
    "text": "these restrictions are no longer enforced.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=838"
  },
  {
    "text": "The last required key, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=841"
  },
  {
    "text": "which sits at the root of your Info.plist ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=842"
  },
  {
    "text": "is the maximum size that your app will require ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=844"
  },
  {
    "text": "in additional storage for these assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=846"
  },
  {
    "text": "We expect that you might want to download compressed assets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=849"
  },
  {
    "text": "so this value should be the final extracted ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=851"
  },
  {
    "text": "uncompressed size.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=853"
  },
  {
    "text": "The number that is placed here ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=855"
  },
  {
    "text": "will be presented on the App Store ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=857"
  },
  {
    "text": "before the app is downloaded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=858"
  },
  {
    "text": "Now that we've gone over some housekeeping, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=859"
  },
  {
    "text": "let's talk about the entry points into your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=861"
  },
  {
    "text": "in more detail.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=863"
  },
  {
    "text": "The functions that you define from the protocol ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=865"
  },
  {
    "text": "will be called by the system and not by your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=867"
  },
  {
    "text": "Unlike other app extensions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=870"
  },
  {
    "text": "where the application is responsible ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=872"
  },
  {
    "text": "for talking to the extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=873"
  },
  {
    "text": "the background download extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=875"
  },
  {
    "text": "is brokered by the system.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=876"
  },
  {
    "text": "Since the system is maintaining the lifecycle of the extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=879"
  },
  {
    "text": "it should be viewed as an ephemeral service.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=881"
  },
  {
    "text": "Whenever any of the functions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=883"
  },
  {
    "text": "inside of the protocol are invoked, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=884"
  },
  {
    "text": "it's important to keep the work that is done there ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=886"
  },
  {
    "text": "to a minimum.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=888"
  },
  {
    "text": "The extension will be terminated rather quickly ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=890"
  },
  {
    "text": "after it is launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=892"
  },
  {
    "text": "This is not the place to kick off decompression ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=893"
  },
  {
    "text": "or other complex operations that may take a while.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=895"
  },
  {
    "text": "One of the great parts of working in the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=898"
  },
  {
    "text": "is that all of the BackgroundAssets APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=901"
  },
  {
    "text": "available to your app are also available within the extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=903"
  },
  {
    "text": "With the only exception being the ForegroundDownload API.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=907"
  },
  {
    "text": "This means that you'll use BADownloadManager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=910"
  },
  {
    "text": "just like you would in your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=912"
  },
  {
    "text": "As a matter of fact, it's entirely likely ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=914"
  },
  {
    "text": "that you'll discover the ability to create something ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=916"
  },
  {
    "text": "that uses the same code to schedule and manage your assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=918"
  },
  {
    "text": "in both your app and its extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=921"
  },
  {
    "text": "Also, when creating your extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=925"
  },
  {
    "text": "it's important to ensure that both are in a common app group.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=927"
  },
  {
    "text": "You'll want to use the same group identifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=930"
  },
  {
    "text": "so that content can be read and written by your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=932"
  },
  {
    "text": "and its extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=934"
  },
  {
    "text": "Now let's take a look at the downloader extension protocol ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=936"
  },
  {
    "text": "that you will be conforming your extension to.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=938"
  },
  {
    "text": "The first thing you'll notice is how similar it looks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=941"
  },
  {
    "text": "to the download manager delegate protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=943"
  },
  {
    "text": "As I stated earlier, you can use BADownloadManager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=945"
  },
  {
    "text": "and construct a delegate from within the extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=949"
  },
  {
    "text": "However, only these entry points can actually wake the extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=951"
  },
  {
    "text": "The first function is invoked ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=955"
  },
  {
    "text": "whenever your application is first installed.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=956"
  },
  {
    "text": "The app hasn't launched yet, but your extension has.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=959"
  },
  {
    "text": "This is the perfect opportunity to start scheduling downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=962"
  },
  {
    "text": "that your app needs to provide the best experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=964"
  },
  {
    "text": "once your app has been launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=967"
  },
  {
    "text": "It's also important to recall that during initial app install, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=969"
  },
  {
    "text": "download restrictions are in effect.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=972"
  },
  {
    "text": "You'll want to consult the BADownloadRestrictions key ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=974"
  },
  {
    "text": "that you defined in your Info.plist ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=976"
  },
  {
    "text": "to know what your maximum permitted download size ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=978"
  },
  {
    "text": "and allowed domains are.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=981"
  },
  {
    "text": "This next function is invoked ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=982"
  },
  {
    "text": "whenever the App Store updates your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=983"
  },
  {
    "text": "As long as the user hasn't quit your app in the app switcher, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=985"
  },
  {
    "text": "your newly updated extension will wake ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=988"
  },
  {
    "text": "and you can begin scheduling work.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=990"
  },
  {
    "text": "The checkForUpdates function provides support ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=991"
  },
  {
    "text": "for your extension being periodically awoken ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=993"
  },
  {
    "text": "by the system, so that you can check for any updates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=995"
  },
  {
    "text": "that need to be background downloaded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=998"
  },
  {
    "text": "This function is invoked by the system based on ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1000"
  },
  {
    "text": "how often a user uses your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1002"
  },
  {
    "text": "We also have support for responding ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1004"
  },
  {
    "text": "to an authentication challenge request.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1006"
  },
  {
    "text": "So that you can better restrict and ensure ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1008"
  },
  {
    "text": "that the files you are downloading ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1009"
  },
  {
    "text": "have come from a trusted source.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1011"
  },
  {
    "text": "Finally, just like the delegate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1013"
  },
  {
    "text": "you'll be informed if the download failed or succeeded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1014"
  },
  {
    "text": "You'll notice that in the backgroundDownloadDidFail ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1017"
  },
  {
    "text": "function, there is no error returned.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1019"
  },
  {
    "text": "The error can be retrieved along with its state ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1022"
  },
  {
    "text": "in a variable inside of the returned BADownload object.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1024"
  },
  {
    "text": "It's also important to note that the last three functions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1027"
  },
  {
    "text": "can be invoked even if your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1029"
  },
  {
    "text": "isn't what scheduled the download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1031"
  },
  {
    "text": "If your app scheduled a download, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1033"
  },
  {
    "text": "but hasn’t become backgrounded, then the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1034"
  },
  {
    "text": "will be expected to service the download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1037"
  },
  {
    "text": "Now that we understand how to use BADownloaderManager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1039"
  },
  {
    "text": "from our app and its extension, we have to start thinking about ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1041"
  },
  {
    "text": "what it means if both the app and its extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1044"
  },
  {
    "text": "are running simultaneously.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1046"
  },
  {
    "text": "For instance, let's say the system has decided ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1048"
  },
  {
    "text": "that it's time to wake the extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1050"
  },
  {
    "text": "to have it periodically check for updates.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1051"
  },
  {
    "text": "And of course, since the extension needs to access ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1055"
  },
  {
    "text": "the network to do this check, it's going to use ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1057"
  },
  {
    "text": "BADownloaderManager to schedule the download of a catalog ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1059"
  },
  {
    "text": "or some other type of metadata that provides a list ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1062"
  },
  {
    "text": "of updated assets that are available.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1065"
  },
  {
    "text": "For instance, let's say the file is a small 100KB catalog ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1068"
  },
  {
    "text": "that contains a list of large multi-gigabyte assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1071"
  },
  {
    "text": "that we need to download.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1074"
  },
  {
    "text": "Since the extension needs to know ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1075"
  },
  {
    "text": "when the download it has scheduled finished, or failed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1076"
  },
  {
    "text": "it's going to attach a delegate onto the download manager.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1080"
  },
  {
    "text": "The download manager's delegate is used ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1083"
  },
  {
    "text": "over its extension entry points ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1084"
  },
  {
    "text": "since its downloading a small file to determine ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1086"
  },
  {
    "text": "what larger assets it will be scheduling, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1088"
  },
  {
    "text": "and extension entry points are not guaranteed ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1090"
  },
  {
    "text": "to be invoked immediately.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1092"
  },
  {
    "text": "After the download has finished, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1094"
  },
  {
    "text": "the extension receives this message through its delegate.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1095"
  },
  {
    "text": "Your extension now has access to the catalog file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1098"
  },
  {
    "text": "and has to make a choice ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1100"
  },
  {
    "text": "with what it plans to do with the downloaded file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1101"
  },
  {
    "text": "You could imagine that the extension will read the file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1103"
  },
  {
    "text": "to determine which of the assets in the catalog ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1105"
  },
  {
    "text": "need to be downloaded to the device.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1107"
  },
  {
    "text": "Then the extension could schedule background downloads ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1108"
  },
  {
    "text": "of those larger assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1111"
  },
  {
    "text": "Now that the downloaded file is no longer necessary, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1112"
  },
  {
    "text": "the extension should delete the file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1115"
  },
  {
    "text": "While this seems appropriate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1117"
  },
  {
    "text": "what happens if your app launches while your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1118"
  },
  {
    "text": "is running and creates its own BADownloadManager? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1120"
  },
  {
    "text": "Well, let's take a look! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1122"
  },
  {
    "text": "The app launches and immediately wants to know ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1124"
  },
  {
    "text": "if it has updated content.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1126"
  },
  {
    "text": "Perhaps a version number is stored in the app group ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1128"
  },
  {
    "text": "that both consult to determine if their assets are up to date.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1130"
  },
  {
    "text": "Since the app was launched before the newer catalog ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1134"
  },
  {
    "text": "finished downloading, it's going to fetch ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1136"
  },
  {
    "text": "the current downloads from the manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1138"
  },
  {
    "text": "and realize that a download of the catalog ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1139"
  },
  {
    "text": "is currently in flight and wait for it to be finished ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1141"
  },
  {
    "text": "in its delegate.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1144"
  },
  {
    "text": "But we have a problem.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1145"
  },
  {
    "text": "Both the extension and the app will receive ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1146"
  },
  {
    "text": "a download finished message in their respective delegates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1148"
  },
  {
    "text": "that were hooked into the download manager.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1151"
  },
  {
    "text": "This means we have a data race on the file being downloaded.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1153"
  },
  {
    "text": "Both the app and extension will try to read and delete the file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1156"
  },
  {
    "text": "at the same time; this is not good.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1160"
  },
  {
    "text": "This means that either your app or extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1161"
  },
  {
    "text": "could try to read the file and it might be missing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1163"
  },
  {
    "text": "This means that you will need think about your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1166"
  },
  {
    "text": "and extension in a similar way that you would think about ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1168"
  },
  {
    "text": "two threads within your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1171"
  },
  {
    "text": "Luckily, Background Assets provides a way to synchronize ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1173"
  },
  {
    "text": "between your app and its extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1176"
  },
  {
    "text": "Let's talk about that now! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1178"
  },
  {
    "text": "Synchronizing between your app and its extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1179"
  },
  {
    "text": "is extremely simple with Background Assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1181"
  },
  {
    "text": "What we're currently looking at is the download manager's ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1184"
  },
  {
    "text": "delegate function for when a download has completed.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1186"
  },
  {
    "text": "A URL is provided that contains a local path to the file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1189"
  },
  {
    "text": "that your app or extension has access to.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1192"
  },
  {
    "text": "In this example, we'll be ensuring mutual exclusion ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1195"
  },
  {
    "text": "of this file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1198"
  },
  {
    "text": "Next, we grab a reference to the download manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1199"
  },
  {
    "text": "and use the withExclusiveControl function, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1201"
  },
  {
    "text": "which takes a completion handler.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1203"
  },
  {
    "text": "All code that is executed within the completion handler scope ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1205"
  },
  {
    "text": "is guaranteed to be mutually exclusive with other calls ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1208"
  },
  {
    "text": "that require exclusive control.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1211"
  },
  {
    "text": "Meaning if your extension calls withExclusiveControl ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1213"
  },
  {
    "text": "while you app has not returned from its completion handler, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1216"
  },
  {
    "text": "then the extension will wait.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1219"
  },
  {
    "text": "This applies in the other direction as well.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1221"
  },
  {
    "text": "If the extension acquires exclusive control first, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1223"
  },
  {
    "text": "then the app will wait until the extension is terminated ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1225"
  },
  {
    "text": "or releases control by exiting scope.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1228"
  },
  {
    "text": "An important thing to keep in mind ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1230"
  },
  {
    "text": "is that acquiring exclusive control can fail.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1232"
  },
  {
    "text": "It is extremely unlikely that this will occur, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1235"
  },
  {
    "text": "but in the event it does, your code should handle it.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1237"
  },
  {
    "text": "You can detect if exclusive control could not be acquired ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1240"
  },
  {
    "text": "by checking if the error provided by the function ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1242"
  },
  {
    "text": "is not nil.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1244"
  },
  {
    "text": "From this point on, you are guaranteed that your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1245"
  },
  {
    "text": "or extension has exclusive access within its context.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1247"
  },
  {
    "text": "So based on our earlier example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1251"
  },
  {
    "text": "it is now perfectly valid to read the contents of the file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1253"
  },
  {
    "text": "and then clean it up, if you so choose.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1255"
  },
  {
    "text": "Just make sure to be aware that when your other app or extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1258"
  },
  {
    "text": "gets its opportunity to enter exclusive control ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1261"
  },
  {
    "text": "that it knows that you have already processed the file.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1264"
  },
  {
    "text": "One way this can be accomplished is by first checking ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1267"
  },
  {
    "text": "if the file exists or writing to a database or plist.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1269"
  },
  {
    "text": "As a reminder, the background downloader extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1272"
  },
  {
    "text": "is for collecting and scheduling the downloads of large assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1275"
  },
  {
    "text": "for your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1278"
  },
  {
    "text": "Its runtime is short lived, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1279"
  },
  {
    "text": "so please keep the work that is done ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1281"
  },
  {
    "text": "within the extension to a minimum.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1282"
  },
  {
    "text": "You should also place your extension and app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1284"
  },
  {
    "text": "within a shared app group so that both can access files ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1286"
  },
  {
    "text": "that are downloaded by one another.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1288"
  },
  {
    "text": "And finally, the extension is brokered by the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1290"
  },
  {
    "text": "and not your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1293"
  },
  {
    "text": "Now that you know how to develop ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1294"
  },
  {
    "text": "a basic background download extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1296"
  },
  {
    "text": "you have everything you need to start implementing ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1298"
  },
  {
    "text": "Background Assets into your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1299"
  },
  {
    "text": "Now, let's go over what we've learned.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1301"
  },
  {
    "text": "The download manager is used to coordinate and schedule ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1303"
  },
  {
    "text": "downloads between your app and its extension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1305"
  },
  {
    "text": "therefore you should be using the download manager ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1308"
  },
  {
    "text": "in both places.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1310"
  },
  {
    "text": "Your extension runs even if your app is not in the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1312"
  },
  {
    "text": "This can occur during app installation, update, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1315"
  },
  {
    "text": "or periodically at an interval determined by the system.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1318"
  },
  {
    "text": "If your app is launched ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1321"
  },
  {
    "text": "and content that was being downloaded in the background ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1322"
  },
  {
    "text": "is now be waited on, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1324"
  },
  {
    "text": "please immediately promote those downloads to the foreground.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1325"
  },
  {
    "text": "The extension can only schedule downloads in the background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1328"
  },
  {
    "text": "By having your app promote them to the foreground, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1331"
  },
  {
    "text": "ensures that your content will arrive as quickly as possible.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1334"
  },
  {
    "text": "If you ever find yourself needing exclusive access ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1337"
  },
  {
    "text": "to the download manager, please use the exclusive control APIs.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1339"
  },
  {
    "text": "This will ensure that only your app or extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1343"
  },
  {
    "text": "will have runtime within that window.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1345"
  },
  {
    "text": "This is extremely useful so that you don't have to think about ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1347"
  },
  {
    "text": "your extension racing your app when accessing its container ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1350"
  },
  {
    "text": "or managing downloads.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1353"
  },
  {
    "text": "If there is anything you should take from this presentation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1354"
  },
  {
    "text": "it's that waiting results in a poor app experience.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1357"
  },
  {
    "text": "Minimize waiting by making your app usable ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1359"
  },
  {
    "text": "while the task you are waiting on is underway.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1362"
  },
  {
    "text": "One of the ways you can minimize waiting in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1365"
  },
  {
    "text": "is to adopt the new Background Assets framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1367"
  },
  {
    "text": "along with the underlying background download extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1369"
  },
  {
    "text": "This helps to ensure that your app will have ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1371"
  },
  {
    "text": "all of its content ready before the app is launched.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1373"
  },
  {
    "text": "Make sure to also check out the documentation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1377"
  },
  {
    "text": "which includes extra information that may not have been ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1379"
  },
  {
    "text": "incorporated into this presentation; ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1381"
  },
  {
    "text": "including how to test your extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1383"
  },
  {
    "text": "and to simulate its entry points.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1385"
  },
  {
    "text": "We're really excited to get to share ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1388"
  },
  {
    "text": "Background Assets with you, and we value your feedback.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1390"
  },
  {
    "text": "Please use Feedback Assistant to let us know ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1392"
  },
  {
    "text": "what is working for you and what you'd like us improve.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1394"
  },
  {
    "text": "This is a new framework and we have the opportunity ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1397"
  },
  {
    "text": "to make adjustments during seeding.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1400"
  },
  {
    "text": "We have some additional sessions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1403"
  },
  {
    "text": "that we think you might find interesting ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1404"
  },
  {
    "text": "and we encourage you to check them out.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1406"
  },
  {
    "text": "\"Accelerating networking with HTTP3\" is a fantastic session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1408"
  },
  {
    "text": "that pairs well with Background Assets.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1411"
  },
  {
    "text": "Also, I encourage you to check out another session: ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1413"
  },
  {
    "text": "the \"Introducing on demand resources\" presentation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1417"
  },
  {
    "text": "covers an alternative to Background Assets ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1419"
  },
  {
    "text": "where your content is hosted by Apple ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1421"
  },
  {
    "text": "and files are downloaded at your request.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1424"
  },
  {
    "text": "Both of these sessions are really engaging ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1426"
  },
  {
    "text": "and have a lot to offer.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1428"
  },
  {
    "text": "Thank you for spending your time with me, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1429"
  },
  {
    "text": "and on behalf of everyone at Apple, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1431"
  },
  {
    "text": "we hope you have a fantastic WWDC! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1433"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110403/?time=1435"
  }
]