[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=0"
  },
  {
    "text": "Souvik Banerjee: Hi, and welcome ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=9"
  },
  {
    "text": "to \"Bring your driver to iPad with DriverKit.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=10"
  },
  {
    "text": "I'm Souvik, and today I'll discuss several exciting new developments in DriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=14"
  },
  {
    "text": "We're going to discuss three topics today. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=19"
  },
  {
    "text": "First, I'll give a brief overview of DriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=22"
  },
  {
    "text": "Then, I'll discuss some updates to AudioDriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=27"
  },
  {
    "text": "And I'll end with how to bring your drivers to the iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=32"
  },
  {
    "text": "Let's get started with an overview. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=37"
  },
  {
    "text": "In 2019, we introduced DriverKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=39"
  },
  {
    "text": "a replacement for IOKit device drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=42"
  },
  {
    "text": "DriverKit brought a new way to extend the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=45"
  },
  {
    "text": "that is more reliable and secure, running in userspace. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=48"
  },
  {
    "text": "And it's easier to develop since your process isn't in the kernel. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=53"
  },
  {
    "text": "These driver extensions, also known as dexts, are bundled in apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=58"
  },
  {
    "text": "and you can easily distribute your apps and drivers on the Mac App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=63"
  },
  {
    "text": "People can easily find your driver with a search, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=69"
  },
  {
    "text": "and if your driver is no longer needed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=72"
  },
  {
    "text": "you can just delete the app to uninstall it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=74"
  },
  {
    "text": "Since introducing DriverKit, we have added support for many new driver families.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=77"
  },
  {
    "text": "We now support Networking, Block Storage, Serial, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=83"
  },
  {
    "text": "Audio, and SCSI controller and peripheral drivers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=87"
  },
  {
    "text": "in addition to transports such as USB, PCI, and HID.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=91"
  },
  {
    "text": "To learn more about the kinds of drivers you can build with DriverKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=97"
  },
  {
    "text": "please check out the \"Create audio drivers with DriverKit\" session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=101"
  },
  {
    "text": "from WWDC 2021 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=105"
  },
  {
    "text": "and the \"Modernize PCI and SCSI drivers with DriverKit\" session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=107"
  },
  {
    "text": "from WWDC 2020. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=112"
  },
  {
    "text": "Next, we added several new features in AudioDriverKit recently ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=114"
  },
  {
    "text": "that I want to highlight. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=119"
  },
  {
    "text": "One of these features is real-time operations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=121"
  },
  {
    "text": "We're excited to introduce a new feature in AudioDriverKit ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=124"
  },
  {
    "text": "allowing you to register a real-time callback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=128"
  },
  {
    "text": "This callback gets invoked every time an IO operation happens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=131"
  },
  {
    "text": "You can use this callback if you need to modify your audio buffers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=136"
  },
  {
    "text": "on a real-time thread, such as for signal processing.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=140"
  },
  {
    "text": "To register a real-time callback in AudioDriverKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=145"
  },
  {
    "text": "we declare an IOOperationHandler block ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=149"
  },
  {
    "text": "to set on the IOUserAudioDevice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=152"
  },
  {
    "text": "This block will be called from a real-time context ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=156"
  },
  {
    "text": "when an IO operation occurs on the IOUserAudioStream buffers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=159"
  },
  {
    "text": "for the device.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=164"
  },
  {
    "text": "Inside the block, we check what the operation is, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=167"
  },
  {
    "text": "and we can modify the data as necessary. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=170"
  },
  {
    "text": "Finally, we call SetIOOperationHandler to set the block on the audio device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=173"
  },
  {
    "text": "Now let's talk about entitlements. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=179"
  },
  {
    "text": "When we introduced AudioDriverKit, you had to use ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=182"
  },
  {
    "text": "the allow-any-userclient-access entitlement on your driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=185"
  },
  {
    "text": "In macOS 12.1, we introduced a new entitlement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=191"
  },
  {
    "text": "specifically for AudioDriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=195"
  },
  {
    "text": "Please update your audio drivers to use the new audio family entitlement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=197"
  },
  {
    "text": "instead of the allow-any-userclient-access entitlement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=202"
  },
  {
    "text": "You can keep the allow-any-userclient-access entitlement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=207"
  },
  {
    "text": "if you want any app to be able to communicate with your driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=210"
  },
  {
    "text": "This new entitlement is public for development, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=215"
  },
  {
    "text": "so you can get started using this today without filing a request. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=218"
  },
  {
    "text": "In fact, all DriverKit family entitlements are now available to use for development. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=223"
  },
  {
    "text": "To request this entitlement for distribution, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=229"
  },
  {
    "text": "please visit the System Extension page on developer.apple.com. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=232"
  },
  {
    "text": "Now, I'm really excited to tell you about DriverKit on iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=237"
  },
  {
    "text": "Professionals are increasingly using iPad to do their best work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=242"
  },
  {
    "text": "But many rely on external hardware that they couldn't use on iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=246"
  },
  {
    "text": "So today, we're excited to announce that DriverKit is coming to iPad.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=251"
  },
  {
    "text": "DriverKit on macOS has made it possible to extend the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=257"
  },
  {
    "text": "in a safe and secure way, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=261"
  },
  {
    "text": "and we're bringing that same technology to the iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=263"
  },
  {
    "text": "In fact, if you've already created a driver with DriverKit on the Mac, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=266"
  },
  {
    "text": "you can bring that exact same driver to the iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=271"
  },
  {
    "text": "without any changes to your driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=275"
  },
  {
    "text": "USB, PCI, and Audio will be supported in iPadOS 16. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=279"
  },
  {
    "text": "This will enable Thunderbolt audio interfaces on iPad for the first time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=285"
  },
  {
    "text": "and many more devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=290"
  },
  {
    "text": "This is made possible with the power of the M1 chip. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=294"
  },
  {
    "text": "All iPads with M1 will support DriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=297"
  },
  {
    "text": "DriverKit on iPadOS is the same as on macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=300"
  },
  {
    "text": "This means that you can build one DriverKit driver ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=305"
  },
  {
    "text": "and have it work on both platforms, no source changes required. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=308"
  },
  {
    "text": "In addition , using the new multiplatform apps feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=313"
  },
  {
    "text": "in Xcode 14, you can easily create a single app target ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=317"
  },
  {
    "text": "to deliver your driver on both Mac and iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=321"
  },
  {
    "text": "For more information about multiplatform apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=325"
  },
  {
    "text": "please check out the \"Use Xcode to develop a multiplatform app\" session.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=328"
  },
  {
    "text": "Xcode also now supports automatic signing of DriverKit drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=334"
  },
  {
    "text": "It knows how to handle DriverKit on iPadOS ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=339"
  },
  {
    "text": "and can provision for both Mac and iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=342"
  },
  {
    "text": "You no longer need to configure manual signing for DriverKit drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=346"
  },
  {
    "text": "Your iPadOS app and driver can be distributed on the App Store , ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=351"
  },
  {
    "text": "just like on macOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=355"
  },
  {
    "text": "This means that you can take advantage of features like in-app purchases ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=357"
  },
  {
    "text": "and have your driver be easily discoverable by users. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=361"
  },
  {
    "text": "Let's see just how easy it is to take an existing macOS driver and app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=365"
  },
  {
    "text": "and bring it to iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=369"
  },
  {
    "text": "Here, I have an app called DriverKitSampleApp. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=372"
  },
  {
    "text": "It has a SwiftUI view with a label and a button ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=375"
  },
  {
    "text": "allowing the user to install the driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=379"
  },
  {
    "text": "Our driver is called NullDriver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=382"
  },
  {
    "text": "It prints a message when the driver starts ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=385"
  },
  {
    "text": "and starts a timer that fires every second ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=389"
  },
  {
    "text": "and increments a counter called timerCount. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=392"
  },
  {
    "text": "To make this an iPad app, all I need to do is select ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=396"
  },
  {
    "text": "the DriverKitSampleApp target in Xcode...",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=400"
  },
  {
    "text": "And add iPad to Supported Destinations.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=405"
  },
  {
    "text": "Now I can change my run destination to the iPad I have connected to my Mac.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=411"
  },
  {
    "text": "Let's try running this on the iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=419"
  },
  {
    "text": "Here's our iPad app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=422"
  },
  {
    "text": "We have the label and the button from the view we saw in Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=424"
  },
  {
    "text": "Tapping the Install Dext button takes us to Settings, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=429"
  },
  {
    "text": "where we see this new Drivers link. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=432"
  },
  {
    "text": "We tap that link, and we see a list of all drivers bundled in this app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=435"
  },
  {
    "text": "We can then enable our Null Driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=440"
  },
  {
    "text": "So you might have noticed several things in the demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=444"
  },
  {
    "text": "Our Null Driver is bundled inside our iPadOS app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=447"
  },
  {
    "text": "and it gets automatically discovered by the system after installation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=451"
  },
  {
    "text": "On macOS , you would need to use the SystemExtension framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=456"
  },
  {
    "text": "to prompt the user to install the driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=460"
  },
  {
    "text": "On iPadOS, there is no SystemExtensions framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=463"
  },
  {
    "text": "Inside Xcode, you can see ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=468"
  },
  {
    "text": "that our driver is embedded within our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=470"
  },
  {
    "text": "Since drivers are low-level software and are privileged, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=474"
  },
  {
    "text": "they need to be approved by the user before they can run. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=478"
  },
  {
    "text": "On macOS, users need to go to the Security & Privacy preferences ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=482"
  },
  {
    "text": "to allow system extensions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=487"
  },
  {
    "text": "On iPadOS, the driver approvals are in the Settings app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=490"
  },
  {
    "text": "There are two options for driver approvals. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=494"
  },
  {
    "text": "If there is at least one app with a driver installed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=497"
  },
  {
    "text": "there will be a menu inside General Settings ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=500"
  },
  {
    "text": "with a list of all available drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=502"
  },
  {
    "text": "Each driver can be toggled on or off. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=505"
  },
  {
    "text": "If your app contains a Settings bundle, there will be a Drivers link ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=509"
  },
  {
    "text": "inside your app's Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=514"
  },
  {
    "text": "Your app should prompt the user to enable the driver in Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=516"
  },
  {
    "text": "Let's start again with our macOS driver project ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=520"
  },
  {
    "text": "and see how we can have our app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=523"
  },
  {
    "text": "prompt the user to enable the driver in Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=525"
  },
  {
    "text": "We start by adding iPad to our supported destinations.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=528"
  },
  {
    "text": "Our SwiftUI view has a button to install the driver, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=535"
  },
  {
    "text": "and our view model has a state machine ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=540"
  },
  {
    "text": "that interacts with the SystemExtensions framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=543"
  },
  {
    "text": "Since this project is going to build for both Mac and iPad, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=547"
  },
  {
    "text": "we want to keep our Mac view and view model ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=551"
  },
  {
    "text": "but create a new view that will be used on iPad.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=554"
  },
  {
    "text": "Then, we can go to Build Phases and Compile sources ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=565"
  },
  {
    "text": "and change the platform filter for each file ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=569"
  },
  {
    "text": "to conditionally compile for iOS or macOS.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=572"
  },
  {
    "text": "Now, let's add a Settings bundle to our app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=589"
  },
  {
    "text": "We're going to use the default example Settings for now, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=592"
  },
  {
    "text": "but we can change these later to real Settings that the app can use.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=595"
  },
  {
    "text": "Now let's check the iOS view we just created. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=603"
  },
  {
    "text": "We can copy our macOS view to our iOS view ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=607"
  },
  {
    "text": "to use as a starting point.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=610"
  },
  {
    "text": "Our iOS view doesn't use a view model, so we can remove that.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=613"
  },
  {
    "text": "We also need to change our button action to open our Settings bundle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=620"
  },
  {
    "text": "This will take the user into Settings, so that they can enable the driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=624"
  },
  {
    "text": "Finally, we change the button text to make it clear ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=640"
  },
  {
    "text": "that the user needs to enable the driver in Settings.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=643"
  },
  {
    "text": "Let's see this in action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=652"
  },
  {
    "text": "We have the view we designed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=655"
  },
  {
    "text": "and tapping the button takes us to our Settings bundle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=657"
  },
  {
    "text": "Then we go into Drivers and enable the Null Driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=661"
  },
  {
    "text": "It's important to keep in mind that drivers launch on demand. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=666"
  },
  {
    "text": "Although we've enabled the driver in Settings, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=670"
  },
  {
    "text": "the driver only starts running ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=672"
  },
  {
    "text": "when the hardware device is plugged in to the iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=674"
  },
  {
    "text": "After the driver starts running, I can attach a debugger to it ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=677"
  },
  {
    "text": "using Xcode wireless debugging. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=681"
  },
  {
    "text": "To do that, I go to the Debug menu in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=683"
  },
  {
    "text": "attach to process, then select the NullDriver process. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=687"
  },
  {
    "text": "Once attached, I can set breakpoints or pause execution. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=691"
  },
  {
    "text": "Here, I've set a breakpoint in our timer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=696"
  },
  {
    "text": "I'm going to print timerCount to see how many times our timer has been called.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=699"
  },
  {
    "text": "When you're done debugging, detach from the driver process ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=706"
  },
  {
    "text": "using the Debug menu in Xcode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=710"
  },
  {
    "text": "So now we have a driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=714"
  },
  {
    "text": "But a driver isn't very useful by itself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=717"
  },
  {
    "text": "It needs to communicate with the rest of the system. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=720"
  },
  {
    "text": "Some DriverKit frameworks like AudioDriverKit handle this for you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=723"
  },
  {
    "text": "But if you need to do something more advanced, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=727"
  },
  {
    "text": "such as creating a custom control panel app for your hardware, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=730"
  },
  {
    "text": "you need to have your app be able to communicate with your driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=734"
  },
  {
    "text": "This is what user clients allow you to do. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=737"
  },
  {
    "text": "They allow you to define your own interface, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=741"
  },
  {
    "text": "allowing app and driver communication. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=743"
  },
  {
    "text": "Apps use the IOKit.framework to open user clients. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=747"
  },
  {
    "text": "For an example of how this works, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=750"
  },
  {
    "text": "please see the sample code on developer.apple.com.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=753"
  },
  {
    "text": "So we know that apps can communicate with drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=758"
  },
  {
    "text": "But it's important to keep security in mind. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=761"
  },
  {
    "text": "Since drivers are privileged, we don't want to allow every app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=763"
  },
  {
    "text": "to communicate with drivers.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=767"
  },
  {
    "text": "On macOS, the app needs the driverkit userclient-access entitlement, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=770"
  },
  {
    "text": "and the value is an array of allowed driver bundle identifiers.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=775"
  },
  {
    "text": "On iPadOS, we added a new entitlement called Communicates With Drivers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=781"
  },
  {
    "text": "It replaces the macOS user client entitlement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=787"
  },
  {
    "text": "This entitlement grants your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=791"
  },
  {
    "text": "the ability to open user clients to your driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=793"
  },
  {
    "text": "If you want to add the Communicates With Drivers entitlement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=798"
  },
  {
    "text": "manually to your app, here's the XML entitlement string.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=801"
  },
  {
    "text": "We can also add this entitlement from Xcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=807"
  },
  {
    "text": "In Xcode, we go to Signing and Capabilities, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=809"
  },
  {
    "text": "then add a new capability. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=813"
  },
  {
    "text": "Then, we can search for \"communicates with drivers\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=815"
  },
  {
    "text": "and add the capability to our app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=818"
  },
  {
    "text": "Another use case for user clients is to allow apps from other developers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=823"
  },
  {
    "text": "to interact with your driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=827"
  },
  {
    "text": "So in this case, suppose you have an app and driver ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=830"
  },
  {
    "text": "and you want to provide a service to other apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=833"
  },
  {
    "text": "including those from other developers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=836"
  },
  {
    "text": "DriverKit user clients also support this.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=839"
  },
  {
    "text": "Each app that needs to communicate with drivers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=843"
  },
  {
    "text": "needs the communicates with drivers entitlement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=846"
  },
  {
    "text": "The driver needs the Allow Third Party User Clients entitlement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=849"
  },
  {
    "text": "This allows apps built with a different team identifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=853"
  },
  {
    "text": "to open a user client to the driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=857"
  },
  {
    "text": "Without this entitlement, only apps from the same team ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=860"
  },
  {
    "text": "can communicate with the driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=863"
  },
  {
    "text": "If you want to add the Allow Third Party User Clients entitlement ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=865"
  },
  {
    "text": "manually to your driver, here's the XML entitlement string.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=869"
  },
  {
    "text": "Or we can add this capability from Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=874"
  },
  {
    "text": "by going into Signing and Capabilities for our driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=877"
  },
  {
    "text": "These new user client entitlements are public for development, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=882"
  },
  {
    "text": "which means that you can get started using this today without any approval. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=886"
  },
  {
    "text": "To request these entitlements for distribution, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=891"
  },
  {
    "text": "please see our developer website. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=893"
  },
  {
    "text": "DriverKit drivers also have important implications for app update. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=896"
  },
  {
    "text": "Automatic app update ensures users always get the latest version of your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=901"
  },
  {
    "text": "However, for apps containing drivers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=907"
  },
  {
    "text": "the update process works a little differently. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=909"
  },
  {
    "text": "Let's suppose you distribute version 1 of your app on the app store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=912"
  },
  {
    "text": "Then, you install that app along with its bundled driver on your iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=918"
  },
  {
    "text": "and enable the driver in Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=923"
  },
  {
    "text": "When you plug in the hardware device for your driver, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=926"
  },
  {
    "text": "the driver starts running, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=929"
  },
  {
    "text": "and once the driver starts running, your app can begin communicating ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=931"
  },
  {
    "text": "with your driver using user clients. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=935"
  },
  {
    "text": "Now, suppose you find a bug in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=938"
  },
  {
    "text": "and you submit version 2 to the App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=941"
  },
  {
    "text": "Because of automatic app update, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=944"
  },
  {
    "text": "the version 2 app is downloaded and installed on your iPad automatically. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=946"
  },
  {
    "text": "The driver approval state is maintained through updates, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=952"
  },
  {
    "text": "so you don't need to approve the driver again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=955"
  },
  {
    "text": "However, notice that the hardware is still plugged in, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=958"
  },
  {
    "text": "and our version 1 driver is still running. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=961"
  },
  {
    "text": "Driver version 2 was downloaded with the app update ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=965"
  },
  {
    "text": "but does not start running. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=968"
  },
  {
    "text": "Since the old driver still continues running, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=971"
  },
  {
    "text": "your version 2 app may have to communicate with the version 1 driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=974"
  },
  {
    "text": "When the hardware device is unplugged, the driver stops running, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=980"
  },
  {
    "text": "so now driver version 1 is done ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=984"
  },
  {
    "text": "and we can update the driver to version 2.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=987"
  },
  {
    "text": "Now, if you plug in the device again, we start the version 2 driver, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=991"
  },
  {
    "text": "and now your app is communicating with the new driver.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=996"
  },
  {
    "text": "To recap: Apps are updated anytime with automatic app update. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1001"
  },
  {
    "text": "Drivers are updated after the device is unplugged. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1007"
  },
  {
    "text": "And your app may communicate with an old driver. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1011"
  },
  {
    "text": "When your app and driver are ready, you can submit them to the App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1015"
  },
  {
    "text": "Your drivers can only run on devices that support DriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1021"
  },
  {
    "text": "If you want to restrict your app to those devices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1025"
  },
  {
    "text": "such as if your app only installs a driver, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1028"
  },
  {
    "text": "add DriverKit to your app's UIRequiredDeviceCapabilities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1031"
  },
  {
    "text": "This will prevent users from installing your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1036"
  },
  {
    "text": "on a device that does not support DriverKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1039"
  },
  {
    "text": "We also suggest submitting a video to App Review ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1042"
  },
  {
    "text": "showing how your app and driver work with your hardware device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1045"
  },
  {
    "text": "So that's DriverKit on iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1049"
  },
  {
    "text": "You can now bring USB, PCI, and Audio drivers to iPad with M1 ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1052"
  },
  {
    "text": "and deliver those drivers inside apps on the App Store. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1058"
  },
  {
    "text": "And if you already have a driver, it's easy to bring that to iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1062"
  },
  {
    "text": "We encourage developers to try using DriverKit on iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1066"
  },
  {
    "text": "and provide any feedback using Feedback Assistant. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1070"
  },
  {
    "text": "Thank you for watching.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-110373/?time=1073"
  }
]