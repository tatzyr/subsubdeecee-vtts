[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=0"
  },
  {
    "text": "Brady Eidson: Hello. My name is Brady Eidson. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=9"
  },
  {
    "text": "I'm an engineer on the WebKit Architecture team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=12"
  },
  {
    "text": "I am thrilled to introduce you to Web Push in Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=15"
  },
  {
    "text": "Web Push lets you remotely send notifications ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=19"
  },
  {
    "text": "to your web application's users. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=21"
  },
  {
    "text": "Here, a notification displays from webkit.org ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=24"
  },
  {
    "text": "in the upper-right of the screen. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=28"
  },
  {
    "text": "Clicking the notification opens a WebKit blog post in a new window. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=30"
  },
  {
    "text": "Before I get into other details on how this works, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=34"
  },
  {
    "text": "I want to answer a few questions up front I know many of you will have.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=38"
  },
  {
    "text": "Web Push is supported in Mac Safari beginning with macOS Ventura. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=43"
  },
  {
    "text": "And Web Push will be coming to iOS and iPadOS next year.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=47"
  },
  {
    "text": "Apple's Safari Push Notifications have been an option ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=53"
  },
  {
    "text": "for reaching Mac Safari users for quite a while. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=56"
  },
  {
    "text": "While it will continue to work, today I'm happy to announce ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=59"
  },
  {
    "text": "that we have added support for Web Push, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=62"
  },
  {
    "text": "and this really is Web Push! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=64"
  },
  {
    "text": "The same combination of various web standards ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=68"
  },
  {
    "text": "as implemented in other browsers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=71"
  },
  {
    "text": "We'll go over those standards more later, but… ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=73"
  },
  {
    "text": "the most important takeaway ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=76"
  },
  {
    "text": "is that if you've coded your application to web standards, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=78"
  },
  {
    "text": "you won't need to make any changes for it to work in Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=82"
  },
  {
    "text": "Of course, if you exclude Safari through browser detection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=85"
  },
  {
    "text": "then you have some work ahead of you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=88"
  },
  {
    "text": "Now would be a great time to switch from browser detection to feature detection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=90"
  },
  {
    "text": "which has always been the best practice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=95"
  },
  {
    "text": "We're using the same Apple Push Notification service ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=97"
  },
  {
    "text": "that powers native push on all Macs and iOS devices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=100"
  },
  {
    "text": "but no Apple Developer account is required to reach Safari users. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=104"
  },
  {
    "text": "We are using new end point URLs for Web Push, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=108"
  },
  {
    "text": "which brings up another thing you might be doing to unintentionally exclude Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=112"
  },
  {
    "text": "If you tightly manage push end points on your server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=117"
  },
  {
    "text": "make sure you allow URLs from any subdomain of push.apple.com. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=120"
  },
  {
    "text": "Moving beyond answers to those important questions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=125"
  },
  {
    "text": "let's get into more detail. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=128"
  },
  {
    "text": "First, we'll look at the Web Push experience in Safari ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=130"
  },
  {
    "text": "from a user's perspective. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=133"
  },
  {
    "text": "Then we'll cover the entire Web Push flow, from asking for permission ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=135"
  },
  {
    "text": "to handling a click on an entry in Notification Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=139"
  },
  {
    "text": "Finally, we'll see what it takes to add Web Push to an existing web app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=143"
  },
  {
    "text": "But first, the Mac Safari user experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=149"
  },
  {
    "text": "And I can think of no better way to cover that than with a demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=152"
  },
  {
    "text": "Here's Safari on macOS Ventura. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=156"
  },
  {
    "text": "I have webkit.org open in this browser tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=159"
  },
  {
    "text": "I need to keep up-to-date with the WebKit open source project, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=163"
  },
  {
    "text": "and Web Push is a great way to do that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=166"
  },
  {
    "text": "webkit.org is not allowed to request permission to push ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=169"
  },
  {
    "text": "without the user asking with a user gesture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=173"
  },
  {
    "text": "So I'll click this bell-shaped button here to subscribe for notifications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=176"
  },
  {
    "text": "What you see here is the system notifications prompt– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=181"
  },
  {
    "text": "the same one you'd see for any other application. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=184"
  },
  {
    "text": "In this case, it's on behalf of webkit.org. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=187"
  },
  {
    "text": "I will click \"allow,\" and I'm all set. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=191"
  },
  {
    "text": "webkit.org is giving me the option to be notified about new blog posts ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=195"
  },
  {
    "text": "as well as new commits to the source code repository. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=200"
  },
  {
    "text": "I know being notified for every commit will distract me from important work, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=203"
  },
  {
    "text": "but I absolutely want to be notified about new blog posts. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=207"
  },
  {
    "text": "So I'll check that box now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=211"
  },
  {
    "text": "Coincidentally, somebody must've just published the WebKit blog post ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=213"
  },
  {
    "text": "about Web Push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=217"
  },
  {
    "text": "This notification looks just like any other ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=219"
  },
  {
    "text": "and is attributed to webkit.org. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=221"
  },
  {
    "text": "I can click it to activate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=224"
  },
  {
    "text": "and there is the blog post, open in Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=227"
  },
  {
    "text": "Once a user has granted permissions to a website, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=230"
  },
  {
    "text": "they maintain control over that permission. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=233"
  },
  {
    "text": "As a macOS user, I'm used to managing Notification preferences ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=236"
  },
  {
    "text": "inside System Settings, and that's where I can go ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=239"
  },
  {
    "text": "to configure webkit.org's notifications. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=243"
  },
  {
    "text": "The same rich configuration as I'd find for any other app or service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=247"
  },
  {
    "text": "As a Safari user, I'm used to managing website settings ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=252"
  },
  {
    "text": "from inside Safari preferences. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=256"
  },
  {
    "text": "I can also go there to turn webkit.org's permissions on or off. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=258"
  },
  {
    "text": "And that's how Web Push works for users in Mac Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=264"
  },
  {
    "text": "Before we move on, I want to reiterate a few things covered in that demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=268"
  },
  {
    "text": "First, we don't want users to be spammed by subscription requests ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=272"
  },
  {
    "text": "they haven't asked for. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=276"
  },
  {
    "text": "So a website may only request a push subscription ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=278"
  },
  {
    "text": "in response to a mouse click or a keystroke. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=281"
  },
  {
    "text": "Once a website has permission to show notifications to the user, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=284"
  },
  {
    "text": "the user controls that permission. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=288"
  },
  {
    "text": "They can choose to manage it in Safari's preferences or System Settings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=290"
  },
  {
    "text": "And the setting will stay in sync if they happen to manage it in both. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=294"
  },
  {
    "text": "Finally, if you provide notifications for different types of events, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=298"
  },
  {
    "text": "it is a best practice to provide fine-grained controls ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=301"
  },
  {
    "text": "for notification types within your web app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=305"
  },
  {
    "text": "just like other apps do. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=307"
  },
  {
    "text": "Now that you've seen Web Push in action, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=309"
  },
  {
    "text": "let's dig in to what's happening at each step. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=311"
  },
  {
    "text": "Some of you are already intimately familiar with this. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=314"
  },
  {
    "text": "But for those of you new to Web Push, I'll go step by step, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=317"
  },
  {
    "text": "referring you to the relevant standards and documentation along the way. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=321"
  },
  {
    "text": "The first thing that happens is a user visits your website in a browser tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=325"
  },
  {
    "text": "Here's webkit.org open in Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=330"
  },
  {
    "text": "Since it is open in a tab, it can install a Service Worker. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=333"
  },
  {
    "text": "A Service Worker is a unit of JavaScript that operates ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=337"
  },
  {
    "text": "on behalf of an entire domain, separate from a currently open browser tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=340"
  },
  {
    "text": "Once the Service Worker script is installed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=345"
  },
  {
    "text": "your web app is eligible to request a push subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=348"
  },
  {
    "text": "As already mentioned, this request must be tied to a user gesture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=352"
  },
  {
    "text": "webkit.org requests permission when clicking this bell-shaped button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=356"
  },
  {
    "text": "which fulfills the user gesture requirement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=361"
  },
  {
    "text": "When your site asks for a push subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=364"
  },
  {
    "text": "the user sees this system prompt. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=367"
  },
  {
    "text": "Here is where they can make the final call ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=369"
  },
  {
    "text": "on granting your website this powerful ability.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=371"
  },
  {
    "text": "It is possible the user might deny the request. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=375"
  },
  {
    "text": "Your JavaScript should be prepared to handle that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=378"
  },
  {
    "text": "But assuming the user grants permission, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=381"
  },
  {
    "text": "your JavaScript gets back a PushSubscription object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=383"
  },
  {
    "text": "This includes everything your server needs to send a push message ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=386"
  },
  {
    "text": "to this user in this browser. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=390"
  },
  {
    "text": "Information like the exact URL end point to use. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=392"
  },
  {
    "text": "You send this PushSubscription payload back to your server ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=396"
  },
  {
    "text": "in whatever manner works best for your web app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=399"
  },
  {
    "text": "Many popular server packages have Web Push support to manage subscriptions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=402"
  },
  {
    "text": "or you can roll your own. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=407"
  },
  {
    "text": "The same pertains to how and when to actually send a push message ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=409"
  },
  {
    "text": "to the URL end points your server knows about. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=413"
  },
  {
    "text": "I can't tell you when to do so. That's up to you and your website. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=416"
  },
  {
    "text": "But once you've decided to send that push message, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=420"
  },
  {
    "text": "I can help with what happens next. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=423"
  },
  {
    "text": "Remember how push requires an installed Service Worker? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=425"
  },
  {
    "text": "Once your server has sent a push message and Safari receives it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=429"
  },
  {
    "text": "Safari wakes up your Service Worker and sends it a JavaScript push event. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=433"
  },
  {
    "text": "Showing a notification to the user in Notification Center ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=438"
  },
  {
    "text": "is a requirement while handling the push event. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=441"
  },
  {
    "text": "Receiving the push event and displaying the notification happens ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=445"
  },
  {
    "text": "if your website is currently open in a browser tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=449"
  },
  {
    "text": "It also happens if your website is not currently open in a browser tab. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=452"
  },
  {
    "text": "In the case of Safari on macOS Ventura, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=456"
  },
  {
    "text": "this happens even if Safari is not currently running. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=459"
  },
  {
    "text": "The final step: If your user clicks on that notification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=463"
  },
  {
    "text": "a notificationclick event is sent to your Service Worker ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=467"
  },
  {
    "text": "so it can respond appropriately. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=470"
  },
  {
    "text": "For example, by opening a new window ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=473"
  },
  {
    "text": "to the URL associated with that notification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=475"
  },
  {
    "text": "With that understanding of the Web Push flow under our belt, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=479"
  },
  {
    "text": "it's time to get into even more detail ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=483"
  },
  {
    "text": "by actually adding Web Push support to an existing web app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=485"
  },
  {
    "text": "Besides webkit.org, Browser Pets is the most ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=489"
  },
  {
    "text": "mission critical internal tool for the Safari and WebKit teams. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=493"
  },
  {
    "text": "Keeping everyone in the department up-to-date on their favorite WebKittens ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=497"
  },
  {
    "text": "and Pups on Safari has always been the mission statement of Browser Pets, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=500"
  },
  {
    "text": "and Web Push has made that easier than ever. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=504"
  },
  {
    "text": "Our internal BrowserPets domain already had a ServiceWorker script ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=507"
  },
  {
    "text": "registered to speed up page loads and synchronize between multiple tabs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=511"
  },
  {
    "text": "At a high level, a ServiceWorker script looks a lot like this. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=516"
  },
  {
    "text": "When an engineer visits the Browser Pets page in a tab, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=520"
  },
  {
    "text": "this JavaScript excerpt either determines if the Service Worker script ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=524"
  },
  {
    "text": "has already been registered, or registers it if necessary. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=527"
  },
  {
    "text": "Notice we're practicing feature detection here, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=531"
  },
  {
    "text": "previously mentioned as a best practice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=535"
  },
  {
    "text": "With the Service Worker prerequisite taken care of, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=537"
  },
  {
    "text": "we're ready to subscribe for push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=541"
  },
  {
    "text": "Remember, you cannot request a push subscription ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=543"
  },
  {
    "text": "without an explicit user gesture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=547"
  },
  {
    "text": "Running this script in response to a button's onclick handler ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=550"
  },
  {
    "text": "is one of many ways to satisfy that requirement. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=553"
  },
  {
    "text": "Once the user clicks that button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=556"
  },
  {
    "text": "here's code to request a push subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=558"
  },
  {
    "text": "I'll go into each of these points in more detail. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=562"
  },
  {
    "text": "First, we need to configure the request for a push subscription. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=564"
  },
  {
    "text": "An important bit for that is the public key our server uses ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=569"
  },
  {
    "text": "to identify themselves to Apple's push servers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=572"
  },
  {
    "text": "Here we use the standard technology called VAPID, the same as other browsers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=576"
  },
  {
    "text": "I won't go over the sometimes complex details of VAPID here, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=581"
  },
  {
    "text": "but there are resources on the web to help you ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=585"
  },
  {
    "text": "with the best solution for your server's setup. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=587"
  },
  {
    "text": "With the VAPID key set, we're ready to configure the subscription request. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=591"
  },
  {
    "text": "Notice we are explicitly stating ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=596"
  },
  {
    "text": "that we promise to always make pushes user visible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=599"
  },
  {
    "text": "While the standard for the JavaScript Push API ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=603"
  },
  {
    "text": "optionally accommodates silent JavaScript runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=606"
  },
  {
    "text": "in response to a push, most browsers do not support that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=609"
  },
  {
    "text": "Safari does not support that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=613"
  },
  {
    "text": "And like most websites, Browser Pets does not need that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=616"
  },
  {
    "text": "Then we request permission to push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=620"
  },
  {
    "text": "This line of JavaScript results in the permission prompt ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=623"
  },
  {
    "text": "for the user to either approve or reject. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=626"
  },
  {
    "text": "Assuming the user grants permission– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=630"
  },
  {
    "text": "which all Safari team members do for Browser Pets– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=632"
  },
  {
    "text": "this gives us a PushSubscription object ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=634"
  },
  {
    "text": "with the details on how to reach this user in their browser. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=637"
  },
  {
    "text": "Things like the URL end point and the key used to encrypt ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=640"
  },
  {
    "text": "the push message for transit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=644"
  },
  {
    "text": "Finally, we need to send all of those details to our server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=647"
  },
  {
    "text": "As mentioned before, the specifics of this will vary ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=651"
  },
  {
    "text": "based on your exact application. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=654"
  },
  {
    "text": "Our BrowserPets server uses WordPress, which already has ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=657"
  },
  {
    "text": "a few plugins to support standard Web Push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=660"
  },
  {
    "text": "It's likely you'll find the same is true for your backend, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=664"
  },
  {
    "text": "and there are resources on the web to help find the right solution ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=667"
  },
  {
    "text": "for just about any setup. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=670"
  },
  {
    "text": "Now we need to go back to our Service Worker JavaScript code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=672"
  },
  {
    "text": "It will need to handle a few new events, starting with the push event. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=676"
  },
  {
    "text": "When a push message makes its way from the Browser Pets server to this browser, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=680"
  },
  {
    "text": "this Service Worker has a push event sent to it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=685"
  },
  {
    "text": "That event contains a PushMessageData object ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=688"
  },
  {
    "text": "which has multiple ways of accessing the data sent by your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=692"
  },
  {
    "text": "We use the JSON accessor here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=695"
  },
  {
    "text": "Remember how when we subscribed for push, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=699"
  },
  {
    "text": "our JavaScript promised they would always be user visible? ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=701"
  },
  {
    "text": "That means we must always show a platform native notification ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=705"
  },
  {
    "text": "in response to each push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=708"
  },
  {
    "text": "It is best to do this as early as possible in your push event handler. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=710"
  },
  {
    "text": "We're pulling everything we need out of that JSON blob ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=715"
  },
  {
    "text": "to configure the notification, including setting up an action with a URL. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=717"
  },
  {
    "text": "That will come in handy in just a moment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=722"
  },
  {
    "text": "After the notification is shown, we need to handle the user clicking on it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=725"
  },
  {
    "text": "One more event for our Service Worker script to handle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=729"
  },
  {
    "text": "In this notificationclick handler, BrowserPets will take the URL ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=733"
  },
  {
    "text": "from the notification that was clicked to open a new window. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=738"
  },
  {
    "text": "Take note: This is a very common pattern. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=741"
  },
  {
    "text": "That's all the JavaScript we need to write to support Web Push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=744"
  },
  {
    "text": "Of course, it's best to have some help while developing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=748"
  },
  {
    "text": "As usual, that's where Web Inspector comes in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=751"
  },
  {
    "text": "In addition to helping debug your website open in a browser tab, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=755"
  },
  {
    "text": "Web Inspector can also inspect Service Worker instances ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=759"
  },
  {
    "text": "and set breakpoints on event handlers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=762"
  },
  {
    "text": "All of this together will let you inspect and debug the JavaScript ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=765"
  },
  {
    "text": "that subscribes for push as well as the service worker code ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=768"
  },
  {
    "text": "that handles the push event and notification events. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=772"
  },
  {
    "text": "Additionally, the Apple Push Notification servers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=775"
  },
  {
    "text": "will give you human readable errors if something goes wrong ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=779"
  },
  {
    "text": "when you attempt to publish a push message. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=781"
  },
  {
    "text": "Check out the links associated with this session for further documentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=784"
  },
  {
    "text": "I'd also like to get into more detail on a few points that came up ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=788"
  },
  {
    "text": "while writing that code, with direct regards ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=792"
  },
  {
    "text": "to user privacy and power usage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=794"
  },
  {
    "text": "Importantly–and this is not the first time I've said this– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=797"
  },
  {
    "text": "subscribing for push requires a user gesture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=800"
  },
  {
    "text": "As with other privileged features of the web platform, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=804"
  },
  {
    "text": "it's the right thing for user trust ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=808"
  },
  {
    "text": "to require that the user actually asked to enable Web Push. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=810"
  },
  {
    "text": "As mentioned when I showed you the code on how to request a push subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=814"
  },
  {
    "text": "you must promise that pushes will be user visible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=819"
  },
  {
    "text": "Handling a push event is not an invitation for your JavaScript ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=822"
  },
  {
    "text": "to get silent background runtime. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=826"
  },
  {
    "text": "Doing so would violate both a user's trust and a user's battery life. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=828"
  },
  {
    "text": "When handling a push event, you are in fact required ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=833"
  },
  {
    "text": "to post a notification to Notification Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=836"
  },
  {
    "text": "Other browsers all have countermeasures against violating the promise ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=839"
  },
  {
    "text": "to make pushes user visible, and so does Safari. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=843"
  },
  {
    "text": "In the beta build of macOS Ventura, after three push events ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=847"
  },
  {
    "text": "where you fail to post a notification in a timely manner, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=851"
  },
  {
    "text": "your site's push subscription will be revoked. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=854"
  },
  {
    "text": "You will need to go through the permission workflow again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=856"
  },
  {
    "text": "That's all. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=859"
  },
  {
    "text": "We're genuinely proud to support Web Push and excited that any site can use it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=861"
  },
  {
    "text": "no Apple Developer account required. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=866"
  },
  {
    "text": "As long as you've coded to the standards and use feature detection, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=869"
  },
  {
    "text": "so you don't unwittingly exclude Safari, your users will already get ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=873"
  },
  {
    "text": "the benefit of Web Push in Safari 16 on macOS Ventura. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=877"
  },
  {
    "text": "As usual, we've added tons of other new stuff to Safari and WebKit this year, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=881"
  },
  {
    "text": "and I hope you'll check out that session to learn more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=885"
  },
  {
    "text": "Thank you for watching. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=888"
  },
  {
    "text": "I hope you have a great rest of WWDC 2022.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10098/?time=890"
  }
]