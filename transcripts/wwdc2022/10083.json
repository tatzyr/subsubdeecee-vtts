[
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=0"
  },
  {
    "text": "Vaibhav Gautam: Hi, I am Vaibhav Gautam, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=9"
  },
  {
    "text": "and I am an engineer on the Software Power team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=11"
  },
  {
    "text": "Apps enrich people's lives, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=15"
  },
  {
    "text": "as they provide various critical functionalities throughout a day of use. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=17"
  },
  {
    "text": "But this use can come with a cost: battery drain. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=22"
  },
  {
    "text": "Therefore, it is important that you take special attention ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=26"
  },
  {
    "text": "to improve your app's battery life ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=30"
  },
  {
    "text": "so that your users can use their devices and your apps longer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=32"
  },
  {
    "text": "We deeply study different system components ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=37"
  },
  {
    "text": "to understand power consumption, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=39"
  },
  {
    "text": "and in this session, I will go over four key actions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=41"
  },
  {
    "text": "we have identified that you can take ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=45"
  },
  {
    "text": "to significantly improve your app's battery life. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=47"
  },
  {
    "text": "These are Dark Mode in your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=51"
  },
  {
    "text": "auditing frame rates, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=54"
  },
  {
    "text": "limiting background time,, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=56"
  },
  {
    "text": "and deferring work in your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=60"
  },
  {
    "text": "First, I'll talk about Dark Mode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=63"
  },
  {
    "text": "Dark Mode was introduced in iOS 13, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=66"
  },
  {
    "text": "and allows someone to configure their devices in a darker presentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=69"
  },
  {
    "text": "You may be familiar with the personalization benefits of Dark Mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=74"
  },
  {
    "text": "but it can also dramatically affect battery life.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=78"
  },
  {
    "text": "This is because on devices with OLED displays, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=84"
  },
  {
    "text": "like iPhone 13 and 13 Pro, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=87"
  },
  {
    "text": "darker content consumes less power than lighter content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=91"
  },
  {
    "text": "On an OLED screen each pixel requires individual power, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=95"
  },
  {
    "text": "and for darker colors less power is required to light up the pixels. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=100"
  },
  {
    "text": "Among all the components in the system, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=105"
  },
  {
    "text": "display is one of the major sources of power consumption. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=108"
  },
  {
    "text": "In fact, in typical use cases, the display can be the leading contributor ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=112"
  },
  {
    "text": "to battery drain. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=118"
  },
  {
    "text": "You have a way to influence the power consumption of the display. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=120"
  },
  {
    "text": "And one way is by adopting Dark Mode.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=124"
  },
  {
    "text": "I'll use the Food Truck app my team has been working on ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=128"
  },
  {
    "text": "as an example. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=132"
  },
  {
    "text": "This app has a very prominent background color ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=134"
  },
  {
    "text": "that takes up most of the screen. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=138"
  },
  {
    "text": "When presenting in Dark Mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=141"
  },
  {
    "text": "this background color becomes much darker than its Light Mode version, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=142"
  },
  {
    "text": "contributing heavily to battery savings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=147"
  },
  {
    "text": "In fact, for cases like this, we expect up ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=149"
  },
  {
    "text": "to a 70% display power savings as a result. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=154"
  },
  {
    "text": "This is a huge savings! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=158"
  },
  {
    "text": "And when screen brightness is high, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=161"
  },
  {
    "text": "the battery savings are even higher. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=163"
  },
  {
    "text": "For users who prefer Dark Mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=166"
  },
  {
    "text": "this is a tremendous opportunity to save them some battery drain ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=169"
  },
  {
    "text": "and it can reduce thermal load too.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=173"
  },
  {
    "text": "To adopt Dark Mode, start by reviewing how your app currently appears ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=176"
  },
  {
    "text": "when Dark Mode is enabled. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=181"
  },
  {
    "text": "Figure out what components of your app you should update ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=183"
  },
  {
    "text": "to fit in better with system UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=187"
  },
  {
    "text": "Xcode makes this easy by using the appearance feature when building your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=190"
  },
  {
    "text": "Your app may have hard coded colors because it only supports Light Mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=198"
  },
  {
    "text": "Use dynamic colors in Xcode to support background color, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=204"
  },
  {
    "text": "images, and text in Light and Dark Mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=208"
  },
  {
    "text": "The system will automatically use the correct color values, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=212"
  },
  {
    "text": "and will update when the mode changes.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=216"
  },
  {
    "text": "Your app should also support alternate images for Light Mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=220"
  },
  {
    "text": "and Dark Mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=224"
  },
  {
    "text": "To learn more about customizing your app for Dark Mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=226"
  },
  {
    "text": "check out \"Implementing Dark Mode on iOS\" from WWDC 2019.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=230"
  },
  {
    "text": "Now that you know how to adopt Dark Mode in your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=237"
  },
  {
    "text": "you should also think about how to adopt Dark Mode for your web content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=240"
  },
  {
    "text": "Safari does not auto-darken any web content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=246"
  },
  {
    "text": "so make sure you adopt Dark Mode for your web content too.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=249"
  },
  {
    "text": "To do so, implement the color-scheme property in your website's stylesheet.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=254"
  },
  {
    "text": "This enables the default text and background colors of the web page ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=260"
  },
  {
    "text": "to match the current system appearance, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=265"
  },
  {
    "text": "standard form controls, and scrollbars. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=267"
  },
  {
    "text": "Other named system colors change their look, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=271"
  },
  {
    "text": "switching between Light and Dark Mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=274"
  },
  {
    "text": "Start using stylesheet variables ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=278"
  },
  {
    "text": "wherever colors are referenced in your stylesheet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=280"
  },
  {
    "text": "This allows your web content to update its colors ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=284"
  },
  {
    "text": "as the device switches between Light and Dark. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=287"
  },
  {
    "text": "Apply the same logic to images and other media assets on your web pages, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=291"
  },
  {
    "text": "with different variants for different modes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=297"
  },
  {
    "text": "To learn more about implementing Dark Mode for web content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=300"
  },
  {
    "text": "refer to \"Supporting Dark Mode in Your Web Content\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=304"
  },
  {
    "text": "from WWDC 2019. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=307"
  },
  {
    "text": "Another way to reduce your app's power usage is to audit your frame rates. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=311"
  },
  {
    "text": "On devices with ProMotion displays, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=317"
  },
  {
    "text": "the refresh rate can affect power consumption. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=319"
  },
  {
    "text": "Higher refresh rates use higher power. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=323"
  },
  {
    "text": "The frame rates of animations in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=326"
  },
  {
    "text": "determine the display's refresh rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=329"
  },
  {
    "text": "Be considerate of the primary content in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=332"
  },
  {
    "text": "and what frame rate it requires, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=335"
  },
  {
    "text": "as not all content in your app may require a high frame rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=338"
  },
  {
    "text": "The display's refresh rate is determined by the animation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=342"
  },
  {
    "text": "with the highest frame rate in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=345"
  },
  {
    "text": "Your app may have secondary elements refreshing at a higher rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=348"
  },
  {
    "text": "than necessary, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=352"
  },
  {
    "text": "causing the app as a whole to consume more battery than expected.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=354"
  },
  {
    "text": "Here we have the food truck app again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=360"
  },
  {
    "text": "The primary truck scene at the top is rendering at 30 frames per second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=363"
  },
  {
    "text": "Below the truck, there is a text overlay \"Food Truck,\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=368"
  },
  {
    "text": "which is horizontally scrolling. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=372"
  },
  {
    "text": "This secondary text is rendering at 60 frames per second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=375"
  },
  {
    "text": "As a result, the whole screen is now rendering at 60 frames per second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=379"
  },
  {
    "text": "If we change the text animation to 30fps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=384"
  },
  {
    "text": "then the entire screen can render at 30fps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=387"
  },
  {
    "text": "and we could save up to 20% of the battery drain. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=390"
  },
  {
    "text": "Amazing! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=393"
  },
  {
    "text": "To debug and get more information about the frame rates in your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=396"
  },
  {
    "text": "use Instruments. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=400"
  },
  {
    "text": "Use the CoreAnimation FPS instrument ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=402"
  },
  {
    "text": "to see a timeline showing the frame rate of your app over time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=405"
  },
  {
    "text": "Start by auditing main user scenarios. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=411"
  },
  {
    "text": "To identify if frames are being rendered at the rate you expect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=414"
  },
  {
    "text": "determine if secondary elements on the screen ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=419"
  },
  {
    "text": "have a higher frame rate than your primary content.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=421"
  },
  {
    "text": "Your app may be using CADisplayLink offered by CoreAnimation on iOS ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=426"
  },
  {
    "text": "to drive custom animations and custom render loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=432"
  },
  {
    "text": "CADisplayLink is a timer synchronized with the display refresh rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=436"
  },
  {
    "text": "It provides necessary timing information to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=441"
  },
  {
    "text": "so that your custom drawing can be aware of refresh events. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=445"
  },
  {
    "text": "Your app can give hints to a CADisplayLink object ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=450"
  },
  {
    "text": "about the desired screen refresh rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=454"
  },
  {
    "text": "Set the preferredFrameRateRange of a CADisplayLink ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=457"
  },
  {
    "text": "and specify your minimum, maximum, and preferred frame rates.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=461"
  },
  {
    "text": "Display link will then choose the nearest available frame rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=467"
  },
  {
    "text": "to your preferred rate, based on what the system can handle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=471"
  },
  {
    "text": "If it cannot provide that rate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=475"
  },
  {
    "text": "it will try to stay within your specified range. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=478"
  },
  {
    "text": "To configure your display link, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=482"
  },
  {
    "text": "initialize it with a target and selector. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=484"
  },
  {
    "text": "The provided selector is used to perform custom animation ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=487"
  },
  {
    "text": "and calculate which video frame to display next. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=491"
  },
  {
    "text": "Once your display link is initialized, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=496"
  },
  {
    "text": "set the preferred frame rate range. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=498"
  },
  {
    "text": "In this example, the preferred rate is 30, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=500"
  },
  {
    "text": "but the range can handle anything between 10 and 60. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=504"
  },
  {
    "text": "Finally, add the display link to the current run loop.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=509"
  },
  {
    "text": "Keep refresh rates in mind when thinking about your app's battery consumption. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=514"
  },
  {
    "text": "This is especially important for devices with ProMotion displays ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=519"
  },
  {
    "text": "that support very dynamic refresh rates. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=523"
  },
  {
    "text": "Monitor your app's frame rates with Instruments ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=527"
  },
  {
    "text": "to discover issues before you release your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=530"
  },
  {
    "text": "Lastly, provide information to the system, using CADisplayLink ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=535"
  },
  {
    "text": "to limit refresh rate for your app's content.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=540"
  },
  {
    "text": "To learn more about frame rate optimizations, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=545"
  },
  {
    "text": "refer to \"Optimize for variable refresh rate displays\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=548"
  },
  {
    "text": "from WWDC 2021. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=551"
  },
  {
    "text": "Now, let's talk about how you can power down your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=555"
  },
  {
    "text": "when it's running in the background. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=559"
  },
  {
    "text": "When someone switches from your app to a different app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=561"
  },
  {
    "text": "your app may rely on background execution APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=565"
  },
  {
    "text": "to continue to run in the background. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=568"
  },
  {
    "text": "While running in the background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=571"
  },
  {
    "text": "your app may continue to use common services like location and audio. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=573"
  },
  {
    "text": "Running these services for long durations will cause battery drain, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=579"
  },
  {
    "text": "so when your app is using these services in background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=583"
  },
  {
    "text": "you need to be especially careful! ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=586"
  },
  {
    "text": "So let's talk about how to avoid excess drain when using these modes ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=589"
  },
  {
    "text": "Location services keep the device awake ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=596"
  },
  {
    "text": "to continuously stream location. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=598"
  },
  {
    "text": "Even though the app is invisible to the user, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=601"
  },
  {
    "text": "it could be continuously streaming location in the background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=604"
  },
  {
    "text": "and cause excess battery drain. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=607"
  },
  {
    "text": "It is important to make sure, that you are on top of background location session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=610"
  },
  {
    "text": "runtime in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=615"
  },
  {
    "text": "When you no longer need the session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=617"
  },
  {
    "text": "make sure your app calls stopUpdatingLocation() ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=619"
  },
  {
    "text": "to stop the session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=623"
  },
  {
    "text": "During different stages of app development, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=625"
  },
  {
    "text": "you can use different tools to find out background location usage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=628"
  },
  {
    "text": "which may not be expected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=631"
  },
  {
    "text": "While building and testing the app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=634"
  },
  {
    "text": "Xcode gauges can be used to find out system energy usage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=636"
  },
  {
    "text": "as well as background location usage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=640"
  },
  {
    "text": "When testing your app before release, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=643"
  },
  {
    "text": "you can use MetricKit to collect diagnostic information for a day of use. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=646"
  },
  {
    "text": "New in iOS 16 is the location usage in Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=651"
  },
  {
    "text": "Xcode gauges provide information about system usage ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=657"
  },
  {
    "text": "such as CPU, Network, and Location usage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=660"
  },
  {
    "text": "Xcode gauges will show a timeline of the location usage ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=665"
  },
  {
    "text": "and energy impact of your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=669"
  },
  {
    "text": "Looking at this timeline view can be a great way to verify ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=671"
  },
  {
    "text": "that your location runtime stops when you expect it to stop.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=675"
  },
  {
    "text": "Another tool is to use Metric Kit when testing your apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=680"
  },
  {
    "text": "Use the cumulativeBackgroundLocationTime property ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=684"
  },
  {
    "text": "to find out how long your app was actively using location services in background.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=688"
  },
  {
    "text": "New in iOS 16, users can monitor apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=694"
  },
  {
    "text": "which are currently using location services by navigating to Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=698"
  },
  {
    "text": "They can tap the text at the top ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=703"
  },
  {
    "text": "for a detailed view of apps using location. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=705"
  },
  {
    "text": "Use this to get an away-from-your-desk insight ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=709"
  },
  {
    "text": "into your location runtime. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=712"
  },
  {
    "text": "If you see your app here and you don't expect to, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=714"
  },
  {
    "text": "it is an indicator that your app has an active location streaming session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=717"
  },
  {
    "text": "We can apply the same principles to audio sessions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=723"
  },
  {
    "text": "Let's say we have a music app that is using the audio player ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=727"
  },
  {
    "text": "for playing back some file, and the user stops playback.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=731"
  },
  {
    "text": "The app should not only pause or stop the sound, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=735"
  },
  {
    "text": "but it should also pause or stop the Audio Engine ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=738"
  },
  {
    "text": "in order to prevent it from running idle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=742"
  },
  {
    "text": "We recommend using auto shutdown mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=746"
  },
  {
    "text": "which can be enabled by setting the autoShutdownEnabled property ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=748"
  },
  {
    "text": "of AVAudioEngine class. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=752"
  },
  {
    "text": "In this mode, the audio engine continuously monitors and detects ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=755"
  },
  {
    "text": "if it is idle for a certain duration. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=759"
  },
  {
    "text": "When idle, the engine will shut down the audio hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=762"
  },
  {
    "text": "And later on, if any of the sources become active again, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=767"
  },
  {
    "text": "it will start the audio hardware dynamically. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=771"
  },
  {
    "text": "And all of this happens under the hood. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=774"
  },
  {
    "text": "On watchOS auto shutdown mode is the enforced behavior. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=777"
  },
  {
    "text": "Make sure to stop the Audio Engine when not in use ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=782"
  },
  {
    "text": "in order to conserve power. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=785"
  },
  {
    "text": "The key to limiting background runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=787"
  },
  {
    "text": "is to remember to tell the system when you are done. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=789"
  },
  {
    "text": "The last action you can take to improve battery life is to defer work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=793"
  },
  {
    "text": "Over the course of the day, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=798"
  },
  {
    "text": "your app may process lots of different tasks and data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=800"
  },
  {
    "text": "Some of this work needs to occur immediately to service user actions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=804"
  },
  {
    "text": "like rendering content on the screen or playing audio ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=808"
  },
  {
    "text": "or a video the user taps on.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=812"
  },
  {
    "text": "Other work like machine learning tasks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=817"
  },
  {
    "text": "uploading analytics, or backups is not as time-sensitive. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=819"
  },
  {
    "text": "If we defer this time insensitive work to a better time– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=825"
  },
  {
    "text": "when the device is charging– ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=829"
  },
  {
    "text": "we can save battery ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=831"
  },
  {
    "text": "and avoid contending with the user initiated and interactive work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=832"
  },
  {
    "text": "Let's talk about three APIs you can use to accomplish this. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=836"
  },
  {
    "text": "BGProcessingTask is a good choice to defer tasks which run for long durations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=841"
  },
  {
    "text": "Discretionary URLSession is the perfect choice ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=847"
  },
  {
    "text": "to schedule deferrable networking. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=850"
  },
  {
    "text": "And leveraging the right push priority can help servers ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=853"
  },
  {
    "text": "deliver pushes at the right time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=856"
  },
  {
    "text": "Let's go into detail for each. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=859"
  },
  {
    "text": "First is BGProcessingTask. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=862"
  },
  {
    "text": "BGProcessingTask lets you defer long-running processing tasks ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=864"
  },
  {
    "text": "to a better time, such as when the device is charging. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=869"
  },
  {
    "text": "It's great for tasks like database cleanup, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=874"
  },
  {
    "text": "creating backups, and running machine learning training. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=877"
  },
  {
    "text": "To use it, you simply create a request by using BGProcessingTaskRequest API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=881"
  },
  {
    "text": "and provide an application identifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=887"
  },
  {
    "text": "Then provide more information, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=890"
  },
  {
    "text": "such as if your task needs external power or network. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=892"
  },
  {
    "text": "Providing more information will help the system schedule the task ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=897"
  },
  {
    "text": "at a better time window. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=901"
  },
  {
    "text": "The system will then launch your app in the background at an opportune time ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=903"
  },
  {
    "text": "and grant several minutes of runtime to complete the deferrable work. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=908"
  },
  {
    "text": "Next is discretionary URLSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=912"
  },
  {
    "text": "Your app may already be using Background URLSessions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=916"
  },
  {
    "text": "for general networking. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=920"
  },
  {
    "text": "Background URLSessions get even better when you use the discretionary flag. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=922"
  },
  {
    "text": "URLSessions with discretionary flag are networking transactions ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=928"
  },
  {
    "text": "offloaded to the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=932"
  },
  {
    "text": "to perform networking at a more optimal time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=935"
  },
  {
    "text": "such as when the device is plugged in and connected to Wi-Fi. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=938"
  },
  {
    "text": "The discretionary flag is great for non-user initiated ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=942"
  },
  {
    "text": "long-running networking, such as telemetry collection ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=946"
  },
  {
    "text": "or downloading the next episode of a TV show. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=950"
  },
  {
    "text": "And because the networking was offloaded, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=954"
  },
  {
    "text": "it means your app does not need to be running ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=957"
  },
  {
    "text": "while the network transaction completes.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=959"
  },
  {
    "text": "To use discretionary URL sessions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=963"
  },
  {
    "text": "you simply set up a background URL session ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=965"
  },
  {
    "text": "and set isDiscretionary to true. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=970"
  },
  {
    "text": "You can provide additional information ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=974"
  },
  {
    "text": "to help the system schedule the download at the right time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=976"
  },
  {
    "text": "Pass in timeout intervals so that the system does not attempt ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=980"
  },
  {
    "text": "to download forever, causing battery drain.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=984"
  },
  {
    "text": "If you don't want to upload or download data ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=988"
  },
  {
    "text": "until some point later in the future, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=991"
  },
  {
    "text": "pass in an earliest begin date. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=993"
  },
  {
    "text": "Finally, pass in an expected workload size ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=996"
  },
  {
    "text": "so that the system can intelligently load balance ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1000"
  },
  {
    "text": "between your various download tasks.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1003"
  },
  {
    "text": "Similar to how you can control the immediacy of certain operations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1008"
  },
  {
    "text": "with BGProcessingTask and discretionary URL sessions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1012"
  },
  {
    "text": "you can influence the immediacy of push delivery ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1017"
  },
  {
    "text": "by using different push priorities. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1020"
  },
  {
    "text": "Push priority determines how urgently a push needs to be delivered ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1023"
  },
  {
    "text": "to the device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1027"
  },
  {
    "text": "For a high priority push, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1028"
  },
  {
    "text": "the server will send the push immediately to the device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1030"
  },
  {
    "text": "potentially waking the device and causing battery drain. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1033"
  },
  {
    "text": "For low priority pushes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1038"
  },
  {
    "text": "the server will delay sending the push until an opportune time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1039"
  },
  {
    "text": "such as when the device is awake ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1044"
  },
  {
    "text": "or a high priority push comes through. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1046"
  },
  {
    "text": "High priority pushes are great for urgent messages like a severe weather warning. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1049"
  },
  {
    "text": "Low priority pushes are great for more passive notifications ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1054"
  },
  {
    "text": "that aren't urgent and can be deferred. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1059"
  },
  {
    "text": "Leveraging low priority push to delay the delivery of deferrable messages ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1062"
  },
  {
    "text": "will save battery as the device will not have to wake as frequently from sleep. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1066"
  },
  {
    "text": "To configure low priority pushes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1072"
  },
  {
    "text": "simply set apns-priority to 5 in the push payload. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1075"
  },
  {
    "text": "The server will take care of the rest, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1079"
  },
  {
    "text": "and your users will appreciate the battery life savings.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1081"
  },
  {
    "text": "So let's wrap it up with some final thoughts and next steps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1086"
  },
  {
    "text": "Provide an option of Dark Mode in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1090"
  },
  {
    "text": "If a user chooses Dark Mode, respecting their intent can save battery. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1093"
  },
  {
    "text": "Review your animations ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1098"
  },
  {
    "text": "and hunt for opportunities to reduce frame rates to what's necessary. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1100"
  },
  {
    "text": "One small animation can have a big impact. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1105"
  },
  {
    "text": "Keep a close eye on your background runtime ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1108"
  },
  {
    "text": "by letting the system know when you are done. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1111"
  },
  {
    "text": "Finally, consider deferring long-running background work ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1114"
  },
  {
    "text": "to a better time, such as when the device is connected to a charger. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1118"
  },
  {
    "text": "If you do all this, ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1122"
  },
  {
    "text": "then you will have truly powered down your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1124"
  },
  {
    "text": "Thank you so much.",
    "link": "https://developer.apple.com/videos/play/wwdc2022-10083/?time=1127"
  }
]