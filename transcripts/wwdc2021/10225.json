[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2"
  },
  {
    "text": "G'day. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=9"
  },
  {
    "text": "Welcome to the session, \"Coordinate media experiences ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=10"
  },
  {
    "text": "with Group Activities.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=12"
  },
  {
    "text": "My name is Hayden, and I'm an engineer ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=14"
  },
  {
    "text": "on the Group Activities team here at Apple. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=15"
  },
  {
    "text": "Today, we will talk about how to create synchronized media apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=18"
  },
  {
    "text": "that give users the ability to watch ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=21"
  },
  {
    "text": "and listen to content together across devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=23"
  },
  {
    "text": "The goal is for your users to feel ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=25"
  },
  {
    "text": "as if they were physically together, wherever they may be. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=27"
  },
  {
    "text": "The GroupActivities API is a Swift framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=30"
  },
  {
    "text": "for creating shared experiences. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=32"
  },
  {
    "text": "It takes care of coordinating media for you, via APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=35"
  },
  {
    "text": "for playback coordination and group session management. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=37"
  },
  {
    "text": "And it is supported across a wide range of Apple platforms, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=41"
  },
  {
    "text": "such as iOS, iPadOS, macOS, and tvOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=44"
  },
  {
    "text": "Let's start off with a demo of the GroupActivities API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=48"
  },
  {
    "text": "by calling my colleague, Moritz, and sharing a video ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=51"
  },
  {
    "text": "from the sample app attached to this talk. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=53"
  },
  {
    "text": "Let's see if Moritz is available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=56"
  },
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=58"
  },
  {
    "text": "Hi, Moritz! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=65"
  },
  {
    "text": "Hey, Hayden! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=66"
  },
  {
    "text": "I'm gonna home out and open the sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=68"
  },
  {
    "text": "You can see it's a list of drone footage from Apple Park. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=71"
  },
  {
    "text": "I'm gonna show the theater footage to Moritz. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=74"
  },
  {
    "text": "How does that look, Moritz? Do you wanna watch it? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=77"
  },
  {
    "text": "That looks great. I really love that one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=80"
  },
  {
    "text": "But did you see the new one I uploaded ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=83"
  },
  {
    "text": "last week from the rings? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=84"
  },
  {
    "text": "Oh, it looks great! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=86"
  },
  {
    "text": "I'm gonna start playback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=88"
  },
  {
    "text": "and our videos will be in sync across our devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=90"
  },
  {
    "text": "You can see if I pause, it'll also pause for Moritz. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=94"
  },
  {
    "text": "And if he moves ahead, it'll also move ahead for me.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=98"
  },
  {
    "text": "Looks awesome. OK, thanks, Moritz! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=104"
  },
  {
    "text": "Yeah, that was great. Bye, Hayden. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=109"
  },
  {
    "text": "There are three main pieces that you need ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=112"
  },
  {
    "text": "to think about when creating a coordinated media playback app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=113"
  },
  {
    "text": "First is implementing the new GroupActivities API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=117"
  },
  {
    "text": "Second is how you can take advantage of picture-in-picture ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=121"
  },
  {
    "text": "to make sharing your experiences as seamless as possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=123"
  },
  {
    "text": "And third, my colleague, Moritz, will do a deep dive ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=127"
  },
  {
    "text": "into how playback coordination works ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=130"
  },
  {
    "text": "and the features of the new playback coordination object. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=132"
  },
  {
    "text": "Let's familiarize ourselves with the GroupActivities API ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=135"
  },
  {
    "text": "by looking at the life cycle of a GroupActivities app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=138"
  },
  {
    "text": "Here, we have two iPhones in a FaceTime call, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=141"
  },
  {
    "text": "just like in the first demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=144"
  },
  {
    "text": "My device is on the left, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=145"
  },
  {
    "text": "and my colleague, Moritz's is on the right. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=147"
  },
  {
    "text": "On my device, I open the shared app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=150"
  },
  {
    "text": "In the app, I then share an activity to the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=153"
  },
  {
    "text": "The GroupActivities framework creates a session object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=156"
  },
  {
    "text": "for the activity, and then delivers it to my app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=159"
  },
  {
    "text": "Meanwhile, the session object is shared to Moritz, where ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=162"
  },
  {
    "text": "the framework handles opening the same app on his device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=165"
  },
  {
    "text": "Finally, the framework passes Moritz's app the GroupSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=169"
  },
  {
    "text": "Now, we have two apps able to communicate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=173"
  },
  {
    "text": "over the same GroupSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=175"
  },
  {
    "text": "Now, let's look at the steps you need ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=177"
  },
  {
    "text": "to take in order to adopt the GroupActivities framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=179"
  },
  {
    "text": "The first step is creating a GroupActivity ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=181"
  },
  {
    "text": "along with its metadata. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=183"
  },
  {
    "text": "So, let's talk about what a GroupActivity is ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=185"
  },
  {
    "text": "and how you define it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=187"
  },
  {
    "text": "GroupActivity is a Swift protocol that represents ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=189"
  },
  {
    "text": "the item that your users are experiencing together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=191"
  },
  {
    "text": "This will be a single piece of content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=194"
  },
  {
    "text": "like a movie or a song. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=196"
  },
  {
    "text": "You should include any properties on this type ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=198"
  },
  {
    "text": "that you need to set up your experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=200"
  },
  {
    "text": "For example, you may want to include the URL to a video here, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=202"
  },
  {
    "text": "so you can load a video in preparation for the session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=205"
  },
  {
    "text": "In order for the framework to send the data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=208"
  },
  {
    "text": "over the network, it conforms to Codable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=210"
  },
  {
    "text": "This means your properties must also conform to Codable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=212"
  },
  {
    "text": "You'll notice there are two required properties. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=216"
  },
  {
    "text": "ActivityIdentifier is a unique type identifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=218"
  },
  {
    "text": "so the system knows how to reference this activity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=221"
  },
  {
    "text": "GroupActivityMetadata contains information to show ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=224"
  },
  {
    "text": "this activity in system UI on the remote device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=226"
  },
  {
    "text": "You'll notice this is an example of the new async effectful ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=230"
  },
  {
    "text": "read-only properties feature that is being introduced ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=233"
  },
  {
    "text": "with Swift Concurrency this year. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=235"
  },
  {
    "text": "For more information see the session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=237"
  },
  {
    "text": "\"Meet async/await in Swift\" at WWDC this year. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=239"
  },
  {
    "text": "So, you've defined a GroupActivity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=244"
  },
  {
    "text": "Now, you wanna share it to the call ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=247"
  },
  {
    "text": "by calling the activate method on your GroupActivity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=248"
  },
  {
    "text": "When you activate a GroupActivity, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=251"
  },
  {
    "text": "the framework creates a GroupSession object, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=253"
  },
  {
    "text": "which is delivered to both the local and remote devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=256"
  },
  {
    "text": "The system is in charge of launching the app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=259"
  },
  {
    "text": "and system UI will show the activity metadata. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=261"
  },
  {
    "text": "But first, there's something we glossed over. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=264"
  },
  {
    "text": "How does your app know that you're in a FaceTime call? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=267"
  },
  {
    "text": "And what if, when a user selects a piece ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=269"
  },
  {
    "text": "of content, they don't mean to share it to the group, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=271"
  },
  {
    "text": "and instead just wanna view it locally? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=273"
  },
  {
    "text": "The PrepareForActivation function solves these problems ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=275"
  },
  {
    "text": "for you, by letting the system work out the user intent. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=277"
  },
  {
    "text": "Here's an example of the prepareForActivation API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=281"
  },
  {
    "text": "In the switch statement, there are three cases ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=284"
  },
  {
    "text": "we need to handle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=286"
  },
  {
    "text": "The first, activationDisabled, will be taken when the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=287"
  },
  {
    "text": "is not in a FaceTime call, or the system has decided ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=290"
  },
  {
    "text": "that they wish to consume it locally. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=293"
  },
  {
    "text": "The second, activationPreferred, will be taken ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=295"
  },
  {
    "text": "when the user is in a FaceTime call, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=298"
  },
  {
    "text": "and they wish to share it to the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=299"
  },
  {
    "text": "Canceled is taken when the user cancels the share action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=301"
  },
  {
    "text": "This is already enough knowledge to create a GroupActivities app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=304"
  },
  {
    "text": "that shares an activity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=307"
  },
  {
    "text": "So, let's jump over to Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=308"
  },
  {
    "text": "and I'll show you it in practice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=310"
  },
  {
    "text": "Before we add GroupActivities support, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=312"
  },
  {
    "text": "I'll give a quick run through of the project. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=314"
  },
  {
    "text": "It's a simple movie-watching app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=316"
  },
  {
    "text": "that lets you select a movie and watch it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=318"
  },
  {
    "text": "It consists of a list of movies to watch, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=321"
  },
  {
    "text": "along with a movie detail page to show you the video player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=323"
  },
  {
    "text": "Right now, the app only lets you watch ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=326"
  },
  {
    "text": "movies alone, so let's change that.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=329"
  },
  {
    "text": "You'll notice we have the Group Activity entitlement set. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=334"
  },
  {
    "text": "And then, we'll add a GroupActivity to Movie.swift. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=339"
  },
  {
    "text": "First thing to do is import GroupActivities.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=344"
  },
  {
    "text": "And then, we'll add the GroupActivity, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=352"
  },
  {
    "text": "MovieWatchingActivity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=355"
  },
  {
    "text": "You'll notice it has a movie property, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=359"
  },
  {
    "text": "and it uses that property to fill in the metadata. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=361"
  },
  {
    "text": "Let's share this activity now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=366"
  },
  {
    "text": "We'll go to the CoordinationManager ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=369"
  },
  {
    "text": "and find the prepareToPlay function. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=372"
  },
  {
    "text": "Currently, this function starts playback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=377"
  },
  {
    "text": "immediately by enqueueing the movie. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=379"
  },
  {
    "text": "Instead, we'll replace this ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=382"
  },
  {
    "text": "with our prepareForActivation function ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=384"
  },
  {
    "text": "that we showed in the slides.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=386"
  },
  {
    "text": "You can see we immediately enqueue the movie ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=392"
  },
  {
    "text": "in the activationDisabled case.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=395"
  },
  {
    "text": "And activate() is called when the user wants to share it ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=400"
  },
  {
    "text": "to their FaceTime call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=403"
  },
  {
    "text": "Later in the talk, we'll enqueue the movie to start playback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=407"
  },
  {
    "text": "but for now, let's see what happens if we run the app as-is. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=410"
  },
  {
    "text": "I've grabbed Moritz's device, and I've started a FaceTime call ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=414"
  },
  {
    "text": "between the two iPhones. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=418"
  },
  {
    "text": "I'll home out and then launch the sample app on my phone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=420"
  },
  {
    "text": "I'll share the rings video we watched earlier ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=425"
  },
  {
    "text": "and launch the app on Moritz's device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=428"
  },
  {
    "text": "You can see that it received the GroupActivity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=432"
  },
  {
    "text": "However, it didn't load the correct video, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=434"
  },
  {
    "text": "and there's no playback synchronization. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=437"
  },
  {
    "text": "So, let's learn how to add that into the app now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=440"
  },
  {
    "text": "The main thing to learn about receiving a Group Activity ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=444"
  },
  {
    "text": "is the GroupSession object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=447"
  },
  {
    "text": "and the way you receive a GroupSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=448"
  },
  {
    "text": "the GroupSessions async sequence. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=450"
  },
  {
    "text": "Here's a high-level diagram ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=453"
  },
  {
    "text": "showing the typical GroupSession life cycle. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=454"
  },
  {
    "text": "Both the local and remote devices receive a group session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=457"
  },
  {
    "text": "The app should then set up in preparation for playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=461"
  },
  {
    "text": "And finally, when ready, join the group session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=464"
  },
  {
    "text": "The GroupSession is the object that represents ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=467"
  },
  {
    "text": "the realtime session between devices of a group activity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=469"
  },
  {
    "text": "It provides state about the session, such ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=473"
  },
  {
    "text": "as the latest group activity, the connection state, and ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=475"
  },
  {
    "text": "the set of active participants connected to the session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=478"
  },
  {
    "text": "As we'll see in a moment, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=481"
  },
  {
    "text": "it's also used for synchronizing playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=482"
  },
  {
    "text": "The GroupSession AsyncSequence ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=484"
  },
  {
    "text": "delivers GroupSessions to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=486"
  },
  {
    "text": "Your app never instantiates a GroupSession object directly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=489"
  },
  {
    "text": "so this is the only way to receive GroupSessions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=493"
  },
  {
    "text": "It's important to note that you should ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=496"
  },
  {
    "text": "get the latest GroupSession from this sequence, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=498"
  },
  {
    "text": "on both the local and remote devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=500"
  },
  {
    "text": "AsyncSequence is covered in the Swift Concurrency talk ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=504"
  },
  {
    "text": "mentioned earlier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=507"
  },
  {
    "text": "Here's what awaiting on the GroupSessions ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=509"
  },
  {
    "text": "AsyncSequence looks like in code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=510"
  },
  {
    "text": "When a GroupActivity is activated, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=513"
  },
  {
    "text": "the system will return a GroupSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=515"
  },
  {
    "text": "from the AsyncSequence into your await loop. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=517"
  },
  {
    "text": "Now that we've received a GroupSession, let's learn ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=521"
  },
  {
    "text": "how to use it to set up playback synchronization. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=523"
  },
  {
    "text": "This latest release of AVFoundation ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=526"
  },
  {
    "text": "introduces a new type called AVPlaybackCoordinator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=528"
  },
  {
    "text": "Moritz will give more information on this object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=532"
  },
  {
    "text": "later in the talk, but for now, I'll show you how ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=534"
  },
  {
    "text": "to attach a GroupSession to the playback coordinator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=536"
  },
  {
    "text": "which will enable synchronized playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=538"
  },
  {
    "text": "The way to access the playback coordinator is ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=541"
  },
  {
    "text": "by the playbackCoordinator property on AVPlayer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=543"
  },
  {
    "text": "Then, to attach the groupSession to the coordinator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=546"
  },
  {
    "text": "we call coordinateWithSession and pass in the GroupSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=549"
  },
  {
    "text": "And that's it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=553"
  },
  {
    "text": "Under the hood, the framework handles all the intricacies ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=554"
  },
  {
    "text": "of playback coordination and realtime networking for you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=557"
  },
  {
    "text": "There's one final step to session management, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=560"
  },
  {
    "text": "and that's finally joining the session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=562"
  },
  {
    "text": "Initially, a GroupSession is not connected ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=564"
  },
  {
    "text": "and is instead in a \"waiting\" state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=567"
  },
  {
    "text": "Calling \"join()\" connects the GroupSession to the group ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=570"
  },
  {
    "text": "and begins the realtime connection, allowing messages ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=572"
  },
  {
    "text": "to be sent and received from other devices in the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=575"
  },
  {
    "text": "Once the GroupSession has successfully joined, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=578"
  },
  {
    "text": "playback synchronization will begin. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=580"
  },
  {
    "text": "Let's add this session management code ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=583"
  },
  {
    "text": "to our sample app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=585"
  },
  {
    "text": "In CoordinationManager, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=586"
  },
  {
    "text": "let's add the session's async sequence in an await loop.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=588"
  },
  {
    "text": "Remember, this gives your app GroupSessions when they've been ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=597"
  },
  {
    "text": "activated from either the local or remote devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=600"
  },
  {
    "text": "Let's store this groupSession on the CoordinatorManager, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=605"
  },
  {
    "text": "which will propagate the change ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=608"
  },
  {
    "text": "over to our MoviePlayerViewController.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=610"
  },
  {
    "text": "Once set, we'll attach the session object to our AVPlayer ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=619"
  },
  {
    "text": "via playbackCoordinator .coordinateWithSession.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=623"
  },
  {
    "text": "Then, back in our await loop, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=631"
  },
  {
    "text": "we'll get the movie from the session object.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=634"
  },
  {
    "text": "Since the activity can change throughout the session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=647"
  },
  {
    "text": "we use a Combine publisher to get the activity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=649"
  },
  {
    "text": "Then, we enqueue a movie to start playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=654"
  },
  {
    "text": "And finally, we join the session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=658"
  },
  {
    "text": "Now that we've set up the code to receive ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=661"
  },
  {
    "text": "a GroupSession and sync playback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=663"
  },
  {
    "text": "let's run the app on our devices and see what happens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=664"
  },
  {
    "text": "Again, the two devices are in a FaceTime call, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=670"
  },
  {
    "text": "and on the first device, I'll open the sample app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=672"
  },
  {
    "text": "and share the rings video.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=676"
  },
  {
    "text": "You can see Moritz's device received ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=682"
  },
  {
    "text": "the Group Activity, so we'll launch the app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=684"
  },
  {
    "text": "And this time, both devices show the right video.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=687"
  },
  {
    "text": "Then, if I press \"play,\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=693"
  },
  {
    "text": "we can see that playback synchronization works. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=695"
  },
  {
    "text": "And if I pause on one, it'll pause on the other.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=699"
  },
  {
    "text": "Or I can move ahead, and it'll move ahead on both.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=705"
  },
  {
    "text": "And playback is in perfect sync.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=711"
  },
  {
    "text": "One final thing to note about GroupSession is ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=721"
  },
  {
    "text": "how the session is finished. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=723"
  },
  {
    "text": "There are two ways to finish a GroupSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=725"
  },
  {
    "text": "The first is leave(). ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=728"
  },
  {
    "text": "This disconnects the local user from the session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=730"
  },
  {
    "text": "but leaves the session active ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=732"
  },
  {
    "text": "for the remaining participants in the call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=734"
  },
  {
    "text": "The second is end(). ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=736"
  },
  {
    "text": "This ends the session, not just ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=738"
  },
  {
    "text": "for the local participant, but for the entire call. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=739"
  },
  {
    "text": "For extra details on creating advanced GroupActivities apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=743"
  },
  {
    "text": "see the following WWDC session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=746"
  },
  {
    "text": "\"Build custom experiences with Group Activities.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=748"
  },
  {
    "text": "It covers how to change the activity of a GroupSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=751"
  },
  {
    "text": "observe state of a GroupSession, and how to use advanced ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=754"
  },
  {
    "text": "features, such as the GroupSessionMessenger, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=757"
  },
  {
    "text": "which lets you send arbitrary messages between the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=760"
  },
  {
    "text": "I highly recommend it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=762"
  },
  {
    "text": "Let's switch gears and look at how you can take advantage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=764"
  },
  {
    "text": "of picture-in-picture to make sharing a video GroupActivity ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=767"
  },
  {
    "text": "as seamless as possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=770"
  },
  {
    "text": "Why is picture-in-picture worth thinking about ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=772"
  },
  {
    "text": "for GroupActivities apps? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=774"
  },
  {
    "text": "Well, supporting picture-in-picture allows ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=776"
  },
  {
    "text": "content to start playing instantly after being shared. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=778"
  },
  {
    "text": "Since it doesn't take a user out of their current context, there ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=782"
  },
  {
    "text": "is no need for an explicit user interaction to start playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=785"
  },
  {
    "text": "This saves your users an extra step and results ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=789"
  },
  {
    "text": "in a frictionless experience to share content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=792"
  },
  {
    "text": "For more information on setting up picture-in-picture, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=795"
  },
  {
    "text": "see the 2019 WWDC session ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=797"
  },
  {
    "text": "on \"Delivering Intuitive Media Playback with AVKit.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=800"
  },
  {
    "text": "However, there are some nuances in how picture-in-picture works ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=803"
  },
  {
    "text": "with GroupActivitities, so let's go over them now. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=806"
  },
  {
    "text": "The GroupActivities framework will deliver sessions ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=809"
  },
  {
    "text": "to your media app while in background, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=812"
  },
  {
    "text": "to give your app a chance to set up picture-in-picture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=814"
  },
  {
    "text": "If the GroupSession indicates playback can start ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=817"
  },
  {
    "text": "in the background, you should set up ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=819"
  },
  {
    "text": "picture-in-picture, and then go through ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=821"
  },
  {
    "text": "the regular GroupActivities flow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=822"
  },
  {
    "text": "The system will start playing the content ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=825"
  },
  {
    "text": "in picture-in-picture without launching the app in fullscreen, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=827"
  },
  {
    "text": "so users get that seamless experience ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=830"
  },
  {
    "text": "and aren't taken out of their current context. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=832"
  },
  {
    "text": "But in some cases, you won't be able ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=835"
  },
  {
    "text": "to set up picture-in-picture because you may need the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=836"
  },
  {
    "text": "to sign in to your app, or the content might not ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=839"
  },
  {
    "text": "be available without some additional steps from the user. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=841"
  },
  {
    "text": "For these cases, GroupSession provides APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=844"
  },
  {
    "text": "for your app to request to be foregrounded. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=847"
  },
  {
    "text": "Another handy thing we've built into picture-in-picture ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=849"
  },
  {
    "text": "is that it handles leaving and ending a GroupSession for you, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=852"
  },
  {
    "text": "via a system dialog, so there's no need to worry about leaving ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=855"
  },
  {
    "text": "or ending a session when picture-in-picture is active. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=858"
  },
  {
    "text": "And now, I'll pass it over to my colleague, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=862"
  },
  {
    "text": "Moritz, to do a deep dive ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=863"
  },
  {
    "text": "on the playback coordinator object.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=865"
  },
  {
    "text": "Hello, my name is Moritz Wittenhagen, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=869"
  },
  {
    "text": "and I am an engineer on the AVFoundation team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=872"
  },
  {
    "text": "Hayden has introduced you to AVPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=874"
  },
  {
    "text": "as an object that automatically keeps playback on multiple ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=877"
  },
  {
    "text": "devices in sync, and we've seen it working in the demo. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=880"
  },
  {
    "text": "In this part of the talk, I am going to demystify ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=883"
  },
  {
    "text": "what the coordinator actually does under the hood ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=886"
  },
  {
    "text": "and how it interacts with your code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=888"
  },
  {
    "text": "For the most part, I will focus on how the coordinator interacts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=890"
  },
  {
    "text": "with AVPlayer, how you should select ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=894"
  },
  {
    "text": "your assets for coordinated playback, how individual ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=897"
  },
  {
    "text": "participants can suspend coordination temporarily, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=900"
  },
  {
    "text": "and I will also give you a brief insight into how ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=903"
  },
  {
    "text": "to implement coordination when not using AVPlayer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=907"
  },
  {
    "text": "AVPlaybackCoordinator is an object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=910"
  },
  {
    "text": "that shares playback state across devices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=912"
  },
  {
    "text": "and it coordinates playback start across those devices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=915"
  },
  {
    "text": "with the goal of no one missing any content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=918"
  },
  {
    "text": "There are two subclasses of the coordinator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=921"
  },
  {
    "text": "An instance of AVPlayerPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=924"
  },
  {
    "text": "is always tied to a particular AVPlayer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=926"
  },
  {
    "text": "and it handles all remote state management for you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=929"
  },
  {
    "text": "This makes it the easiest way to jump into coordinated ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=933"
  },
  {
    "text": "playback, and I highly recommend you start here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=935"
  },
  {
    "text": "We are not going to talk much ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=938"
  },
  {
    "text": "about AVDelegatingPlaybackCoordinator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=940"
  },
  {
    "text": "but this subclass gives you the flexibility to control ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=942"
  },
  {
    "text": "any other playback objects that aren't an AVPlayer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=945"
  },
  {
    "text": "Let's look at our device setup again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=949"
  },
  {
    "text": "For the rest of the talk, we are going to represent ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=951"
  },
  {
    "text": "the GroupActivities objects through the GroupSession. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=954"
  },
  {
    "text": "We also assume that your UI presents an AVPlayer playing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=957"
  },
  {
    "text": "some AVPlayerItem, and this is where the new ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=961"
  },
  {
    "text": "AVPlayerPlaybackCoordinator comes in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=964"
  },
  {
    "text": "When you call coordinator coordinateWithSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=967"
  },
  {
    "text": "as Hayden showed earlier, we have effectively connected ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=970"
  },
  {
    "text": "the two AVPlayers, and they start to affect each other. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=973"
  },
  {
    "text": "The basic rule is the coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=977"
  },
  {
    "text": "will intercept any transport control API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=979"
  },
  {
    "text": "so any API that changes rate or current time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=982"
  },
  {
    "text": "It takes those commands, figures out if it needs to coordinate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=985"
  },
  {
    "text": "them with someone else, and then, at the appropriate time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=989"
  },
  {
    "text": "lets them take effect on the AVPlayer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=993"
  },
  {
    "text": "Let's look at an example. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=996"
  },
  {
    "text": "Here, Hayden and I are in a GroupSession together, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=998"
  },
  {
    "text": "and because the GroupActivity told us which URL to load, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1001"
  },
  {
    "text": "have enqueued the same AVPlayerItem. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1005"
  },
  {
    "text": "Now, if my device changes the AVPlayer's rate property, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1007"
  },
  {
    "text": "the playback coordinator will intercept that command ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1011"
  },
  {
    "text": "and not immediately allow the player to start playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1014"
  },
  {
    "text": "Instead, it will ask the player ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1017"
  },
  {
    "text": "to enter a timeControlStatus of WaitingToPlayAtSpecifiedRate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1020"
  },
  {
    "text": "UIs will typically represent this timeControlStatus ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1025"
  },
  {
    "text": "with a waiting spinner. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1027"
  },
  {
    "text": "The coordinator will then send the command ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1029"
  },
  {
    "text": "over to Hayden's iPad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1031"
  },
  {
    "text": "The AVPlayerPlaybackCoordinator there receives the command ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1033"
  },
  {
    "text": "and similarly asks Hayden's AVPlayer ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1036"
  },
  {
    "text": "to change rate and enter a waiting state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1038"
  },
  {
    "text": "The coordinators give everyone some time to prepare ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1041"
  },
  {
    "text": "for playback with the goal of everyone starting playback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1044"
  },
  {
    "text": "at the same time without missing any content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1046"
  },
  {
    "text": "When everyone is good to go, all devices begin playback together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1049"
  },
  {
    "text": "All coordinators in the session are equal, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1054"
  },
  {
    "text": "meaning that Hayden can also initiate a command. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1056"
  },
  {
    "text": "Let's have him seek this time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1059"
  },
  {
    "text": "Again, the seek API is intercepted, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1061"
  },
  {
    "text": "and the coordinator forces the AVPlayer to wait ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1063"
  },
  {
    "text": "while it shares the command with connected coordinators. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1066"
  },
  {
    "text": "Everyone is given some time to complete the seek, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1070"
  },
  {
    "text": "and when all devices are ready to go again, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1072"
  },
  {
    "text": "playback resumes for everyone together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1075"
  },
  {
    "text": "You may ask yourself, what happens when the AVPlayers ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1078"
  },
  {
    "text": "are playing different items? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1081"
  },
  {
    "text": "And the answer is that the coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1083"
  },
  {
    "text": "only applies state to the other player ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1085"
  },
  {
    "text": "when both players are playing identical content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1087"
  },
  {
    "text": "I will elaborate on the concept of identity later. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1090"
  },
  {
    "text": "For now, think that content is identical ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1093"
  },
  {
    "text": "when you create the items from the same URL. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1096"
  },
  {
    "text": "What this means is that any command you send for item A will ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1098"
  },
  {
    "text": "only be applied if the receiver is also playing item A. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1103"
  },
  {
    "text": "And changing the item to B will ignore all state from item A. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1106"
  },
  {
    "text": "We do this because distinguishing commands ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1111"
  },
  {
    "text": "per-item allows for safe joining of participants ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1113"
  },
  {
    "text": "and transitions between items. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1116"
  },
  {
    "text": "Let me show you what I mean. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1118"
  },
  {
    "text": "Here's our example again, but this time, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1120"
  },
  {
    "text": "we start with Hayden already playing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1122"
  },
  {
    "text": "As I join and connect my playback coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1125"
  },
  {
    "text": "to the same session, nothing happens to my AVPlayer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1127"
  },
  {
    "text": "because I am not playing the same current item as Hayden. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1131"
  },
  {
    "text": "Even creating that same item has no impact ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1134"
  },
  {
    "text": "because the item is not current in my player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1137"
  },
  {
    "text": "This means that I can even seek the item ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1141"
  },
  {
    "text": "without consequences for anyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1144"
  },
  {
    "text": "Only when the item becomes current ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1146"
  },
  {
    "text": "in the AVPlayer will the coordinator start ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1148"
  },
  {
    "text": "doing its work and try to apply the right state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1151"
  },
  {
    "text": "The rule is that the coordinator always starts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1154"
  },
  {
    "text": "with the group state, if there is one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1156"
  },
  {
    "text": "And since Hayden was already playing in the GroupSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1159"
  },
  {
    "text": "the coordinator prefers his state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1162"
  },
  {
    "text": "over my own configuration from before enqeueuing the item. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1164"
  },
  {
    "text": "This means that my coordinator will override any configuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1168"
  },
  {
    "text": "in the AVPlayer and AVPlayerItem to match Hayden's device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1172"
  },
  {
    "text": "And with that, we are both in the same state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1176"
  },
  {
    "text": "and can play together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1179"
  },
  {
    "text": "Let's repeat this with an item transition. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1180"
  },
  {
    "text": "As we both approach the end of item A, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1183"
  },
  {
    "text": "my AVQueuePlayer is getting ready to play the next item. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1185"
  },
  {
    "text": "Usually, we would expect Hayden to get ready, as well, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1189"
  },
  {
    "text": "but for this example, let's assume Hayden's iPad ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1192"
  },
  {
    "text": "is in a bad network and cannot load the next item yet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1194"
  },
  {
    "text": "So, now that I'm at the end of item A, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1197"
  },
  {
    "text": "I already have item B enqueued, and it is ready to play. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1200"
  },
  {
    "text": "But because the item is not current, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1203"
  },
  {
    "text": "the coordinator is not doing anything yet. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1205"
  },
  {
    "text": "Only when my player transitions to the new item, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1208"
  },
  {
    "text": "will the coordinator do its job again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1210"
  },
  {
    "text": "And this time, it does not find an existing state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1213"
  },
  {
    "text": "for item B, so it just continues ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1215"
  },
  {
    "text": "with the state my player is proposing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1217"
  },
  {
    "text": "Even though the coordinator shares ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1220"
  },
  {
    "text": "this new state with Hayden, he is not affected ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1221"
  },
  {
    "text": "because he is still displaying item A. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1224"
  },
  {
    "text": "But when he eventually transitions to match my item, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1227"
  },
  {
    "text": "his coordinator will again apply the existing state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1230"
  },
  {
    "text": "to his player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1233"
  },
  {
    "text": "And with that, everyone is playing in sync again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1234"
  },
  {
    "text": "After all this, here is my first call-to-action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1238"
  },
  {
    "text": "Be careful about the order of your item changes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1241"
  },
  {
    "text": "and transport control commands. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1244"
  },
  {
    "text": "Let's say we have a function beginPlayback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1246"
  },
  {
    "text": "that enqueues an item and automatically starts playing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1249"
  },
  {
    "text": "This code would be called whenever the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1252"
  },
  {
    "text": "has selected something to play ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1254"
  },
  {
    "text": "or when our GroupSession informs us of a new activity. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1256"
  },
  {
    "text": "It is important that we seek to our start time first, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1259"
  },
  {
    "text": "and similarly, we should change player rate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1263"
  },
  {
    "text": "before the item is enqueued so that our initial ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1266"
  },
  {
    "text": "configuration cannot affect anyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1270"
  },
  {
    "text": "If we do it in this order, the playback coordinator can ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1273"
  },
  {
    "text": "decide if we are first and our state should be shared ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1276"
  },
  {
    "text": "with everyone else, or if another state already ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1279"
  },
  {
    "text": "exists, and that should override our state instead. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1282"
  },
  {
    "text": "Also, audit your transport control commands and consider ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1285"
  },
  {
    "text": "if they should affect everyone in the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1289"
  },
  {
    "text": "Usually, an API call should affect ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1292"
  },
  {
    "text": "the group if it originates from playback UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1295"
  },
  {
    "text": "So if the user pauses, everyone else should pause, too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1297"
  },
  {
    "text": "In that case, just call the AVPlayer API as usual. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1301"
  },
  {
    "text": "So, what should we do ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1305"
  },
  {
    "text": "with the other API calls not coming from playback UI? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1307"
  },
  {
    "text": "Usually, these are automated pauses ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1310"
  },
  {
    "text": "because your app has encountered some system event. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1312"
  },
  {
    "text": "Automatic pauses like this should ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1315"
  },
  {
    "text": "not usually affect the other participants. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1317"
  },
  {
    "text": "In such a situation, where your users are playing together ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1320"
  },
  {
    "text": "with others, you should first consider not pausing at all. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1322"
  },
  {
    "text": "Since everyone else continues to play, users will often prefer ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1326"
  },
  {
    "text": "to stick with the group, even if it has some kind of drawback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1330"
  },
  {
    "text": "like not being able to see the content temporarily. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1333"
  },
  {
    "text": "If you have no other choice but to pause, you have two options: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1337"
  },
  {
    "text": "remove the item first, or begin a coordinated playback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1340"
  },
  {
    "text": "suspension, which I will cover later in this talk. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1344"
  },
  {
    "text": "Now that you have an idea of how the playback coordinator works, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1347"
  },
  {
    "text": "let's talk about content for coordinated playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1350"
  },
  {
    "text": "As I stated previously, we consider two player items ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1353"
  },
  {
    "text": "on different devices to be the same ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1356"
  },
  {
    "text": "when their assets were created from the same URL. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1359"
  },
  {
    "text": "While this default can work well, there are situations ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1362"
  },
  {
    "text": "where you want to change this behavior. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1365"
  },
  {
    "text": "For example, your app may offer the user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1367"
  },
  {
    "text": "a choice to download and cache the content on device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1370"
  },
  {
    "text": "So, if I have downloaded the asset to my local cache, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1373"
  },
  {
    "text": "and Hayden is still streaming the content from the cloud, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1376"
  },
  {
    "text": "we are no longer using the same URL, meaning the playback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1379"
  },
  {
    "text": "coordinator will not keep our playback states in sync. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1382"
  },
  {
    "text": "Similarly, some of you may have exciting use cases ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1386"
  },
  {
    "text": "for coordinating the state of AVMutableMovies or ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1389"
  },
  {
    "text": "AVCompositions, which don't have a URL representation at all. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1392"
  },
  {
    "text": "Again, the playback coordinator does not know what to do here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1396"
  },
  {
    "text": "To solve this problem, you can provide a custom string ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1400"
  },
  {
    "text": "as an identifier for an AVPlayerItem. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1403"
  },
  {
    "text": "If this string is present, the coordinator will use it ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1406"
  },
  {
    "text": "to decide if two items represent the same content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1408"
  },
  {
    "text": "and it will ignore the URL. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1411"
  },
  {
    "text": "You do this by implementing the AVPlayerPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1413"
  },
  {
    "text": "Delegate protocol and its playbackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1416"
  },
  {
    "text": "identifierFor playerItem function. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1419"
  },
  {
    "text": "The coordinator will ask its delegate for an identifier ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1421"
  },
  {
    "text": "whenever you enqueue an item in the player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1425"
  },
  {
    "text": "Whenever the playback coordinator considers ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1427"
  },
  {
    "text": "two items equal, it is important that a time ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1430"
  },
  {
    "text": "on one device matches the same time on the others. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1433"
  },
  {
    "text": "This means that you need to be careful ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1436"
  },
  {
    "text": "with content that is automatically injected ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1439"
  },
  {
    "text": "into the playback stream by a server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1441"
  },
  {
    "text": "So, if Hayden and I request the same URL, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1443"
  },
  {
    "text": "but the server decides to inject an ad into only my stream, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1447"
  },
  {
    "text": "the devices are now out of sync, as I play into the ad, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1451"
  },
  {
    "text": "and Hayden continues with the main content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1454"
  },
  {
    "text": "The right way to approach this problem is to move ads ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1457"
  },
  {
    "text": "and other interstitials into a separate player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1460"
  },
  {
    "text": "That leaves the main asset unaffected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1463"
  },
  {
    "text": "Now, as I play into the ad, my phone switches ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1466"
  },
  {
    "text": "to a different player for the duration of the ad. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1470"
  },
  {
    "text": "And when the ad is over, the coordinator can easily ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1473"
  },
  {
    "text": "rejoin everyone else's timing, and we are back in sync. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1475"
  },
  {
    "text": "If you are playing HLS content, AVPlayer will be able to help ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1480"
  },
  {
    "text": "you with this through the new AVPlayerInterstitialEvent API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1484"
  },
  {
    "text": "Check out the dynamic pre-roll and mid-rolls ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1487"
  },
  {
    "text": "in HLS talk to learn more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1490"
  },
  {
    "text": "In summary, use custom identifiers to match ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1492"
  },
  {
    "text": "content if the URL does not cover the right information. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1495"
  },
  {
    "text": "Make sure times are the same for everyone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1499"
  },
  {
    "text": "And if you want to play personalized interstitials, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1502"
  },
  {
    "text": "play them through a different player, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1504"
  },
  {
    "text": "so that your main content is not affected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1506"
  },
  {
    "text": "And finally, use date tags when coordinating ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1509"
  },
  {
    "text": "live content so that the coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1512"
  },
  {
    "text": "can share the correct timing with everyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1514"
  },
  {
    "text": "So far, we have only dealt with the perfect playback cases, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1517"
  },
  {
    "text": "where everyone can stay in sync the whole time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1521"
  },
  {
    "text": "Unfortunately, that is not always possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1524"
  },
  {
    "text": "Let's say Hayden and I are playing together, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1527"
  },
  {
    "text": "but an alarm goes off telling me to feed my cat, Zorro. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1530"
  },
  {
    "text": "By the rules of AVAudioSession, my app must now pause, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1533"
  },
  {
    "text": "and those rules still apply, even when playing in a group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1537"
  },
  {
    "text": "Yet, we do not want my pause to affect everyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1542"
  },
  {
    "text": "Forwarding everyone's little pauses to the whole group ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1545"
  },
  {
    "text": "would just cause too many annoyances. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1548"
  },
  {
    "text": "So, instead, we want Hayden's iPad to continue playing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1550"
  },
  {
    "text": "And when I dismiss my alarm, playback should catch up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1555"
  },
  {
    "text": "and everyone should play in sync again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1559"
  },
  {
    "text": "So, how can we implement behavior like this? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1562"
  },
  {
    "text": "You use a new object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1565"
  },
  {
    "text": "called an AVCoordinatedPlaybackSuspension. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1567"
  },
  {
    "text": "Such a suspension represents a separation ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1570"
  },
  {
    "text": "between one participant's coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1573"
  },
  {
    "text": "and the other participants' coordinators. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1575"
  },
  {
    "text": "The participant is separate from the group, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1577"
  },
  {
    "text": "and player rate changes or seeks no longer affect anyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1579"
  },
  {
    "text": "Similarly, any rate change coming ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1584"
  },
  {
    "text": "from the group will not change the AVPlayer's rate or time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1586"
  },
  {
    "text": "In the example, this means that it ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1590"
  },
  {
    "text": "is not possible for Hayden to start ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1593"
  },
  {
    "text": "my player while the alarm is still playing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1594"
  },
  {
    "text": "There are two different kinds of suspensions: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1598"
  },
  {
    "text": "automatic suspensions and suspensions you add yourself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1600"
  },
  {
    "text": "Automatic suspensions are added by AVPlayerPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1604"
  },
  {
    "text": "when the player pauses automatically. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1608"
  },
  {
    "text": "We already saw the example of the audio ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1610"
  },
  {
    "text": "session interruption, but this also applies ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1612"
  },
  {
    "text": "to network stalls or playing an interstitial ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1614"
  },
  {
    "text": "through the new AVPlayer interstitial API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1617"
  },
  {
    "text": "Suspensions added by the playback coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1619"
  },
  {
    "text": "end when the player resumes playback, and it causes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1622"
  },
  {
    "text": "the player to match timing to the current group state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1625"
  },
  {
    "text": "For our example, this means that I will ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1629"
  },
  {
    "text": "automatically rejoin the group when my player rate changes back ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1631"
  },
  {
    "text": "to one after my app handled the end-interruption ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1634"
  },
  {
    "text": "notification from dismissing the alarm. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1637"
  },
  {
    "text": "Let me show you two examples of how the system uses ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1640"
  },
  {
    "text": "coordinated playback suspensions.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1643"
  },
  {
    "text": "Here is our sample app playing drone footage of the rings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1653"
  },
  {
    "text": "Let's look at the interruption example we discussed before. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1656"
  },
  {
    "text": "I have set a timer to go off in a few seconds, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1659"
  },
  {
    "text": "so let's wait for that.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1662"
  },
  {
    "text": "Ah, here we go. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1666"
  },
  {
    "text": "This has paused the iPad on my left, but as you can see, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1668"
  },
  {
    "text": "the other device is still happily playing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1672"
  },
  {
    "text": "And as I dismiss the timer, playback on the device ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1674"
  },
  {
    "text": "on the left jumps forward to rejoin ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1677"
  },
  {
    "text": "the other device and is perfectly in sync. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1679"
  },
  {
    "text": "This is not the only way the system makes use ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1683"
  },
  {
    "text": "of suspensions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1685"
  },
  {
    "text": "AVKit uses them to keep random video frames ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1686"
  },
  {
    "text": "from flashing in front of everybody during scrubbing. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1688"
  },
  {
    "text": "You may have noticed already that scrubbing will ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1691"
  },
  {
    "text": "show intermediate frames only on the device ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1693"
  },
  {
    "text": "that I'm interacting with. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1695"
  },
  {
    "text": "So, as I touch the scrubber, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1697"
  },
  {
    "text": "the device on the right continues playing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1698"
  },
  {
    "text": "while the left device shows the scrubbing frames. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1700"
  },
  {
    "text": "Only when I let go of the scrubber ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1703"
  },
  {
    "text": "will the new time be shared with the other device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1705"
  },
  {
    "text": "and playback resumes for everyone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1708"
  },
  {
    "text": "These are examples of how the system uses suspensions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1711"
  },
  {
    "text": "Now, let's look at how you would adopt one yourself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1714"
  },
  {
    "text": "So, let's jump into Xcode and actually do that. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1718"
  },
  {
    "text": "Let's say you wanted ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1721"
  },
  {
    "text": "to implement a feature that allows one participant ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1723"
  },
  {
    "text": "to rewatch something they just missed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1725"
  },
  {
    "text": "Maybe there was a particularly exciting moment ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1727"
  },
  {
    "text": "in the drone footage we are watching. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1730"
  },
  {
    "text": "With all the coordinator behaviors we discussed so far, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1732"
  },
  {
    "text": "seeking back and playing again will affect everyone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1735"
  },
  {
    "text": "And I want to emphasize ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1738"
  },
  {
    "text": "that this may very well be the right thing to do. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1739"
  },
  {
    "text": "Try to keep your users together as much as possible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1742"
  },
  {
    "text": "But let's say seeking back for everyone is not an option. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1745"
  },
  {
    "text": "So, what we will build instead is a way to seek back ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1748"
  },
  {
    "text": "by a few seconds and play the content at twice the speed ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1751"
  },
  {
    "text": "until we join back up with everyone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1755"
  },
  {
    "text": "I have already added a button in my UI that a user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1757"
  },
  {
    "text": "can use to indicate that they missed something. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1760"
  },
  {
    "text": "It is hooked up with this function ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1762"
  },
  {
    "text": "in our MoviePlayerViewController. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1764"
  },
  {
    "text": "Let's fill that in.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1766"
  },
  {
    "text": "Here is just the player logic. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1771"
  },
  {
    "text": "We figure out what time to seek to, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1774"
  },
  {
    "text": "seek back, and set the player rate to 2. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1777"
  },
  {
    "text": "When we have caught up, we just resume playback at rate 1. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1780"
  },
  {
    "text": "So far, this would all happen to everyone because ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1785"
  },
  {
    "text": "the playback coordinator will intercept those API calls. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1788"
  },
  {
    "text": "This is where the suspensions come in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1792"
  },
  {
    "text": "Right before we seek back, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1795"
  },
  {
    "text": "I want to separate our player from everyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1796"
  },
  {
    "text": "And we do that with the coordinator's ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1801"
  },
  {
    "text": "beginSuspension function. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1804"
  },
  {
    "text": "It requires a reason, and to provide that reason, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1807"
  },
  {
    "text": "we just extend the Reason struct with a new string constant.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1811"
  },
  {
    "text": "In this case, what-happened. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1816"
  },
  {
    "text": "Now, we can use that in our beginSuspension call.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1819"
  },
  {
    "text": "Since the coordinator is now suspended, we can safely seek ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1827"
  },
  {
    "text": "and set the rate, just for our player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1830"
  },
  {
    "text": "Once we are ready to meet up with everyone else, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1834"
  },
  {
    "text": "we need to signal to the coordinator to listen ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1836"
  },
  {
    "text": "to the group again, so we call ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1839"
  },
  {
    "text": "suspension.end(). ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1843"
  },
  {
    "text": "Note that we don't actually need the player rate change anymore. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1846"
  },
  {
    "text": "Since ending the suspension will always ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1850"
  },
  {
    "text": "rejoin everyone else, our player rate change would ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1852"
  },
  {
    "text": "also change back to whatever the current group rate is.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1855"
  },
  {
    "text": "Now, let's try this out.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1861"
  },
  {
    "text": "Everyone plays together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1868"
  },
  {
    "text": "I miss an exciting event, like the approach to the ring, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1869"
  },
  {
    "text": "and I tap our new what-happened button. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1872"
  },
  {
    "text": "So, you can see, the device I'm interacting with ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1874"
  },
  {
    "text": "jumps back to repeat the content. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1876"
  },
  {
    "text": "It plays faster to catch up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1878"
  },
  {
    "text": "while the other device is not affected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1880"
  },
  {
    "text": "And now, we are already perfectly in sync again. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1882"
  },
  {
    "text": "So, when you begin a suspension on an AVPlaybackCoordinator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1886"
  },
  {
    "text": "you separate its player from the group, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1890"
  },
  {
    "text": "and it is now safe to issue any rate change ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1892"
  },
  {
    "text": "or seek without affecting anyone else. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1895"
  },
  {
    "text": "Ending the suspension will ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1898"
  },
  {
    "text": "rejoin the group's current time and rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1899"
  },
  {
    "text": "And, new on this slide, you can optionally propose ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1901"
  },
  {
    "text": "a new time to the group when ending the suspension. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1905"
  },
  {
    "text": "This is how you can implement a scrubbing suspension ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1907"
  },
  {
    "text": "that changes time for everyone only ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1910"
  },
  {
    "text": "when letting go of the playback control. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1912"
  },
  {
    "text": "Here is a summary of when AVPlayer transport control ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1915"
  },
  {
    "text": "commands are actually shared with other participants. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1918"
  },
  {
    "text": "First, you have to connect the AVPlayerPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1921"
  },
  {
    "text": "to other participants through a group session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1924"
  },
  {
    "text": "as Hayden showed you at the beginning of the talk. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1927"
  },
  {
    "text": "Second, the AVPlayer's current AVPlayerItem must have ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1929"
  },
  {
    "text": "the same URL as the other participants' player items. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1933"
  },
  {
    "text": "Or if you're providing your own identifiers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1937"
  },
  {
    "text": "they must have the same custom identifier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1940"
  },
  {
    "text": "Once an item is enqueued, all seeks and rate changes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1943"
  },
  {
    "text": "affect everyone in the group, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1946"
  },
  {
    "text": "except when you begin a coordinated playback suspension. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1949"
  },
  {
    "text": "And to close out the discussion of AVPlayerPlaybackCoordinator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1953"
  },
  {
    "text": "here's a quick tour of other API related to coordinated playback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1956"
  },
  {
    "text": "If you want other participants to wait ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1960"
  },
  {
    "text": "during one user's suspension, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1963"
  },
  {
    "text": "you can configure this using the coordinator's ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1965"
  },
  {
    "text": "suspensionReasons ThatTriggerWaiting property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1968"
  },
  {
    "text": "This is how you could request that no one misses any content ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1971"
  },
  {
    "text": "if participants have different length ads. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1975"
  },
  {
    "text": "To learn more about the state of other participants, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1978"
  },
  {
    "text": "take a look at the coordinator's otherParticipants property ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1981"
  },
  {
    "text": "and its corresponding notification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1984"
  },
  {
    "text": "The AVCoordinatedPlaybackParticipant ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1987"
  },
  {
    "text": "most notably gives you the list of suspensionReasons, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1989"
  },
  {
    "text": "which may be useful to inform UI, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1992"
  },
  {
    "text": "especially if you use suspension ReasonsThatTriggerWaiting above. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1994"
  },
  {
    "text": "Whenever the coordinator requests its AVPlayer to wait, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=1999"
  },
  {
    "text": "that is reflected in the players reasonForWaitingToPlay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2003"
  },
  {
    "text": "with the new waiting ForCoordinatedPlayback reason. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2007"
  },
  {
    "text": "To override waiting and immediately start playback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2011"
  },
  {
    "text": "regardless of the other participants' states, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2014"
  },
  {
    "text": "use the player's playImmediately atRate function. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2016"
  },
  {
    "text": "Note that this can cause other participants to miss content, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2019"
  },
  {
    "text": "so be aware of that when using this API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2023"
  },
  {
    "text": "AVPlayer also has a new rateDidChangeNotification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2026"
  },
  {
    "text": "which provides more information about the rate change, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2030"
  },
  {
    "text": "including when another participant caused it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2032"
  },
  {
    "text": "And similarly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2036"
  },
  {
    "text": "AVPlayerItem's TimeJumpedNotification ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2037"
  },
  {
    "text": "will also tell you if a time jump originates ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2040"
  },
  {
    "text": "from another participant. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2042"
  },
  {
    "text": "There is some AVPlayer API you cannot use ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2045"
  },
  {
    "text": "with AVPlayerPlaybackCoordinator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2047"
  },
  {
    "text": "The default time pitch algorithm on iOS used to be ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2050"
  },
  {
    "text": "low quality zero latency. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2053"
  },
  {
    "text": "This value is now deprecated in iOS 15. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2055"
  },
  {
    "text": "LowQualityZeroLatency is not supported ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2058"
  },
  {
    "text": "for coordinated playback, and you should watch out ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2061"
  },
  {
    "text": "for code resetting to this now-deprecated value. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2063"
  },
  {
    "text": "Use one of the other algorithms instead. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2067"
  },
  {
    "text": "Also, do not use ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2069"
  },
  {
    "text": "AVPlayer's setRate(time:atHostTime:) ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2071"
  },
  {
    "text": "function with an AVPlayerPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2074"
  },
  {
    "text": "because it is vital that the playback coordinater ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2076"
  },
  {
    "text": "is in charge of player timing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2079"
  },
  {
    "text": "which is incompatible with external startup sync. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2081"
  },
  {
    "text": "After all this talk about AVPlayer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2084"
  },
  {
    "text": "let's quickly dip into the second subclass ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2086"
  },
  {
    "text": "of AVPlaybackCoordinator, AVDelegatingPlaybackCoordinator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2089"
  },
  {
    "text": "A lot of the concepts that we discussed still apply ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2094"
  },
  {
    "text": "for delegating playback coordinator, but instead ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2097"
  },
  {
    "text": "of observing the player for you, the delegating coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2100"
  },
  {
    "text": "requires you to provide information about playback state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2103"
  },
  {
    "text": "and apply state to your playback objects yourself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2106"
  },
  {
    "text": "A custom playback object setup will look something like this. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2109"
  },
  {
    "text": "Your UI controls the player, which uses one of the other ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2113"
  },
  {
    "text": "system-rendering APIs underneath. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2116"
  },
  {
    "text": "The delegating playback coordinator fits ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2118"
  },
  {
    "text": "in between your UI and your player implementation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2121"
  },
  {
    "text": "As the name suggests, AVDelegatingPlaybackCoordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2124"
  },
  {
    "text": "requires you to implement a delegate protocol ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2127"
  },
  {
    "text": "that receives playback commands for playing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2130"
  },
  {
    "text": "pausing, seeking, and buffering. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2133"
  },
  {
    "text": "Instead of sending a play command to your player directly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2136"
  },
  {
    "text": "your UI would tell the coordinator first. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2139"
  },
  {
    "text": "The coordinator will then decide if it needs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2142"
  },
  {
    "text": "to first negotiate with other connected players, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2144"
  },
  {
    "text": "before changing your playback object's time or rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2147"
  },
  {
    "text": "You also have to tell the coordinator whenever ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2151"
  },
  {
    "text": "your player transitions to a new current item, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2153"
  },
  {
    "text": "so that the coordinator knows which commands to send to you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2156"
  },
  {
    "text": "As before, items are identified by arbitrary strings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2159"
  },
  {
    "text": "When the coordinator sends a command, it should ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2163"
  },
  {
    "text": "affect the originating UI, as well as the receiver UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2165"
  },
  {
    "text": "And when it is time to play, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2169"
  },
  {
    "text": "it should affect all players in the same way. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2171"
  },
  {
    "text": "It is your responsibility to make your playback object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2173"
  },
  {
    "text": "follow along and to update your UI ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2176"
  },
  {
    "text": "for commands appropriately. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2179"
  },
  {
    "text": "I want to specially call out that the delegating coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2180"
  },
  {
    "text": "will often tell you to begin buffering, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2184"
  },
  {
    "text": "even if your device is already ready to go. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2186"
  },
  {
    "text": "This means the coordinator is still waiting for other ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2189"
  },
  {
    "text": "connected participants, and your UI should reflect that, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2193"
  },
  {
    "text": "even if there is nothing to do on your end. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2196"
  },
  {
    "text": "Final words of warning. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2199"
  },
  {
    "text": "Be careful with events like route changes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2201"
  },
  {
    "text": "that briefly pause and resume your player. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2203"
  },
  {
    "text": "It is your responsibility to stick to the requested timing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2205"
  },
  {
    "text": "and reapply the group timing as needed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2209"
  },
  {
    "text": "If you cannot keep up for whatever reason, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2211"
  },
  {
    "text": "you should communicate that to the coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2214"
  },
  {
    "text": "using a suspension. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2216"
  },
  {
    "text": "The delegating playback coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2218"
  },
  {
    "text": "also does not add any automatic suspensions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2220"
  },
  {
    "text": "This means you should begin and end suspensions ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2223"
  },
  {
    "text": "for relevant system events yourself. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2226"
  },
  {
    "text": "Use the reasons provided by AVFoundation ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2228"
  },
  {
    "text": "where appropriate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2230"
  },
  {
    "text": "And it is possible to connect a delegating playback ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2232"
  },
  {
    "text": "coordinator on one device to a player playback coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2235"
  },
  {
    "text": "on another, but you must use custom identifiers ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2238"
  },
  {
    "text": "on the player playback coordinator end. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2242"
  },
  {
    "text": "Let's wrap up. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2244"
  },
  {
    "text": "To build a coordinated media playback app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2246"
  },
  {
    "text": "use a GroupActivity to define the content you are ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2248"
  },
  {
    "text": "playing and to propose it to the group. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2251"
  },
  {
    "text": "Start to keep track of GroupSessions as soon ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2254"
  },
  {
    "text": "as your app launches to learn when your users ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2256"
  },
  {
    "text": "are in a FaceTime call and want to play together. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2259"
  },
  {
    "text": "And finally, connect the playback coordinator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2261"
  },
  {
    "text": "to your GroupSession to keep your content ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2264"
  },
  {
    "text": "in sync for everyone. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2266"
  },
  {
    "text": "Thank you, and enjoy the rest of WWDC. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2268"
  },
  {
    "text": "[music]",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10225/?time=2271"
  }
]