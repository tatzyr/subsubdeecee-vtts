[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=0"
  },
  {
    "text": "♪ ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=3"
  },
  {
    "text": "Hello, and welcome to \"Mitigate fraud ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=9"
  },
  {
    "text": "with App Attest and DeviceCheck.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=12"
  },
  {
    "text": "My name is Xuerui Yan, and I work ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=15"
  },
  {
    "text": "on the App Store Trust and Safety team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=16"
  },
  {
    "text": "I'm excited to talk about protecting your apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=19"
  },
  {
    "text": "using App Attest and DeviceCheck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=23"
  },
  {
    "text": "At Apple, we're constantly working ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=26"
  },
  {
    "text": "to ensure that the App Store ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=28"
  },
  {
    "text": "is a safe and trusted place for customers and developers.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=30"
  },
  {
    "text": "In this video, we will cover the engineering specifics.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=35"
  },
  {
    "text": "For business and conceptual details, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=39"
  },
  {
    "text": "see \"Safeguard your accounts, promotions, and content\" video ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=42"
  },
  {
    "text": "from WWDC 2021.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=46"
  },
  {
    "text": "In iOS 11, we introduced the DeviceCheck framework. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=50"
  },
  {
    "text": "DeviceCheck helps mitigate fraud on promotional offerings. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=55"
  },
  {
    "text": "Suppose you are introducing a new feature in your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=60"
  },
  {
    "text": "To promote the feature, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=64"
  },
  {
    "text": "you offer a free, single-use item. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=65"
  },
  {
    "text": "Someone might abuse the promotion ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=69"
  },
  {
    "text": "by reinstalling the app over and over again ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=71"
  },
  {
    "text": "just to claim the free item. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=75"
  },
  {
    "text": "Likely, you'll want to limit promotional items ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=78"
  },
  {
    "text": "to once per device, instead of allowing the app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=81"
  },
  {
    "text": "to be installed repeatedly and having the promotion reused.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=85"
  },
  {
    "text": "Now, DeviceCheck can help you detect ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=90"
  },
  {
    "text": "whether a device has received a promotion offer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=93"
  },
  {
    "text": "or if a device has participated in fraudulent activity.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=97"
  },
  {
    "text": "It allows you to persistently store two bits of information ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=103"
  },
  {
    "text": "and a timestamp associated with one device on Apple servers.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=107"
  },
  {
    "text": "It is up to you to decide what these bits mean to your applications.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=113"
  },
  {
    "text": "The state will be maintained by Apple ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=119"
  },
  {
    "text": "for you to update and query.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=121"
  },
  {
    "text": "The bits are shared by all apps from a developer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=125"
  },
  {
    "text": "Please keep that in mind when assigning meanings to the bits ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=129"
  },
  {
    "text": "so they are applicable across all your apps.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=133"
  },
  {
    "text": "The state persists across app reinstallation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=138"
  },
  {
    "text": "device transfer between users, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=142"
  },
  {
    "text": "and even \"Erase all contents and settings.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=144"
  },
  {
    "text": "Consider using the timestamp to reset the bits ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=147"
  },
  {
    "text": "on a period of your choosing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=151"
  },
  {
    "text": "based on your promotional and business strategies.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=153"
  },
  {
    "text": "To find out more about DeviceCheck, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=158"
  },
  {
    "text": "see the \"Privacy and Your Apps\" video ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=160"
  },
  {
    "text": "from WWDC 2017 ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=162"
  },
  {
    "text": "and the DeviceCheck Framework documentation.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=165"
  },
  {
    "text": "So that's DeviceCheck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=169"
  },
  {
    "text": "Next, I'm going to talk about App Attest, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=172"
  },
  {
    "text": "also available under the DeviceCheck Framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=176"
  },
  {
    "text": "When your service receives a request, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=180"
  },
  {
    "text": "it can be hard to know whether it really is from your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=183"
  },
  {
    "text": "App Attest allows your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=188"
  },
  {
    "text": "to attach a hardware-backed assertion ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=190"
  },
  {
    "text": "as a part of the request. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=193"
  },
  {
    "text": "Your server can use assertion to verify the request came ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=196"
  },
  {
    "text": "from your genuine app, on a genuine Apple device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=199"
  },
  {
    "text": "Imagine, you designed a beautiful app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=203"
  },
  {
    "text": "that encourages travel to discover collectibles, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=207"
  },
  {
    "text": "only to find that a modified app allowed ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=211"
  },
  {
    "text": "collecting everything without ever leaving home.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=213"
  },
  {
    "text": "Or imagine players' frustration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=218"
  },
  {
    "text": "seeing others racing up the leaderboards, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=221"
  },
  {
    "text": "by using cheats to get unlimited boosts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=223"
  },
  {
    "text": "in a competitive multiplayer racing game.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=226"
  },
  {
    "text": "Or imagine waking up on a Saturday ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=230"
  },
  {
    "text": "and, much to your delight, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=234"
  },
  {
    "text": "seeing a very high request volume on your server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=236"
  },
  {
    "text": "but after investigation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=239"
  },
  {
    "text": "you find the calls aren't coming from your app at all.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=241"
  },
  {
    "text": "App Attest can help you identify genuine ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=246"
  },
  {
    "text": "and modified versions of your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=249"
  },
  {
    "text": "letting you protect your app experience and your business.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=252"
  },
  {
    "text": "App Attest provides three key properties that you can ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=257"
  },
  {
    "text": "take advantage of to protect you and your customers.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=261"
  },
  {
    "text": "App Attest lets your service verify a request came ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=267"
  },
  {
    "text": "from a legitimate instance of your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=270"
  },
  {
    "text": "by satisfying three conditions: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=273"
  },
  {
    "text": "the request came from a genuine Apple device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=276"
  },
  {
    "text": "running your genuine application, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=279"
  },
  {
    "text": "and that the payload has not been tampered with.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=282"
  },
  {
    "text": "Let's go through how App Attest provides ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=286"
  },
  {
    "text": "each of these properties. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=289"
  },
  {
    "text": "At the heart of App Attest is a secure key pair ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=292"
  },
  {
    "text": "and an attestation, signed by Apple, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=295"
  },
  {
    "text": "certifying that the key pair originates ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=299"
  },
  {
    "text": "from a genuine Apple device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=302"
  },
  {
    "text": "The private key is stored and accessible ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=305"
  },
  {
    "text": "only through the Secure Enclave using the App Attest API.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=309"
  },
  {
    "text": "Your app can sign requests to your service with the key, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=314"
  },
  {
    "text": "and your service can then check the signature to verify ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=318"
  },
  {
    "text": "the request was generated on a genuine Apple device.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=321"
  },
  {
    "text": "For an app to execute on an Apple device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=326"
  },
  {
    "text": "it must be signed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=330"
  },
  {
    "text": "A person making unauthorized modifications to your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=332"
  },
  {
    "text": "must re-sign it with an identity they control. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=335"
  },
  {
    "text": "This unavoidably modifies the app identity.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=339"
  },
  {
    "text": "We include a hash of the app identity in the attestation.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=345"
  },
  {
    "text": "By comparing your app identity with the one included ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=351"
  },
  {
    "text": "in the attestation, you can determine ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=354"
  },
  {
    "text": "whether the caller is using a modified version.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=357"
  },
  {
    "text": "Now that you know the request came ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=361"
  },
  {
    "text": "from a genuine device and your genuine app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=364"
  },
  {
    "text": "let's talk about the request payload.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=367"
  },
  {
    "text": "Before sending a payload to your server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=372"
  },
  {
    "text": "you can instruct App Attest to sign a digest ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=374"
  },
  {
    "text": "of the payload using the attested key. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=377"
  },
  {
    "text": "This creates an assertion of the payload.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=381"
  },
  {
    "text": "Your app should transmit the payload ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=386"
  },
  {
    "text": "and the assertion to your service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=388"
  },
  {
    "text": "By verifying the assertion against the payload, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=390"
  },
  {
    "text": "you can trust that the payload was not tampered with in transit.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=393"
  },
  {
    "text": "Those are three key properties. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=399"
  },
  {
    "text": "Now let's talk a bit about privacy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=402"
  },
  {
    "text": "Here at Apple, we care deeply about privacy. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=406"
  },
  {
    "text": "We believe that privacy is an essential foundation ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=411"
  },
  {
    "text": "for a healthy app ecosystem. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=414"
  },
  {
    "text": "Each element of App Attest has been built with privacy in mind.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=417"
  },
  {
    "text": "The attestations are designed to provide assurance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=423"
  },
  {
    "text": "of a genuine device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=426"
  },
  {
    "text": "while protecting against tracking. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=428"
  },
  {
    "text": "The attestations are anonymous ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=431"
  },
  {
    "text": "and include no hardware identifiers.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=433"
  },
  {
    "text": "App Attest keys are unique per installation of your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=437"
  },
  {
    "text": "This means that an App Attest key will not survive ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=442"
  },
  {
    "text": "app reinstallation, is not backed up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=446"
  },
  {
    "text": "and is not synced across devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=450"
  },
  {
    "text": "Keep this in mind when designing your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=453"
  },
  {
    "text": "Now that you understand the value App Attest provides, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=458"
  },
  {
    "text": "let's dive into the details ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=462"
  },
  {
    "text": "of incorporating it into your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=464"
  },
  {
    "text": "There are three basic parts to incorporate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=468"
  },
  {
    "text": "App Attest into your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=470"
  },
  {
    "text": "Creating an App Attest key, attesting and verifying the key, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=474"
  },
  {
    "text": "and generating and verifying assertions. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=478"
  },
  {
    "text": "Let's start with creating an App Attest Key. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=482"
  },
  {
    "text": "All App Attest calls should be guarded ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=486"
  },
  {
    "text": "by the isSupported property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=489"
  },
  {
    "text": "App Attest is supported ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=491"
  },
  {
    "text": "on devices that have a Secure Enclave, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=493"
  },
  {
    "text": "but there are cases, such as App Extensions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=497"
  },
  {
    "text": "where isSupported will still return false. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=500"
  },
  {
    "text": "Your app must handle these cases gracefully.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=504"
  },
  {
    "text": "Instead of immediately blocking access, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=509"
  },
  {
    "text": "use failures as a risk signal. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=512"
  },
  {
    "text": "First, classify the caller as untrusted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=516"
  },
  {
    "text": "Then, based on your risk assessment logic, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=520"
  },
  {
    "text": "evaluate whether to allow the client ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=522"
  },
  {
    "text": "to use sensitive features.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=525"
  },
  {
    "text": "Another approach is to monitor ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=529"
  },
  {
    "text": "for a sudden increase in devices ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=531"
  },
  {
    "text": "claiming they don't support App Attest ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=534"
  },
  {
    "text": "when calling your service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=536"
  },
  {
    "text": "If the ratio of devices supporting App Attest ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=538"
  },
  {
    "text": "suddenly decreases, it may be a sign ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=542"
  },
  {
    "text": "of modified apps trying to bypass your checks.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=545"
  },
  {
    "text": "With an App Attest key successfully generated, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=549"
  },
  {
    "text": "let's go ahead and attest the key. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=553"
  },
  {
    "text": "To prevent man-in-the-middle and replay attacks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=557"
  },
  {
    "text": "we need a one-time server challenge. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=560"
  },
  {
    "text": "Let's have your server issue the challenge to the app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=564"
  },
  {
    "text": "To link the attestation with a user account ID ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=568"
  },
  {
    "text": "or other values, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=571"
  },
  {
    "text": "hash those values together ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=573"
  },
  {
    "text": "with the challenge to create the clientDataHash. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=575"
  },
  {
    "text": "Using the clientDataHash, along with the keyId ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=580"
  },
  {
    "text": "from the previous step, we can now call attestKey API.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=583"
  },
  {
    "text": "attestKey will use the private key to create ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=589"
  },
  {
    "text": "a hardware attestation request for the device, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=592"
  },
  {
    "text": "and submit the request to Apple for verification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=597"
  },
  {
    "text": "Once verified, Apple will return ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=600"
  },
  {
    "text": "an anonymous attestation object to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=603"
  },
  {
    "text": "Send the attestation, along with any custom payload, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=607"
  },
  {
    "text": "back to your server for verification. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=611"
  },
  {
    "text": "OK, now that your app has sent the attestation ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=615"
  },
  {
    "text": "to your server, let's try to verify it.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=618"
  },
  {
    "text": "The attestation follows the Web Authentication standard ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=622"
  },
  {
    "text": "and contains three parts: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=626"
  },
  {
    "text": "a list of certificates signed by Apple, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=628"
  },
  {
    "text": "an Authenticator Data structure, and a risk metric receipt.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=631"
  },
  {
    "text": "Let's look at the important pieces that you need to verify.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=636"
  },
  {
    "text": "The certificate section contains the leaf ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=642"
  },
  {
    "text": "and intermediate certificates. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=645"
  },
  {
    "text": "The App Attest root certificate is available ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=648"
  },
  {
    "text": "in the Apple Private PKI repository. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=651"
  },
  {
    "text": "Validating the full certificate chain ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=655"
  },
  {
    "text": "tells you the device is a genuine Apple device.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=657"
  },
  {
    "text": "When you called attestKey, a single-use hash, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=662"
  },
  {
    "text": "known as a nonce, was created ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=665"
  },
  {
    "text": "from the clientDataHash and other data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=667"
  },
  {
    "text": "That nonce is included in the leaf certificate.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=672"
  },
  {
    "text": "To prevent tampering, you'll reconstruct the nonce ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=676"
  },
  {
    "text": "on your server and verify it matches.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=679"
  },
  {
    "text": "The authenticator data block contains multiple properties, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=684"
  },
  {
    "text": "including a hash of the app identity, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=688"
  },
  {
    "text": "that you can use to verify it is your app calling you.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=691"
  },
  {
    "text": "The key attestation also contains a receipt that you can ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=696"
  },
  {
    "text": "store and use later to request a risk metric from Apple. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=699"
  },
  {
    "text": "I will cover more information about it later in the video.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=704"
  },
  {
    "text": "If everything checks out, the App Attest Key is genuine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=709"
  },
  {
    "text": "Store the key associated with the client data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=714"
  },
  {
    "text": "for use to verify subsequent requests.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=717"
  },
  {
    "text": "Not all failures are due to an invalid attestation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=722"
  },
  {
    "text": "Gracefully handle scenarios, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=726"
  },
  {
    "text": "such as isSupported returning false, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=728"
  },
  {
    "text": "being throttled during ramp up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=731"
  },
  {
    "text": "or general network failures. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=733"
  },
  {
    "text": "You can then incorporate failures ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=736"
  },
  {
    "text": "as signals in your overall risk assessment.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=737"
  },
  {
    "text": "For further details on implementing the verification, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=742"
  },
  {
    "text": "please see the documentation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=746"
  },
  {
    "text": "Calling the attest-Key API generates a network call ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=748"
  },
  {
    "text": "from your app to App Attest service. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=752"
  },
  {
    "text": "This only happens once per app instance. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=756"
  },
  {
    "text": "However, if you have a large install base, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=759"
  },
  {
    "text": "collectively, your app may send many requests to App Attest. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=762"
  },
  {
    "text": "In order to manage resources and avoid being rate limited, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=767"
  },
  {
    "text": "make sure you gradually enable this feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=772"
  },
  {
    "text": "across your install base. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=774"
  },
  {
    "text": "For example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=776"
  },
  {
    "text": "if you have a million daily active users, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=778"
  },
  {
    "text": "you can probably ramp up over a day or so. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=781"
  },
  {
    "text": "If you have a billion daily active users, nice work! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=785"
  },
  {
    "text": "You should ramp up over a month or more.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=789"
  },
  {
    "text": "Now that you have the attested key, you can use ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=794"
  },
  {
    "text": "the generateAssertion API call to protect ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=797"
  },
  {
    "text": "sensitive communication between your app and your server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=800"
  },
  {
    "text": "The assertion flow is simpler than attestation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=805"
  },
  {
    "text": "as the Apple servers are no longer involved.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=809"
  },
  {
    "text": "All assertions using the key are generated ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=813"
  },
  {
    "text": "on-device and validated on your server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=816"
  },
  {
    "text": "Start by requesting a unique challenge from the server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=821"
  },
  {
    "text": "then generate a digest of the payload ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=825"
  },
  {
    "text": "and call generateAssertion. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=827"
  },
  {
    "text": "generateAssertion will use the digest to compute ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=831"
  },
  {
    "text": "a nonce and sign it with the App Attest key.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=834"
  },
  {
    "text": "Your app can then send the payload ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=839"
  },
  {
    "text": "and the assertion to your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=841"
  },
  {
    "text": "Finally, your server should verify the payload.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=844"
  },
  {
    "text": "Assertion payloads contains this high-level structure. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=849"
  },
  {
    "text": "Signature and Authenticator Data.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=853"
  },
  {
    "text": "To validate the signature, reverse the process ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=858"
  },
  {
    "text": "to reconstruct the nonce on your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=861"
  },
  {
    "text": "Then use the public key to verify the signature.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=864"
  },
  {
    "text": "If the signature is valid, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=869"
  },
  {
    "text": "you can trust the payload is unmodified.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=871"
  },
  {
    "text": "The authenticator data section contains the app identity hash.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=876"
  },
  {
    "text": "Validate the hash to ensure the assertion ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=881"
  },
  {
    "text": "is from your genuine app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=884"
  },
  {
    "text": "The authenticator data also includes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=888"
  },
  {
    "text": "an ever-increasing counter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=890"
  },
  {
    "text": "To help protect against replay attacks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=893"
  },
  {
    "text": "store the counter value on your server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=896"
  },
  {
    "text": "and expect it to increase with each subsequent request.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=898"
  },
  {
    "text": "With the key, you can now repeat this process ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=904"
  },
  {
    "text": "as much as you need. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=907"
  },
  {
    "text": "While generating an assertion doesn't call Apple servers, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=910"
  },
  {
    "text": "it's a cryptographic operation, which adds some latency. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=913"
  },
  {
    "text": "You should factor this into your design ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=917"
  },
  {
    "text": "when incorporating App Attest into your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=920"
  },
  {
    "text": "Assertions are a good fit for important ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=925"
  },
  {
    "text": "but infrequent calls, and the calls that can deal ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=928"
  },
  {
    "text": "with the additional latency and the computation required.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=931"
  },
  {
    "text": "For frequent real-time network commands, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=936"
  },
  {
    "text": "assertions may not be suitable.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=939"
  },
  {
    "text": "Congratulations! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=942"
  },
  {
    "text": "You have now completed the basic implementation of App Attest. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=944"
  },
  {
    "text": "With this implementation alone, you can start classifying ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=949"
  },
  {
    "text": "your incoming server requests as genuine and modified, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=952"
  },
  {
    "text": "and incorporate this important fraud signal ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=956"
  },
  {
    "text": "into your business logic.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=959"
  },
  {
    "text": "But there's more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=962"
  },
  {
    "text": "An attacker may try to work around App Attest ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=964"
  },
  {
    "text": "by using a single device to create many App Attest keys, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=968"
  },
  {
    "text": "and use that device to serve communications ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=973"
  },
  {
    "text": "between many modified apps and your server. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=976"
  },
  {
    "text": "To help detect such behavior, we offer a service ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=980"
  },
  {
    "text": "called the App Attest Risk Metric Service ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=984"
  },
  {
    "text": "that provides the approximate number of keys ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=987"
  },
  {
    "text": "created on a device for your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=990"
  },
  {
    "text": "Recall that attestKey returns both ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=995"
  },
  {
    "text": "the attestation and a risk metric receipt. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=997"
  },
  {
    "text": "Your server can submit that receipt ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1001"
  },
  {
    "text": "to the service and redeem it for a new receipt. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1003"
  },
  {
    "text": "The new receipt will include the risk metric.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1008"
  },
  {
    "text": "Periodically, you can redeem your latest receipt ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1013"
  },
  {
    "text": "for updated metrics for that app/device pair.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1016"
  },
  {
    "text": "Here is a high-level view of the receipt structure. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1022"
  },
  {
    "text": "It is a PKCS7 container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1026"
  },
  {
    "text": "For full details, see \"Assessing Fraud Risk\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1030"
  },
  {
    "text": "in the DeviceCheck Framework documentation.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1033"
  },
  {
    "text": "App Clips is an exciting feature in iOS. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1037"
  },
  {
    "text": "We've added App Attest support to App Clips in iOS 15. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1042"
  },
  {
    "text": "To support a seamless upgrade from App Clip to full app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1049"
  },
  {
    "text": "the App Clip and full app share the same app identity ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1053"
  },
  {
    "text": "in the App Attest context. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1057"
  },
  {
    "text": "Make sure to keep this in mind ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1060"
  },
  {
    "text": "when you verify the app identity on your server side.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1062"
  },
  {
    "text": "When App Clips are manually removed ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1067"
  },
  {
    "text": "or expire, their keys will be invalidated, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1069"
  },
  {
    "text": "just like when your full app is uninstalled.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1074"
  },
  {
    "text": "OK, that's it for App Clips. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1078"
  },
  {
    "text": "Now, remember these key points for success with App Attest. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1082"
  },
  {
    "text": "Validate on server, not on-device. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1087"
  },
  {
    "text": "The app may be modified to disable your validation code.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1090"
  },
  {
    "text": "Incorporate a one-time server challenge in your flow ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1095"
  },
  {
    "text": "to prevent network replay attacks.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1098"
  },
  {
    "text": "Handle failure scenarios, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1102"
  },
  {
    "text": "such as isSupported returning false, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1104"
  },
  {
    "text": "being throttled during ramp up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1107"
  },
  {
    "text": "or general network failures. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1109"
  },
  {
    "text": "Incorporate failures as signals in your risk assessment.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1112"
  },
  {
    "text": "App Attest and DeviceCheck provide the information ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1117"
  },
  {
    "text": "that you can integrate into your overall fraud assessment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1121"
  },
  {
    "text": "Use DeviceCheck to mitigate fraud on promotional offerings.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1125"
  },
  {
    "text": "Take advantage of App Attest to help you ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1131"
  },
  {
    "text": "detect modified versions of your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1134"
  },
  {
    "text": "protecting your content and your user experience. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1136"
  },
  {
    "text": "Thanks for watching! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1140"
  },
  {
    "text": "I'm looking forward to seeing your apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1141"
  },
  {
    "text": "protected by App Attest and DeviceCheck. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1144"
  },
  {
    "text": "Peace!",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10244/?time=1148"
  }
]