[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=0"
  },
  {
    "text": "♪ Bass music playing ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=2"
  },
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=5"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=7"
  },
  {
    "text": "Tommy Pauly: Hi, I'm Tommy Pauly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=9"
  },
  {
    "text": "and along with my colleague, Delziel, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=11"
  },
  {
    "text": "I'll be giving you an introduction ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=14"
  },
  {
    "text": "to an exciting new feature in internet privacy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=15"
  },
  {
    "text": "iCloud Private Relay is a new service ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=19"
  },
  {
    "text": "that prevents networks and servers ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=22"
  },
  {
    "text": "from monitoring user activity across the internet.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=25"
  },
  {
    "text": "And it's available as part of every iCloud+ subscription.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=29"
  },
  {
    "text": "Private Relay not only protects users ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=34"
  },
  {
    "text": "when they're browsing the web, but also adds protection ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=36"
  },
  {
    "text": "to the traffic generated by your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=40"
  },
  {
    "text": "to make sure you're not unintentionally ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=42"
  },
  {
    "text": "leaking user information ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=45"
  },
  {
    "text": "or exposing users to security attacks.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=47"
  },
  {
    "text": "Today, you'll learn what iCloud Private Relay is ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=51"
  },
  {
    "text": "and how it affects your app; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=54"
  },
  {
    "text": "how to ensure that your app works great with Private Relay; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=57"
  },
  {
    "text": "how to prepare your websites and servers; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=61"
  },
  {
    "text": "and, lastly, how to manage a network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=64"
  },
  {
    "text": "and monitor your traffic when Private Relay is enabled.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=67"
  },
  {
    "text": "Let's get started.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=71"
  },
  {
    "text": "Private Relay is built into iOS and macOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=74"
  },
  {
    "text": "so you don't need to do anything to adopt it from your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=77"
  },
  {
    "text": "It's also important to understand ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=82"
  },
  {
    "text": "that it won't always be affecting your app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=84"
  },
  {
    "text": "It will only apply when a user is an iCloud+ subscriber ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=86"
  },
  {
    "text": "and has Private Relay enabled.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=91"
  },
  {
    "text": "You're probably wondering, What does it actually do? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=94"
  },
  {
    "text": "Here's how things currently work without Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=98"
  },
  {
    "text": "When someone accesses the internet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=102"
  },
  {
    "text": "anyone on their local network can see the names ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=105"
  },
  {
    "text": "of all of the websites they access ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=108"
  },
  {
    "text": "based on inspecting DNS queries.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=110"
  },
  {
    "text": "This information can be used to fingerprint a user ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=114"
  },
  {
    "text": "and build a history of their activity over time.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=118"
  },
  {
    "text": "No one should be able to silently collect ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=121"
  },
  {
    "text": "all of this information, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=123"
  },
  {
    "text": "whether it's a public Wi-Fi operator, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=125"
  },
  {
    "text": "another user on the network, or an internet service provider.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=128"
  },
  {
    "text": "When connections reach the servers that run websites, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=133"
  },
  {
    "text": "those servers can see the user's IP address.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=137"
  },
  {
    "text": "This allows the servers to determine user location ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=140"
  },
  {
    "text": "without explicit permission.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=143"
  },
  {
    "text": "Even worse, the servers are able to fingerprint user identity ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=146"
  },
  {
    "text": "and recognize users across different websites, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=151"
  },
  {
    "text": "even when tools like Intelligent Tracking Prevention in Safari ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=154"
  },
  {
    "text": "are preventing correlation via cookies.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=159"
  },
  {
    "text": "These are big problems for user privacy, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=162"
  },
  {
    "text": "and in order to fix them, we need a new approach ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=166"
  },
  {
    "text": "that has privacy built in by design.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=169"
  },
  {
    "text": "iCloud Private Relay adds multiple secure proxies ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=173"
  },
  {
    "text": "to help route user traffic and keep it private.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=177"
  },
  {
    "text": "The proxies are run by separate entities.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=181"
  },
  {
    "text": "One is Apple, and one is a content provider.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=184"
  },
  {
    "text": "Now, when someone accesses the internet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=189"
  },
  {
    "text": "only the client IP address is visible ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=192"
  },
  {
    "text": "to both the network provider and to the first proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=195"
  },
  {
    "text": "The second proxy only sees the name the user is requesting ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=200"
  },
  {
    "text": "and uses that to build the connection to the server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=205"
  },
  {
    "text": "It is critical to note that no one in this chain -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=209"
  },
  {
    "text": "not even Apple -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=212"
  },
  {
    "text": "can see both the client IP address ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=214"
  },
  {
    "text": "and what the user is accessing.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=216"
  },
  {
    "text": "The opportunities for fingerprinting ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=219"
  },
  {
    "text": "have been removed.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=221"
  },
  {
    "text": "This is privacy by design.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=223"
  },
  {
    "text": "Private Relay uses the latest transport protocols ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=228"
  },
  {
    "text": "and privacy-preserving authentication ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=231"
  },
  {
    "text": "to ensure that every transaction is both secure and fast.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=233"
  },
  {
    "text": "You can learn more about this technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=239"
  },
  {
    "text": "in the “Apple's privacy pillars in focus” session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=242"
  },
  {
    "text": "Private Relay is focused on securing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=247"
  },
  {
    "text": "the most sensitive traffic on the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=249"
  },
  {
    "text": "without impacting user experience.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=252"
  },
  {
    "text": "In iOS 15 and macOS 12, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=255"
  },
  {
    "text": "Private Relay will apply to all web browsing in Safari, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=259"
  },
  {
    "text": "all DNS name resolution queries, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=263"
  },
  {
    "text": "and a small subset of traffic from apps.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=266"
  },
  {
    "text": "Specifically, this will include all insecure HTTP traffic, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=270"
  },
  {
    "text": "such as TCP port 80.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=275"
  },
  {
    "text": "If your app provides a content filter ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=279"
  },
  {
    "text": "or a parental controls filter, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=282"
  },
  {
    "text": "it will still see traffic before it goes through Private Relay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=284"
  },
  {
    "text": "so you can apply your filters just as before.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=287"
  },
  {
    "text": "You can learn more about this ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=291"
  },
  {
    "text": "in the \"Meet the Screen Time API\" session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=293"
  },
  {
    "text": "Not all networking done by your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=297"
  },
  {
    "text": "occurs over the public internet, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=298"
  },
  {
    "text": "so there are several categories of traffic ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=301"
  },
  {
    "text": "that are not affected by Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=303"
  },
  {
    "text": "Any connections your app makes over the local network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=307"
  },
  {
    "text": "or to private domain names will be unaffected.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=310"
  },
  {
    "text": "Similarly, if your app provides a network extension ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=315"
  },
  {
    "text": "to add VPN or app-proxying capabilities, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=319"
  },
  {
    "text": "your extension won't use Private Relay ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=323"
  },
  {
    "text": "and neither will app traffic that uses your extension.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=325"
  },
  {
    "text": "Traffic that uses a proxy is also exempt.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=330"
  },
  {
    "text": "Next, let's cover what you need to do ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=334"
  },
  {
    "text": "to make sure your app is ready to work well with Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=337"
  },
  {
    "text": "The great news is that for almost every app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=342"
  },
  {
    "text": "you don't need to do anything new! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=344"
  },
  {
    "text": "Private Relay will just work.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=347"
  },
  {
    "text": "However, there are some best practices you should know about.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=350"
  },
  {
    "text": "Private Relay works no matter what networking API ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=355"
  },
  {
    "text": "you're using.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=358"
  },
  {
    "text": "For several years, we've recommended that your apps use ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=359"
  },
  {
    "text": "modern APIs such as URLSession and NWConnection.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=363"
  },
  {
    "text": "Now, you have one more reason ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=369"
  },
  {
    "text": "to adopt them throughout your apps.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=370"
  },
  {
    "text": "These APIs provide you the best tools ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=373"
  },
  {
    "text": "to understand how Private Relay is applying to your traffic.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=377"
  },
  {
    "text": "If you use URLSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=382"
  },
  {
    "text": "you can use the Network Xcode Instrument ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=385"
  },
  {
    "text": "to inspect your tasks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=388"
  },
  {
    "text": "even when they are going through Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=390"
  },
  {
    "text": "You can learn more about how to do this ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=394"
  },
  {
    "text": "in the \"Analyze HTTP traffic in Instruments\" session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=396"
  },
  {
    "text": "And you can use metrics APIs in both ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=402"
  },
  {
    "text": "URLSession and Network.framework ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=405"
  },
  {
    "text": "to understand when your connections use Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=408"
  },
  {
    "text": "In TaskTransactionMetrics, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=412"
  },
  {
    "text": "you can check to see if your task used a proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=415"
  },
  {
    "text": "In NWConnection's EstablishmentReport, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=420"
  },
  {
    "text": "you can also inspect the timings of DNS name resolution ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=423"
  },
  {
    "text": "and each stage of the proxied connection establishment.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=427"
  },
  {
    "text": "Private Relay takes a big step towards making unencrypted ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=432"
  },
  {
    "text": "and insecure HTTP connections a thing of the past.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=436"
  },
  {
    "text": "You can join in this effort too! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=440"
  },
  {
    "text": "If you're still using insecure HTTP -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=443"
  },
  {
    "text": "that's connections on TCP port 80 -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=446"
  },
  {
    "text": "now is the time to change.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=449"
  },
  {
    "text": "When Private Relay is enabled, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=452"
  },
  {
    "text": "these insecure connections will be proxied, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=454"
  },
  {
    "text": "which protects them from attackers on a local network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=457"
  },
  {
    "text": "between the client and the proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=460"
  },
  {
    "text": "However, it’s still best to have your connections ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=463"
  },
  {
    "text": "be secure end to end for all users.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=467"
  },
  {
    "text": "To do this, make sure your server supports TLS ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=471"
  },
  {
    "text": "and change your URLs from http:// to https://.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=475"
  },
  {
    "text": "Your app may have exceptions for App Transport Security ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=482"
  },
  {
    "text": "to allow insecure traffic.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=486"
  },
  {
    "text": "You can look at this list to audit what insecure traffic ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=488"
  },
  {
    "text": "your app uses and remove these exceptions.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=492"
  },
  {
    "text": "If your app provides functionality based on location, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=498"
  },
  {
    "text": "this is also a great time to make sure you're using ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=501"
  },
  {
    "text": "APIs from Core Location ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=504"
  },
  {
    "text": "instead of relying on servers inferring location ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=507"
  },
  {
    "text": "from IP addresses.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=511"
  },
  {
    "text": "IP address geolocation is often unreliable and inaccurate.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=513"
  },
  {
    "text": "Core Location allows you to specify ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=520"
  },
  {
    "text": "the precision of the location you need ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=522"
  },
  {
    "text": "and is based on explicit user permission.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=524"
  },
  {
    "text": "You can learn more about the latest enhancements ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=529"
  },
  {
    "text": "to location access ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=531"
  },
  {
    "text": "in the “Apple's privacy pillars in focus” session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=533"
  },
  {
    "text": "Once you've made sure your app is ready for Private Relay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=538"
  },
  {
    "text": "try it out! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=541"
  },
  {
    "text": "Sign into an iPhone, iPad, or Mac ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=543"
  },
  {
    "text": "with an iCloud+ subscription, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=546"
  },
  {
    "text": "and make sure Private Relay is enabled ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=548"
  },
  {
    "text": "in the iCloud section of the Settings app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=551"
  },
  {
    "text": "or in System Preferences.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=554"
  },
  {
    "text": "You can provide feedback with the tag ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=556"
  },
  {
    "text": "\"iCloud Private Relay\" in the feedback app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=558"
  },
  {
    "text": "Now I'll hand it off to my colleague, Delziel.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=562"
  },
  {
    "text": "Delziel Fernandes: Thanks, Tommy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=565"
  },
  {
    "text": "Hi, I'm Delziel Fernandes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=567"
  },
  {
    "text": "and I'll be talking about how to prepare your server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=569"
  },
  {
    "text": "and manage your network with Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=572"
  },
  {
    "text": "If you have servers that your app relies on, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=575"
  },
  {
    "text": "or that user access in Safari, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=578"
  },
  {
    "text": "there are a few things you can do to prepare for Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=580"
  },
  {
    "text": "Your servers can identify connections that come in ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=585"
  },
  {
    "text": "using Private Relay ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=588"
  },
  {
    "text": "by recognizing the proxy IP addresses.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=590"
  },
  {
    "text": "These proxy IP addresses ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=593"
  },
  {
    "text": "may be shared by many users within a region.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=595"
  },
  {
    "text": "Each address is mapped to a specific city or region.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=598"
  },
  {
    "text": "So if you apply the correct geo IP mapping databases, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=602"
  },
  {
    "text": "your servers will still have the relevant information.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=606"
  },
  {
    "text": "Private Relay guarantees that users can't use the system ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=610"
  },
  {
    "text": "to pretend to be from a different region, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=614"
  },
  {
    "text": "so you can continue to enforce ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=616"
  },
  {
    "text": "region-based access restrictions.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=618"
  },
  {
    "text": "Details about the proxy IP addresses ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=621"
  },
  {
    "text": "will be available as an article associated with this session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=623"
  },
  {
    "text": "Now let's take a look at network connections ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=627"
  },
  {
    "text": "from devices using Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=630"
  },
  {
    "text": "When a device tries to access a server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=632"
  },
  {
    "text": "it first sets up a network connection to the ingress proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=635"
  },
  {
    "text": "This connection is set up using an IP address ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=638"
  },
  {
    "text": "assigned by the network provider.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=641"
  },
  {
    "text": "The device then uses the ingress proxy ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=644"
  },
  {
    "text": "to forward network requests to the egress proxy ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=647"
  },
  {
    "text": "using the ingress proxy IP address.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=649"
  },
  {
    "text": "The egress proxy then forwards these requests ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=652"
  },
  {
    "text": "to the destination servers by choosing an IP address ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=655"
  },
  {
    "text": "that maps to the device's city or region.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=658"
  },
  {
    "text": "In general, your servers and websites ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=662"
  },
  {
    "text": "should stop solely relying on client IP address ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=665"
  },
  {
    "text": "to determine user location or identity.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=668"
  },
  {
    "text": "If you need location access, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=672"
  },
  {
    "text": "consider requesting the user's location explicitly, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=674"
  },
  {
    "text": "and only at the granularity you need.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=677"
  },
  {
    "text": "If you need to identify users, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=680"
  },
  {
    "text": "request a login or some other form of explicit identification ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=682"
  },
  {
    "text": "rather than assuming that the IP address is tied to the identity.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=687"
  },
  {
    "text": "Last, let's cover some tips for managing your network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=692"
  },
  {
    "text": "when Private Relay is in use.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=696"
  },
  {
    "text": "If you're running a packet trace on your local network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=699"
  },
  {
    "text": "when Private Relay is in use, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=702"
  },
  {
    "text": "you'll see some new traffic patterns.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=704"
  },
  {
    "text": "You'll now see a lot more traffic running on UDP port 443.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=707"
  },
  {
    "text": "This is QUIC -- or HTTP/3 -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=712"
  },
  {
    "text": "traffic that's being used to communicate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=714"
  },
  {
    "text": "with the Private Relay proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=716"
  },
  {
    "text": "You can make sure your traffic works well ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=719"
  },
  {
    "text": "by allowing UDP port 443 on your network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=721"
  },
  {
    "text": "and by making sure your routers or Network Address Translators ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=724"
  },
  {
    "text": "are tuned to handle it well.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=728"
  },
  {
    "text": "You'll also see fewer cleartext UDP DNS queries on your network.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=731"
  },
  {
    "text": "Let's go over a typical network connection request ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=736"
  },
  {
    "text": "from a device when Private Relay is not in use.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=739"
  },
  {
    "text": "When a device tries to access a server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=742"
  },
  {
    "text": "it first sends a DNS query for the hostname of the server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=745"
  },
  {
    "text": "Once the hostname is resolved to an IP address, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=749"
  },
  {
    "text": "the device then connects to the IP address of the server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=752"
  },
  {
    "text": "using a transport protocol like TCP.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=755"
  },
  {
    "text": "The device then performs a TCP three-way handshake ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=759"
  },
  {
    "text": "with the server followed by a TLS exchange ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=762"
  },
  {
    "text": "to set up a secure connection with the server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=765"
  },
  {
    "text": "But as you can see, without Private Relay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=769"
  },
  {
    "text": "the hostname of the server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=772"
  },
  {
    "text": "and the IP address of the device connecting to the server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=774"
  },
  {
    "text": "are visible by simply observing packets on the network.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=777"
  },
  {
    "text": "With Private Relay, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=782"
  },
  {
    "text": "the device first sets up a connection to the ingress Proxy ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=784"
  },
  {
    "text": "using QUIC, or HTTP/3.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=787"
  },
  {
    "text": "In packet captures, you will notice UDP packets ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=789"
  },
  {
    "text": "sent to port 443 of the ingress proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=792"
  },
  {
    "text": "Once the network connection is established ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=796"
  },
  {
    "text": "to the ingress proxy, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=798"
  },
  {
    "text": "access to a server is secured within the connection ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=800"
  },
  {
    "text": "to the ingress proxy.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=802"
  },
  {
    "text": "On the server end, there is no change in protocol.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=806"
  },
  {
    "text": "The TCP/TLS exchange is similar to traffic ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=809"
  },
  {
    "text": "without Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=811"
  },
  {
    "text": "The only difference is that the server sees ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=813"
  },
  {
    "text": "the incoming connection from a proxy IP address ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=816"
  },
  {
    "text": "instead of a device's IP address.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=819"
  },
  {
    "text": "Most networks don't need to audit or monitor ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=823"
  },
  {
    "text": "all user traffic.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=826"
  },
  {
    "text": "However, if you run an enterprise or school network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=827"
  },
  {
    "text": "your network may have policies ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=831"
  },
  {
    "text": "that require intercepting all traffic.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=833"
  },
  {
    "text": "To support this use case, you can block the hostname ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=836"
  },
  {
    "text": "of the iCloud Private Relay proxy server.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=839"
  },
  {
    "text": "Then, when a device connects to your network, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=842"
  },
  {
    "text": "the user will receive a prompt indicating that Private Relay ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=845"
  },
  {
    "text": "is blocked on the current network.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=849"
  },
  {
    "text": "They can then choose to either disable Private Relay ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=851"
  },
  {
    "text": "for that network or switch networks.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=854"
  },
  {
    "text": "Information about the proxy hostname will be available ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=858"
  },
  {
    "text": "as an article associated with this session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=860"
  },
  {
    "text": "For parental controls, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=864"
  },
  {
    "text": "the best solution is to use content filter APIs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=865"
  },
  {
    "text": "provided by NetworkExtension framework.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=868"
  },
  {
    "text": "This allows traffic to be audited on device ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=871"
  },
  {
    "text": "even when Private Relay is enabled.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=874"
  },
  {
    "text": "For more information on content Filter APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=876"
  },
  {
    "text": "watch \"Meet the Screen Time API\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=879"
  },
  {
    "text": "and \"Network extension for the modern Mac\" sessions.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=882"
  },
  {
    "text": "To wrap things up, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=885"
  },
  {
    "text": "use modern secure networking APIs like URLSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=886"
  },
  {
    "text": "in your apps; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=890"
  },
  {
    "text": "test your apps with Private Relay; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=891"
  },
  {
    "text": "and make sure your servers and websites work well ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=894"
  },
  {
    "text": "when they receive connections routed through Private Relay.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=897"
  },
  {
    "text": "Thanks for watching, everyone! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=900"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10096/?time=901"
  }
]