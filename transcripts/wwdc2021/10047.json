[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=0"
  },
  {
    "text": "♪ Bass music playing ♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2"
  },
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=5"
  },
  {
    "text": "♪ ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=7"
  },
  {
    "text": "Brad Ford: Hello and welcome to \"What's new in camera capture.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=9"
  },
  {
    "text": "I'm Brad Ford from the Camera Software team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=13"
  },
  {
    "text": "I'll be presenting a host of new camera features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=16"
  },
  {
    "text": "beginning with minimum focus distance reporting; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=18"
  },
  {
    "text": "how to capture 10-bit HDR video; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=22"
  },
  {
    "text": "the main course, Video Effects in Control Center; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=25"
  },
  {
    "text": "and then -- a brief respite from new features -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=30"
  },
  {
    "text": "I'll review strategies to get the best performance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=32"
  },
  {
    "text": "out of your camera app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=34"
  },
  {
    "text": "And lastly, I'll introduce a brand-new performance trick ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=37"
  },
  {
    "text": "for your bag, IOSurface compression. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=40"
  },
  {
    "text": "All of the features I'll be describing today ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=44"
  },
  {
    "text": "are found in the AVFoundation framework -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=46"
  },
  {
    "text": "specifically, the classes prefixed with AVCapture. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=48"
  },
  {
    "text": "To briefly review, the main objects are AVCaptureDevices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=52"
  },
  {
    "text": "which represent cameras or microphones; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=57"
  },
  {
    "text": "AVCaptureDeviceInputs, which wrap devices, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=60"
  },
  {
    "text": "allowing them to be plugged into an AVCaptureSession, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=64"
  },
  {
    "text": "which is the central control object of the AVCapture graph. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=68"
  },
  {
    "text": "AVCaptureOutputs render data from inputs in various ways. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=73"
  },
  {
    "text": "The MovieFileOutput records QuickTime movies. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=77"
  },
  {
    "text": "The PhotoOutput captures high-quality stills ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=81"
  },
  {
    "text": "and Live Photos. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=84"
  },
  {
    "text": "Data outputs, such as the VideoDataOutput ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=86"
  },
  {
    "text": "or AudioDataOutput, deliver video or audio buffers ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=88"
  },
  {
    "text": "from the camera or mic to your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=92"
  },
  {
    "text": "There are several other kinds of data outputs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=95"
  },
  {
    "text": "such as Metadata and Depth. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=97"
  },
  {
    "text": "For live camera preview, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=103"
  },
  {
    "text": "there's a special type of output, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=104"
  },
  {
    "text": "the AVCaptureVideoPreviewLayer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=106"
  },
  {
    "text": "which is a subclass of CALayer. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=109"
  },
  {
    "text": "Data flows from the capture inputs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=113"
  },
  {
    "text": "to compatible capture outputs through AVCaptureConnections, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=115"
  },
  {
    "text": "represented here by these arrows. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=119"
  },
  {
    "text": "If you're new to AVFoundation camera capture, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=124"
  },
  {
    "text": "I invite you to learn more at the Cameras and Media Capture ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=126"
  },
  {
    "text": "start page on developer.apple.com. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=130"
  },
  {
    "text": "OK, let's dive right into the first of our new features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=133"
  },
  {
    "text": "Minimum focus distance is the distance from the lens ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=137"
  },
  {
    "text": "to the closest point where sharp focus can be attained. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=141"
  },
  {
    "text": "It's an attribute of all lenses, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=144"
  },
  {
    "text": "be they on DSLR cameras or smartphones. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=146"
  },
  {
    "text": "iPhone cameras have a minimum focus distance too, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=149"
  },
  {
    "text": "we've just never published it before... ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=152"
  },
  {
    "text": "...until now, that is. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=156"
  },
  {
    "text": "Beginning in iOS 15, minimum focus distance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=158"
  },
  {
    "text": "is a published property of iPhone autofocus cameras. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=161"
  },
  {
    "text": "Here's a sampling of recent iPhones. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=166"
  },
  {
    "text": "The chart illustrates how the minimum focus distance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=168"
  },
  {
    "text": "of the Wide and telephoto cameras ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=171"
  },
  {
    "text": "varies from model to model. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=173"
  },
  {
    "text": "There's a notable difference between the iPhone 12 Pro ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=176"
  },
  {
    "text": "and 12 Pro Max Wide cameras, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=179"
  },
  {
    "text": "the Pro Max focusing at a minimum distance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=182"
  },
  {
    "text": "of 15 centimeters compared to 12 on the Pro. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=185"
  },
  {
    "text": "This is due to the sensor shift stabilization technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=189"
  },
  {
    "text": "in the iPhone 12 Pro Max. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=192"
  },
  {
    "text": "Likewise, the minimum focus distance of the tele ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=196"
  },
  {
    "text": "is farther on the 12 Pro Max than the 12 Pro. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=199"
  },
  {
    "text": "This is due to the longer reach of the telephoto lens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=203"
  },
  {
    "text": "It has a 2.5x versus a 2x zoom. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=207"
  },
  {
    "text": "Let me show you a quick demo ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=212"
  },
  {
    "text": "of why minimum focus distance reporting is important.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=214"
  },
  {
    "text": "Here's a sample app called AVCamBarcode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=222"
  },
  {
    "text": "It showcases our AVFoundation barcode detection APIs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=225"
  },
  {
    "text": "The UI guides the user to position an object ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=228"
  },
  {
    "text": "inside of a rectangle for scanning. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=231"
  },
  {
    "text": "In this example, I've chosen a fairly small QR code ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=234"
  },
  {
    "text": "on a piece of paper. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=237"
  },
  {
    "text": "The barcode is only 20 millimeters wide. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=239"
  },
  {
    "text": "By tapping on the Metadata button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=242"
  },
  {
    "text": "I see a list of all the various object types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=244"
  },
  {
    "text": "supported by AVCaptureMetadataOutput. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=247"
  },
  {
    "text": "There are a lot of them. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=250"
  },
  {
    "text": "I'll choose QRCodes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=252"
  },
  {
    "text": "and then position my iPhone 12 Pro Max camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=255"
  },
  {
    "text": "to fill the rectangle with the QRCode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=258"
  },
  {
    "text": "Unfortunately, it's so small ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=261"
  },
  {
    "text": "that I have to get very close to the page to fill the preview. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=263"
  },
  {
    "text": "That's closer than the camera's minimum focus distance. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=267"
  },
  {
    "text": "The code is blurry, so it doesn't scan. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=270"
  },
  {
    "text": "To guide the user to back away, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=273"
  },
  {
    "text": "I need to apply a zoom factor to the camera preview...",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=276"
  },
  {
    "text": "...like so. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=282"
  },
  {
    "text": "Seeing a zoomed image on the screen ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=284"
  },
  {
    "text": "will prompt them to physically move the camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=286"
  },
  {
    "text": "farther away from the paper. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=287"
  },
  {
    "text": "I can do that with a slider button, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=289"
  },
  {
    "text": "but it would be much better ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=291"
  },
  {
    "text": "if the app took care of the zoom automatically.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=292"
  },
  {
    "text": "That's where the new minimumFocusDistance property ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=298"
  },
  {
    "text": "of AVCaptureDevice comes in. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=301"
  },
  {
    "text": "It's new in iOS 15. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=303"
  },
  {
    "text": "Given the camera's horizontal field of view, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=306"
  },
  {
    "text": "the minimum barcode size you'd like to scan -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=309"
  },
  {
    "text": "here I've set it to 20 millimeters -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=312"
  },
  {
    "text": "and the width of the camera preview window as a percentage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=315"
  },
  {
    "text": "we can do a little math to calculate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=319"
  },
  {
    "text": "the minimum subject distance needed ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=321"
  },
  {
    "text": "to fill that preview width. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=323"
  },
  {
    "text": "Then, using the new minimumFocusDistance ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=326"
  },
  {
    "text": "property of the camera, we can detect when our camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=329"
  },
  {
    "text": "can't focus that close and calculate a zoom factor ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=332"
  },
  {
    "text": "large enough to guide the user to back away. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=336"
  },
  {
    "text": "And finally, we apply it to the camera by locking it ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=339"
  },
  {
    "text": "for configuration, setting the zoom factor, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=343"
  },
  {
    "text": "and then unlocking it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=345"
  },
  {
    "text": "After recompiling our demo app, the UI now automatically ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=348"
  },
  {
    "text": "applies the correct zoom amount.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=353"
  },
  {
    "text": "As the app launches, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=358"
  },
  {
    "text": "it's already zoomed to the correct space. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=359"
  },
  {
    "text": "No more blurry barcodes! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=362"
  },
  {
    "text": "And if I tap on it, we can see where it takes me. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=365"
  },
  {
    "text": "Ah! \"Capturing Depth in iPhone Photography\" -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=370"
  },
  {
    "text": "an oldie but a goodie. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=372"
  },
  {
    "text": "I deeply appreciate that session.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=374"
  },
  {
    "text": "Please check out the new AVCamBarcode sample ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=380"
  },
  {
    "text": "for best practices on how to incorporate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=382"
  },
  {
    "text": "minimum focus distance, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=384"
  },
  {
    "text": "as well as a lot of other best practices for scanning barcodes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=386"
  },
  {
    "text": "Next up is 10-bit HDR video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=391"
  },
  {
    "text": "HDR stands for High Dynamic Range, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=395"
  },
  {
    "text": "and it's been around as a still image technology ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=397"
  },
  {
    "text": "since way back in iOS 4.1. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=399"
  },
  {
    "text": "Preserving High Dynamic Range is usually accomplished ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=403"
  },
  {
    "text": "by taking multiple exposures of a scene ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=405"
  },
  {
    "text": "and then blending them to preserve ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=408"
  },
  {
    "text": "both highlights and shadows. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=410"
  },
  {
    "text": "But what about video HDR? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=413"
  },
  {
    "text": "That's a challenge since you've got to deliver ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=416"
  },
  {
    "text": "30 or 60 frames a second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=418"
  },
  {
    "text": "Not exactly Video HDR -- but close -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=422"
  },
  {
    "text": "in 2018, Apple introduced EDR, or Extended Dynamic Range, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=425"
  },
  {
    "text": "to the iPhone XS camera line. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=430"
  },
  {
    "text": "EDR is an HDR-like solution for video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=433"
  },
  {
    "text": "It essentially doubles the capture frame rate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=438"
  },
  {
    "text": "alternating between standard exposures and short exposures, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=440"
  },
  {
    "text": "but timed so there's virtually no vertical blanking ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=445"
  },
  {
    "text": "between the captures. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=447"
  },
  {
    "text": "When nominally capturing 30 frames per second, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=450"
  },
  {
    "text": "EDR video is actually running the camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=452"
  },
  {
    "text": "at 60 frames a second. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=455"
  },
  {
    "text": "When required by the scene, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=458"
  },
  {
    "text": "the hue map from the EV- is dynamically applied ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=460"
  },
  {
    "text": "to the EV0 image to recover clipped highlights, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=463"
  },
  {
    "text": "but without sacrificing detail in the shadow. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=467"
  },
  {
    "text": "It's not a full HDR solution, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=470"
  },
  {
    "text": "as its effectiveness diminishes in low light, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=472"
  },
  {
    "text": "but it provides amazing results in medium to good light. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=475"
  },
  {
    "text": "Now here's the confusing part. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=480"
  },
  {
    "text": "EDR was presented as a suite of AVCaptureDevice properties ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=482"
  },
  {
    "text": "under the moniker of videoHDR. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=486"
  },
  {
    "text": "Wherever you see videoHDRSupported ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=490"
  },
  {
    "text": "or videoHDREnabled in the AVCapture API, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=493"
  },
  {
    "text": "you should mentally substitute EDR. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=496"
  },
  {
    "text": "That's what it is. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=499"
  },
  {
    "text": "AVCaptureDevice also has a property ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=502"
  },
  {
    "text": "called \"automaticallyAdjusts VideoHDREnabled\", ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=504"
  },
  {
    "text": "which defaults to true. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=508"
  },
  {
    "text": "So EDR is enabled automatically whenever it's available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=510"
  },
  {
    "text": "If for some reason you wish to disable it, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=515"
  },
  {
    "text": "you need to set ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=517"
  },
  {
    "text": "automaticallyAdjustsVideo HDREnabled to false, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=518"
  },
  {
    "text": "and then set videoHDREnabled to false as well. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=522"
  },
  {
    "text": "Now the story gets even better. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=528"
  },
  {
    "text": "I needed to tell you about EDR ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=530"
  },
  {
    "text": "so I could tell you about 10-bit HDR Video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=533"
  },
  {
    "text": "10-bit HDR video is truly High Dynamic Range ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=538"
  },
  {
    "text": "because it's got more bits! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=542"
  },
  {
    "text": "That means increased editability. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=544"
  },
  {
    "text": "It's got EDR for highlight recovery, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=547"
  },
  {
    "text": "and it's always on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=550"
  },
  {
    "text": "It uses hybrid log gamma curves ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=552"
  },
  {
    "text": "as well as the BT.2020 color space, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=554"
  },
  {
    "text": "allowing for even greater contrast of colors -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=558"
  },
  {
    "text": "brighter brights than Rec 709. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=560"
  },
  {
    "text": "And whether you use AVCaptureMovieFileOutput ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=563"
  },
  {
    "text": "or AVCaptureVideoDataOutput plus AVAssetWriter, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=566"
  },
  {
    "text": "we automatically insert per-frame Dolby Vision metadata ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=570"
  },
  {
    "text": "into your movies, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=574"
  },
  {
    "text": "making them compatible with Dolby Vision displays. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=575"
  },
  {
    "text": "10-bit HDR video was first introduced on the iPhone 12. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=579"
  },
  {
    "text": "10-bit HDR video formats can be identified ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=585"
  },
  {
    "text": "by their unique pixel format type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=587"
  },
  {
    "text": "On older iPhone models, cameras have ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=590"
  },
  {
    "text": "AVCaptureDeviceFormats that always come in pairs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=592"
  },
  {
    "text": "For each resolution and frame rate range, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=596"
  },
  {
    "text": "there's a 420v and a 420f format. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=599"
  },
  {
    "text": "These are 8-bit, biplanar, YUV formats. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=603"
  },
  {
    "text": "The V in 420v stands for video range -- or 16 to 235 -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=607"
  },
  {
    "text": "and the F in 420f stands for full range -- or 0 to 255. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=613"
  },
  {
    "text": "On iPhone 12 models, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=621"
  },
  {
    "text": "some formats come in clusters of three. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=623"
  },
  {
    "text": "After the 420v and 420f formats comes an x420 format ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=626"
  },
  {
    "text": "of the same resolution and frame rate range. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=631"
  },
  {
    "text": "Like 420v, x420 is a biplanar 420 format in video range, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=634"
  },
  {
    "text": "but the x in x420 stands for 10 bits instead of 8. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=640"
  },
  {
    "text": "To find and select a 10-bit HDR video format in code, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=646"
  },
  {
    "text": "simply iterate through the AVCaptureDevice formats ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=650"
  },
  {
    "text": "until you find one whose pixel format matches x420, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=653"
  },
  {
    "text": "or -- deep breath -- 420YpCbCr10BiPlanarVideoRange. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=657"
  },
  {
    "text": "You can of course include other search criteria, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=666"
  },
  {
    "text": "such as width, height, and max frame rate. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=669"
  },
  {
    "text": "We've updated our AVCam sample code ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=673"
  },
  {
    "text": "to support 10-bit HDR video when available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=675"
  },
  {
    "text": "There's a handy utility function in it ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=678"
  },
  {
    "text": "called \"tenBitVariantOfFormat\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=680"
  },
  {
    "text": "which can find the 10-bit HDR variant of ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=683"
  },
  {
    "text": "whatever the currently selected device active format is. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=685"
  },
  {
    "text": "Please take a look. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=689"
  },
  {
    "text": "10-bit HDR video is supported ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=692"
  },
  {
    "text": "in all the most popular video formats, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=694"
  },
  {
    "text": "including 720p, 1080p, and 4K. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=696"
  },
  {
    "text": "And we included a 4 by 3 format as well -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=701"
  },
  {
    "text": "1920 by 1440 -- which does support 12 megapixel, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=703"
  },
  {
    "text": "high-resolution photos.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=708"
  },
  {
    "text": "While capturing 10-bit HDR video is simple, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=713"
  },
  {
    "text": "editing and playing it back properly is tricky. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=716"
  },
  {
    "text": "I invite you to watch a companion session from 2020 ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=720"
  },
  {
    "text": "entitled \"Edit and play back HDR video with AVFoundation.\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=723"
  },
  {
    "text": "All right, that's it for HDR video.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=730"
  },
  {
    "text": "Now on to the main event: Video Effects in Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=734"
  },
  {
    "text": "Put simply, these are system-level camera features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=740"
  },
  {
    "text": "that are available in your apps with no code changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=744"
  },
  {
    "text": "And the user is in control. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=748"
  },
  {
    "text": "This is a bit of a departure for us. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=752"
  },
  {
    "text": "Traditionally, when we introduce a new camera feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=754"
  },
  {
    "text": "in iOS or macOS, Apple's apps adopt it out of the box. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=756"
  },
  {
    "text": "We expose new AVCapture APIs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=762"
  },
  {
    "text": "you learn about them -- just as you're doing now -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=765"
  },
  {
    "text": "and then you adopt the feature at your own pace. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=768"
  },
  {
    "text": "This is a safe and conservative approach, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=771"
  },
  {
    "text": "but often results in a long lead time ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=774"
  },
  {
    "text": "in which users miss out on a great feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=776"
  },
  {
    "text": "in their favorite camera apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=778"
  },
  {
    "text": "With Video Effects in Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=781"
  },
  {
    "text": "we are introducing system-level prepackaged camera features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=783"
  },
  {
    "text": "that are available to everyone right away ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=788"
  },
  {
    "text": "with no code changes, and the user is in control. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=791"
  },
  {
    "text": "We do continue to expose new APIs for these features, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=796"
  },
  {
    "text": "so you can tailor the experience in your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=799"
  },
  {
    "text": "as soon as your release schedule allows. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=802"
  },
  {
    "text": "Let's take a look at these effects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=806"
  },
  {
    "text": "The first was announced at our May ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=808"
  },
  {
    "text": "Spring Loaded Apple event and it's called \"Center Stage\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=809"
  },
  {
    "text": "It's available on the recently released M1 iPad Pro models ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=814"
  },
  {
    "text": "and it makes use of their incredible ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=818"
  },
  {
    "text": "12 megapixel Ultra Wide front-facing cameras. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=820"
  },
  {
    "text": "Center Stage really enhances ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=824"
  },
  {
    "text": "the production value of your FaceTime video calls. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=825"
  },
  {
    "text": "It also works great out of the box ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=829"
  },
  {
    "text": "in every other video conferencing app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=830"
  },
  {
    "text": "Here, let me show you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=833"
  },
  {
    "text": "I've just downloaded Skype from the App Store; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=835"
  },
  {
    "text": "this is a stock version of the app.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=838"
  },
  {
    "text": "When I start a Skype call, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=843"
  },
  {
    "text": "you immediately see Center Stage kick into action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=845"
  },
  {
    "text": "It's kind of like having your own personal camera operator. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=848"
  },
  {
    "text": "It frames you as you move around the scene ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=852"
  },
  {
    "text": "to keep you perfectly framed, whether you come in tight ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=854"
  },
  {
    "text": "or you move back and like to pace. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=858"
  },
  {
    "text": "it can even track you when you turn your face ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=862"
  },
  {
    "text": "away from the camera. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=864"
  },
  {
    "text": "That's because it tracks bodies, not just faces. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=866"
  },
  {
    "text": "As a user, I can control Center Stage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=871"
  },
  {
    "text": "by simply swiping down for Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=873"
  },
  {
    "text": "tapping on the new Video Effects module, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=877"
  },
  {
    "text": "and making my selection. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=880"
  },
  {
    "text": "As I turn Center Stage off and go back to the app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=883"
  },
  {
    "text": "I no longer get the Center Stage effect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=886"
  },
  {
    "text": "No changes in the app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=889"
  },
  {
    "text": "There's a companion new feature that all video conferencing apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=892"
  },
  {
    "text": "get as well, and that's called \"Portrait\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=895"
  },
  {
    "text": "Portrait mode offers me a beautifully rendered ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=899"
  },
  {
    "text": "shallow depth-of-field effect. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=901"
  },
  {
    "text": "It's not just a simple privacy blur; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=903"
  },
  {
    "text": "it uses Apple's Neural Engine ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=906"
  },
  {
    "text": "plus a trained monocular depth network ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=908"
  },
  {
    "text": "to approximate a real camera with a wide-open lens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=911"
  },
  {
    "text": "Now let's take a look finally at the mic modes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=916"
  },
  {
    "text": "by swiping down and picking the Mic Mode module, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=919"
  },
  {
    "text": "I can make my choice between Standard, Voice Isolation, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=926"
  },
  {
    "text": "or Wide Spectrum. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=931"
  },
  {
    "text": "Mic modes enhance the audio quality in your video chats. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=933"
  },
  {
    "text": "More on these in a minute. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=937"
  },
  {
    "text": "While Center Stage, Portrait, and Mic Modes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=939"
  },
  {
    "text": "share screen real estate in Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=942"
  },
  {
    "text": "they differ somewhat in API treatment. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=945"
  },
  {
    "text": "I'll introduce you to Center Stage APIs first ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=948"
  },
  {
    "text": "and then to Portrait and Mic Modes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=950"
  },
  {
    "text": "Center Stage is available on all the front cameras ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=954"
  },
  {
    "text": "of the M1 iPad Pros. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=956"
  },
  {
    "text": "Whether you're using the new front-facing Ultra Wide camera, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=959"
  },
  {
    "text": "the Virtual Wide camera -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=963"
  },
  {
    "text": "which presents a cropped, conventional field of view -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=965"
  },
  {
    "text": "or the Virtual TrueDepth camera, Center Stage is available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=968"
  },
  {
    "text": "The TrueDepth camera comes with some conditions, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=973"
  },
  {
    "text": "which I'll cover momentarily. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=975"
  },
  {
    "text": "The Control Center Video Effects module ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=979"
  },
  {
    "text": "presents an on/off toggle per app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=981"
  },
  {
    "text": "This allows you to default Center Stage to on ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=984"
  },
  {
    "text": "in a conferencing app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=987"
  },
  {
    "text": "while defaulting it to off in a pro photography app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=988"
  },
  {
    "text": "where you want to frame your shot manually. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=991"
  },
  {
    "text": "There's one state per app, not one state per camera. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=994"
  },
  {
    "text": "Because the Center Stage on/off toggle is per app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1000"
  },
  {
    "text": "not per camera, it's presented in the API ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1003"
  },
  {
    "text": "as a set of class properties on AVCaptureDevice. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1006"
  },
  {
    "text": "These are readable, writable, and key-value observable. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1010"
  },
  {
    "text": "centerStageEnabled matches the on/off state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1015"
  },
  {
    "text": "of the Center Stage UI in Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1018"
  },
  {
    "text": "The Center Stage control mode dictates who is allowed ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1021"
  },
  {
    "text": "to toggle the enabled state. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1025"
  },
  {
    "text": "More on that in a minute. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1027"
  },
  {
    "text": "Not all cameras or formats support Center Stage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1030"
  },
  {
    "text": "You can iterate through the formats array of any camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1033"
  },
  {
    "text": "to find a format that supports the feature ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1036"
  },
  {
    "text": "and set it as your activeFormat. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1039"
  },
  {
    "text": "Additionally, you can find out ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1042"
  },
  {
    "text": "if Center Stage is currently active for a particular camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1044"
  },
  {
    "text": "by querying or observing its Center Stage active property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1048"
  },
  {
    "text": "You should be aware of Center Stage's limitations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1054"
  },
  {
    "text": "Center Stage uses the full 12-megapixel format ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1057"
  },
  {
    "text": "of the Ultra Wide camera, which is a 30 fps format, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1060"
  },
  {
    "text": "so the max frame rate is limited to 30. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1064"
  },
  {
    "text": "Center Stage avoids upscaling to preserve image quality, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1068"
  },
  {
    "text": "so it's limited to a max output resolution of 1920 by 1440. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1072"
  },
  {
    "text": "Pan and zoom must remain under Center Stage control, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1079"
  },
  {
    "text": "so video zoom factor is locked at one. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1083"
  },
  {
    "text": "Geometric distortion correction ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1087"
  },
  {
    "text": "is integral to Center Stage's people framing, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1089"
  },
  {
    "text": "and depth delivery must be off, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1092"
  },
  {
    "text": "since depth generation requires matching ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1095"
  },
  {
    "text": "full field of view images from the RGB and infrared cameras. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1098"
  },
  {
    "text": "Now let's get into the concept of control modes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1103"
  },
  {
    "text": "Center Stage has three supported modes: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1107"
  },
  {
    "text": "user, app, and cooperative. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1110"
  },
  {
    "text": "User mode is the default Center Stage control mode ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1116"
  },
  {
    "text": "for all apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1119"
  },
  {
    "text": "In this mode, only the user can turn the feature on and off. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1120"
  },
  {
    "text": "If your app tries to programmatically change ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1124"
  },
  {
    "text": "the Center Stage enabled state, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1126"
  },
  {
    "text": "an exception is thrown. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1128"
  },
  {
    "text": "Next is the app mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1132"
  },
  {
    "text": "wherein only your app is allowed to control the feature. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1133"
  },
  {
    "text": "Users can't use Control Center ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1137"
  },
  {
    "text": "because the toggle is grayed out there. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1139"
  },
  {
    "text": "Use of this mode is discouraged. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1142"
  },
  {
    "text": "You should only use it if Center Stage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1144"
  },
  {
    "text": "is incompatible with your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1146"
  },
  {
    "text": "If you do need to opt out, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1148"
  },
  {
    "text": "you can set the control mode to app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1150"
  },
  {
    "text": "then set isCenterStageEnabled to false. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1153"
  },
  {
    "text": "The best possible user experience for Center Stage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1158"
  },
  {
    "text": "is the cooperative mode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1161"
  },
  {
    "text": "in which the user can control the feature in Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1163"
  },
  {
    "text": "and your app can control it with your own UI. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1166"
  },
  {
    "text": "You need to do some extra work, though. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1171"
  },
  {
    "text": "You must observe the ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1173"
  },
  {
    "text": "AVCaptureDevice .isCenterStageEnabled property ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1174"
  },
  {
    "text": "and update your UI to make sure Center Stage is on ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1178"
  },
  {
    "text": "when the user wants it on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1182"
  },
  {
    "text": "After setting the control mode to cooperative, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1184"
  },
  {
    "text": "you can set center stage enabled to true or false -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1187"
  },
  {
    "text": "based on a button in your app, for instance. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1191"
  },
  {
    "text": "The poster child for cooperative mode is FaceTime. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1194"
  },
  {
    "text": "While I'm in a FaceTime call, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1198"
  },
  {
    "text": "I can use a button right within the app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1200"
  },
  {
    "text": "to turn Center Stage on so that it tracks me, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1202"
  },
  {
    "text": "or I can use the conventional method ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1207"
  },
  {
    "text": "of swiping down in Control Center ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1210"
  },
  {
    "text": "and turning Center Stage on or off. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1212"
  },
  {
    "text": "FaceTime and Control Center cooperate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1216"
  },
  {
    "text": "on the state of Center Stage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1218"
  },
  {
    "text": "so that it's always matching user intent. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1220"
  },
  {
    "text": "FaceTime is also smart enough to know ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1223"
  },
  {
    "text": "when features are mutually incompatible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1225"
  },
  {
    "text": "So if, for instance, I tried to turn on Animoji, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1227"
  },
  {
    "text": "which requires depth...",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1231"
  },
  {
    "text": "...it knows to turn Center Stage off, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1238"
  },
  {
    "text": "because those two features are mutually incompatible. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1241"
  },
  {
    "text": "If I tap to turn Center Stage back on, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1244"
  },
  {
    "text": "FaceTime knows to disable Animoji. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1247"
  },
  {
    "text": "That wraps up Center Stage API. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1252"
  },
  {
    "text": "Let's transition over to Center Stage's ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1254"
  },
  {
    "text": "roommate in Control Center, Portrait. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1256"
  },
  {
    "text": "Put simply, it's a beautifully rendered ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1260"
  },
  {
    "text": "shallow depth-of-field effect, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1262"
  },
  {
    "text": "designed to look like a wide-aperture lens. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1264"
  },
  {
    "text": "On iOS, Portrait is supported ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1268"
  },
  {
    "text": "on all devices with Apple Neural Engine -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1270"
  },
  {
    "text": "that's 2018 and newer phones and pads. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1273"
  },
  {
    "text": "Only the front-facing camera is supported. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1277"
  },
  {
    "text": "It's also supported on all M1 Macs, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1280"
  },
  {
    "text": "which likewise contain Apple's Neural Engine. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1282"
  },
  {
    "text": "Portrait is a computationally complex algorithm. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1287"
  },
  {
    "text": "Thus, to keep video rendering performance responsive, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1290"
  },
  {
    "text": "it's limited to a max resolution of 1920 by 1440 ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1293"
  },
  {
    "text": "and a max resolution of 30 frames per second.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1298"
  },
  {
    "text": "Like Center Stage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1306"
  },
  {
    "text": "the Portrait effect has a sticky on/off state per app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1308"
  },
  {
    "text": "Its API is simpler than Center Stage's, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1312"
  },
  {
    "text": "the user is always in control through Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1315"
  },
  {
    "text": "and it's only available by default ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1319"
  },
  {
    "text": "in certain classes of apps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1321"
  },
  {
    "text": "On iOS, apps that use the VoIP UIBackgroundMode ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1324"
  },
  {
    "text": "are automatically opted in -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1328"
  },
  {
    "text": "users can turn the effect on or off in Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1330"
  },
  {
    "text": "All other iOS apps must opt in to declare themselves ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1334"
  },
  {
    "text": "eligible for the Portrait effect ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1337"
  },
  {
    "text": "by adding a new key to their app's Info.plist: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1339"
  },
  {
    "text": "NSCameraPortraitEffectEnabled. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1343"
  },
  {
    "text": "On macOS, all apps are automatically opted in, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1346"
  },
  {
    "text": "and can use the effect out-of-the-box. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1349"
  },
  {
    "text": "The Portrait effect is always under user control ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1353"
  },
  {
    "text": "through Control Center only. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1356"
  },
  {
    "text": "As with Center Stage, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1358"
  },
  {
    "text": "not all cameras or formats support Portrait. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1359"
  },
  {
    "text": "You can iterate through the formats array of any camera ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1363"
  },
  {
    "text": "to find a format that supports the feature, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1366"
  },
  {
    "text": "and set it as your active format. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1369"
  },
  {
    "text": "You can also find out if Portrait is currently active ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1372"
  },
  {
    "text": "for a particular camera by querying or observing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1375"
  },
  {
    "text": "its isPortraitEffectActive property. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1378"
  },
  {
    "text": "Mic Mode APIs are analogous to Portrait.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1383"
  },
  {
    "text": "User selection is sticky per app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1388"
  },
  {
    "text": "Users are always in control; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1391"
  },
  {
    "text": "your app can't set the Mic Mode directly. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1394"
  },
  {
    "text": "Some apps need to opt in to use the feature. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1397"
  },
  {
    "text": "Mic Modes are presented ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1401"
  },
  {
    "text": "in AVFoundation's AVCaptureDevice interface, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1402"
  },
  {
    "text": "and there are three flavors: ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1405"
  },
  {
    "text": "standard, which uses standard audio DSP; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1407"
  },
  {
    "text": "wide spectrum, which minimizes processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1412"
  },
  {
    "text": "to capture all sounds around the device ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1414"
  },
  {
    "text": "but it still includes echo cancellation; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1417"
  },
  {
    "text": "and voice isolation, which enhances speech ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1420"
  },
  {
    "text": "and removes unwanted background noise ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1424"
  },
  {
    "text": "such as typing on keyboards, mouse clicks, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1426"
  },
  {
    "text": "or leaf blowers running somewhere in the neighborhood. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1429"
  },
  {
    "text": "These flavors can only be set by the user in Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1432"
  },
  {
    "text": "but you can read and observe their state ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1436"
  },
  {
    "text": "using AVCaptureDevice's preferredMicrophoneMode -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1438"
  },
  {
    "text": "which is the mode selected by the user -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1442"
  },
  {
    "text": "and activeMicrophoneMode -- which is the mode now in use, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1445"
  },
  {
    "text": "taking into account the current audio route, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1450"
  },
  {
    "text": "which may not support the user's preferred Mic Mode. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1452"
  },
  {
    "text": "In order to use Mic Modes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1457"
  },
  {
    "text": "your app must adopt the Core Audio AUVoiceIO audio unit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1459"
  },
  {
    "text": "This is a popular interface in video conferencing apps, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1464"
  },
  {
    "text": "since it performs echo cancellation. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1467"
  },
  {
    "text": "And Mic Mode processing is only available on 2018 and later ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1470"
  },
  {
    "text": "iOS and macOS devices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1474"
  },
  {
    "text": "With Portrait and Mic Modes, the user is always in control, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1478"
  },
  {
    "text": "but you can prompt them to turn the feature off or on ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1482"
  },
  {
    "text": "by calling the new AVCaptureDevice ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1485"
  },
  {
    "text": ".showSystemUserInterface method. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1488"
  },
  {
    "text": "And you can pass it either videoEffects or microphoneModes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1491"
  },
  {
    "text": "Calling this API opens Control Center ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1497"
  },
  {
    "text": "and deeplinks to the appropriate submodule. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1499"
  },
  {
    "text": "Here, we're drilling down to the Video Effects module, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1502"
  },
  {
    "text": "where the user can choose to turn Portrait off.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1505"
  },
  {
    "text": "That wraps up Portrait, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1512"
  },
  {
    "text": "and wraps up Video Effects in Control Center. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1513"
  },
  {
    "text": "I've just shown you examples of system-level camera features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1517"
  },
  {
    "text": "injected into your app without you changing a line of code -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1519"
  },
  {
    "text": "a pretty powerful concept! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1523"
  },
  {
    "text": "There's a companion session to this one ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1526"
  },
  {
    "text": "called \"Capture high-quality photos using video formats\", ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1527"
  },
  {
    "text": "where you'll learn about improvements we've made ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1531"
  },
  {
    "text": "to still image quality in your apps ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1533"
  },
  {
    "text": "without you changing a line of code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1536"
  },
  {
    "text": "Please check it out. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1538"
  },
  {
    "text": "We've covered a lot of new features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1541"
  },
  {
    "text": "At this point in the session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1543"
  },
  {
    "text": "I'd like to take a breather and talk about performance. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1545"
  },
  {
    "text": "Center Stage and Portrait are great new user features, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1548"
  },
  {
    "text": "but they do carry an added performance cost. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1551"
  },
  {
    "text": "So let's review performance best practices ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1556"
  },
  {
    "text": "to make sure your camera apps are ready for new features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1559"
  },
  {
    "text": "like Portrait and Center Stage. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1561"
  },
  {
    "text": "Camera apps use AVCapture classes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1564"
  },
  {
    "text": "to deliver a wide array of features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1566"
  },
  {
    "text": "The most popular interface is AVCaptureVideoDataOutput, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1569"
  },
  {
    "text": "which allows you to get video frames direct to your process ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1574"
  },
  {
    "text": "for manipulating, displaying, encoding, recording... ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1576"
  },
  {
    "text": "you name it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1581"
  },
  {
    "text": "When using VideoDataOutput, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1583"
  },
  {
    "text": "it's important to ensure that your app ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1585"
  },
  {
    "text": "is keeping up with real-time deadlines ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1587"
  },
  {
    "text": "so there are no frame drops. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1589"
  },
  {
    "text": "By default, VideoDataOutput ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1591"
  },
  {
    "text": "prevents you from getting behind by setting its ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1593"
  },
  {
    "text": "alwaysDiscardsLateVideoFrames property to true. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1596"
  },
  {
    "text": "This enforces a buffer queue size of one ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1600"
  },
  {
    "text": "at the end of video data output's processing pipeline ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1602"
  },
  {
    "text": "and saves you from periodic or chronic slow processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1605"
  },
  {
    "text": "by always giving you the freshest frame ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1609"
  },
  {
    "text": "and dropping frames you weren't ready to process. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1611"
  },
  {
    "text": "It doesn't help you if you need to record ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1615"
  },
  {
    "text": "the frames you're receiving, such as with AVAssetWriter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1617"
  },
  {
    "text": "If you intend to record your processed results, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1620"
  },
  {
    "text": "you should turn alwaysDiscardsLateVideoFrames ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1623"
  },
  {
    "text": "off and pay close attention to your processing times. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1626"
  },
  {
    "text": "VideoDataOutput tells you when frame drops are occurring ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1632"
  },
  {
    "text": "by calling your provided captureOutput didDrop ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1635"
  },
  {
    "text": "sampleBuffer delegate callback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1638"
  },
  {
    "text": "When you receive a didDrop callback, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1641"
  },
  {
    "text": "you can inspect the included sampleBuffer's attachments ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1643"
  },
  {
    "text": "for a droppedFrameReason. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1646"
  },
  {
    "text": "This can inform what to do to mitigate further frame drops. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1649"
  },
  {
    "text": "There are three reasons: FrameWasLate, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1653"
  },
  {
    "text": "which means your processing is taking too long; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1656"
  },
  {
    "text": "OutOfBuffers, which means you may be holding on ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1660"
  },
  {
    "text": "to too many buffers; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1662"
  },
  {
    "text": "and Discontinuity, which means there is a system slow down ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1665"
  },
  {
    "text": "or hardware failure that's not your fault. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1669"
  },
  {
    "text": "Now let's talk about how to react to frame drops. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1673"
  },
  {
    "text": "One of the best ways ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1676"
  },
  {
    "text": "is to lower the device frame rate dynamically. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1677"
  },
  {
    "text": "Doing so incurs no glitches in preview or output. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1680"
  },
  {
    "text": "You simply set a new activeMinVideoFrameDuration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1684"
  },
  {
    "text": "on your AVCaptureDevice at run time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1687"
  },
  {
    "text": "A second way is to simplify your workload ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1690"
  },
  {
    "text": "so you're not taking so much time. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1693"
  },
  {
    "text": "Now let's talk about system pressure, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1698"
  },
  {
    "text": "another performance metric that's crucially important ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1700"
  },
  {
    "text": "to a good user experience in your camera app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1703"
  },
  {
    "text": "System pressure means just that, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1706"
  },
  {
    "text": "the system is subject to strain or pressure. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1708"
  },
  {
    "text": "AVCaptureDevice has a property called systemPressureState, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1712"
  },
  {
    "text": "which consists of factors and an overall level. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1715"
  },
  {
    "text": "The SystemPressureState contributing factors ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1720"
  },
  {
    "text": "are a bit mask of three possible contributors. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1723"
  },
  {
    "text": "systemTemperature refers to how hot the device is getting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1727"
  },
  {
    "text": "peakPower is all about battery aging, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1731"
  },
  {
    "text": "and whether the battery is capable of ramping up voltage ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1734"
  },
  {
    "text": "quickly enough to meet peak power demands. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1737"
  },
  {
    "text": "And the depthModuleTemperature, which refers to how hot ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1740"
  },
  {
    "text": "the TrueDepth camera's infrared sensor is getting. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1744"
  },
  {
    "text": "The SystemPressureState's level is an indicator ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1748"
  },
  {
    "text": "that can help you take action ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1751"
  },
  {
    "text": "before your user experience is compromised. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1753"
  },
  {
    "text": "When it's nominal, everything is copacetic. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1756"
  },
  {
    "text": "Fair indicates that system pressure is slightly elevated. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1759"
  },
  {
    "text": "This might happen even if you're doing very little processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1763"
  },
  {
    "text": "but the ambient temperature is high. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1766"
  },
  {
    "text": "At serious, system pressure is highly elevated; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1769"
  },
  {
    "text": "capture performance may be impacted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1772"
  },
  {
    "text": "Frame rate throttling is advised. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1775"
  },
  {
    "text": "Once you reach critical, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1778"
  },
  {
    "text": "system pressure is critically elevated; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1780"
  },
  {
    "text": "capture quality and performance are significantly impacted. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1783"
  },
  {
    "text": "Frame rate throttling is highly advised. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1787"
  },
  {
    "text": "And you never want to let things escalate to shutdown, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1790"
  },
  {
    "text": "where system pressure is beyond critical. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1793"
  },
  {
    "text": "At this level, AVCaptureSession ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1797"
  },
  {
    "text": "stops automatically to spare the device from thermal trap.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1798"
  },
  {
    "text": "You can react to elevated pressure in a variety of ways. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1805"
  },
  {
    "text": "Lower the capture frame rate; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1809"
  },
  {
    "text": "this will always help system pressure. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1811"
  },
  {
    "text": "If lowering the frame rate isn't an option, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1814"
  },
  {
    "text": "consider lessening your workload on the CPU or GPU, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1816"
  },
  {
    "text": "such as turning off certain features. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1820"
  },
  {
    "text": "You might also keep features on but degrade the quality, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1822"
  },
  {
    "text": "perhaps by only processing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1826"
  },
  {
    "text": "a smaller resolution or less frequently. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1828"
  },
  {
    "text": "AVCaptureSession never frame rate throttles ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1831"
  },
  {
    "text": "on your behalf, since we don't know ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1833"
  },
  {
    "text": "if that's an acceptable quality degradation strategy ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1835"
  },
  {
    "text": "for your app. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1838"
  },
  {
    "text": "That wraps up performance best practices. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1841"
  },
  {
    "text": "Now onto our dessert course, IOSurface compression. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1843"
  },
  {
    "text": "I carefully avoided talking about memory bandwidth ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1849"
  },
  {
    "text": "in the performance section, since there's not much ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1852"
  },
  {
    "text": "you can do about the overall memory bandwidth ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1854"
  },
  {
    "text": "requirements of video flowing through the ISP ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1856"
  },
  {
    "text": "and eventually to your photos, movies, preview, or buffers. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1859"
  },
  {
    "text": "But still, memory bandwidth can be a crucial limiter ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1864"
  },
  {
    "text": "in determining which camera features ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1867"
  },
  {
    "text": "can simultaneously run. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1869"
  },
  {
    "text": "When working with uncompressed video on iOS and macOS, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1872"
  },
  {
    "text": "there are a lot of layers involved. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1876"
  },
  {
    "text": "It's a little like a Russian nesting doll. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1878"
  },
  {
    "text": "At the top level is a CMSampleBuffer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1881"
  },
  {
    "text": "which can wrap all kinds of media data, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1885"
  },
  {
    "text": "as well as timing and metadata. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1887"
  },
  {
    "text": "Down one level, there's the CVPixelBuffer, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1891"
  },
  {
    "text": "which specifically wraps pixel buffer data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1894"
  },
  {
    "text": "along with metadata attachments. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1897"
  },
  {
    "text": "Finally, you get to that lowest level, IOSurface, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1900"
  },
  {
    "text": "which allows the memory to be wired to the kernel, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1904"
  },
  {
    "text": "as well as provides an interface ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1906"
  },
  {
    "text": "for sharing large video buffers across processes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1908"
  },
  {
    "text": "IOSurfaces are huge. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1912"
  },
  {
    "text": "They account for the great memory bandwidth requirements ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1914"
  },
  {
    "text": "of uncompressed video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1917"
  },
  {
    "text": "Now thankfully, IOSurface compression ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1919"
  },
  {
    "text": "offers a solution for memory bandwidth problems. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1921"
  },
  {
    "text": "New in iOS 15, we're introducing support ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1925"
  },
  {
    "text": "for a lossless in-memory video compression format. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1928"
  },
  {
    "text": "It's an optimization to lower total memory bandwidth ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1932"
  },
  {
    "text": "for live video. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1935"
  },
  {
    "text": "It's an interchange format ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1937"
  },
  {
    "text": "understood by the major hardware blocks on iOS devices and Macs. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1938"
  },
  {
    "text": "It's available on all iPhone 12 variants, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1943"
  },
  {
    "text": "Fall 2020 iPad Airs, and Spring 2021 M1 iPad Pros. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1948"
  },
  {
    "text": "Which major hardware blocks deal in compressed IOSurfaces? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1956"
  },
  {
    "text": "Well, there are a lot. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1960"
  },
  {
    "text": "All services listed here understand ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1963"
  },
  {
    "text": "how to read or write compressed IOSurfaces. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1966"
  },
  {
    "text": "At this point you may be saying, \"Great, how do I sign up?\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1971"
  },
  {
    "text": "Well, good news. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1976"
  },
  {
    "text": "If you're capturing video on supported hardware ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1977"
  },
  {
    "text": "and the AVCaptureSession doesn't need to deliver ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1979"
  },
  {
    "text": "any buffers to your process, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1982"
  },
  {
    "text": "congratulations, your session is already ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1984"
  },
  {
    "text": "taking advantage of IOSurface compression ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1986"
  },
  {
    "text": "whenever it can to reduce memory bandwidth. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1989"
  },
  {
    "text": "If you want compressed surfaces ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1992"
  },
  {
    "text": "delivered to your video data output, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1994"
  },
  {
    "text": "you need to know about a few rules. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=1996"
  },
  {
    "text": "Physical memory layout is opaque and may change, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2000"
  },
  {
    "text": "so don't write to disk, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2004"
  },
  {
    "text": "don't assume the same layout on all platforms, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2006"
  },
  {
    "text": "don't read or write using the CPU. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2010"
  },
  {
    "text": "AVCaptureVideoDataOutput supports several flavors ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2015"
  },
  {
    "text": "of IOSurface compression. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2018"
  },
  {
    "text": "Earlier in the talk, you learned that iOS cameras ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2020"
  },
  {
    "text": "natively support 420v and 420f -- ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2023"
  },
  {
    "text": "8-bit YUV formats; one video and one full range. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2026"
  },
  {
    "text": "And later, you learned about x420, a 10-bit HDR video format. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2031"
  },
  {
    "text": "Video data output can also internally expand ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2037"
  },
  {
    "text": "to 16-bits-per-pixel BGRA if requested. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2040"
  },
  {
    "text": "Each of these has an IOSurface compressed equivalent ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2045"
  },
  {
    "text": "which, beginning in iOS 15, you can request ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2048"
  },
  {
    "text": "through AVCaptureVideoDataOutput. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2051"
  },
  {
    "text": "If you're a fan of ampersands in your four-character codes, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2054"
  },
  {
    "text": "this is your lucky day. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2057"
  },
  {
    "text": "Here it is again in eye chart format. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2060"
  },
  {
    "text": "These are the actual constants you should use in your code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2063"
  },
  {
    "text": "Two years ago we released a piece of sample code ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2068"
  },
  {
    "text": "called \"AVMultiCamPiP\". ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2070"
  },
  {
    "text": "In this sample, the front and back cameras ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2073"
  },
  {
    "text": "are streamed simultaneously to VideoDataOutputs ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2076"
  },
  {
    "text": "using a multicam session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2079"
  },
  {
    "text": "then composited as a Picture in Picture ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2082"
  },
  {
    "text": "using a Metal shader, which then renders the composite to preview ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2085"
  },
  {
    "text": "and writes to a movie using AVAssetWriter. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2090"
  },
  {
    "text": "This is the perfect candidate for IOSurface compression ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2093"
  },
  {
    "text": "as all of these operations are performed on hardware. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2096"
  },
  {
    "text": "Here's the existing VideoDataOutput setup code ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2101"
  },
  {
    "text": "in AVMultiCamPiP. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2103"
  },
  {
    "text": "It likes to work with BGRA, so it configures ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2106"
  },
  {
    "text": "the VideoDataOutput's videoSettings ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2109"
  },
  {
    "text": "to produce that pixel format type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2112"
  },
  {
    "text": "The new code just incorporates some checks. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2116"
  },
  {
    "text": "First it sees if the IOSurface compressed version ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2119"
  },
  {
    "text": "of BGRA is available. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2123"
  },
  {
    "text": "And if so, it picks that; ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2125"
  },
  {
    "text": "the else clause is just there as a fallback. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2127"
  },
  {
    "text": "And just like that, we've come to the end. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2131"
  },
  {
    "text": "You learned about minimum focus distance reporting, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2135"
  },
  {
    "text": "how to capture 10-bit HDR video, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2139"
  },
  {
    "text": "Video Effects and Mic Modes in Control Center, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2142"
  },
  {
    "text": "performance best practices, and IOSurface compression. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2147"
  },
  {
    "text": "I hope you enjoyed it! ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2152"
  },
  {
    "text": "Thanks for watching. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2154"
  },
  {
    "text": "♪",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10047/?time=2155"
  }
]