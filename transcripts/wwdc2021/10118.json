[
  {
    "text": " ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=2"
  },
  {
    "text": "Hi, I'm Rusty. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=10"
  },
  {
    "text": "I'm an engineer on the CloudKit team, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=11"
  },
  {
    "text": "and I'm excited to introduce a new CloudKit developer tool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=14"
  },
  {
    "text": "as well as a brand-new CloudKit schema language. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=17"
  },
  {
    "text": "In this session, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=19"
  },
  {
    "text": "I'll talk about why integration testing ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=20"
  },
  {
    "text": "can be challenging for an application ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=22"
  },
  {
    "text": "that integrates with the cloud. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=24"
  },
  {
    "text": "Then, I'll demonstrate cktool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=26"
  },
  {
    "text": "our new command line developer tool for CloudKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=28"
  },
  {
    "text": "You'll find out how cktool can be used ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=30"
  },
  {
    "text": "inside of Xcode to automate test setup. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=32"
  },
  {
    "text": "You'll learn about CloudKit's new declarative schema language. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=35"
  },
  {
    "text": "And then, I'll wrap things up with next steps. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=38"
  },
  {
    "text": "Let's get started.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=40"
  },
  {
    "text": "When you write applications that depend on cloud services, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=43"
  },
  {
    "text": "there are explicit contracts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=45"
  },
  {
    "text": "between your application ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=47"
  },
  {
    "text": "and the services you depend on. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=48"
  },
  {
    "text": "Integration tests can help you validate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=50"
  },
  {
    "text": "how you interact with these services, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=52"
  },
  {
    "text": "but properly automating setup ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=54"
  },
  {
    "text": "of these integration tests can be challenging ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=55"
  },
  {
    "text": "for a few reasons. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=57"
  },
  {
    "text": "First, it's not always easy to keep the server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=58"
  },
  {
    "text": "up to date with the data model ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=60"
  },
  {
    "text": "your app is using. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=62"
  },
  {
    "text": "As you iterate on your schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=63"
  },
  {
    "text": "during development of your app, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=64"
  },
  {
    "text": "it's important that the schema on the server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=66"
  },
  {
    "text": "exactly matches the schema your app is using ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=68"
  },
  {
    "text": "when your tests run. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=70"
  },
  {
    "text": "Also, it can be difficult ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=71"
  },
  {
    "text": "to ensure that your tests are running ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=73"
  },
  {
    "text": "against a consistent set of sample data in the cloud ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=74"
  },
  {
    "text": "each time the tests run, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=76"
  },
  {
    "text": "particularly if your tests modify that data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=78"
  },
  {
    "text": "as part of the test. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=79"
  },
  {
    "text": "The CloudKit team has just made all of this easier for you. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=81"
  },
  {
    "text": "With the new CloudKit schema language we've just introduced, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=84"
  },
  {
    "text": "you can declare your CloudKit schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=87"
  },
  {
    "text": "in a file right alongside your application code, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=89"
  },
  {
    "text": "and then check it into version control ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=91"
  },
  {
    "text": "so that you can track changes ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=93"
  },
  {
    "text": "along with all other changes in your project, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=94"
  },
  {
    "text": "and always ensure that your app's data model ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=96"
  },
  {
    "text": "is consistent with your CloudKit schema. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=98"
  },
  {
    "text": "And with the new cktool command line developer tool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=101"
  },
  {
    "text": "you can easily automate ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=103"
  },
  {
    "text": "the process of sending this schema declaration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=104"
  },
  {
    "text": "to the CloudKit server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=106"
  },
  {
    "text": "while also creating a consistent set of sample data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=107"
  },
  {
    "text": "on the server right before you run your tests. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=110"
  },
  {
    "text": "Let me jump right in and start using cktool. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=113"
  },
  {
    "text": "First, cktool is installed with Xcode 13. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=116"
  },
  {
    "text": "Once you install Xcode 13, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=119"
  },
  {
    "text": "you can start using cktool from the Terminal right away. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=120"
  },
  {
    "text": "cktool is invoked with xcrun. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=124"
  },
  {
    "text": "It offers several commands. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=127"
  },
  {
    "text": "For example, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=128"
  },
  {
    "text": "it can create records on the CloudKit server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=129"
  },
  {
    "text": "query records that already exist on the server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=132"
  },
  {
    "text": "import and export the new schema language files, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=134"
  },
  {
    "text": "manage authorization for the tool itself, and more. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=137"
  },
  {
    "text": "Before using cktool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=141"
  },
  {
    "text": "there are a few things to understand ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=143"
  },
  {
    "text": "about authorization with CloudKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=144"
  },
  {
    "text": "Since cktool communicates directly ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=146"
  },
  {
    "text": "with the CloudKit server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=148"
  },
  {
    "text": "it's necessary to first get the tool authorized. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=149"
  },
  {
    "text": "You can choose to only authorize cktool ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=152"
  },
  {
    "text": "to perform container-management functions like schema import, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=154"
  },
  {
    "text": "or you can additionally authorize the tool ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=157"
  },
  {
    "text": "to access data in your container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=159"
  },
  {
    "text": "CloudKit has introduced ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=161"
  },
  {
    "text": "two new concepts for this purpose. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=162"
  },
  {
    "text": "The first is called a \"management token,\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=164"
  },
  {
    "text": "which is used by cktool ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=166"
  },
  {
    "text": "to manage your CloudKit container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=168"
  },
  {
    "text": "The management token is tied to a single developer account ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=169"
  },
  {
    "text": "and can be used across developer teams ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=172"
  },
  {
    "text": "if that developer is a member of multiple teams. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=174"
  },
  {
    "text": "A management token is intended ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=177"
  },
  {
    "text": "for configuration use cases only, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=178"
  },
  {
    "text": "like schema import and export. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=180"
  },
  {
    "text": "This token doesn't provide any access ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=182"
  },
  {
    "text": "to data in the container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=183"
  },
  {
    "text": "So, we've also introduced a user token, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=185"
  },
  {
    "text": "which can be used to authorize the tool to write data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=188"
  },
  {
    "text": "into the user's private database of an app's container ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=190"
  },
  {
    "text": "or to the public database of an app's container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=192"
  },
  {
    "text": "I can get a management token ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=195"
  },
  {
    "text": "and also a user token from the CloudKit Console. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=196"
  },
  {
    "text": "For more information on the CloudKit Console, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=199"
  },
  {
    "text": "you can check out \"Meet CloudKit Console,\" ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=201"
  },
  {
    "text": "another WWDC21 session. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=203"
  },
  {
    "text": "Now that I've obtained both a management token ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=206"
  },
  {
    "text": "for my developer account and also a user token, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=208"
  },
  {
    "text": "I can add them to the tool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=210"
  },
  {
    "text": "which will store them securely in my macOS Keychain, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=212"
  },
  {
    "text": "and I'm ready to proceed. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=214"
  },
  {
    "text": "I can now start doing some interesting things. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=216"
  },
  {
    "text": "For example, I'll ask for a list ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=218"
  },
  {
    "text": "of my Apple developer team memberships. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=220"
  },
  {
    "text": "And I get back a list of teams ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=222"
  },
  {
    "text": "that I'm a member of. Great. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=223"
  },
  {
    "text": "Now let's say that I have a database schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=225"
  },
  {
    "text": "defined in my container, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=227"
  },
  {
    "text": "and I want to commit it to my source code repository ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=228"
  },
  {
    "text": "prior to making changes. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=231"
  },
  {
    "text": "With cktool, that's easy to do. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=232"
  },
  {
    "text": "Using this export-schema command, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=234"
  },
  {
    "text": "I can pull down my development schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=237"
  },
  {
    "text": "to a file called “schema.ckdb.” ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=238"
  },
  {
    "text": "This file is formatted in the new ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=241"
  },
  {
    "text": "CloudKit schema language I mentioned earlier, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=243"
  },
  {
    "text": "and we'll explore this file in detail in just a minute. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=245"
  },
  {
    "text": "With cktool, I can add data to my container, too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=248"
  },
  {
    "text": "Here, if I have sample values expressed as JSON, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=251"
  },
  {
    "text": "like for this sample Book record here, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=253"
  },
  {
    "text": "I can use that JSON as input to the tool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=255"
  },
  {
    "text": "just like this, to create a record ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=258"
  },
  {
    "text": "in my public database. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=259"
  },
  {
    "text": "Okay, so now that you have a basic sense ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=261"
  },
  {
    "text": "of how the tool operates, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=263"
  },
  {
    "text": "I'll make a simple three-step script ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=265"
  },
  {
    "text": "to delete all the data from the development environment ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=267"
  },
  {
    "text": "of my app's CloudKit container, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=269"
  },
  {
    "text": "then send my schema declaration to the server, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=271"
  },
  {
    "text": "and finally, load some test data. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=273"
  },
  {
    "text": "That way, I can run this script ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=275"
  },
  {
    "text": "as part of a test pre-action in Xcode ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=277"
  },
  {
    "text": "and ensure that my CloudKit container ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=279"
  },
  {
    "text": "is always in a consistent state, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=281"
  },
  {
    "text": "with the exact schema my application is using ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=282"
  },
  {
    "text": "before each time that I run my tests. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=284"
  },
  {
    "text": "So, here in Xcode, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=287"
  },
  {
    "text": "I'll edit the scheme for my project's application ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=289"
  },
  {
    "text": "and choose Pre-actions in the Test phase. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=292"
  },
  {
    "text": "Now, I can add a New Run Script Action. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=295"
  },
  {
    "text": "I'll provide build settings for my app target, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=298"
  },
  {
    "text": "so that the script has a path to the schema file ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=301"
  },
  {
    "text": "in my project. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=303"
  },
  {
    "text": "Right here, I'll paste a cktool command ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=305"
  },
  {
    "text": "to reset my container, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=308"
  },
  {
    "text": "and then, one to import schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=310"
  },
  {
    "text": "from the file in my application project, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=312"
  },
  {
    "text": "and finally, one to create an example record ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=314"
  },
  {
    "text": "in my container's public database.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=317"
  },
  {
    "text": "Note that since these commands are synchronous, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=320"
  },
  {
    "text": "they will execute one after another, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=321"
  },
  {
    "text": "and any failure will stop execution, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=323"
  },
  {
    "text": "just in case something doesn't go as expected. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=325"
  },
  {
    "text": "In that case, I can take care to resolve ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=327"
  },
  {
    "text": "any pre-test issues ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=330"
  },
  {
    "text": "before actually running my tests. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=331"
  },
  {
    "text": "That's it. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=332"
  },
  {
    "text": "Now, when I run my Xcode tests, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=334"
  },
  {
    "text": "cktool will prepare my CloudKit container ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=336"
  },
  {
    "text": "right before they run. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=338"
  },
  {
    "text": "Perfect.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=339"
  },
  {
    "text": "So, what if I need to change ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=340"
  },
  {
    "text": "the data model for my application? ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=342"
  },
  {
    "text": "Let's talk more about CloudKit schema language. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=344"
  },
  {
    "text": "In fact, let's examine that schema.ckdb file ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=346"
  },
  {
    "text": "that I downloaded earlier. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=350"
  },
  {
    "text": "Inside the file ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=351"
  },
  {
    "text": "is the new CloudKit schema language, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=353"
  },
  {
    "text": "which is a powerful way to describe ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=354"
  },
  {
    "text": "the record types in my schema. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=356"
  },
  {
    "text": "It's easy to read and write, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=358"
  },
  {
    "text": "and to include right here in my project ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=359"
  },
  {
    "text": "with my application code. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=361"
  },
  {
    "text": "Here inside the schema section, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=362"
  },
  {
    "text": "there are record types. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=364"
  },
  {
    "text": "These exactly mirror the record types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=366"
  },
  {
    "text": "as shown for my container in the CloudKit Console. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=368"
  },
  {
    "text": "Each record type has multiple fields, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=370"
  },
  {
    "text": "and each field has a name and data type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=372"
  },
  {
    "text": "The triple-underscore field names are system fields, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=375"
  },
  {
    "text": "which are created by CloudKit for every record type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=378"
  },
  {
    "text": "Below these system fields are my custom fields, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=381"
  },
  {
    "text": "which represent my custom application data ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=383"
  },
  {
    "text": "for this record type in CloudKit. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=385"
  },
  {
    "text": "I can create an index for a field, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=387"
  },
  {
    "text": "like a Queryable, Searchable, or Sortable index, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=389"
  },
  {
    "text": "just like I can do in the CloudKit Console.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=392"
  },
  {
    "text": "I do this in CloudKit schema language ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=395"
  },
  {
    "text": "by declaring the index ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=396"
  },
  {
    "text": "right after the data type for the field, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=398"
  },
  {
    "text": "like for this \"title\" custom field ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=400"
  },
  {
    "text": "in my Book record type here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=402"
  },
  {
    "text": "Below the field definitions ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=403"
  },
  {
    "text": "are the security role settings for the record type. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=405"
  },
  {
    "text": "This is where permissions can be granted ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=407"
  },
  {
    "text": "to each named security role, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=409"
  },
  {
    "text": "like for each of these three built-in ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=411"
  },
  {
    "text": "system security roles here. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=412"
  },
  {
    "text": "“_creator\" includes only the user that created the record, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=414"
  },
  {
    "text": "“_world\" includes all users, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=417"
  },
  {
    "text": "and “_icloud\" includes any authenticated user. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=419"
  },
  {
    "text": "Note that in CloudKit schema language, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=422"
  },
  {
    "text": "you can include both single and multi-line comments ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=424"
  },
  {
    "text": "to make the schema files even more readable ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=426"
  },
  {
    "text": "for you and your team. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=428"
  },
  {
    "text": "Comments will be ignored by the CloudKit server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=429"
  },
  {
    "text": "when the file is processed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=431"
  },
  {
    "text": "so feel free to put comments wherever you'd like. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=432"
  },
  {
    "text": "Now that CloudKit schema language ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=434"
  },
  {
    "text": "provides developers a fast, flexible way ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=436"
  },
  {
    "text": "to declare and modify schemas, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=437"
  },
  {
    "text": "it's important to remember a few core concepts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=439"
  },
  {
    "text": "around CloudKit schema evolution. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=441"
  },
  {
    "text": "First, you have full control over record types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=444"
  },
  {
    "text": "in the development environment of your container. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=447"
  },
  {
    "text": "You can add and remove record types in development, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=449"
  },
  {
    "text": "and also add and remove custom fields ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=451"
  },
  {
    "text": "inside those record types, with no limitations. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=454"
  },
  {
    "text": "Of course, new record types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=457"
  },
  {
    "text": "can always be promoted to production, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=458"
  },
  {
    "text": "and new fields can be added to existing record types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=460"
  },
  {
    "text": "in production, as well. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=462"
  },
  {
    "text": "But once record types have been promoted ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=464"
  },
  {
    "text": "to the production environment of your container, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=465"
  },
  {
    "text": "they can't be deleted or renamed, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=467"
  },
  {
    "text": "and custom fields inside record types ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=469"
  },
  {
    "text": "that have been promoted to production ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=471"
  },
  {
    "text": "cannot be deleted or renamed, either. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=473"
  },
  {
    "text": "The reason for this ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=475"
  },
  {
    "text": "is to ensure that the CloudKit server ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=476"
  },
  {
    "text": "always understands record types and fields, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=478"
  },
  {
    "text": "which older versions of your app might still be using. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=480"
  },
  {
    "text": "This means that while you can ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=483"
  },
  {
    "text": "make destructive changes to your schema declaration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=484"
  },
  {
    "text": "in the development environment of your container, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=486"
  },
  {
    "text": "you will not be able to promote ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=488"
  },
  {
    "text": "these destructive changes to production. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=490"
  },
  {
    "text": "Note that it is possible to add and remove ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=492"
  },
  {
    "text": "indexes in production, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=493"
  },
  {
    "text": "and security role settings can be modified, too. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=495"
  },
  {
    "text": "All of these schema promotion concepts ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=498"
  },
  {
    "text": "are not new to CloudKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=500"
  },
  {
    "text": "but the flexibility you get ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=501"
  },
  {
    "text": "from this new file-based schema declaration ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=503"
  },
  {
    "text": "means that it's important to review and understand them.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=505"
  },
  {
    "text": "Now that you've gotten a sense of what cktool can do ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=508"
  },
  {
    "text": "and how CloudKit schema language works, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=511"
  },
  {
    "text": "I encourage you to try out both in your own projects. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=513"
  },
  {
    "text": "Authorize cktool with a management token ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=516"
  },
  {
    "text": "and user token from the CloudKit Console, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=518"
  },
  {
    "text": "and explore its commands. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=520"
  },
  {
    "text": "Export your existing CloudKit schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=522"
  },
  {
    "text": "into a CloudKit schema language file, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=524"
  },
  {
    "text": "and add it to your project, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=526"
  },
  {
    "text": "making sure to check it into version control ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=527"
  },
  {
    "text": "with the rest of your project.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=529"
  },
  {
    "text": "Compose some setup steps for your integration tests ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=531"
  },
  {
    "text": "using cktool, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=533"
  },
  {
    "text": "and add the script as a test pre-action ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=535"
  },
  {
    "text": "to your Xcode scheme.",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=537"
  },
  {
    "text": "The ability to administer certain elements ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=538"
  },
  {
    "text": "of your CloudKit container from the command line ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=540"
  },
  {
    "text": "can be really powerful. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=542"
  },
  {
    "text": "Maintaining a declaration of your CloudKit schema ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=544"
  },
  {
    "text": "in a file, right alongside all of your other application code, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=546"
  },
  {
    "text": "can help you keep it consistent with your data model ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=550"
  },
  {
    "text": "throughout your development life cycle, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=552"
  },
  {
    "text": "and tying all of this together ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=554"
  },
  {
    "text": "to automate cloud setup of your integration tests ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=556"
  },
  {
    "text": "is even better. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=558"
  },
  {
    "text": "We're excited to find out ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=560"
  },
  {
    "text": "what you do with these new tools. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=561"
  },
  {
    "text": "Thanks for taking the time to learn more about CloudKit, ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=563"
  },
  {
    "text": "and for your interest in WWDC21. ",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=565"
  },
  {
    "text": "[music]",
    "link": "https://developer.apple.com/videos/play/wwdc2021/10118/?time=567"
  }
]